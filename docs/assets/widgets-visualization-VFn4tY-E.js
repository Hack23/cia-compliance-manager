import{r as g,j as e}from"./react-vendor-CfW4w6aS.js";import{Z as f,B as m,j as i,_ as S,W as I,a as w,$ as s,b as C,c as V,g as R,a0 as T,a1 as A,a2 as E,r as u,p as $}from"./widgets-assessment-63OCX6xS.js";import"./chart-BRhaV9pk.js";const D=({availabilityLevel:t,integrityLevel:r,confidentialityLevel:a,className:h="",testId:x=s.root})=>{const{error:b,isLoading:y}=f(),l=g.useMemo(()=>{const d=m(t),n=m(r),o=m(a),p=i(d),N=i(n),k=i(o),v=p+N+k;return Math.round(v/12*100)},[t,r,a]),c=g.useMemo(()=>{const d=$(t,r,a);return S(d)},[t,r,a]),j=()=>{const d=i(t),n=i(r),o=i(a);return t===r&&r===a&&(t==="High"||t==="Very High")?e.jsx("div",{"data-testid":s.section("balanced-recommendation"),className:"p-md bg-green-50 dark:bg-green-900/20 rounded-lg mt-md",children:e.jsx("p",{className:"text-sm",children:"Your security posture is well-balanced with strong controls across all CIA components."})}):e.jsxs("div",{className:"space-y-xs mt-md","data-testid":s.section("recommendations"),children:[d<2&&e.jsx("div",{className:"p-sm bg-info-light/10 dark:bg-info-dark/20 rounded",children:e.jsx("p",{className:"text-sm",children:"Consider improving availability controls to ensure business continuity."})}),n<3&&e.jsx("div",{className:"p-sm bg-success-light/10 dark:bg-success-dark/20 rounded",children:e.jsx("p",{className:"text-sm",children:"Enhance data validation mechanisms and change management to improve integrity."})}),o<2&&e.jsx("div",{className:"p-sm bg-primary-light/10 dark:bg-primary-dark/20 rounded-md",children:e.jsx("p",{className:"text-sm",children:"Strengthen access controls and data protection to improve confidentiality."})})]})};return e.jsx(I,{widgetName:"Security Visualization",children:e.jsx(w,{title:V.SECURITY_VISUALIZATION,icon:C.SECURITY_VISUALIZATION,className:h,testId:x,isLoading:y,error:b,children:e.jsxs("div",{className:"p-md sm:p-lg",role:"region","aria-label":R("Security Visualization","Visual representation of security posture with CIA triad metrics, security score, and risk level"),children:[e.jsxs("section",{className:"mb-lg","aria-labelledby":"security-posture-heading",children:[e.jsx("h3",{id:"security-posture-heading",className:"text-subheading font-medium mb-md",children:"Security Posture"}),e.jsxs("div",{className:"p-md bg-neutral-light/10 dark:bg-neutral-dark/20 rounded-md",role:"group","aria-label":"Security metrics",children:[e.jsxs("div",{className:"flex justify-between items-center mb-md",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-body text-gray-600 dark:text-gray-400",children:"Security Score"}),e.jsx("div",{className:"text-title font-bold","data-testid":s.value("security-score"),"aria-label":`Security score: ${l} out of 100`,children:l})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-body text-gray-600 dark:text-gray-400",children:"Risk Level"}),e.jsx("div",{className:`text-xl font-bold ${T(c)}`,"data-testid":s.label("risk-level"),role:"status","aria-label":`Risk level: ${c}`,children:c})]})]}),e.jsxs("div",{className:"mb-sm","aria-label":"Security score visualization",children:[e.jsx("div",{className:"text-caption text-gray-600 dark:text-gray-400 mb-xs",children:"Security Level"}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${A(l)}`,style:{width:`${l}%`},"data-testid":s.section("security-score-bar")})}),e.jsxs("div",{className:"flex justify-between text-caption text-gray-600 dark:text-gray-400 mt-xs",children:[e.jsx("div",{children:"Critical"}),e.jsx("div",{children:"High"}),e.jsx("div",{children:"Medium"}),e.jsx("div",{children:"Low"}),e.jsx("div",{children:"Minimal"})]})]})]})]}),e.jsxs("div",{className:"mb-lg",children:[e.jsx("h3",{className:"text-subheading font-medium mb-md",children:"Security Components"}),e.jsx("div",{className:"p-md bg-white dark:bg-gray-800 rounded-md border border-neutral-light dark:border-neutral-dark",children:e.jsx("div",{className:"w-full aspect-square max-h-[400px] mx-auto",children:e.jsx(E,{availabilityLevel:t,integrityLevel:r,confidentialityLevel:a,testId:`${x}-radar-chart`})})})]}),e.jsxs("div",{className:"mb-lg",children:[e.jsx("h3",{className:"text-subheading font-medium mb-md",children:"Component Details"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-sm",children:[e.jsxs("div",{className:"p-md bg-primary-light/10 dark:bg-primary-dark/20 rounded-md","data-testid":s.section("confidentiality-component"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-sm",children:[e.jsx("div",{className:"text-body-lg font-medium text-primary-dark dark:text-primary-light",children:"Confidentiality"}),e.jsx(u,{level:a,testId:"confidentiality-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${i(a)/4*100}%`},"data-testid":s.section("confidentiality-gauge")})})]}),e.jsxs("div",{className:"p-md bg-green-50 dark:bg-green-900/20 rounded-lg","data-testid":s.section("integrity-component"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-sm",children:[e.jsx("div",{className:"text-body-lg font-medium text-green-800 dark:text-green-300",children:"Integrity"}),e.jsx(u,{level:r,testId:"integrity-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${i(r)/4*100}%`},"data-testid":s.section("integrity-gauge")})})]}),e.jsxs("div",{className:"p-md bg-blue-50 dark:bg-blue-900/20 rounded-lg","data-testid":s.section("availability-component"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-sm",children:[e.jsx("div",{className:"text-body-lg font-medium text-blue-800 dark:text-blue-300",children:"Availability"}),e.jsx(u,{level:t,testId:"availability-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full",style:{width:`${i(t)/4*100}%`},"data-testid":s.section("availability-gauge")})})]})]})]}),j(),e.jsxs("div",{className:"p-md bg-blue-50 dark:bg-blue-900/20 rounded-lg mt-md",children:[e.jsx("h3",{className:"text-body-lg font-medium mb-sm",children:"Security Visualization Key"}),e.jsx("p",{className:"text-body text-gray-600 dark:text-gray-400 mb-sm",children:"The security score represents your overall security posture based on your CIA triad levels. The risk level indicates the potential business risk associated with your current security posture."}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-sm text-xs",children:[e.jsx("div",{className:"p-xs bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300 rounded text-center",children:"Critical Risk"}),e.jsx("div",{className:"p-xs bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300 rounded text-center",children:"High Risk"}),e.jsx("div",{className:"p-xs bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded text-center",children:"Medium Risk"}),e.jsx("div",{className:"p-xs bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 rounded text-center",children:"Low Risk"}),e.jsx("div",{className:"p-xs bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 rounded text-center",children:"Minimal Risk"})]})]})]})})})};export{D as default};
//# sourceMappingURL=widgets-visualization-VFn4tY-E.js.map
