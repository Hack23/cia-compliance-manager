import{r as e,j as t,R as i,a}from"./react-CsjRAjRV.js";import{C as s}from"./vendor-BiRFWzok.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const r={BACKGROUND:{NONE:"#dc3545",LOW:"#e67e22",MODERATE:"#f1c40f",HIGH:"#2ecc71",VERY_HIGH:"#3498db"},DARK_MODE:{NONE:"#ff6b6b",LOW:"#ff9f43",MODERATE:"#feca57",HIGH:"#54e346",VERY_HIGH:"#70a1ff"}},n={CONFIDENTIALITY:{PRIMARY:"#9c27b0",SECONDARY:"#e1bee7",DARK:"#7b1fa2"},INTEGRITY:{PRIMARY:"#27ae60",SECONDARY:"#d4efdf",DARK:"#2ecc71"},AVAILABILITY:{PRIMARY:"#2196f3",SECONDARY:"#bbdefb",DARK:"#1976d2"}},l=e=>{const t=document.documentElement.classList.contains("dark"),i=e.replace(/\s+/g,"_").toUpperCase();return{bg:t?r.DARK_MODE[i]||r.DARK_MODE.NONE:r.BACKGROUND[i]||r.BACKGROUND.NONE,text:t||"NONE"===i||"LOW"===i?"#ffffff":"#000000"}},o={None:{description:"No availability measures are in place. The system is prone to frequent, unpredictable outages.",technical:"No redundancy, backup systems, monitoring, or disaster recovery procedures are implemented.",businessImpact:"Severe disruptions occur during outages, potentially resulting in revenue losses estimated at 5-10% annually under prolonged conditions.",capex:0,opex:0,bg:l("None").bg,text:l("None").text,recommendations:["Implement basic monitoring to detect outages early","Establish a rudimentary backup process with periodic testing","Document manual recovery procedures with clear roles","Establish baseline uptime metrics to gauge current performance","Identify and prioritize critical systems for improvement"],uptime:"<90%",businessImpactDetails:{financialImpact:{description:"Prolonged outages can lead to significant revenue loss, estimated at 5-10% of annual revenue.",riskLevel:"Critical",annualRevenueLoss:"5-10% of annual revenue"},operationalImpact:{description:"Operations are severely disrupted with recovery timelines that are highly unpredictable.",riskLevel:"Critical",meanTimeToRecover:"Unpredictable (hours to days)"},regulatory:{description:"Likely violates basic service agreements and regulatory requirements.",riskLevel:"High",complianceViolations:["SLAs","Basic industry standards"]}},securityIcon:"âš ï¸"},Low:{description:"Basic availability measures are present but have significant limitations, leading to extended downtime during disruptions.",technical:"Reliance on manual backup processes and limited monitoring, with basic recovery documentation.",businessImpact:"Moderate disruptions can lead to revenue losses estimated at 3-5% annually, heavily dependent on recovery speed.",capex:5,opex:3,bg:l("Low").bg,text:l("Low").text,recommendations:["Implement scheduled backups and test recovery procedures regularly","Set up basic monitoring alerts for early detection","Document recovery processes and establish a communication protocol for outages"],uptime:"95%",rto:"24-48 hours",rpo:"24 hours",mttr:"12-24 hours",businessImpactDetails:{financialImpact:{description:"Revenue impact is estimated at around 3-5% annually due to extended downtimes.",riskLevel:"High",annualRevenueLoss:"3-5% of annual revenue"},operationalImpact:{description:"Business disruptions are significant and require manual intervention, leading to slower recovery.",riskLevel:"High",meanTimeToRecover:"12-24 hours"}},securityIcon:"ðŸ”’"},Moderate:{description:"Standard availability measures that yield acceptable uptime with planned disaster recovery processes.",technical:"Scheduled backups, automated monitoring with alerts, documented recovery procedures, and partial redundancy for key components.",businessImpact:"Occasional disruptions are generally contained, with revenue losses estimated at 1-3% annually.",capex:15,opex:10,bg:l("Moderate").bg,text:l("Moderate").text,recommendations:["Enhance redundancy for mission-critical systems","Automate backup and disaster recovery testing","Integrate comprehensive monitoring with defined SLAs"],uptime:"99%",rto:"4-8 hours",rpo:"4 hours",mttr:"2-4 hours",businessImpactDetails:{financialImpact:{description:"Revenue impact is modest, estimated at approximately 1-3% annually, assuming typical outage scenarios.",riskLevel:"Medium",annualRevenueLoss:"1-3% of annual revenue"},operationalImpact:{description:"Disruptions occur infrequently and recovery is relatively quick.",riskLevel:"Medium",meanTimeToRecover:"2-4 hours"}},securityIcon:"ðŸ›¡ï¸"},High:{description:"Robust availability measures with high redundancy and automated recovery systems ensure near-continuous operations.",technical:"N+1 redundancy, multi-region standby systems, automated failover, comprehensive monitoring, and regular disaster recovery testing.",businessImpact:"Business continuity is well-maintained with negligible revenue impact (generally under 1%).",capex:30,opex:20,bg:l("High").bg,text:l("High").text,recommendations:["Deploy N+1 redundancy for all critical systems","Implement automated failover and real-time monitoring","Conduct regular disaster recovery drills and define escalation procedures"],uptime:"99.9%",rto:"15-60 minutes",rpo:"15 minutes",mttr:"10-30 minutes",businessImpactDetails:{financialImpact:{description:"Revenue impact is minimal, generally estimated at less than 1% of annual revenue.",riskLevel:"Low",annualRevenueLoss:"<1% of annual revenue"},operationalImpact:{description:"Disruptions are rare and recovery is almost instantaneous due to automation.",riskLevel:"Low",meanTimeToRecover:"10-30 minutes"},strategic:{description:"High reliability can support market expansion and reinforces customer trust.",riskLevel:"Low"}},securityIcon:"ðŸ›¡ï¸ðŸ›¡ï¸"},"Very High":{description:"Maximum availability with continuous operations enabled by multi-region redundancy, real-time replication, and fully automated recovery.",technical:"N+2 redundancy, active-active multi-region architecture, real-time replication, and automated remediation ensure near-zero downtime.",businessImpact:"Operational continuity is nearly uninterrupted under normal conditions, with revenue impact considered negligibleâ€”though extreme events remain a risk.",capex:60,opex:40,bg:l("Very High").bg,text:l("Very High").text,recommendations:["Implement N+2 redundancy across all critical components","Deploy an active-active multi-region architecture with real-time replication","Establish fully automated remediation systems and 24/7 operations support","Conduct regular chaos engineering exercises to stress-test resilience"],uptime:"99.99%",rto:"<5 minutes",rpo:"<1 minute",mttr:"<5 minutes",businessImpactDetails:{financialImpact:{description:"Revenue losses due to availability issues are negligible under normal conditions.",riskLevel:"Minimal"},operationalImpact:{description:"Business operations are maintained nearly continuously with rapid, automated recovery.",riskLevel:"Minimal",meanTimeToRecover:"<5 minutes"},strategic:{description:"Superior reliability offers a competitive advantage in high-demand markets.",riskLevel:"Minimal"},regulatory:{description:"Exceeds stringent regulatory and SLA requirements for availability.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ›¡ï¸ðŸ›¡ï¸ðŸ›¡ï¸"}},c={None:{description:"No integrity controls are implemented, leaving the system vulnerable to undetected data corruption.",technical:"There is no input validation, no checksums, no audit logging, and no data verification mechanisms.",businessImpact:"This lack of controls poses a critical risk to decision-making and financial reporting, potentially leading to significant operational disruptions.",capex:0,opex:0,bg:l("None").bg,text:l("None").text,recommendations:["Implement fundamental input validation measures","Introduce basic application-level data checks","Set up rudimentary audit logs for critical transactions"],businessImpactDetails:{financialImpact:{description:"Financial reporting reliability is severely compromised, risking misallocation of resources.",riskLevel:"Critical"},operationalImpact:{description:"Decisions based on inaccurate data can lead to cascading failures and prolonged recovery times.",riskLevel:"Critical"}},validationMethod:"None"},Low:{description:"Basic integrity controls are present, relying mainly on manual verification processes that are error-prone and hard to scale.",technical:"Relies on simple input validation, rudimentary access controls, and manual checksum verification without automated oversight.",businessImpact:"Data inaccuracies may occur intermittently, potentially leading to errors in financial calculations and operational inefficiencies.",capex:5,opex:3,bg:l("Low").bg,text:l("Low").text,recommendations:["Adopt server-side validation to minimize human error","Introduce automated data verification where possible","Schedule regular manual reviews to detect anomalies"],validationMethod:"Manual checks",businessImpactDetails:{financialImpact:{description:"Financial calculations might be affected by occasional errors, though the overall impact is moderate.",riskLevel:"High"},operationalImpact:{description:"Manual processes may catch corruption inconsistently, leading to sporadic operational delays.",riskLevel:"High"}}},Moderate:{description:"Standard integrity controls combine automated verification with periodic manual oversight, providing a reasonable level of assurance.",technical:"Utilizes comprehensive input validation, checksums, version control, and audit logging with a blend of automated and manual checks.",businessImpact:"Most data corruption is detected and corrected, though sophisticated attacks or subtle errors may still occur.",capex:15,opex:10,bg:l("Moderate").bg,text:l("Moderate").text,recommendations:["Implement end-to-end automated data validation","Utilize database constraints and triggers to enforce integrity rules","Establish robust audit trails and periodic integrity reviews"],validationMethod:"Automated validation",businessImpactDetails:{financialImpact:{description:"Financial data is generally reliable; however, occasional discrepancies may still impact reporting accuracy.",riskLevel:"Medium"},operationalImpact:{description:"Operational disruptions are infrequent and usually resolved quickly via established audit trails.",riskLevel:"Medium"},regulatory:{description:"Controls meet basic regulatory standards, though they might fall short of stricter compliance requirements.",riskLevel:"Medium"}}},High:{description:"Advanced integrity controls employing cryptographic techniques provide strong data assurance, albeit with increased complexity and cost.",technical:"Incorporates digital signatures, hash verifications, and tamper-resistant audit logs to secure data integrity.",businessImpact:"Data integrity is strongly maintained, reducing risks in financial and operational decision-making, but the high investment may limit broader scalability.",capex:30,opex:20,bg:l("High").bg,text:l("High").text,recommendations:["Deploy digital signatures for high-risk data entries","Implement cryptographic hash validations for data immutability","Establish immutable audit logging mechanisms"],validationMethod:"Cryptographic verification",businessImpactDetails:{financialImpact:{description:"High confidence in financial data minimizes the risk of significant misreporting.",riskLevel:"Low"},operationalImpact:{description:"Robust change tracking enables timely detection and correction of data errors.",riskLevel:"Low"},regulatory:{description:"These controls typically exceed many regulatory requirements, providing a strong compliance posture.",riskLevel:"Low"}}},"Very High":{description:"State-of-the-art integrity controls leveraging distributed ledger technologies provide near-absolute data assurance, though they introduce significant complexity and cost.",technical:"Employs multi-party verification, blockchain-based ledgers, and zero-knowledge proofs to ensure immutable audit trails.",businessImpact:"Data integrity is virtually guaranteed, which is critical for high-stakes regulatory and financial environments, but the substantial investment and complexity may not be justifiable for all organizations.",capex:60,opex:40,bg:l("Very High").bg,text:l("Very High").text,recommendations:["Explore blockchain or distributed ledger solutions for critical data","Deploy multi-party verification systems to enhance auditability","Investigate zero-knowledge proofs to verify data integrity without compromising confidentiality"],validationMethod:"Blockchain/distributed ledger",businessImpactDetails:{financialImpact:{description:"Ensures exceptional reliability of financial data, enabling precise reporting in regulated sectors.",riskLevel:"Minimal"},operationalImpact:{description:"Data integrity is nearly absolute, reducing operational risk to an absolute minimum, despite high system complexity.",riskLevel:"Minimal"},strategic:{description:"Supports organizations in highly regulated or high-stakes markets; however, the cost and complexity may outweigh benefits for most.",riskLevel:"Minimal"}}}},d={None:{description:"No confidentiality controls are implemented, leaving sensitive information fully exposed to any user with system access.",technical:"There are no access controls, no encryption measures, and no data classification processes.",businessImpact:"This exposes the organization to severe reputational damage and regulatory non-compliance, with potential legal penalties if sensitive data is compromised.",capex:0,opex:0,bg:l("None").bg,text:l("None").text,recommendations:["Implement basic authentication mechanisms","Introduce simple authorization controls","Establish a rudimentary data classification scheme"],protectionMethod:"None",businessImpactDetails:{reputationalImpact:{description:"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical"},regulatory:{description:"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}}},Low:{description:"Basic confidentiality measures are in place but provide only minimal protection against unauthorized access.",technical:"Relies on password protection, basic role-based access controls, and minimal encryption.",businessImpact:"Sensitive data is somewhat protected, but the risk of exposure remains high, potentially leading to moderate reputational harm and regulatory challenges.",capex:5,opex:3,bg:l("Low").bg,text:l("Low").text,recommendations:["Upgrade to a robust authentication system","Implement comprehensive role-based access controls","Enforce TLS/SSL for all data in transit"],protectionMethod:"Basic access control",businessImpactDetails:{reputationalImpact:{description:"Exposure of sensitive data is possible, which could lead to moderate damage to the organizationâ€™s reputation if an incident occurs.",riskLevel:"High"},regulatory:{description:"Existing measures may not fully satisfy privacy regulations, leading to potential fines or legal scrutiny.",riskLevel:"High"}}},Moderate:{description:"Standard confidentiality measures provide a reasonable level of protection for sensitive information under typical threat scenarios.",technical:"Utilizes strong authentication, role-based access control, and encryption both at rest and in transit.",businessImpact:"Most unauthorized access attempts are thwarted, reducing the risk of data breaches. However, sophisticated threats might still pose a risk, leading to moderate operational and reputational impacts.",capex:15,opex:10,bg:l("Moderate").bg,text:l("Moderate").text,recommendations:["Implement robust encryption for data both at rest and in transit","Regularly review and update access controls","Establish continuous monitoring and auditing of data access"],protectionMethod:"Standard encryption",businessImpactDetails:{reputationalImpact:{description:"Sensitive data is largely protected, mitigating the risk of reputational damage in the event of an incident.",riskLevel:"Medium"},regulatory:{description:"Generally meets standard data protection requirements, though vulnerabilities may remain against highly sophisticated attacks.",riskLevel:"Medium"}}},High:{description:"Advanced confidentiality measures provide strong protection against unauthorized access to sensitive information.",technical:"Employs multi-factor authentication, robust encryption, fine-grained access controls, and continuous security monitoring.",businessImpact:"Significantly reduces the risk of data breaches, thereby minimizing reputational damage and ensuring compliance with stringent regulatory standards.",capex:30,opex:20,bg:l("High").bg,text:l("High").text,recommendations:["Deploy multi-factor authentication across all user access points","Implement end-to-end encryption and conduct regular security audits","Establish comprehensive monitoring of data access and activity"],protectionMethod:"E2E encryption",businessImpactDetails:{reputationalImpact:{description:"High-level measures substantially reduce the risk of sensitive data exposure, protecting the organizationâ€™s reputation.",riskLevel:"Low"},regulatory:{description:"Measures meet or exceed many regulatory requirements, thereby reducing legal risks.",riskLevel:"Low"}}},"Very High":{description:"Maximum confidentiality measures are implemented for protecting highly sensitive or classified information.",technical:"Uses advanced encryption standards, hardware security modules, strict access controls, and a zero-trust architecture with continuous monitoring.",businessImpact:"Provides best-in-class protection, virtually eliminating the risk of unauthorized data access. However, the high cost and system complexity may not be justifiable for all organizations.",capex:60,opex:40,bg:l("Very High").bg,text:l("Very High").text,recommendations:["Implement quantum-resistant encryption algorithms","Deploy hardware security modules for critical data repositories","Adopt a zero-trust architecture to continuously validate access"],protectionMethod:"Military-grade encryption",businessImpactDetails:{reputationalImpact:{description:"Provides near-absolute protection of sensitive data, virtually eliminating the risk of reputational damage.",riskLevel:"Minimal"},strategic:{description:"Enables secure handling of top-secret or highly regulated information, although the high investment and complexity require careful justification.",riskLevel:"Minimal"}}}},m={NONE:{value:"0%",returnRate:"0%",description:"No security investment yields no cost avoidance, leaving the firm fully exposed.",potentialSavings:"$0",breakEvenPeriod:"N/A"},LOW:{value:"0-10%",returnRate:"0-10%",description:"Minimal investment yields negligible benefits; returns are marginal and highly context-dependent.",potentialSavings:"$0.5K-$2K (contextual)",breakEvenPeriod:"30-36 months"},MODERATE:{value:"10-20%",returnRate:"10-20%",description:"Standard investments offer modest risk reduction with benefits that vary by environment.",potentialSavings:"$2K-$10K (contextual)",breakEvenPeriod:"24-30 months"},HIGH:{value:"20-30%",returnRate:"20-30%",description:"Advanced measures improve protection, though realized returns may be lower than expected.",potentialSavings:"$10K-$30K (contextual)",breakEvenPeriod:"18-24 months"},VERY_HIGH:{value:"30-50%",returnRate:"30-50%",description:"Premium investments aim for robust risk management but may not fully justify the high cost in less favorable contexts.",potentialSavings:"$30K-$70K (contextual)",breakEvenPeriod:"12-18 months",implementationCost:"High initial investment with variable returns"}},u=o,p=c,g=d,x=m;const y="Unknown Risk",h={NONE:"None",LOW:"Low",MODERATE:"Moderate",HIGH:"High",VERY_HIGH:"Very High"},b="Availability",v="Integrity",f="Confidentiality",N="ðŸ”’",j="ðŸ”",k="â±ï¸",I="Controls who can access your data and systems",w="Ensures data remains accurate and unaltered",L="Determines how reliably your systems can be accessed",C={NONE:"Not recommended for any production system. Implement basic security controls immediately.",LOW:"Only appropriate for non-critical systems with public information.",MODERATE:"Suitable for internal business systems with some regulatory requirements.",HIGH:"Appropriate for systems handling sensitive customer data or financial information.",VERY_HIGH:"Suitable for mission-critical systems handling top secret information.",BASIC:"Only appropriate for non-critical systems with public information."},M="Negative (high risk of losses)",S="1-2x for basic security implementation",A="2-3x with moderate security",E="3-5x with high security",R="5x+ with very high security",T="Basic security implementation with minimal investment. Suitable for small businesses or non-critical systems.",H="Comprehensive security solution requiring significant investment. Recommended for critical systems or regulated industries.",O={SECURITY_LEVEL:"Security Profile Configuration"},$="CIA Compliance Manager Dashboard";new RegExp(Object.values({SOC2:"SOC 2",ISO27001:"ISO 27001",PCI_DSS:"PCI DSS",HIPAA:"HIPAA",NIST:"NIST 800-53 High"}).join("|"));const P={None:{developmentEffort:"Minimal",maintenance:"None",expertise:"Basic"},Low:{developmentEffort:"Days",maintenance:"Monthly checks",expertise:"Junior"},Moderate:{developmentEffort:"Weeks",maintenance:"Weekly checks",expertise:"Mid-level"},High:{developmentEffort:"1-2 Months",maintenance:"Daily monitoring",expertise:"Senior"},"Very High":{developmentEffort:"2-6 Months",maintenance:"Continuous monitoring",expertise:"Expert"}},D={SECURITY_LEVEL:"ðŸ›¡ï¸",SECURITY_SUMMARY:"ðŸ“Š",SECURITY_VISUALIZATION:"ðŸ“ˆ",COMPLIANCE_STATUS:"âœ…",VALUE_CREATION:"ðŸ’¹",COST_ESTIMATION:"ðŸ’°",BUSINESS_IMPACT:"ðŸ¢",TECHNICAL_IMPLEMENTATION:"âš™ï¸",AVAILABILITY_IMPACT:"â±ï¸",INTEGRITY_IMPACT:"ðŸ”",CONFIDENTIALITY_IMPACT:"ðŸ”’",SECURITY_RESOURCES:"ðŸ“š"},V={CRITICAL:"Significant vulnerabilities present that require immediate attention. Extremely high likelihood of security incidents with severe business impact.",HIGH:"Major security deficiencies exist that should be addressed urgently. High likelihood of security incidents with substantial business impact.",MEDIUM:"Some security gaps exist that should be addressed as part of regular improvement cycles. Moderate likelihood of security incidents.",LOW:"Minor security improvements could be beneficial. Low likelihood of security incidents with limited business impact.",MINIMAL:"Strong security posture with only marginal improvement opportunities. Very low likelihood of security incidents."},Y="availability-selector",B="integrity-selector",z="confidentiality-selector",U="availability-description",G="integrity-description",_="confidentiality-description",F="availability-section",q="integrity-section",W="confidentiality-section",K="availability-color-indicator",Z="integrity-color-indicator",X="confidentiality-color-indicator",J="availability-technical-info-button",Q="integrity-technical-info-button",ee="confidentiality-technical-info-button",te="business-impact-widget",ie="compliance-status-widget",ae="compliance-status-badge",se="compliant-frameworks-list",re="compliance-requirements-list",ne="radar-chart",le="radar-availability-value",oe="radar-integrity-value",ce="radar-confidentiality-value",de="roi-estimate",me="capex-estimate-value",ue="capex-percentage",pe="opex-estimate-value",ge="opex-percentage",xe="three-year-total",ye="cost-analysis-text",he="widget-cost-estimation",be="security-summary-container",ve="security-summary-container",fe="security-icon",Ne="security-summary-description",je="roi-estimate-summary",ke="roi-estimate-pair",Ie="technical-section-toggle",we="technical-details-section",Le="business-impact-toggle",Ce="business-impact-section",Me="metrics-toggle",Se="metrics-section",Ae="availability-tech-heading",Ee="integrity-tech-heading",Re="confidentiality-tech-heading",Te="availability-tech-details",He="integrity-tech-details",Oe="confidentiality-tech-details",$e="availability-impact-heading",Pe="integrity-impact-heading",De="confidentiality-impact-heading",Ve="availability-impact-details",Ye="integrity-impact-details",Be="confidentiality-impact-details",ze="recommendation-heading",Ue="security-recommendation",Ge="app-container",_e="theme-toggle",Fe="app-title",qe="app-root",We="cia-classification-app",Ke="dashboard-grid",Ze="metrics-card",Xe="metrics-card-title",Je="metrics-card-trend",Qe="metrics-card-value",et="key-value-pair",tt="status-badge",it="current-availability",at="current-integrity",st="current-confidentiality",rt="widget-availability-impact",nt="confidentiality-impact",lt="integrity-impact",ot="technical-details-widget",ct="technical-details-availability",dt="technical-details-integrity",mt="technical-details-confidentiality",ut="technical-header",pt="technical-details-section",gt="technical-description",xt="development-effort",yt="security-level-widget",ht="confidentiality-level-selector",bt="integrity-level-selector",vt="availability-level-selector",ft="security-resources-widget",Nt="resource-search",jt="resource-category-filter",kt="resource-list",It="resource-item",wt="resource-link",Lt="value-creation-widget",Ct=e=>`widget-${e}`,Mt=({children:e,title:i,icon:a,testId:s,className:r="",style:n,size:l,loading:o=!1,error:c=null})=>{const d=`widget-container bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden \n    border border-gray-200 dark:border-gray-700 ${r}`,m={...n,...l&&{gridColumn:`span ${l.width}`,gridRow:`span ${l.height}`}};return t.jsxs("div",{"data-testid":s,className:d,style:m,"data-loading":o?"true":void 0,children:[i&&t.jsxs("div",{className:"widget-header p-3 border-b border-gray-200 dark:border-gray-700 flex items-center bg-gray-50 dark:bg-gray-900",children:[a&&t.jsx("span",{className:"widget-icon mr-2",children:a}),t.jsx("h2",{className:"text-md font-semibold text-gray-800 dark:text-gray-200",children:i})]}),t.jsx("div",{className:"widget-content h-full",children:o?t.jsx("div",{className:"animate-pulse h-full w-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:t.jsx("div",{className:"w-8 h-8 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin"})}):c?t.jsxs("div",{className:"p-4 text-red-500 dark:text-red-400",children:[t.jsx("p",{className:"font-bold",children:"Error:"}),t.jsx("p",{children:c.message})]}):e})]})},St="ðŸ“Š",At="ðŸ“Š",Et="âœ“",Rt="ðŸ’°",Tt="ðŸ’²",Ht="ðŸ¢",Ot="âš™ï¸",$t="â±ï¸",Pt="ðŸ›¡ï¸",Dt="ðŸ”’",Vt="ðŸ“š",Yt="None",Bt="Security Level Selection",zt="Security Summary",Ut="Security Visualization",Gt="Compliance Status",_t="Value Creation",Ft="Cost Estimation",qt="Business Impact",Wt="Technical Implementation",Kt="Security Resources",Zt="Availability Impact",Xt="Integrity Impact",Jt="Confidentiality Impact";function Qt(e){if(!e)return h.NONE;if(Object.values(h).includes(e))return e;const t=e.toLowerCase();for(const i of Object.values(h))if(t===i.toLowerCase())return i;return h.NONE}function ei(e){switch(Qt(e)){case"Very High":return 4;case"High":return 3;case"Moderate":return 2;case"Low":return 1;default:return 0}}function ti(e){switch(Qt(e)){case h.VERY_HIGH:return"text-purple-600 dark:text-purple-400 font-bold";case h.HIGH:return"text-green-600 dark:text-green-400 font-bold";case h.MODERATE:return"text-blue-600 dark:text-blue-400";case h.LOW:return"text-yellow-600 dark:text-yellow-400";default:return"text-gray-600 dark:text-gray-400"}}function ii(e){switch(Qt(e)){case h.VERY_HIGH:return"purple";case h.HIGH:return"success";case h.MODERATE:return"info";case h.LOW:return"warning";case h.NONE:return"error";default:return"neutral"}}const ai={availabilityOptions:u,integrityOptions:p,confidentialityOptions:g,roiEstimates:x,getDefaultSecurityIcon:e=>{switch(e){case"Very High":return"ðŸ›¡ï¸ðŸ›¡ï¸ðŸ›¡ï¸";case"High":return"ðŸ›¡ï¸ðŸ›¡ï¸";case"Moderate":return"ðŸ›¡ï¸";case"Low":return"ðŸ”’";default:return"âš ï¸"}},getDefaultValuePoints:e=>{const t=["Provides basic security foundation"];switch(e){case"Very High":return["Maximum security value with comprehensive protection","Enables business in highly regulated industries","Provides competitive advantage through superior security posture","Minimizes risk of data breaches and associated costs","Ensures regulatory compliance across major frameworks"];case"High":return["Strong security value with robust protection","Supports business in moderately regulated industries","Reduces risk of security incidents significantly","Protects sensitive data and critical operations","Meets requirements for most compliance frameworks"];default:return t}}};const si=function(e=ai){function t(t){switch(t){case"availability":return e.availabilityOptions;case"integrity":return e.integrityOptions;case"confidentiality":return e.confidentialityOptions;default:return{}}}function i(e,i){if(!e||!i)return;return t(e)[i]}function a(e){switch(e){case"None":return"None";case"Low":return"Days (1-5)";case"Moderate":return"Weeks (2-4)";case"High":return"Months (1-3)";case"Very High":return"Months (3+)";default:return"Not specified"}}function s(e){switch(e){case"None":return"None";case"Low":return"Minimal (quarterly review)";case"Moderate":return"Regular (monthly review)";case"High":return"Significant (biweekly monitoring)";case"Very High":return"Extensive (continuous monitoring)";default:return"Not specified"}}function r(e){switch(e){case"None":return"None";case"Low":return"Basic security knowledge";case"Moderate":return"Security professional";case"High":return"Security specialist";case"Very High":return"Security expert team";default:return"Not specified"}}function n(e,t,i){const a=["None","Low","Moderate","High","Very High"],s=e=>{const t=a.indexOf(e);return t>=0?t:0},r=s(e),n=s(t),l=s(i);return`${100+75*Math.round((r+n+l)/3)}%`}function l(e,t,i){const a={None:0,Low:1,Moderate:2,High:3,"Very High":4},s=a[e],r=a[t],n=a[i];let l=[],o=[],c=[];s>=2&&r>=2&&n>=2?l.push("SOC2"):s>=1&&r>=1&&n>=1?o.push("SOC2"):c.push("SOC2"),s>=3||r>=3||n>=3?l.push("ISO27001"):s>=2&&r>=2&&n>=2?o.push("ISO27001"):c.push("ISO27001"),n>=3&&r>=2?l.push("PCI_DSS"):n>=2?o.push("PCI_DSS"):c.push("PCI_DSS"),n>=3&&s>=2&&r>=2?l.push("HIPAA"):n>=2&&s>=1&&r>=1?o.push("HIPAA"):c.push("HIPAA"),s>=3&&r>=3&&n>=3?l.push("NIST"):s>=2&&r>=2&&n>=2?o.push("NIST"):c.push("NIST");const d=function(e){const t=[];e.includes("SOC2")&&(t.push("Logical access controls"),t.push("Change management processes"));e.includes("ISO27001")&&(t.push("Risk assessment framework"),t.push("Security incident management"));e.includes("PCI_DSS")&&(t.push("Data encryption"),t.push("Network monitoring"),t.push("Regular vulnerability scanning"));e.includes("HIPAA")&&(t.push("Protected health information safeguards"),t.push("Breach notification protocols"));e.includes("NIST")&&(t.push("Continuous monitoring"),t.push("Comprehensive documentation"),t.push("Strict access controls"));return t}(l),m=function(e,t){const i=[];e.includes("SOC2")&&i.push("Implement additional access controls");e.includes("ISO27001")&&i.push("Develop and document risk assessment framework");t.includes("PCI_DSS")&&(i.push("Implement encryption for sensitive data"),i.push("Establish network segmentation"));t.includes("HIPAA")&&(i.push("Develop PHI handling procedures"),i.push("Implement breach notification process"));t.includes("NIST")&&(i.push("Implement continuous monitoring solution"),i.push("Develop comprehensive security documentation"));return i}(o,c);return{compliantFrameworks:l,partiallyCompliantFrameworks:o,nonCompliantFrameworks:c,requirements:d,remediationSteps:m}}const o=(e,t)=>{const a=i(e,t);let s="";if(a?.businessImpactDetails&&"regulatory"in a.businessImpactDetails){const e=a.businessImpactDetails.regulatory;s=e?.description||""}return{financialImpact:a?.businessImpactDetails?.financialImpact?.description,operationalImpact:a?.businessImpactDetails?.operationalImpact?.description,reputationalImpact:a?.businessImpactDetails?.reputationalImpact?.description,regulatoryImpact:s,uptime:a?.uptime,rto:a?.rto,rpo:a?.rpo,mttr:a?.mttr,keyImpact:a?.keyImpact||c(e,t),metric:a?.metric||d(e,t)}};function c(e,t){if("availability"===e)switch(t){case"None":return"No guaranteed uptime";case"Low":return"Basic availability";case"Moderate":return"Standard business hours";case"High":return"High availability";case"Very High":return"Continuous availability";default:return"Unknown impact"}else if("integrity"===e)switch(t){case"None":return"No data integrity";case"Low":return"Basic integrity checks";case"Moderate":return"Standard validation";case"High":return"Advanced integrity controls";case"Very High":return"Complete data integrity";default:return"Unknown impact"}else if("confidentiality"===e)switch(t){case"None":return"Public information only";case"Low":return"Limited protection";case"Moderate":return"Business confidential";case"High":return"Sensitive information";case"Very High":return"Highly classified";default:return"Unknown impact"}return"Unknown component"}function d(e,t){if("availability"===e)switch(t){case"None":return"< 90% uptime";case"Low":return"95% uptime";case"Moderate":return"99% uptime";case"High":return"99.9% uptime";case"Very High":return"99.999% uptime";default:return"Unknown metric"}else if("integrity"===e)switch(t){case"None":return"No validation";case"Low":return"Basic checksums";case"Moderate":return"Hash validation";case"High":return"Digital signatures";case"Very High":return"Blockchain verification";default:return"Unknown metric"}else if("confidentiality"===e)switch(t){case"None":return"No encryption";case"Low":return"Basic encryption";case"Moderate":return"Standard encryption";case"High":return"Advanced encryption";case"Very High":return"Quantum-safe encryption";default:return"Unknown metric"}return"Unknown component"}function m(e,t,i){return"Business impact assessment"}function x(e,t,i){return"Technical impact assessment"}function h(e,t,i){return"Regulatory impact assessment"}function b(e,t,i){const a=e=>{switch(e){case"None":return 0;case"Low":return 25;case"Moderate":return 50;case"High":return 75;case"Very High":return 100}};return Math.round((a(e)+a(t)+a(i))/3)}function v(e,t,i){return 100-b(e,t,i)}return{getCIAOptions:t,getComponentDetails:i,getBusinessImpact:function(e,t){const a=i(e,t);if(!a)return{summary:"No business impact details available",financial:{description:"Financial impact not specified",riskLevel:y},operational:{description:"Operational impact not specified",riskLevel:y}};const s=a.businessImpactDetails||{};return{summary:a.businessImpact||`Standard ${t} ${e} security impact`,financial:{description:s.financialImpact?.description||"Financial impact not specified",riskLevel:s.financialImpact?.riskLevel||y,annualRevenueLoss:s.financialImpact?.annualRevenueLoss},operational:{description:s.operationalImpact?.description||"Operational impact not specified",riskLevel:s.operationalImpact?.riskLevel||y,meanTimeToRecover:s.operationalImpact?.meanTimeToRecover},reputational:s.reputationalImpact&&{description:s.reputationalImpact.description,riskLevel:s.reputationalImpact.riskLevel||y},strategic:s.strategic&&{description:s.strategic.description,riskLevel:s.strategic.riskLevel||y,competitiveAdvantage:void 0},regulatory:s.regulatory&&{description:s.regulatory.description,riskLevel:s.regulatory.riskLevel||y,complianceImpact:void 0}}},getDetailedDescription:function(e,t){if(!e||!t)return"Invalid component or security level specified";const a=i(e,t);return a?.description||`${t} ${e} controls`},getBusinessPerspective:function(e,t){const a=i(e,t);return a?.businessPerspective||`No business perspective available for ${t} ${e}`},getRecommendations:function(e,t){const a=i(e,t);return a?.recommendations&&Array.isArray(a.recommendations)?a.recommendations:[]},getROIEstimates:function(t){const i=t.toUpperCase().replace(/\s+/g,"_"),a=Object.keys(e.roiEstimates).includes(i)?i:"NONE";return e.roiEstimates[a]??{returnRate:"0%",description:"No ROI data available",potentialSavings:"N/A",breakEvenPeriod:"N/A"}},getSecurityMetrics:function(e,t,a){const s=i("availability",e),r=i("integrity",t),l=i("confidentiality",a),o=(s?.capex||0)+(r?.capex||0)+(l?.capex||0),c=(s?.opex||0)+(r?.opex||0)+(l?.opex||0);return{totalCapex:o,totalOpex:c,capexEstimate:"$"+5e3*o,opexEstimate:`$${2e3*c}/year`,isSmallSolution:o<=60,roi:n(e,t,a)}},getComplianceStatus:l,getComponentMetrics:o,getImpactMetrics:(e,t,i)=>{return{availability:o("availability",e),integrity:o("integrity",t),confidentiality:o("confidentiality",i),businessImpact:m(e,t,i),technicalImpact:x(e,t,i),regulatoryImpact:h(e,t,i),securityScore:b(e,t,i),complianceScore:(a=e,s=t,r=i,b(a,s,r)-10),costEffectivenessScore:v(e,t,i)};var a,s,r},getSecurityResources:(e,t,i,a)=>[{title:`${a} Security Resource`,description:`Resource for ${e} availability, ${t} integrity, and ${i} confidentiality`,url:"https://example.com/security-resource",category:"Framework",tags:["framework","guidelines","risk-management"],relevanceScore:b(e,t,i),type:"Documentation"}],getTechnicalImplementation:function(e,t){const i=Qt(t);let n;switch(e){case"confidentiality":n=g[i]?.technicalImplementation;break;case"integrity":n=p[i]?.technicalImplementation;break;case"availability":n=u[i]?.technicalImplementation}return n?{description:n.description||`Standard ${e} controls for ${i} security level`,implementationSteps:n.implementationSteps||[],effort:{development:n.effort?.development||a(i),maintenance:n.effort?.maintenance||s(i),expertise:n.effort?.expertise||r(i)},requirements:n.requirements||[],technologies:n.technologies||[]}:{description:`No technical implementation details available for ${i} ${e}`,implementationSteps:["Consider implementing basic security controls"],effort:{development:a(i),maintenance:s(i),expertise:r(i)}}},getSecurityLevelDescription:function(e){return{None:"No specific security controls applied. Suitable only for non-sensitive public information.",Low:"Basic security controls for internal use. Minimal protection against casual threats.",Moderate:"Standard security controls suitable for business data. Balanced protection against common threats.",High:"Enhanced security controls for sensitive data. Robust protection against sophisticated threats.","Very High":"Maximum security controls for critical data. Comprehensive protection against advanced threats."}[e]||`${e} security level`},getInformationSensitivity:function(e){switch(e){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Sensitive Data";case"High":return"Confidential Data";case"Very High":return"Restricted Data";default:return"Unknown"}},getProtectionLevel:function(e){switch(e){case"None":return"No Protection";case"Low":return"Basic Protection";case"Moderate":return"Standard Protection";case"High":return"Enhanced Protection";case"Very High":return"Maximum Protection";default:return"Unknown"}},calculateBusinessImpactLevel:function(e,t,i){const a=["None","Low","Moderate","High","Very High"],s=a.indexOf(e),r=a.indexOf(t),n=a.indexOf(i);return a[Math.round((s+r+n)/3)]||"Moderate"},getRiskBadgeVariant:function(e){return{Critical:"error",High:"warning",Medium:"info",Low:"success",Minimal:"success"}[e]||"neutral"},getCategoryIcon:function(e){const t={FINANCIAL:"ðŸ’°",OPERATIONAL:"âš™ï¸",REPUTATIONAL:"ðŸ†",REGULATORY:"âš–ï¸",STRATEGIC:"ðŸŽ¯",NEUTRAL:"ðŸ“Š"};return t[e.toUpperCase()]??t.NEUTRAL??"ðŸ“Š"},getValuePoints:function(t){const a=i("availability",t);return a?.valuePoints&&a.valuePoints.length>0?a.valuePoints:e.getDefaultValuePoints(t)},getROIEstimate:function(e){switch(e){case"Very High":return{value:"5x+",returnRate:"5x+",description:"Maximum return with comprehensive security controls"};case"High":return{value:"3-5x",returnRate:"3-5x",description:"Strong return with robust security implementation"};case"Moderate":return{value:"2-3x",returnRate:"2-3x",description:"Good return with balanced security approach"};case"Low":return{value:"1-2x",returnRate:"1-2x",description:"Basic return with minimal security investment"};default:return{value:"Negative",returnRate:"Negative",description:"No return without security investment"}}},getImplementationConsiderations:function(e){switch(e){case"Very High":return"Implementation requires significant upfront investment but offers maximum long-term value through comprehensive risk reduction and regulatory compliance.";case"High":return"Balanced approach with substantial security benefits and reasonable implementation costs for most organizations with sensitive data or operations.";case"Moderate":return"Cost-effective implementation that provides standard security capabilities suitable for most business applications and moderate risk environments.";case"Low":return"Minimal implementation effort focused on essential security controls, appropriate for non-critical systems or limited budgets.";default:return"No security implementation considerations. Consider baseline security controls for any business system."}},getComponentImplementationDetails:function(e,t){const n=i(e,t),l={development:a(t),maintenance:s(t),expertise:r(t)},o=["Implement basic controls","Document procedures"];return"availability"===e||"integrity"===e||"confidentiality"===e?{description:n?.technical||"",implementationSteps:n?.technicalImplementation?.implementationSteps||o,effort:n?.technicalImplementation?.effort||l}:{description:`Technical implementation for ${t} ${e}`,implementationSteps:o,effort:l}},getBusinessImpactDescription:function(e,t){const a=i(e,t);return a?.businessImpact||`${t} ${e} impact on business operations`},getTechnicalDescription:function(e,t){const a=i(e,t);return a?.technical||`${t} ${e} technical implementation`},getSecurityIcon:function(t){const a=i("availability",t);return a?.securityIcon?a.securityIcon:e.getDefaultSecurityIcon(t)},getCompliantFrameworks:function(e,t,i){return l(e,t,i).compliantFrameworks},getFrameworkDescription:function(e){return{SOC2:"System and Organization Controls 2 - Focuses on security, availability, processing integrity, confidentiality, and privacy",ISO27001:"International standard for information security management",PCI_DSS:"Payment Card Industry Data Security Standard - Security standard for organizations handling credit cards",HIPAA:"Health Insurance Portability and Accountability Act - Standards for sensitive patient data protection",NIST:"National Institute of Standards and Technology - Framework for improving critical infrastructure cybersecurity",GDPR:"General Data Protection Regulation - EU data protection and privacy regulation",CCPA:"California Consumer Privacy Act - Enhances privacy rights and consumer protection"}[e]||`${e} compliance framework`},getImplementationTime:function(e,t,i){const a={None:0,Low:1,Moderate:2,High:3,"Very High":4},s=a[e]+a[t]+a[i];return s<=2?"1-2 weeks":s<=5?"2-4 weeks":s<=8?"1-3 months":s<=10?"3-6 months":"6+ months"}}}(),ri=si.getSecurityLevelDescription,ni=si.getInformationSensitivity,li=si.getProtectionLevel,oi=si.getROIEstimate,ci=si.getBusinessImpactDescription,di=si.getTechnicalDescription,mi=si.getSecurityIcon,ui=si.getImplementationTime,pi=({status:e="neutral",children:i,className:a="",size:s="md",testId:r=tt})=>t.jsx("span",{"data-testid":r,"data-status":e,className:`${(()=>{const e=["inline-flex","items-center","justify-center","rounded-full","font-medium","status-badge"];switch(s){case"xs":e.push("text-xs","py-0.5","px-2");break;case"sm":e.push("text-xs","py-1","px-2");break;case"lg":e.push("text-sm","py-2","px-4","font-bold");break;default:e.push("text-sm","py-1","px-3")}return e.join(" ")})()} ${(()=>{const t={success:"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-20 dark:text-green-300 success",warning:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-20 dark:text-yellow-300 warning",error:"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-20 dark:text-red-300 error",info:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-20 dark:text-blue-300 info",purple:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-20 dark:text-purple-300 purple",neutral:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:bg-opacity-50 dark:text-gray-300 neutral"};return t[e]||t.neutral})()} ${a}`,children:i}),gi=({title:e,level:i,description:a,icon:s,badgeVariant:r,cardClass:n,children:l,testId:o})=>t.jsxs("div",{className:`p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-l-4 ${n} security-card`,"data-testid":o,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"text-lg font-medium flex items-center",children:[t.jsx("span",{className:"mr-2 "+(n.includes("confidentiality")?"icon-confidentiality":n.includes("integrity")?"icon-integrity":n.includes("availability")?"icon-availability":""),children:s}),e]}),t.jsxs(pi,{status:r,className:"text-xs px-3",children:[t.jsx("span",{className:`security-level-indicator ${{None:"level-none",Low:"level-low",Moderate:"level-moderate",High:"level-high","Very High":"level-very-high"}[i]||"level-none"} mr-1`}),i]})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:a}),l]}),xi=({label:e,value:i,valueClassName:a="",labelClassName:s="",className:r="",testId:n=et})=>t.jsxs("div",{className:`flex flex-col ${r}`,"data-testid":n,children:[t.jsx("span",{className:`text-xs text-gray-500 dark:text-gray-400 mb-0.5 ${s}`,children:e}),t.jsx("span",{className:`font-medium text-sm text-gray-800 dark:text-gray-200 ${a}`,children:i})]}),yi=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:s,className:r="",testId:n=rt,options:l={}})=>{const[o,c]=e.useState(!1),d=e.useMemo((()=>si.getComponentDetails("availability",i)),[i]),m=e.useMemo((()=>si.getBusinessImpact("availability",i)),[i]),u=e.useMemo((()=>si.getTechnicalImplementation("availability",i)),[i]),p=e.useMemo((()=>si.getRecommendations("availability",i)),[i]),g=e.useMemo((()=>d?.description||m?.summary||`Impact of ${i} availability on system operations and business continuity.`),[d,m,i]);return d?t.jsx(Mt,{title:Zt,icon:$t,className:r,testId:n||"widget-availability-impact",children:t.jsxs("div",{className:"p-4",role:"region","aria-labelledby":"availability-impact-heading",children:[t.jsxs("h3",{id:"availability-impact-heading",className:"text-lg font-medium mb-4 text-blue-600 dark:text-blue-400",children:[i," Availability Impact"]}),t.jsx("div",{className:"mb-6",children:t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:g||"No impact description available."})}),t.jsxs("div",{className:"space-y-6",children:[t.jsx(gi,{title:"Availability Profile",level:i,description:d.description||"No description available",icon:"â±ï¸",badgeVariant:"info",cardClass:"availability-card",testId:`${n}-impact-card`,children:d.uptime&&t.jsxs("div",{className:"flex items-center mt-2 text-sm text-blue-600 dark:text-blue-400",children:[t.jsx("span",{className:"mr-2",children:"â±ï¸"}),t.jsx("span",{className:"font-medium",children:"Uptime Target: "}),t.jsx("span",{className:"ml-1",children:d.uptime})]})}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact"]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${n}-business-impact`,children:m.summary||d.businessImpact||"No business impact data available"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.operational&&t.jsxs("div",{className:"p-3 rounded-md bg-opacity-10 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),t.jsx("span",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Operational Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:m.operational.description||"No operational impact information available"})]}),m.financial&&t.jsxs("div",{className:"p-3 rounded-md bg-opacity-10 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’°"}),t.jsx("span",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Financial Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:m.financial.description||"No financial impact information available"})]})]})]}),u&&u.description&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4 availability-card security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),"Technical Implementation"]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-3",children:u.description}),u.implementationSteps&&u.implementationSteps.length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("h5",{className:"text-sm font-medium mb-2 text-blue-700 dark:text-blue-300",children:"Implementation Steps"}),t.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-300",children:u.implementationSteps.slice(0,3).map(((e,i)=>t.jsx("li",{children:e},i)))})]})]}),p&&p.length>0&&t.jsxs("div",{className:"bg-blue-50 dark:bg-gray-800 p-4 rounded-lg border border-blue-200 dark:border-blue-900 shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Recommendations"]}),p.length>3&&t.jsx("button",{className:"text-sm px-3 py-1 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors",onClick:()=>c(!o),children:o?"Show Less":"Show All"})]}),t.jsx("ul",{className:"list-disc pl-5 space-y-2 text-gray-600 dark:text-gray-300",children:(o?p:p.slice(0,3)).map(((e,i)=>t.jsx("li",{"data-testid":`${n}-recommendation-${i}`,className:"text-sm",children:e},i)))})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4 availability-card security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“Š"}),"Availability Metrics"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Uptime Target",value:d.uptime||"N/A",testId:`${n}-uptime-target`,valueClassName:"text-blue-700 dark:text-blue-300 font-medium"})}),t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Recovery Time Objective",value:d.rto||"N/A",testId:`${n}-rto-value`,valueClassName:"text-blue-700 dark:text-blue-300 font-medium"})}),d.rpo&&t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Recovery Point Objective",value:d.rpo,testId:`${n}-rpo-value`,valueClassName:"text-blue-700 dark:text-blue-300 font-medium"})}),d.mttr&&t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Mean Time To Recovery",value:d.mttr,testId:`${n}-mttr-value`,valueClassName:"text-blue-700 dark:text-blue-300 font-medium"})})]})]})]})]})}):t.jsx(Mt,{title:"Availability Impact",icon:"â±ï¸",className:r,testId:n,error:new Error("Availability details not available"),children:t.jsx("div",{children:"Availability details not available"})})},hi=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:s,securityLevel:r,className:l="",testId:o=te,activeComponent:c="availability"})=>{const[d,m]=e.useState(c),u=si.getBusinessImpact("availability",i),p=si.getBusinessImpact("integrity",a),g=si.getBusinessImpact("confidentiality",s),x=si.getComponentMetrics("availability",i),y=si.getComponentMetrics("integrity",a),h=si.getComponentMetrics("confidentiality",s),I=e=>e?e.toLowerCase().includes("high")?"error":e.toLowerCase().includes("medium")?"warning":e.toLowerCase().includes("low")?"success":"info":"neutral",{impact:w,metrics:L,color:C,level:M,icon:S,badgeVariant:A,label:E}=(()=>{switch(d){case"availability":return{impact:u,metrics:x,color:n.AVAILABILITY.PRIMARY,level:i,icon:k,badgeVariant:"info",label:b};case"integrity":return{impact:p,metrics:y,color:n.INTEGRITY.PRIMARY,level:a,icon:j,badgeVariant:"success",label:v};case"confidentiality":return{impact:g,metrics:h,color:n.CONFIDENTIALITY.PRIMARY,level:s,icon:N,badgeVariant:"purple",label:f}}})();return t.jsx(Mt,{title:"Business Impact Analysis",icon:"ðŸ“Š",className:l,testId:o,children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex border-b mb-4",role:"tablist",children:[t.jsxs("button",{className:"px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 "+("availability"===d?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"),onClick:()=>m("availability"),"data-testid":`${o}-availability-tab`,role:"tab","aria-selected":"availability"===d,"aria-controls":"availability-tab-panel",id:"availability-tab-button",style:"availability"===d?{borderColor:n.AVAILABILITY.PRIMARY}:void 0,children:[t.jsx("span",{className:"mr-1",children:k}),"Availability"]}),t.jsxs("button",{className:"px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 "+("integrity"===d?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"),onClick:()=>m("integrity"),"data-testid":`${o}-integrity-tab`,role:"tab","aria-selected":"integrity"===d,"aria-controls":"integrity-tab-panel",id:"integrity-tab-button",style:"integrity"===d?{borderColor:n.INTEGRITY.PRIMARY}:void 0,children:[t.jsx("span",{className:"mr-1",children:j}),"Integrity"]}),t.jsxs("button",{className:"px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 "+("confidentiality"===d?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"),onClick:()=>m("confidentiality"),"data-testid":`${o}-confidentiality-tab`,role:"tab","aria-selected":"confidentiality"===d,"aria-controls":"confidentiality-tab-panel",id:"confidentiality-tab-button",style:"confidentiality"===d?{borderColor:n.CONFIDENTIALITY.PRIMARY}:void 0,children:[t.jsx("span",{className:"mr-1",children:N}),"Confidentiality"]})]}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-l-4 security-card",style:{borderLeftColor:C},children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"text-lg font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:S}),E," Impact"]}),t.jsx(pi,{status:A,className:"text-xs px-3",children:M})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${o}-summary`,children:w.summary})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[w.operational&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),"Operational Impact"]}),t.jsx(pi,{status:I(w.operational.riskLevel),size:"sm",children:w.operational.riskLevel||"Unknown"})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:w.operational.description}),L.operationalImpact&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Key Metric"}),t.jsx("div",{className:"text-sm font-medium mt-1",children:"availability"===d?`Uptime: ${L.uptime||"N/A"}`:L.operationalImpact})]})]}),w.financial&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’°"}),"Financial Impact"]}),t.jsx(pi,{status:I(w.financial.riskLevel),size:"sm",children:w.financial.riskLevel||"Unknown"})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:w.financial.description}),L.financialImpact&&t.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Potential Cost"}),t.jsx("div",{className:"text-sm font-medium mt-1",children:L.financialImpact})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[w.reputational&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ†"}),"Reputational Impact"]}),w.reputational.riskLevel&&t.jsx(pi,{status:I(w.reputational.riskLevel),size:"xs",children:w.reputational.riskLevel})]}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:w.reputational.description})]}),w.regulatory&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš–ï¸"}),"Regulatory Impact"]}),w.regulatory.riskLevel&&t.jsx(pi,{status:I(w.regulatory.riskLevel),size:"xs",children:w.regulatory.riskLevel})]}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:w.regulatory.description})]}),w.strategic&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("h4",{className:"text-sm font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),"Strategic Impact"]}),w.strategic.riskLevel&&t.jsx(pi,{status:I(w.strategic.riskLevel),size:"xs",children:w.strategic.riskLevel})]}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:w.strategic.description})]})]}),"availability"===d&&t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[L.uptime&&t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Uptime"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:L.uptime})]}),L.rto&&t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"RTO"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:L.rto})]}),L.rpo&&t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"RPO"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:L.rpo})]}),L.mttr&&t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg text-center",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"MTTR"}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:L.mttr})]})]})]})})},bi=({label:e,value:i,icon:a,testId:s,color:r="blue",borderColor:n,compact:l=!1})=>{const o=()=>e.toLowerCase().includes("confidentiality")?"icon-confidentiality":e.toLowerCase().includes("integrity")?"icon-integrity":e.toLowerCase().includes("availability")?"icon-availability":"",c=()=>({None:"level-none",Low:"level-low",Moderate:"level-moderate",High:"level-high","Very High":"level-very-high"}[i]||"level-none");return l?t.jsxs("div",{"data-testid":s,className:"flex items-center bg-gray-50 dark:bg-gray-800 px-2 py-1 rounded-md text-xs",style:{borderLeft:n?`3px solid ${n}`:void 0},children:[t.jsx("span",{className:`mr-1 ${o()}`,children:a}),t.jsxs("div",{children:[t.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xxs",children:e}),t.jsxs("div",{className:"font-medium flex items-center",children:[t.jsx("span",{className:`security-level-indicator ${c()} mr-1`}),i]})]})]}):t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-md flex items-center security-card",style:{borderLeft:n?`3px solid ${n}`:void 0},"data-testid":s,children:[t.jsx("div",{className:"icon-container mr-3",children:t.jsx("span",{className:o(),children:a})}),t.jsxs("div",{className:"flex-grow",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e}),t.jsxs("div",{className:"font-medium flex items-center",children:[t.jsx("span",{className:`security-level-indicator ${c()} mr-1`}),i]})]})]})};const vi=({availabilityLevel:i="None",integrityLevel:a="None",confidentialityLevel:s="None",className:r="",testId:n=ie})=>{const l=Qt(i),o=Qt(a),c=Qt(s),d=e.useMemo((()=>si.getComplianceStatus(l,o,c)),[l,o,c]),m=(e=>{const t=e.compliantFrameworks.length+e.partiallyCompliantFrameworks.length+e.nonCompliantFrameworks.length;if(0===t)return 0;const i=(e.compliantFrameworks.length+.5*e.partiallyCompliantFrameworks.length)/t;return Math.round(100*i)})(d);return t.jsx(Mt,{title:"Compliance Status",icon:"ðŸ“‹",className:r,testId:n,children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsx("h3",{className:"text-lg font-medium",children:"Compliance Status"}),t.jsxs(pi,{status:(u=m,u>=75?"success":u>=50?"info":u>=25?"warning":"error"),size:"lg",testId:ae,children:[m,"%"]})]}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:["Based on your selected security levels: ",l," ","Availability, ",o," Integrity, and ",c," ","Confidentiality."]})]}),t.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-10 rounded-lg border border-green-200 dark:border-green-800",children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center text-green-700 dark:text-green-400",children:[t.jsx("span",{className:"mr-2",children:"âœ“"}),"Compliant Frameworks"]}),d.compliantFrameworks.length>0?t.jsx("ul",{className:"list-disc list-inside space-y-1","data-testid":se,children:d.compliantFrameworks.map(((e,i)=>t.jsxs("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-center",children:[t.jsx(pi,{status:"success",size:"xs",className:"mr-2",children:"Compliant"}),e.replace(/_/g," ")]},i)))}):t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No compliant frameworks at current security levels."})]}),t.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-10 rounded-lg border border-yellow-200 dark:border-yellow-800",children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center text-yellow-700 dark:text-yellow-400",children:[t.jsx("span",{className:"mr-2",children:"âš ï¸"}),"Partially Compliant Frameworks"]}),d.partiallyCompliantFrameworks.length>0?t.jsx("ul",{className:"list-disc list-inside space-y-1",children:d.partiallyCompliantFrameworks.map(((e,i)=>t.jsxs("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-center",children:[t.jsx(pi,{status:"warning",size:"xs",className:"mr-2",children:"Partial"}),e.replace(/_/g," ")]},i)))}):t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No partially compliant frameworks at current security levels."})]}),t.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-900 dark:bg-opacity-10 rounded-lg border border-red-200 dark:border-red-800",children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center text-red-700 dark:text-red-400",children:[t.jsx("span",{className:"mr-2",children:"âŒ"}),"Non-Compliant Frameworks"]}),d.nonCompliantFrameworks.length>0?t.jsx("ul",{className:"list-disc list-inside space-y-1",children:d.nonCompliantFrameworks.map(((e,i)=>t.jsxs("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-center",children:[t.jsx(pi,{status:"error",size:"xs",className:"mr-2",children:"Non-Compliant"}),e.replace(/_/g," ")]},i)))}):t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"No non-compliant frameworks at current security levels."})]}),d.remediationSteps&&d.remediationSteps.length>0&&t.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-10 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center text-blue-700 dark:text-blue-400",children:[t.jsx("span",{className:"mr-2",children:"ðŸ› ï¸"}),"Remediation Steps"]}),t.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-700 dark:text-gray-300","data-testid":re,children:d.remediationSteps.map(((e,i)=>t.jsx("li",{children:e},i)))})]})]})});var u},fi=({confidentialityLevel:i,availabilityLevel:a,integrityLevel:s,className:r="",testId:n=nt})=>{const[l,o]=e.useState(!1),c=e.useMemo((()=>si.getComponentDetails("confidentiality",i)),[i]),d=e.useMemo((()=>si.getBusinessImpact("confidentiality",i)),[i]),m=e.useMemo((()=>si.getTechnicalImplementation("confidentiality",i)),[i]),u=e.useMemo((()=>si.getRecommendations("confidentiality",i)),[i]),p=ni(Qt(i));return li(Qt(i)),c?t.jsx(Mt,{title:"Confidentiality Impact",icon:"ðŸ”’",className:r,testId:n,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(gi,{title:"Confidentiality Profile",level:i,description:c.description||"No description available",icon:"ðŸ”’",badgeVariant:"purple",cardClass:"confidentiality-card",testId:`${n}-impact-card`,children:c.protectionMethod&&t.jsxs("div",{className:"flex items-center mt-2 text-sm text-purple-600 dark:text-purple-400",children:[t.jsx("span",{className:"mr-2",children:"ðŸ›¡ï¸"}),t.jsx("span",{className:"font-medium",children:"Protection Method: "}),t.jsx("span",{className:"ml-1",children:c.protectionMethod})]})}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact"]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${n}-business-impact`,children:d.summary||c.businessImpact||"No business impact data available"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.reputational&&t.jsxs("div",{className:"p-3 rounded-md bg-opacity-10 bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20 border border-purple-200 dark:border-purple-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ†"}),t.jsx("span",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Reputational Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:d.reputational.description||"No reputational impact information available"})]}),d.regulatory&&t.jsxs("div",{className:"p-3 rounded-md bg-opacity-10 bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20 border border-purple-200 dark:border-purple-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),t.jsx("span",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Regulatory Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:d.regulatory.description||"No regulatory impact information available"})]})]})]}),m&&m.description&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4 confidentiality-card security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),"Technical Implementation"]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-3",children:m.description}),m.implementationSteps&&m.implementationSteps.length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("h5",{className:"text-sm font-medium mb-2 text-purple-700 dark:text-purple-300",children:"Implementation Steps"}),t.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-300",children:m.implementationSteps.slice(0,3).map(((e,i)=>t.jsx("li",{children:e},i)))})]})]}),u&&u.length>0&&t.jsxs("div",{className:"bg-purple-50 dark:bg-gray-800 p-4 rounded-lg border border-purple-200 dark:border-purple-900 shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Recommendations"]}),u.length>3&&t.jsx("button",{className:"text-sm px-3 py-1 rounded-full bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors",onClick:()=>o(!l),children:l?"Show Less":"Show All"})]}),t.jsx("ul",{className:"list-disc pl-5 space-y-2 text-gray-600 dark:text-gray-300",children:(l?u:u.slice(0,3)).map(((e,i)=>t.jsx("li",{"data-testid":`${n}-recommendation-${i}`,className:"text-sm",children:e},i)))})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4 confidentiality-card security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ·ï¸"}),"Data Protection Classification"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Classification Level",value:i,testId:`${n}-classification-level`,valueClassName:"text-purple-700 dark:text-purple-300 font-medium"})}),t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Information Sensitivity",value:p,testId:`${n}-information-sensitivity`,valueClassName:"text-purple-700 dark:text-purple-300 font-medium"})})]})]})]})}):t.jsx(Mt,{title:"Confidentiality Impact",icon:"ðŸ”’",className:r,testId:n,error:new Error("Confidentiality details not available"),children:t.jsx("div",{children:"Confidentiality details not available"})})},Ni=({title:i,value:a,subtitle:s,icon:r,className:n="",testId:l=Ze,accentColor:o,trend:c,variant:d="primary"})=>{const[m,u]=e.useState("0"),p=String(a),g=parseInt(p.replace(/\D/g,""))||0;e.useEffect((()=>{if(g>0){const e=20,t=g/e;let i=0;const s=setInterval((()=>{if(i+=t,i>=g)u(String(a)),clearInterval(s);else{let e;p.includes("$")?(e=`$${Math.round(i).toLocaleString()}`,p.includes("/")&&(e+="/"+p.split("/")[1])):(e=Math.round(i).toString(),p.includes("%")&&(e+="%")),u(e)}}),1500/e);return()=>clearInterval(s)}u(String(a))}),[a,g,p]);return t.jsxs("div",{className:`p-4 rounded-lg border ${(()=>{switch(d){case"success":return"bg-green-100 dark:bg-green-900 dark:bg-opacity-20 border-green-200 dark:border-green-800";case"warning":return"bg-yellow-100 dark:bg-yellow-900 dark:bg-opacity-20 border-yellow-200 dark:border-yellow-800";case"danger":return"bg-red-100 dark:bg-red-900 dark:bg-opacity-20 border-red-200 dark:border-red-800";case"info":return"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 border-blue-200 dark:border-blue-800";case"purple":return"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20 border-purple-200 dark:border-purple-800";default:return"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-10 border-blue-100 dark:border-blue-800"}})()} ${n}`,"data-testid":l,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center",children:[r&&t.jsx("span",{className:"mr-2 text-xl",children:r}),t.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-300","data-testid":Xe,children:i})]}),c&&t.jsx("div",{className:"text-xs px-1.5 py-0.5 rounded "+("up"===c.direction?"bg-green-100 text-green-700 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-400":"down"===c.direction?"bg-red-100 text-red-700 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-400":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400"),"data-testid":Je,children:c.value})]}),t.jsxs("div",{className:"flex items-end justify-between",children:[t.jsx("span",{className:`text-2xl font-bold ${(()=>{switch(d){case"success":return"text-green-700 dark:text-green-400";case"warning":return"text-yellow-700 dark:text-yellow-400";case"danger":return"text-red-700 dark:text-red-400";case"info":default:return"text-blue-700 dark:text-blue-400";case"purple":return"text-purple-700 dark:text-purple-400"}})()}`,"data-testid":Qe,style:o?{color:o}:void 0,children:m}),s&&t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:s})]})]})},ji=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:s,className:r="",testId:n=he})=>{const l=e.useMemo((()=>si.getSecurityMetrics(i,a,s)),[i,a,s]),o=ui(i,a,s),c=e.useMemo((()=>`$${(parseInt(l.capexEstimate.replace(/[^0-9]/g,""))+3*parseInt(l.opexEstimate.replace(/[^0-9]/g,""))).toLocaleString()}`),[l.capexEstimate,l.opexEstimate]),d=e=>{const t=e.match(/\$(\d+)(.*)$/);if(t&&t[1]){const e=parseInt(t[1]),i=t[2]||"";return`$${e.toLocaleString()}${i}`}return e};return t.jsx(Mt,{title:"Estimated Implementation Cost",icon:"ðŸ’°",testId:n,className:r,children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(Ni,{title:"Capital Expenditure",value:d(l.capexEstimate||""),icon:"ðŸ’¼",testId:me,accentColor:"#3498db",variant:"info"}),t.jsx(Ni,{title:"Operational Expenditure",value:d(l.opexEstimate),icon:"âš™ï¸",testId:pe,accentColor:"#2ecc71",variant:"success"}),t.jsx(Ni,{title:"3-Year TCO",value:c,icon:"ðŸ”„",testId:xe,accentColor:"#9b59b6",variant:"purple"})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm",children:[t.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’°"}),"Budget Allocation"]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Capital Expenditure"}),t.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300","data-testid":ue,children:[l.totalCapex,"% of IT budget"]})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:t.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${l.totalCapex}%`}})})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Operational Expenditure"}),t.jsxs("span",{className:"text-sm font-medium text-green-700 dark:text-green-300","data-testid":ge,children:[l.totalOpex,"% of IT budget"]})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:t.jsx("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:`${l.totalOpex}%`}})})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-green-50 dark:bg-green-900 dark:bg-opacity-20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:[t.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“ˆ"}),"Return on Investment"]}),t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(pi,{status:"success",size:"lg",testId:de,children:l.roi}),t.jsx("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-300",children:"Estimated ROI"})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Based on prevented breaches, operational efficiencies, and compliance cost reduction."})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Implementation Timeline"]}),t.jsx("div",{className:"flex items-center mb-2",children:t.jsx(pi,{status:"info",size:"lg",children:o})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Estimated time to fully implement and operationalize these security controls."})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Cost Analysis"}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3","data-testid":ye,children:l.isSmallSolution?T:H}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[t.jsx(pi,{status:"info",children:"Capital Investment"}),t.jsx(pi,{status:"success",children:"Recurring Costs"}),t.jsx(pi,{status:"purple",children:"Long-term Value"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-10 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),"CAPEX Components"]}),t.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-300 space-y-1",children:[t.jsx("li",{children:"Security hardware and infrastructure"}),t.jsx("li",{children:"Software licenses and tools"}),t.jsx("li",{children:"Initial implementation services"}),t.jsx("li",{children:"Training and certification"})]})]}),t.jsxs("div",{className:"bg-green-50 dark:bg-green-900 dark:bg-opacity-10 p-4 rounded-lg border border-green-200 dark:border-green-800",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),"OPEX Components"]}),t.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-300 space-y-1",children:[t.jsx("li",{children:"Personnel costs and staffing"}),t.jsx("li",{children:"Maintenance and support contracts"}),t.jsx("li",{children:"Subscription services"}),t.jsx("li",{children:"Ongoing training and awareness"})]})]})]})]})})},ki=({integrityLevel:i,availabilityLevel:a,confidentialityLevel:s,className:r="",testId:n=lt,options:l={}})=>{const[o,c]=e.useState(!1),d=e.useMemo((()=>si.getComponentDetails("integrity",i)),[i]),m=e.useMemo((()=>si.getBusinessImpact("integrity",i)),[i]),u=e.useMemo((()=>si.getTechnicalImplementation("integrity",i)),[i]),p=e.useMemo((()=>si.getRecommendations("integrity",i)),[i]);return d?t.jsx(Mt,{title:"Integrity Impact",icon:"âœ“",className:r,testId:n,children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(gi,{title:"Integrity Profile",level:i,description:d.description||"No description available",icon:"âœ“",badgeVariant:"success",cardClass:"integrity-card",testId:`${n}-impact-card`,children:u.validationMethod&&t.jsxs("div",{className:"flex items-center mt-2 text-sm text-green-600 dark:text-green-400",children:[t.jsx("span",{className:"mr-2",children:"âœ“"}),t.jsx("span",{className:"font-medium",children:"Validation Method: "}),t.jsx("span",{className:"ml-1",children:u.validationMethod})]})}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact"]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${n}-business-impact`,children:m.summary||d.businessImpact||"No business impact data available"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.operational&&t.jsxs("div",{className:"p-3 rounded-md bg-opacity-10 bg-green-100 dark:bg-green-900 dark:bg-opacity-20 border border-green-200 dark:border-green-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),t.jsx("span",{className:"font-medium text-green-700 dark:text-green-300",children:"Operational Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:m.operational.description||"No operational impact information available"})]}),m.financial&&t.jsxs("div",{className:"p-3 rounded-md bg-opacity-10 bg-green-100 dark:bg-green-900 dark:bg-opacity-20 border border-green-200 dark:border-green-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’°"}),t.jsx("span",{className:"font-medium text-green-700 dark:text-green-300",children:"Financial Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:m.financial.description||"No financial impact information available"})]})]})]}),u&&u.description&&t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4 integrity-card security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),"Technical Implementation"]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-3",children:u.description}),u.implementationSteps&&u.implementationSteps.length>0&&t.jsxs("div",{className:"mt-3",children:[t.jsx("h5",{className:"text-sm font-medium mb-2 text-green-700 dark:text-green-300",children:"Implementation Steps"}),t.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-300",children:u.implementationSteps.slice(0,3).map(((e,i)=>t.jsx("li",{children:e},i)))})]})]}),p&&p.length>0&&t.jsxs("div",{className:"bg-green-50 dark:bg-gray-800 p-4 rounded-lg border border-green-200 dark:border-green-900 shadow-sm security-card",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Recommendations"]}),p.length>3&&t.jsx("button",{className:"text-sm px-3 py-1 rounded-full bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-800 transition-colors",onClick:()=>c(!o),children:o?"Show Less":"Show All"})]}),t.jsx("ul",{className:"list-disc pl-5 space-y-2 text-gray-600 dark:text-gray-300",children:(o?p:p.slice(0,3)).map(((e,i)=>t.jsx("li",{"data-testid":`${n}-recommendation-${i}`,className:"text-sm",children:e},i)))})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4 integrity-card security-card",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ·ï¸"}),"Data Integrity Classification"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-green-100 dark:bg-green-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Protection Level",value:i,testId:`${n}-protection-level`,valueClassName:"text-green-700 dark:text-green-300 font-medium"})}),u&&u.validationMethod&&t.jsx("div",{className:"p-3 rounded-md bg-opacity-10 bg-green-100 dark:bg-green-900 dark:bg-opacity-20",children:t.jsx(xi,{label:"Validation Technique",value:u.validationMethod,testId:`${n}-validation-technique`,valueClassName:"text-green-700 dark:text-green-300 font-medium"})})]})]})]})}):t.jsx(Mt,{title:"Integrity Impact",icon:"âœ“",className:r,testId:n,error:new Error("Integrity details not available"),children:t.jsx("div",{children:"Integrity details not available"})})},Ii=({securityLevel:i,availabilityLevel:a,integrityLevel:s,confidentialityLevel:r,className:n="",testId:l=ft})=>{const[o,c]=e.useState(""),[d,m]=e.useState("all"),u=e.useMemo((()=>{const e={None:0,Low:1,Moderate:2,High:3,"Very High":4},t=e[a]||0,i=e[s]||0,n=e[r]||0,l=Math.max(t,i,n);return Object.keys(e).find((t=>e[t]===l))}),[a,s,r]),p=[{title:"NIST 800-53 Rev. 5",description:"Security and Privacy Controls for Information Systems and Organizations",link:"https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final",category:"standard",tags:["government","compliance","controls"],requiredLevel:"Moderate"},{title:"ISO/IEC 27001:2022",description:"Information security management systems - Requirements",link:"https://www.iso.org/standard/27001",category:"standard",tags:["international","management","certification"],requiredLevel:"Moderate"},{title:"OWASP Top 10",description:"The standard awareness document for developers about the most critical security risks to web applications",link:"https://owasp.org/www-project-top-ten/",category:"best-practice",tags:["web","development","vulnerabilities"],requiredLevel:"Low"},{title:"CIS Controls v8",description:"Prescriptive, prioritized, and simplified set of cybersecurity best practices",link:"https://www.cisecurity.org/controls/cis-controls-list",category:"best-practice",tags:["implementation","prioritization","controls"],requiredLevel:"Moderate"},{title:"GDPR",description:"General Data Protection Regulation - EU data protection and privacy regulation",link:"https://gdpr.eu/",category:"regulation",tags:["privacy","EU","data-protection"],requiredLevel:"Moderate"},{title:"HIPAA",description:"Health Insurance Portability and Accountability Act - US healthcare data privacy",link:"https://www.hhs.gov/hipaa/index.html",category:"regulation",tags:["healthcare","US","privacy"],requiredLevel:"High"},{title:"NIST Cybersecurity Framework 2.0",description:"Framework for improving critical infrastructure cybersecurity",link:"https://www.nist.gov/cyberframework",category:"standard",tags:["risk-management","critical-infrastructure"],requiredLevel:"Moderate"},{title:"OWASP ASVS",description:"Application Security Verification Standard - requirements for secure development",link:"https://owasp.org/www-project-application-security-verification-standard/",category:"best-practice",tags:["application-security","verification","requirements"],requiredLevel:"High"},{title:"SOC 2",description:"Service Organization Control 2 - trust services criteria for security, availability, processing integrity, confidentiality, and privacy",link:"https://www.aicpa.org/interestareas/frc/assuranceadvisoryservices/aicpasoc2report.html",category:"standard",tags:["service-providers","audit","trust"],requiredLevel:"High"},{title:"OWASP ZAP",description:"Open source web application security scanner",link:"https://www.zaproxy.org/",category:"tool",tags:["scanner","open-source","web"],requiredLevel:"Low"},{title:"NIST Secure Software Development Framework (SSDF)",description:"Recommended secure software development practices",link:"https://csrc.nist.gov/Projects/ssdf",category:"best-practice",tags:["sdlc","secure-development"],requiredLevel:"Moderate"},{title:"PCI DSS",description:"Payment Card Industry Data Security Standard - security standard for organizations handling credit cards",link:"https://www.pcisecuritystandards.org/",category:"regulation",tags:["payment","finance","compliance"],requiredLevel:"High"}],g=e.useMemo((()=>{const e={None:0,Low:1,Moderate:2,High:3,"Very High":4},t=e[u];return p.filter((i=>{if((i.requiredLevel?e[i.requiredLevel]:0)>t)return!1;if("all"!==d&&i.category!==d)return!1;if(o){const e=o.toLowerCase();return i.title.toLowerCase().includes(e)||i.description.toLowerCase().includes(e)||i.tags.some((t=>t.toLowerCase().includes(e)))}return!0}))}),[p,u,d,o]),x=e.useMemo((()=>{const e={all:0};return g.forEach((t=>{e.all=(e.all||0)+1,e[t.category]=(e[t.category]||0)+1})),e}),[g]),y={all:"All Resources",standard:"Standards & Frameworks",regulation:"Regulations & Compliance","best-practice":"Best Practices",tool:"Tools & Software"};return t.jsx(Mt,{title:"Security Resources",icon:"ðŸ“š",className:n,testId:l,children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg",children:[t.jsx("h4",{className:"text-sm font-medium mb-2",children:"Recommended For"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs(pi,{status:"info",size:"sm",children:["Availability: ",a]}),t.jsxs(pi,{status:"success",size:"sm",children:["Integrity: ",s]}),t.jsxs(pi,{status:"purple",size:"sm",children:["Confidentiality: ",r]})]})]}),t.jsx("div",{className:"search-container",children:t.jsx("input",{type:"text",placeholder:"Search resources...",value:o,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 border rounded-md","data-testid":Nt})}),t.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(y).map((([e,i])=>t.jsxs("button",{onClick:()=>m(e),className:"px-3 py-1 text-xs rounded-full "+(d===e?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),"data-testid":`${jt}-${e}`,children:[i," (",x[e]||0,")"]},e)))}),g.length>0?t.jsx("div",{className:"space-y-4","data-testid":kt,children:g.map(((e,i)=>t.jsxs("div",{className:"resource-card p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow","data-testid":`${It}-${i}`,children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start mb-2",children:[t.jsx("h4",{className:"font-medium mb-1",children:t.jsx("a",{href:e.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline","data-testid":`${wt}-${i}`,children:e.title})}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 sm:ml-2",children:e.requiredLevel&&t.jsxs("span",{className:"resource-tag inline-block rounded-full px-2 py-1 mr-1",children:["Required: ",e.requiredLevel,"+"]})})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-2",children:e.description}),t.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[e.tags.map(((e,i)=>t.jsxs("span",{className:"inline-block bg-gray-100 dark:bg-gray-700 rounded-full px-2 py-1 text-xs text-gray-600 dark:text-gray-300",children:["#",e]},i))),t.jsx("span",{className:"ml-auto inline-block rounded-full px-2 py-1 text-xs "+("standard"===e.category?"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 text-blue-800 dark:text-blue-200":"regulation"===e.category?"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20 text-purple-800 dark:text-purple-200":"best-practice"===e.category?"bg-green-100 dark:bg-green-900 dark:bg-opacity-20 text-green-800 dark:text-green-200":"bg-yellow-100 dark:bg-yellow-900 dark:bg-opacity-20 text-yellow-800 dark:text-yellow-200"),children:y[e.category].replace(" & Software","").replace(" & Frameworks","").replace(" & Compliance","")})]})]},i)))}):t.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No resources match your search criteria."}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-4",children:t.jsx("p",{children:"Note: Resources are recommended based on your selected security levels. Higher security levels include more comprehensive resources."})})]})})},wi=({securityLevel:i,availabilityLevel:a,integrityLevel:s,confidentialityLevel:r,className:l="",testId:o=ve})=>{const[c,d]=e.useState(!1),[m,u]=e.useState(!1),[p,g]=e.useState(!1),x=e.useMemo((()=>ri(i)||"Security level not specified"),[i]),y=e.useMemo((()=>oi(i)),[i]),I=y.value;y.description.includes("break-even");const w=e.useMemo((()=>di("availability",a)),[a]),L=e.useMemo((()=>di("integrity",s)),[s]),M=e.useMemo((()=>di("confidentiality",r)),[r]),S=e.useMemo((()=>ci("availability",a)),[a]),A=e.useMemo((()=>ci("integrity",s)),[s]),E=e.useMemo((()=>ci("confidentiality",r)),[r]),R=e.useMemo((()=>si.getRecommendations("availability",i)),[i]),T=mi(i);return e.useMemo((()=>25*ei(i)),[i]),e.useMemo((()=>ri(i)),[i]),e.useMemo((()=>{const e=ei(a),t=ei(s),i=ei(r);let n="Balanced",l="Balanced";return e>t&&e>i?n="Availability":t>e&&t>i?n="Integrity":i>e&&i>t&&(n="Confidentiality"),e<t&&e<i?l="Availability":t<e&&t<i?l="Integrity":i<e&&i<t&&(l="Confidentiality"),{highest:n,lowest:l,balanced:"Balanced"===n}}),[a,s,r]),e.useMemo((()=>{switch(i){case h.NONE:return"Critical";case h.LOW:return"High";case h.MODERATE:return"Medium";case h.HIGH:return"Low";case h.VERY_HIGH:return"Minimal";default:return"Unknown"}}),[i]),e.useMemo((()=>{switch(i){case h.NONE:return"Significant vulnerabilities present. Immediate action required.";case h.LOW:return"Basic protection. Substantial security improvements needed.";case h.MODERATE:return"Standard protection. Key security controls in place.";case h.HIGH:return"Strong protection. Comprehensive security controls.";case h.VERY_HIGH:return"Maximum protection. Advanced security controls with redundancy.";default:return"Security level not assessed."}}),[i]),t.jsx(Mt,{title:zt,icon:St,className:l,testId:o,children:t.jsxs("div",{className:"space-y-6",role:"region","aria-label":"Security Summary",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("span",{className:"text-3xl","data-testid":fe,role:"img","aria-label":`Security level: ${i}`,children:T})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-bold",children:[i," Security"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1","data-testid":Ne,children:x})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2","data-testid":be,children:[t.jsx(bi,{label:f,value:r,icon:N,testId:`${o}-confidentiality-summary`,color:"purple",borderColor:n.CONFIDENTIALITY.PRIMARY,compact:!0}),t.jsx(bi,{label:v,value:s,icon:j,testId:`${o}-integrity-summary`,color:"green",borderColor:n.INTEGRITY.PRIMARY,compact:!0}),t.jsx(bi,{label:b,value:a,icon:k,testId:`${o}-availability-summary`,color:"blue",borderColor:n.AVAILABILITY.PRIMARY,compact:!0})]}),t.jsxs("div",{className:"bg-green-50 dark:bg-green-900 dark:bg-opacity-20 p-3 rounded-lg","data-testid":je,children:[t.jsx(xi,{label:"Estimated ROI",value:I,testId:ke,valueClassName:"text-green-600 dark:text-green-400 text-lg"}),t.jsx("p",{className:"text-sm text-green-700 dark:text-green-400 mt-1",children:y.description})]}),t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>d(!c),className:"flex items-center justify-between w-full text-left font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors","data-testid":Ie,"aria-expanded":c,children:[t.jsx("span",{children:"Technical Implementation"}),t.jsx("span",{className:"transition-transform duration-200",style:{transform:c?"rotate(180deg)":"none"},children:c?"â–²":"â–¼"})]}),c&&t.jsxs("div",{className:"mt-3 space-y-4 pl-3 border-l-2 border-gray-200 dark:border-gray-700","data-testid":we,children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium mb-1",style:{color:n.AVAILABILITY.PRIMARY},"data-testid":Ae,children:"Availability Implementation"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":Te,children:w})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium mb-1",style:{color:n.INTEGRITY.PRIMARY},"data-testid":Ee,children:"Integrity Implementation"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":He,children:L})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium mb-1",style:{color:n.CONFIDENTIALITY.PRIMARY},"data-testid":Re,children:"Confidentiality Implementation"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":Oe,children:M})]})]})]}),t.jsxs("div",{children:[t.jsxs("button",{onClick:()=>u(!m),className:"flex items-center justify-between w-full text-left font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors","data-testid":Le,"aria-expanded":m,children:[t.jsx("span",{children:"Business Impact"}),t.jsx("span",{className:"transition-transform duration-200",style:{transform:m?"rotate(180deg)":"none"},children:m?"â–²":"â–¼"})]}),m&&t.jsxs("div",{className:"mt-3 space-y-4 pl-3 border-l-2 border-gray-200 dark:border-gray-700","data-testid":Ce,children:[t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium mb-1",style:{color:n.AVAILABILITY.PRIMARY},"data-testid":$e,children:"Availability Impact"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":Ve,children:S})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium mb-1",style:{color:n.INTEGRITY.PRIMARY},"data-testid":Pe,children:"Integrity Impact"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":Ye,children:A})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium mb-1",style:{color:n.CONFIDENTIALITY.PRIMARY},"data-testid":De,children:"Confidentiality Impact"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":Be,children:E})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-2","data-testid":ze,children:"Security Recommendation"}),t.jsx(pi,{status:ii(i),testId:Ue,children:C[i.toUpperCase().replace(" ","_")]||C.BASIC}),R.length>0&&t.jsx("ul",{className:"mt-3 space-y-1 list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:R.slice(0,3).map(((e,i)=>t.jsx("li",{children:e},i)))})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4",style:{borderLeftColor:n.CONFIDENTIALITY.PRIMARY},children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Data Protection Classification"}),t.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[t.jsx(xi,{label:"Classification Level",value:r,testId:`${o}-classification-level`}),t.jsx(xi,{label:"Information Sensitivity",value:si.getInformationSensitivity(r),testId:`${o}-information-sensitivity`})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border-l-4",style:{borderLeftColor:n.INTEGRITY.PRIMARY},children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Data Integrity Classification"}),t.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[t.jsx(xi,{label:"Protection Level",value:s,testId:`${o}-protection-level`}),(()=>{const e=si.getTechnicalImplementation("integrity",s);return e&&"validationMethod"in e&&e.validationMethod?t.jsx(xi,{label:"Validation Technique",value:e.validationMethod,testId:`${o}-validation-technique`}):null})()]})]})]}),t.jsxs("button",{onClick:()=>g(!p),className:"flex items-center justify-between w-full text-left font-medium text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors mb-2","data-testid":Me,"aria-expanded":p,children:[t.jsx("span",{children:"Availability Metrics"}),t.jsx("span",{className:"transition-transform duration-200",style:{transform:p?"rotate(180deg)":"none"},children:p?"â–²":"â–¼"})]}),p&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4","data-testid":Se,children:(()=>{const e=si.getComponentDetails("availability",a);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center",children:[t.jsx("h5",{className:"text-sm font-medium mb-2",children:"Uptime"}),t.jsx("p",{className:"text-lg font-bold",children:e?.uptime||"N/A"})]}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center",children:[t.jsx("h5",{className:"text-sm font-medium mb-2",children:"Mean Time To Recovery (MTTR)"}),t.jsx("p",{className:"text-lg font-bold",children:e?.mttr||"N/A"})]}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center",children:[t.jsxs("h5",{className:"flex items-center justify-center text-sm font-medium mb-2",children:[t.jsx("span",{className:"mr-1",children:"â±ï¸"}),"Recovery Time Objective (RTO)"]}),t.jsx("p",{className:"text-lg font-bold",children:e?.rto||"N/A"})]}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center",children:[t.jsxs("h5",{className:"flex items-center justify-center text-sm font-medium mb-2",children:[t.jsx("span",{className:"mr-1",children:"ðŸ’¾"}),"Recovery Point Objective (RPO)"]}),t.jsx("p",{className:"text-lg font-bold",children:e?.rpo||"N/A"})]})]})})()})]})})},Li=({availabilityLevel:i="None",integrityLevel:a="None",confidentialityLevel:r="None",className:n="",testId:l=ne})=>{const o=e.useRef(null),c=e.useRef(null),[d,m]=e.useState(null),[u,p]=e.useState(document.documentElement.classList.contains("dark")),[g]=e.useState({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r}),x=e=>{switch(e){case"None":default:return 0;case"Basic":case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4}};e.useEffect((()=>{const e=new MutationObserver((e=>{e.forEach((e=>{if("class"===e.attributeName&&e.target===document.documentElement){const e=document.documentElement.classList.contains("dark");e!==u&&p(e)}}))}));return e.observe(document.documentElement,{attributes:!0}),()=>e.disconnect()}),[u]),e.useEffect((()=>{if(o.current)try{c.current&&c.current.destroy();const e=o.current?.getContext("2d");if(!e)return void m("Could not get canvas context");const t=x(i),n=x(a),l=x(r),d=u?"rgba(0, 204, 102, 0.2)":"rgba(0, 102, 51, 0.2)",p=u?"#00cc66":"#006633",g=u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",y=u?"#f0f0f0":"#222222";c.current=new s(e,{type:"radar",data:{labels:["Availability","Integrity","Confidentiality"],datasets:[{label:"Security Profile",data:[t,n,l],backgroundColor:d,borderColor:p,borderWidth:2,pointBackgroundColor:p,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:p}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{r:{angleLines:{color:g},grid:{color:g},pointLabels:{color:y,font:{size:12}},min:0,max:4,ticks:{backdropColor:"transparent",color:y,z:100,stepSize:1,font:{size:10},callback:function(e){return["None","Basic","Moderate","High","Very High"][e]||""}},beginAtZero:!0}},plugins:{legend:{display:!1,labels:{color:u?"#00cc66":"#006633",font:{family:"'Share Tech Mono', monospace",size:12},boxWidth:15,boxHeight:2}},tooltip:{callbacks:{label:function(e){const t=e.raw;return`${e.label}: ${["None","Basic","Moderate","High","Very High"][t]||""}`}}}}}});const h=()=>{c.current&&c.current.resize()};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h),c.current&&c.current.destroy()}}catch(e){m(e instanceof Error?e.message:String(e))}}),[i,a,r,u]);const y=n?`radar-chart-container ${n}`.trim():"radar-chart-container";return t.jsxs("div",{className:y,"data-testid":`${l}-container`,children:[d?t.jsxs("div",{"data-testid":`${l}-error`,className:"error-message",children:["Error loading chart: ",d]}):t.jsxs("div",{className:"radar-values flex justify-between mb-2",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Availability:"})," ",t.jsx("span",{"data-testid":le,children:i||"None"})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Integrity:"})," ",t.jsx("span",{"data-testid":oe,children:a||"None"})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Confidentiality:"})," ",t.jsx("span",{"data-testid":ce,children:r||"None"})]})]}),t.jsx("canvas",{ref:o,"data-testid":l})]})},Ci=({title:e,iconKey:i,actions:a,className:s="",testId:r})=>{let n="";return i&&(n=i in D?D[i]:i),t.jsxs("div",{className:`flex items-center justify-between pb-2 mb-4 border-b border-gray-200 dark:border-gray-700 ${s}`,"data-testid":r,children:[t.jsxs("h3",{className:"flex items-center text-lg font-semibold text-gray-800 dark:text-gray-200",children:[n&&t.jsx("span",{className:"mr-2","aria-hidden":"true",children:n}),e]}),a&&t.jsx("div",{className:"flex items-center space-x-2",children:a})]})},Mi=({content:i,children:a,position:s="top",className:r="",testId:n})=>{const[l,o]=e.useState(!1);return t.jsxs("div",{className:`relative inline-block ${r}`,"data-testid":n,children:[t.jsx("div",{onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onFocus:()=>o(!0),onBlur:()=>o(!1),className:"inline-block",children:a}),l&&t.jsxs("div",{className:`absolute z-50 bg-gray-800 dark:bg-gray-700 text-white text-xs rounded py-1 px-2 left-1/2 transform -translate-x-1/2 w-max max-w-xs shadow-md ${(()=>{switch(s){case"bottom":return"top-full mt-1";case"left":return"right-full mr-1";case"right":return"left-full ml-1";default:return"bottom-full mb-1"}})()}`,role:"tooltip",children:[i,t.jsx("div",{className:`tooltip-arrow absolute ${"bottom"===s?"bottom-full":"top"===s?"top-full":"top-1/2 -translate-y-1/2"} left-1/2 transform -translate-x-1/2 border-4 border-transparent ${"bottom"===s?"border-b-gray-800 dark:border-b-gray-700":"top"===s?"border-t-gray-800 dark:border-t-gray-700":"left"===s?"border-l-gray-800 dark:border-l-gray-700 left-auto right-0":"border-r-gray-800 dark:border-r-gray-700 left-0 right-auto"}`})]})]})},Si=({label:e,value:i,onChange:a,options:s,description:r,icon:n,tooltipContent:l,testId:o,accentColor:c,disabled:d=!1,className:m=""})=>{const u=()=>{if(!i)return"";const t=e.toLowerCase().includes("confidentiality")?"confidentiality":e.toLowerCase().includes("integrity")?"integrity":"availability",a=si.getComponentDetails(t,i);return"availability"===t&&a?.uptime?a.uptime:"integrity"===t&&a?.validationMethod?a.validationMethod:"confidentiality"===t&&a?.protectionMethod?a.protectionMethod:""};return t.jsxs("div",{className:`mb-4 ${m}`,"data-testid":o,children:[t.jsxs("div",{className:"flex items-center mb-1",children:[n&&t.jsx("span",{className:"mr-2",children:n}),t.jsx("label",{htmlFor:`select-${e.toLowerCase().replace(/\s/g,"-")}`,className:"font-medium text-gray-700 dark:text-gray-300",children:e}),l&&t.jsx(Mi,{content:l,children:t.jsx("button",{type:"button",className:"info-button ml-1 text-gray-500 hover:text-gray-600 dark:text-gray-400","aria-label":`Info about ${e}`,children:t.jsx("span",{children:"â„¹ï¸"})})})]}),r&&t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:r}),t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2 font-medium",style:c?{color:c}:void 0,children:i}),t.jsx("select",{id:`select-${e.toLowerCase().replace(/\s/g,"-")}`,value:i,onChange:e=>a(e.target.value),className:"block w-full px-2 py-1.5 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300",style:c?{borderColor:c}:void 0,disabled:d,children:s.map((e=>t.jsx("option",{value:e,children:e},e)))})]}),i&&t.jsxs("div",{className:"mt-2",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:(()=>{if(!i)return"";const t=e.toLowerCase().includes("confidentiality")?"confidentiality":e.toLowerCase().includes("integrity")?"integrity":"availability",a=si.getComponentDetails(t,i);return a?.description||`${i} - ${t.charAt(0).toUpperCase()+t.slice(1)} security level of ${i}.`})()}),u()&&t.jsx("span",{className:"inline-block text-xs mt-1 px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded",style:c?{color:c}:void 0,children:u()})]})]})},Ai=({score:e,label:i,testId:a})=>{const{color:s,className:r}=e>=80?{color:"#ff5252",className:"critical-risk"}:e>=60?{color:"#ff9800",className:"high-risk"}:e>=40?{color:"#ffeb3b",className:"medium-risk"}:{color:"#00e676",className:"low-risk"},n=`${e}%`;return t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border shadow-sm","data-testid":a,children:[t.jsx("h4",{className:"text-sm font-medium mb-2",children:"Risk Assessment Score"}),t.jsx("div",{className:"flex justify-center mb-3",children:t.jsxs("div",{className:`text-2xl font-bold ${r} risk-score-value`,children:[e,"/100"]})}),t.jsx("div",{className:"text-center mb-3",children:t.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${r}`,children:[i," Risk"]})}),t.jsxs("div",{className:"mt-2",children:[t.jsx("div",{className:"security-gauge",children:t.jsx("div",{className:"security-gauge-indicator",style:{left:n}})}),t.jsxs("div",{className:"flex justify-between text-xs mt-1 text-gray-500 dark:text-gray-400",children:[t.jsx("span",{children:"Low"}),t.jsx("span",{children:"Medium"}),t.jsx("span",{children:"High"}),t.jsx("span",{children:"Critical"})]})]})]})},Ei=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:s,className:r="",testId:n="security-visualization-widget"})=>{e.useMemo((()=>[{category:"Availability",value:ei(i),maxValue:4,color:"#3498db"},{category:"Integrity",value:ei(a),maxValue:4,color:"#2ecc71"},{category:"Confidentiality",value:ei(s),maxValue:4,color:"#9b59b6"}]),[i,a,s]);const l=e.useMemo((()=>{const e=(ei(i)+ei(a)+ei(s))/3;return Math.round(100-e/4*100)}),[i,a,s]),o=e.useMemo((()=>l>=80?"Critical":l>=60?"High":l>=40?"Medium":l>=20?"Low":"Minimal"),[l]),c=e.useMemo((()=>V[o.toUpperCase()]||"Risk level not available"),[o]);return t.jsx("div",{className:`h-full flex flex-col ${r}`,"data-testid":n,children:t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 h-full",children:[t.jsx("div",{className:"md:w-3/5 h-full flex items-center justify-center radar-chart-container overflow-hidden",children:t.jsx(Li,{availabilityLevel:i,integrityLevel:a,confidentialityLevel:s,testId:`${n}-radar-chart`})}),t.jsxs("div",{className:"md:w-2/5 flex flex-col",children:[t.jsx(Ai,{score:l,label:o,testId:`${n}-risk-score`}),t.jsxs("div",{className:"mt-4 bg-gray-50 dark:bg-gray-800 p-3 rounded-lg border shadow-sm",children:[t.jsx("h4",{className:"text-sm font-medium mb-2",children:"Risk Assessment"}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300",children:c})]}),t.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2 text-center",children:[t.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-md",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Availability"}),t.jsx("div",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:i})]}),t.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-md",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Integrity"}),t.jsx("div",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:a})]}),t.jsxs("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-md",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Confidentiality"}),t.jsx("div",{className:"text-sm font-medium text-purple-600 dark:text-purple-400",children:s})]})]})]})]})})},Ri=({availabilityLevel:i="None",integrityLevel:a="None",confidentialityLevel:s="None",className:r="",testId:l=ot})=>{const[o,c]=e.useState("confidentiality"),d=e=>{switch(e){case"None":return"None";case"Low":return"Days (1-5)";case"Moderate":return"Weeks (2-4)";case"High":return"Months (1-3)";case"Very High":return"Months (3+)";default:return"Not specified"}},m=e=>{switch(e){case"None":return"None";case"Low":return"Minimal (quarterly review)";case"Moderate":return"Regular (monthly review)";case"High":return"Significant (biweekly monitoring)";case"Very High":return"Extensive (continuous monitoring)";default:return"Not specified"}},u=e=>{switch(e){case"None":return"None";case"Low":return"Basic security knowledge";case"Moderate":return"Security professional";case"High":return"Security specialist";case"Very High":return"Security expert team";default:return"Not specified"}},p=e.useMemo((()=>si.getComponentDetails("availability",i)),[i]),g=e.useMemo((()=>si.getComponentDetails("integrity",a)),[a]),x=e.useMemo((()=>si.getComponentDetails("confidentiality",s)),[s]),y=e.useMemo((()=>si.getRecommendations("availability",i)||[]),[i]),h=e.useMemo((()=>si.getRecommendations("integrity",a)||[]),[a]),I=e.useMemo((()=>si.getRecommendations("confidentiality",s)||[]),[s]),w=e.useMemo((()=>{switch(o){case"availability":return{details:p,level:i,color:n.AVAILABILITY,recommendations:y,icon:k,protectionMethod:p?.uptime||"Not specified",validationKey:"uptime"};case"integrity":return{details:g,level:a,color:n.INTEGRITY,recommendations:h,icon:j,protectionMethod:g?.validationMethod||"Not specified",validationKey:"validationMethod"};case"confidentiality":return{details:x,level:s,color:n.CONFIDENTIALITY,recommendations:I,icon:N,protectionMethod:x?.protectionMethod||"Not specified",validationKey:"protectionMethod"}}}),[o,p,g,x,i,a,s,y,h,I]),L=e.useMemo((()=>{if(!w?.details)return null;const e=w.level,t={development:d(e),maintenance:m(e),expertise:u(e)};return{implementationSteps:w.details.implementationSteps||[],effort:{development:w.details.effort?.development||t.development,maintenance:w.details.effort?.maintenance||t.maintenance,expertise:w.details.effort?.expertise||t.expertise},codeExamples:w.details.codeExamples||[],technicalImplementation:w.details.technicalImplementation}}),[w]);return e.useMemo((()=>{let e;return e="availability"===o?i:"integrity"===o?a:s,P[e]||{developmentEffort:d(e),maintenance:m(e),expertise:u(e)}}),[o,i,a,s]),e.useMemo((()=>`$ security-level --availability ${i} --integrity ${a} --confidentiality ${s}\nAnalyzing security requirements...\nGenerating implementation plan...\nSecurity level set: ${i}/${a}/${s}\nActive component: ${o}`),[i,a,s,o]),t.jsx(Mt,{title:"Technical Implementation Details",icon:"âš™ï¸",className:r,testId:l,children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex space-x-1 border-b",children:[t.jsxs("button",{onClick:()=>c("confidentiality"),className:"px-4 py-2 text-sm font-medium rounded-t-lg focus:outline-none "+("confidentiality"===o?`bg-${n.CONFIDENTIALITY.PRIMARY} bg-opacity-10 border-b-2`:"hover:bg-gray-100 dark:hover:bg-gray-800"),style:{borderBottomColor:"confidentiality"===o?n.CONFIDENTIALITY.PRIMARY:"transparent"},"data-testid":mt,children:[t.jsx("span",{className:"mr-1",children:N}),f]}),t.jsxs("button",{onClick:()=>c("integrity"),className:"px-4 py-2 text-sm font-medium rounded-t-lg focus:outline-none "+("integrity"===o?`bg-${n.INTEGRITY.PRIMARY} bg-opacity-10 border-b-2`:"hover:bg-gray-100 dark:hover:bg-gray-800"),style:{borderBottomColor:"integrity"===o?n.INTEGRITY.PRIMARY:"transparent"},"data-testid":dt,children:[t.jsx("span",{className:"mr-1",children:j}),v]}),t.jsxs("button",{onClick:()=>c("availability"),className:"px-4 py-2 text-sm font-medium rounded-t-lg focus:outline-none "+("availability"===o?`bg-${n.AVAILABILITY.PRIMARY} bg-opacity-10 border-b-2`:"hover:bg-gray-100 dark:hover:bg-gray-800"),style:{borderBottomColor:"availability"===o?n.AVAILABILITY.PRIMARY:"transparent"},"data-testid":ct,children:[t.jsx("span",{className:"mr-1",children:k}),b]})]}),t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"flex items-center text-lg font-medium",style:{color:w?.color.PRIMARY},"data-testid":ut,children:[t.jsx("span",{className:"mr-2",children:w?.icon}),o.charAt(0).toUpperCase()+o.slice(1)," Technical Implementation"]}),t.jsxs("div",{className:"mt-1 flex items-center",children:[t.jsx(pi,{status:"confidentiality"===o?"purple":"integrity"===o?"success":"info",children:w?.level}),t.jsx("span",{className:"mx-2",children:"â€¢"}),t.jsx("span",{className:"text-sm font-medium",children:"uptime"===w?.validationKey?"Uptime:":"validationMethod"===w?.validationKey?"Validation Method:":"Protection Method:"}),t.jsx("span",{className:"ml-1 text-sm",children:w?.protectionMethod})]})]})}),t.jsx("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm","data-testid":pt,children:t.jsx("p",{className:"text-gray-700 dark:text-gray-300","data-testid":gt,children:w?.details?.technical||"No technical details available for this security level."})}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Implementation Recommendations"}),w?.recommendations&&w.recommendations.length>0?t.jsx("ul",{className:"space-y-2 pl-5 list-disc marker:text-blue-500 dark:marker:text-blue-400",children:w.recommendations.map(((e,i)=>t.jsx("li",{className:"text-gray-700 dark:text-gray-300",children:e},i)))}):t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No recommendations available for this security level."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[t.jsxs("h5",{className:"text-sm font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’»"}),"Development Effort"]}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm","data-testid":xt,children:L?.effort?.development||d(w?.level)})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[t.jsxs("h5",{className:"text-sm font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ”§"}),"Maintenance"]}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:L?.effort?.maintenance||m(w?.level)})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[t.jsxs("h5",{className:"text-sm font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ‘¨â€ðŸ’»"}),"Required Expertise"]}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm",children:L?.effort?.expertise||u(w?.level)})]})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Implementation Reference"}),t.jsxs("div",{className:"technical-terminal shadow-md",children:[t.jsxs("div",{className:"terminal-header",children:[t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("div",{className:"terminal-dot red"}),t.jsx("div",{className:"terminal-dot yellow"}),t.jsx("div",{className:"terminal-dot green"})]}),t.jsx("div",{className:"terminal-title",children:"Terminal"})]}),t.jsx("div",{className:"terminal-content",children:t.jsxs("pre",{className:"text-xs overflow-x-auto p-2",children:[t.jsx("span",{className:"terminal-prompt",children:"$"})," ",t.jsxs("span",{className:"terminal-command",children:["security-level --availability ",i," --integrity"," ",a," --confidentiality ",s]}),t.jsx("br",{}),t.jsx("span",{className:"terminal-output",children:"Analyzing security requirements..."}),t.jsx("br",{}),t.jsx("span",{className:"terminal-output",children:"Generating implementation plan..."}),t.jsx("br",{}),t.jsxs("span",{className:"terminal-output",children:["Security level set: ",i,"/",a,"/",s]}),t.jsx("br",{}),t.jsxs("span",{className:"terminal-output",children:["Active component: ",o]}),t.jsx("br",{}),t.jsx("span",{className:"terminal-output",children:"---"}),t.jsx("br",{}),t.jsxs("span",{className:"terminal-output",children:[w?.icon," ",o.charAt(0).toUpperCase()+o.slice(1)," ","Level: ",w?.level]}),t.jsx("br",{}),t.jsxs("span",{className:"terminal-output",children:["Protection Method: ",w?.protectionMethod]})]})})]})]}),L?.codeExamples&&L.codeExamples.length>0&&t.jsxs("div",{className:"mt-6",children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Code Examples"}),t.jsx("div",{className:"space-y-4",children:L.codeExamples.map(((e,i)=>t.jsxs("div",{className:"code-block",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-xs font-medium",children:e.title}),t.jsx("span",{className:"text-xs text-gray-500",children:e.language})]}),t.jsx("pre",{className:"overflow-x-auto",children:t.jsx("code",{children:e.code})})]},i)))})]}),L?.implementationSteps&&L.implementationSteps.length>0&&t.jsxs("div",{className:"mt-6",children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Implementation Steps"}),t.jsx("div",{className:"space-y-2",children:L.implementationSteps.map(((e,i)=>t.jsxs("div",{className:"flex items-start",children:[t.jsx("div",{className:"flex-shrink-0 h-6 w-6 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 mr-3",children:i+1}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:e})]},i)))})]})]})})},Ti=({securityLevel:i,availabilityLevel:a,integrityLevel:s,confidentialityLevel:r,className:n="",testId:l=Lt})=>{const o=e.useMemo((()=>oi(i)),[i]),c=e.useMemo((()=>ci("availability",a)),[a]),d=e.useMemo((()=>ci("integrity",s)),[s]),m=e.useMemo((()=>ci("confidentiality",r)),[r]),u=e.useMemo((()=>({[h.NONE]:"$0",[h.LOW]:"$100,000 - $250,000",[h.MODERATE]:"$250,000 - $750,000",[h.HIGH]:"$750,000 - $2,000,000",[h.VERY_HIGH]:"$2,000,000+"}[i]||"$0")),[i]),p=e.useMemo((()=>({[h.NONE]:"High disruption risk",[h.LOW]:"Moderate disruption risk",[h.MODERATE]:"Controlled disruption",[h.HIGH]:"Minimal disruption",[h.VERY_HIGH]:"Business continuity assured"}[i]||"Unknown impact")),[i]),g=e.useMemo((()=>{const e=parseInt(o.value.replace(/[^0-9]/g,""),10)||0;return e>=400?{score:"A+",label:"Exceptional"}:e>=300?{score:"A",label:"Excellent"}:e>=200?{score:"B+",label:"Very Good"}:e>=100?{score:"B",label:"Good"}:e>=50?{score:"C",label:"Average"}:{score:"D",label:"Minimal"}}),[o.value]),x=e.useMemo((()=>({NONE:M,LOW:S,MODERATE:A,HIGH:E,VERY_HIGH:R})),[]),y=e.useMemo((()=>({[h.NONE]:"N/A",[h.LOW]:"18-24 months",[h.MODERATE]:"12-18 months",[h.HIGH]:"6-12 months",[h.VERY_HIGH]:"3-6 months"}[i]||"Unknown")),[i]);return t.jsx(Mt,{title:"Business Value & ROI",icon:"ðŸ’°",className:n,testId:l,children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsx(Ni,{title:"Return on Investment",value:o.value,icon:"ðŸ“ˆ",testId:`${l}-roi`,accentColor:"#9b59b6",variant:"purple"}),t.jsx(Ni,{title:"Break-Even Period",value:y,icon:"â±ï¸",testId:`${l}-breakeven`,accentColor:"#3498db",variant:"info"}),t.jsx(Ni,{title:"Investment Impact",value:`${g.score} - ${g.label}`,icon:"ðŸŽ¯",testId:`${l}-impact-score`,accentColor:"#2ecc71",variant:"success"})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Business Value Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-3",children:[t.jsxs("div",{className:"p-3 rounded-md bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20 border border-purple-200 dark:border-purple-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ›¡ï¸"}),t.jsx("span",{className:"font-medium",children:"Breach Cost Avoidance"})]}),t.jsx("p",{className:"text-lg font-bold text-purple-700 dark:text-purple-300","data-testid":`${l}-breach-cost`,children:u}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Estimated financial loss avoided based on risk reduction"})]}),t.jsxs("div",{className:"p-3 rounded-md bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"âš¡"}),t.jsx("span",{className:"font-medium",children:"Productivity Impact"})]}),t.jsx("p",{className:"text-lg font-bold text-blue-700 dark:text-blue-300","data-testid":`${l}-productivity`,children:p}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:"Effect on business operations and employee productivity"})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Impact Summary"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-gray-800 rounded-md border-l-4",style:{borderLeftColor:"#9b59b6"},"data-testid":`${l}-conf-impact`,children:[t.jsxs("h4",{className:"text-sm font-medium mb-1 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Confidentiality Value"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:m||"No business impact information available."}),t.jsx("div",{className:"mt-2",children:t.jsx(pi,{status:"purple",size:"sm",children:r})})]}),t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-gray-800 rounded-md border-l-4",style:{borderLeftColor:"#2ecc71"},"data-testid":`${l}-int-impact`,children:[t.jsxs("h4",{className:"text-sm font-medium mb-1 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âœ“"}),"Integrity Value"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:d||"No business impact information available."}),t.jsx("div",{className:"mt-2",children:t.jsx(pi,{status:"success",size:"sm",children:s})})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-gray-800 rounded-md border-l-4",style:{borderLeftColor:"#3498db"},"data-testid":`${l}-avail-impact`,children:[t.jsxs("h4",{className:"text-sm font-medium mb-1 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Availability Value"]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:c||"No business impact information available."}),t.jsx("div",{className:"mt-2",children:t.jsx(pi,{status:"info",size:"sm",children:a})})]})]})]}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm",children:[t.jsx("h3",{className:"text-md font-medium mb-3",children:"Security Value Comparison"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b dark:border-gray-700",children:[t.jsx("th",{className:"text-left py-2 px-3",children:"Security Level"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Est. ROI"}),t.jsx("th",{className:"text-left py-2 px-3",children:"Notes"})]})}),t.jsx("tbody",{children:Object.entries(x).map((([e,a])=>{const s=a;return t.jsxs("tr",{className:"border-b dark:border-gray-700 "+(i===e.replace(/_/g," ")?"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20":""),children:[t.jsx("td",{className:"py-2 px-3",children:e.replace(/_/g," ")}),t.jsx("td",{className:"py-2 px-3",children:s.returnRate}),t.jsx("td",{className:"py-2 px-3",children:s.description})]},e)}))})]})})]})]})})},Hi=e=>{if(e)switch(e){case"small":return{width:1,height:1};case"medium":default:return{width:2,height:1};case"large":return{width:2,height:2};case"full":return{width:4,height:2}}};const Oi=new class{widgets=new Map;register(e){const t={...e,size:e.size||"medium",order:e.order||999};this.widgets.set(t.id,t)}get(e){return this.widgets.get(e)}getAll(){return Array.from(this.widgets.values()).sort(((e,t)=>e.order-t.order))}renderWidget(e,i={}){const a=this.widgets.get(e);if(!a)return null;try{const e={...a.defaultProps,...i};return t.jsx(Mt,{title:a.title,icon:a.icon,size:Hi(a.size),testId:`widget-${a.id}`,children:t.jsx(a.component,{...e})},a.id)}catch(s){return((e,i)=>t.jsxs("div",{className:"widget-error p-4 bg-red-50 border border-red-300 text-red-700 rounded-md","data-testid":`widget-error-${i}`,children:[t.jsx("h3",{className:"font-medium mb-2",children:"Widget Error"}),t.jsx("p",{className:"text-sm",children:e.message}),t.jsx("p",{className:"text-xs mt-2 text-gray-600",children:"Please try refreshing the page or contact support if the issue persists."})]}))(s instanceof Error?s:new Error(String(s)),e)}}renderWidgets(e,i={}){return Array.from(this.widgets.values()).filter(e||(()=>!0)).sort(((e,t)=>e.order-t.order)).map((e=>{const a=i[e.id]||{},s={...e.defaultProps,...a};return t.jsx(Mt,{title:e.title,icon:e.icon,size:Hi(e.size),testId:`widget-${e.id}`,children:t.jsx(e.component,{...s})},e.id)}))}};Oi.register({id:"security-summary",title:zt,component:wi,icon:St,size:"medium",order:10}),Oi.register({id:"compliance-status",title:Gt,component:vi,icon:Et,size:"medium",order:20,defaultProps:{securityLevel:Yt}}),Oi.register({id:"value-creation",title:_t,component:Ti,icon:Rt,size:"medium",order:25,description:"Business value created by security investments",defaultProps:{securityLevel:Yt}}),Oi.register({id:"integrity-impact",title:Xt,component:ki,icon:Pt,size:"medium",order:30,description:"Impact and recommendations for data integrity",defaultProps:{integrityLevel:Yt,availabilityLevel:Yt,confidentialityLevel:Yt}}),Oi.register({id:"confidentiality-impact",title:Jt,component:fi,icon:Dt,size:"medium",order:35,description:"Impact and recommendations for data confidentiality",defaultProps:{confidentialityLevel:Yt,availabilityLevel:Yt,integrityLevel:Yt}}),Oi.register({id:"availability-impact",title:Zt,component:yi,icon:$t,size:"medium",order:40,description:"Impact and recommendations for system availability",defaultProps:{availabilityLevel:Yt,integrityLevel:Yt,confidentialityLevel:Yt,options:{}}}),Oi.register({id:"security-resources",title:Kt,component:Ii,icon:Vt,size:"medium",order:45,description:"Security resources and documentation",defaultProps:{securityLevel:Yt,availabilityLevel:Yt,integrityLevel:Yt,confidentialityLevel:Yt}}),Oi.register({id:"technical-details",title:Wt,component:Ri,icon:Ot,size:"large",order:50,description:"Technical implementation details for security controls",defaultProps:{availabilityLevel:Yt,integrityLevel:Yt,confidentialityLevel:Yt}}),Oi.register({id:"business-impact",title:qt,component:hi,icon:Ht,size:"large",order:55,description:"Business impact analysis for security choices",defaultProps:{availabilityLevel:Yt,integrityLevel:Yt,confidentialityLevel:Yt}}),Oi.register({id:"cia-impact-summary",title:"CIA Impact Summary",description:"Shows a consolidated overview of CIA security impacts",component:({confidentialityLevel:e,integrityLevel:i,availabilityLevel:a,confidentiality:s,integrity:r,availability:l,className:o="",testId:c="cia-impact-summary-widget"})=>{const d=e||s||"None",m=i||r||"None",u=a||l||"None",p=si.getComponentDetails("confidentiality",d),g=si.getComponentDetails("integrity",m),x=si.getComponentDetails("availability",u),y=function(e,t,i){const a=["None","Low","Moderate","High","Very High"],s=a.indexOf(e),r=a.indexOf(t),n=a.indexOf(i);return a[Math.round((s+r+n)/3)]}(u,m,d);return t.jsx(Mt,{title:"CIA Security Impact Summary",icon:"ðŸ”",className:o,testId:c,children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg mb-4 border-l-4 border-blue-500",children:[t.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ›¡ï¸"}),"Overall Security Profile"]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(pi,{status:ii(y),className:"mr-2",children:y}),t.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Security Level"})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.jsx(bi,{label:f,value:d,icon:N,testId:`${c}-confidentiality-summary`,color:"purple",borderColor:n.CONFIDENTIALITY.PRIMARY}),t.jsx(bi,{label:v,value:m,icon:j,testId:`${c}-integrity-summary`,color:"green",borderColor:n.INTEGRITY.PRIMARY}),t.jsx(bi,{label:b,value:u,icon:k,testId:`${c}-availability-summary`,color:"blue",borderColor:n.AVAILABILITY.PRIMARY})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-l-4",style:{borderLeftColor:n.CONFIDENTIALITY.PRIMARY},children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:N}),f]}),t.jsx(pi,{status:"purple",className:"mb-2",children:d}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:[p?.description?.substring(0,100),"..."]}),t.jsx(xi,{label:"Protection Method",value:p?.protectionMethod||"Not specified",className:"mt-2"})]}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-l-4",style:{borderLeftColor:n.INTEGRITY.PRIMARY},children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:j}),v]}),t.jsx(pi,{status:"success",className:"mb-2",children:m}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:[g?.description?.substring(0,100),"..."]}),t.jsx(xi,{label:"Validation Method",value:g?.validationMethod||"Not specified",className:"mt-2"})]}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border-l-4",style:{borderLeftColor:n.AVAILABILITY.PRIMARY},children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:k}),b]}),t.jsx(pi,{status:"info",className:"mb-2",children:u}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:[x?.description?.substring(0,100),"..."]}),t.jsx(xi,{label:"Uptime Target",value:x?.uptime||"Not specified",className:"mt-2"})]})]}),t.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[t.jsx("h4",{className:"font-medium mb-2",children:"Security Profile Summary"}),t.jsxs("p",{className:"text-sm",children:["This security profile combines ",d," ","confidentiality, ",m," integrity, and"," ",u," availability controls to create an"," ",y.toLowerCase()," security posture. For detailed implementation recommendations, see the individual CIA component tabs."]})]})]})})},defaultProps:{availabilityLevel:Yt,integrityLevel:Yt,confidentialityLevel:Yt},size:"small",order:12,icon:"ðŸ›¡ï¸",position:0}),Oi.register({id:"security-visualization",title:Ut,component:Ei,icon:At,size:"medium",order:15,description:"Security profile visualization and risk assessment",defaultProps:{availabilityLevel:Yt,integrityLevel:Yt,confidentialityLevel:Yt}}),Oi.register({id:"cost-estimation",title:Ft,component:ji,icon:Tt,size:"medium",order:22,description:"Cost estimation for security implementation",defaultProps:{availabilityLevel:Yt,integrityLevel:Yt,confidentialityLevel:Yt}});const $i=({children:e,useRegistry:a=!1,availability:s,integrity:r,confidentiality:n,columnsSmall:l=1,columnsMedium:o=2,columnsLarge:c=3,className:d="",compact:m=!1,showBorders:x=!0})=>{const y={"availability-impact":{level:s,options:u},"integrity-impact":{level:r,options:p},"confidentiality-impact":{level:n,options:g}},h={securityLevel:Pi(s,r,n),availabilityLevel:s,integrityLevel:r,confidentialityLevel:n},b={"security-summary":h,"compliance-status":{securityLevels:{availabilityLevel:s,integrityLevel:r,confidentialityLevel:n}},"value-creation":{securityLevel:h.securityLevel},"cost-estimation":Di(s,r,n),...y};return t.jsxs("div",{className:`dashboard-grid \n  grid \n  grid-cols-1 \n  sm:grid-cols-2 \n  lg:grid-cols-3\n  gap-4 \n  p-4\n ${d}`,"data-testid":Ke,children:[a?Oi.renderWidgets(void 0,b):i.Children.map(e,(e=>i.isValidElement(e)?e:null)),!a&&s&&r&&n&&t.jsx(Ri,{availabilityLevel:s,integrityLevel:r,confidentialityLevel:n})]})};function Pi(e,t,i){const a=["None","Low","Moderate","High","Very High"],s=a.indexOf(e||"None"),r=a.indexOf(t||"None"),n=a.indexOf(i||"None");return a[Math.round((s+r+n)/3)]||"None"}function Di(e,t,i){const a=e||"None",s=t||"None",r=i||"None",n=(u[a]?.capex||0)+(p[s]?.capex||0)+(g[r]?.capex||0),l=(u[a]?.opex||0)+(p[s]?.opex||0)+(g[r]?.opex||0);return{totalCapex:n,totalOpex:l,capexEstimate:""+5e3*n,opexEstimate:""+2e3*l,isSmallSolution:n<=60,roi:`${Math.round(200+n/2)}%`}}const Vi=({children:e,title:i,description:a,className:s="",headerClassName:r="",testId:n,showHeader:l=!0,colSpan:o=1,rowSpan:c=1,actions:d,headerContent:m,loading:u=!1,error:p=null,fullHeight:g=!0,compact:x=!1,emptyState:y,icon:h})=>t.jsxs("div",{className:`widget widget-col-4 ${s} ${g?"h-full":""}`,"data-testid":n||Ct(i),role:"region","aria-labelledby":`widget-title-${i?.toLowerCase().replace(/\s+/g,"-")}`,children:[l&&t.jsx(Ci,{title:i,iconKey:h,actions:d||m,className:r,testId:`${n||Ct(i)}-header`}),t.jsx("div",{className:"widget-body",children:u?t.jsx("div",{className:"flex items-center justify-center h-full",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):p?t.jsxs("div",{className:"text-red-500 p-4",children:[t.jsx("div",{className:"font-bold",children:"Error"}),t.jsx("div",{children:p.toString()})]}):t.jsx("div",{className:"widget-content-wrapper",children:e||y||t.jsx("div",{className:"text-gray-400 p-4 text-center italic",children:"No content available"})})})]}),Yi=({availabilityLevel:i="None",integrityLevel:a="None",confidentialityLevel:s="None",onAvailabilityChange:r,onIntegrityChange:n,onConfidentialityChange:l,availabilityOptions:u,integrityOptions:p,confidentialityOptions:g,showSelectionSummary:x=!0,disabled:y=!1,testId:h="security-level-selector",showDescriptions:I=!0})=>{const[w,L]=e.useState(i),[C,M]=e.useState(a),[S,A]=e.useState(s),[E,R]=e.useState(null),[T,H]=e.useState(null),{availabilityOptions:O,integrityOptions:$,confidentialityOptions:P}=function(){const t=e.useMemo((()=>o),[]),i=e.useMemo((()=>c),[]),a=e.useMemo((()=>d),[]),s=e.useMemo((()=>m),[]);return e.useMemo((()=>({availabilityOptions:t,integrityOptions:i,confidentialityOptions:a,ROI_ESTIMATES:s})),[t,i,a,s])}(),D=u||O,V=p||$,te=g||P;e.useEffect((()=>{L(i)}),[i]),e.useEffect((()=>{M(a)}),[a]),e.useEffect((()=>{A(s)}),[s]);const ie=e=>{R(e)},ae=()=>{R(null)},se=(e,i)=>Object.keys(e||{}).map((e=>{const a=(e=>Qt(e))(e),s=((e,t)=>{const i=(e=>["confidentiality","integrity","availability"].includes(e)?e:"confidentiality")(e);return si.getComponentDetails(i,t)})(i,a),r=s?.description||"",n=r.length>50?r.substring(0,50)+"...":r;return t.jsxs("option",{value:e,className:ti(e),children:[e," ",n?`- ${n}`:""]},e)}));return t.jsxs("div",{"data-testid":h,className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg shadow-md border border-gray-200 dark:border-gray-700",children:[x&&t.jsxs("div",{className:"mb-4 pb-3 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("h4",{className:"font-medium mb-2 text-gray-800 dark:text-gray-200 text-sm flex items-center terminal-text",children:[t.jsx("span",{className:"mr-2 pulse-dot",children:"â—‰"}),"Current Security Profile"]}),t.jsxs("div",{className:"flex flex-wrap gap-2 justify-between",children:[t.jsx(bi,{label:f,value:S,icon:N,testId:st,color:"purple",compact:!0}),t.jsx(bi,{label:v,value:C,icon:j,testId:at,color:"green",compact:!0}),t.jsx(bi,{label:b,value:w,icon:k,testId:it,color:"blue",compact:!0})]})]}),t.jsx("div",{className:"mb-4 pb-3 border-b border-gray-200 dark:border-gray-700",children:t.jsx("div",{className:"flex justify-between items-center text-xs",children:["None","Low","Moderate","High","Very High"].map((e=>t.jsxs("div",{className:"flex items-center "+(e===w||e===C||e===S?"text-blue-600 dark:text-blue-400 font-medium":"text-gray-500 dark:text-gray-400"),children:[t.jsx("span",{className:`w-2 h-2 mr-1 rounded-full inline-block security-level-indicator level-${e.toLowerCase()}`}),e]},e)))})}),t.jsxs("div",{className:"mb-5 pb-4 border-b border-gray-100 dark:border-gray-700","data-testid":W,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("label",{htmlFor:"confidentialitySelect",className:"flex items-center terminal-text text-purple-600 dark:text-purple-400 font-medium",children:[t.jsx("span",{className:"mr-2 icon-confidentiality",children:N}),f,t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:"Controls who can access your data and systems"})]}),t.jsx("button",{type:"button",className:"info-button w-6 h-6 rounded-full flex items-center justify-center bg-purple-100 dark:bg-purple-900 dark:bg-opacity-30 text-purple-600 dark:text-purple-400 hover:bg-purple-200 dark:hover:bg-purple-800 transition-colors",onMouseEnter:()=>ie("confidentiality"),onMouseLeave:ae,"data-testid":ee,"aria-label":"Show technical information about confidentiality",children:t.jsx("span",{className:"text-xs",children:"â„¹ï¸"})})]}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{id:"confidentialitySelect",className:"block w-full px-3 py-2 pr-10 text-sm border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 rounded-md dark:bg-gray-700 dark:text-white transition-colors",value:S,onChange:e=>{const t=e.target.value;A(t),H("confidentiality"),l&&l(t)},disabled:y,"data-testid":z,"aria-haspopup":"listbox","aria-expanded":"false",children:se(te,"confidentiality")}),t.jsx("div",{className:`absolute right-3 top-2.5 w-3 h-3 rounded-full ${ti(S)}`,"data-testid":X})]}),te?.[S]?.description&&I&&t.jsx("div",{className:"mt-3 p-2.5 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-10 rounded-md text-xs text-gray-700 dark:text-gray-300 border-l-4 border-purple-500","data-testid":_,children:te[S].description}),te?.[S]?.protectionMethod&&t.jsxs("div",{className:"mt-2 flex items-center text-xs text-purple-600 dark:text-purple-400",children:[t.jsx("span",{className:"mr-1",children:"ðŸ›¡ï¸"}),t.jsx("span",{children:te[S].protectionMethod})]})]}),t.jsxs("div",{className:"mb-5 pb-4 border-b border-gray-100 dark:border-gray-700","data-testid":q,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("label",{htmlFor:"integritySelect",className:"flex items-center terminal-text text-green-600 dark:text-green-400 font-medium",children:[t.jsx("span",{className:"mr-2 icon-integrity",children:j}),v,t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:"Ensures data remains accurate and unaltered"})]}),t.jsx("button",{type:"button",className:"info-button w-6 h-6 rounded-full flex items-center justify-center bg-green-100 dark:bg-green-900 dark:bg-opacity-30 text-green-600 dark:text-green-400 hover:bg-green-200 dark:hover:bg-green-800 transition-colors",onMouseEnter:()=>ie("integrity"),onMouseLeave:ae,"data-testid":Q,"aria-label":"Show technical information about integrity",children:t.jsx("span",{className:"text-xs",children:"â„¹ï¸"})})]}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{id:"integritySelect",className:"block w-full px-3 py-2 pr-10 text-sm border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 rounded-md dark:bg-gray-700 dark:text-white transition-colors",value:C,onChange:e=>{const t=e.target.value;M(t),H("integrity"),n&&n(t)},disabled:y,"data-testid":B,"aria-haspopup":"listbox","aria-expanded":"false",children:se(V,"integrity")}),t.jsx("div",{className:`absolute right-3 top-2.5 w-3 h-3 rounded-full ${ti(C)}`,"data-testid":Z})]}),V?.[C]?.description&&I&&t.jsx("div",{className:"mt-3 p-2.5 bg-green-50 dark:bg-green-900 dark:bg-opacity-10 rounded-md text-xs text-gray-700 dark:text-gray-300 border-l-4 border-green-500","data-testid":G,children:V[C].description}),V?.[C]?.validationMethod&&t.jsxs("div",{className:"mt-2 flex items-center text-xs text-green-600 dark:text-green-400",children:[t.jsx("span",{className:"mr-1",children:"âœ“"}),t.jsx("span",{children:V[C].validationMethod})]})]}),t.jsxs("div",{className:"mb-2","data-testid":F,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("label",{htmlFor:"availabilitySelect",className:"flex items-center terminal-text text-blue-600 dark:text-blue-400 font-medium",children:[t.jsx("span",{className:"mr-2 icon-availability",children:k}),b,t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:"Determines how reliably your systems can be accessed"})]}),t.jsx("button",{type:"button",className:"info-button w-6 h-6 rounded-full flex items-center justify-center bg-blue-100 dark:bg-blue-900 dark:bg-opacity-30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors",onMouseEnter:()=>ie("availability"),onMouseLeave:ae,"data-testid":J,"aria-label":"Show technical information about availability",children:t.jsx("span",{className:"text-xs",children:"â„¹ï¸"})})]}),t.jsxs("div",{className:"relative",children:[t.jsx("select",{id:"availabilitySelect",className:"block w-full px-3 py-2 pr-10 text-sm border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 rounded-md dark:bg-gray-700 dark:text-white transition-colors",value:w,onChange:e=>{const t=e.target.value;L(t),H("availability"),r&&r(t)},disabled:y,"data-testid":Y,"aria-haspopup":"listbox","aria-expanded":"false",children:se(D,"availability")}),t.jsx("div",{className:`absolute right-3 top-2.5 w-3 h-3 rounded-full ${ti(w)}`,"data-testid":K})]}),D?.[w]?.description&&I&&t.jsx("div",{className:"mt-3 p-2.5 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-10 rounded-md text-xs text-gray-700 dark:text-gray-300 border-l-4 border-blue-500","data-testid":U,children:D[w].description}),D?.[w]?.uptime&&t.jsxs("div",{className:"mt-2 flex items-center text-xs text-blue-600 dark:text-blue-400",children:[t.jsx("span",{className:"mr-1",children:"â±ï¸"}),t.jsx("span",{children:D[w].uptime}),D?.[w]?.rto&&t.jsxs("span",{className:"ml-3",children:[t.jsx("span",{className:"mr-1",children:"ðŸ”„"}),"RTO:"," ",D[w].rto]})]})]}),E&&t.jsxs("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-md border border-gray-200 dark:border-gray-700 shadow-md terminal-text-container",children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center text-gray-800 dark:text-gray-200 text-sm",children:[t.jsx("span",{className:"mr-2 pulse-dot",children:"â—‰"}),"Technical Details"]}),t.jsxs("div",{className:"text-xs leading-relaxed bg-black bg-opacity-20 dark:bg-black dark:bg-opacity-40 p-2 rounded border-l-2 border-cyan-500",children:["confidentiality"===E&&t.jsxs("div",{className:"color-confidentiality terminal-text",children:[t.jsx("p",{children:"Confidentiality measures protect sensitive data from unauthorized access."}),t.jsx("p",{className:"mt-1",children:"Higher levels implement stronger access controls, encryption, and data protection mechanisms."})]}),"integrity"===E&&t.jsxs("div",{className:"color-integrity terminal-text",children:[t.jsx("p",{children:"Integrity controls ensure data remains accurate and free from unauthorized modifications."}),t.jsx("p",{className:"mt-1",children:"Higher levels implement cryptographic checksums, blockchain, and advanced validation mechanisms."})]}),"availability"===E&&t.jsxs("div",{className:"color-availability terminal-text",children:[t.jsx("p",{children:"Availability measures ensure systems remain operational and accessible."}),t.jsx("p",{className:"mt-1",children:"Higher levels implement redundancy, failover systems, and disaster recovery protocols."})]})]})]})]})},Bi=e=>{if(e.useEnhancedVersion||void 0!==e.availabilityLevel||void 0!==e.integrityLevel||void 0!==e.confidentialityLevel||void 0!==e.onAvailabilityChange||void 0!==e.onIntegrityChange||void 0!==e.onConfidentialityChange){const i={availabilityLevel:e.availabilityLevel||"None",integrityLevel:e.integrityLevel||"None",confidentialityLevel:e.confidentialityLevel||"None",...e};return t.jsx(Yi,{...i})}{if(!(e.label&&e.value&&e.onChange&&e.options))return null;const i={label:e.label,value:e.value,onChange:e.onChange,options:e.options,description:e.description,icon:e.icon,tooltipContent:e.tooltipContent,testId:e.testId,accentColor:e.accentColor,disabled:e.disabled,className:e.className};return t.jsx(Si,{...i})}},zi=({availabilityLevel:e,integrityLevel:i,confidentialityLevel:a,setAvailability:s,setIntegrity:r,setConfidentiality:l,className:o="",testId:c=yt,onAvailabilityChange:d,onIntegrityChange:m,onConfidentialityChange:u,loading:p=!1,error:g=null,title:x=O.SECURITY_LEVEL})=>p?t.jsx(Mt,{title:x,className:o,testId:c,loading:!0,children:t.jsx("div",{className:"loading-placeholder"})}):g?t.jsx(Mt,{title:x,className:o,testId:c,children:t.jsxs("div",{className:"p-4 text-red-600 dark:text-red-400",children:[t.jsx("h3",{className:"font-medium mb-2",children:"Error Loading Security Levels"}),t.jsx("p",{className:"text-sm",children:g.message})]})}):t.jsx(Mt,{title:x,icon:"ðŸ“Š",className:o,testId:c,children:t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Current Security Profile"}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.jsx(bi,{label:f,value:a,icon:N,testId:`${c}-confidentiality-summary`,color:"purple",borderColor:n.CONFIDENTIALITY.PRIMARY}),t.jsx(bi,{label:v,value:i,icon:j,testId:`${c}-integrity-summary`,color:"green",borderColor:n.INTEGRITY.PRIMARY}),t.jsx(bi,{label:b,value:e,icon:k,testId:`${c}-availability-summary`,color:"blue",borderColor:n.AVAILABILITY.PRIMARY})]})]}),t.jsx("div",{className:"security-level-selector",children:t.jsx(Bi,{label:"Confidentiality Level",value:a,onChange:e=>{u&&u(e),l(e)},options:[h.NONE,h.LOW,h.MODERATE,h.HIGH,h.VERY_HIGH],description:I,icon:N,testId:ht,tooltipContent:"Confidentiality measures how well your data is protected from unauthorized access",accentColor:n.CONFIDENTIALITY.PRIMARY})}),t.jsx("div",{className:"security-level-selector",children:t.jsx(Bi,{label:"Integrity Level",value:i,onChange:e=>{m&&m(e),r(e)},options:[h.NONE,h.LOW,h.MODERATE,h.HIGH,h.VERY_HIGH],description:w,icon:j,testId:bt,tooltipContent:"Integrity measures how well your data is protected from unauthorized modification",accentColor:n.INTEGRITY.PRIMARY})}),t.jsx("div",{className:"security-level-selector",children:t.jsx(Bi,{label:"Availability Level",value:e,onChange:e=>{d&&d(e),s(e)},options:[h.NONE,h.LOW,h.MODERATE,h.HIGH,h.VERY_HIGH],description:L,icon:k,testId:vt,tooltipContent:"Availability measures how well your systems can maintain operations and recover from disruptions",accentColor:n.AVAILABILITY.PRIMARY})})]})}),Ui={toIntegrityDetail:e=>({description:e.description||"",businessImpact:e.businessImpact||"",validationMethod:e.validationMethod,recommendations:e.recommendations||[],technicalControls:Array.isArray(e.technicalControls)?e.technicalControls:void 0,complianceImplications:"string"==typeof e.complianceImplications?e.complianceImplications:void 0}),toConfidentialityDetail:e=>({impact:e.impact||e.description||"",businessImpact:e.businessImpact||"",recommendations:e.recommendations||[],technicalMeasures:Array.isArray(e.technicalMeasures)?e.technicalMeasures:void 0,complianceImplications:"string"==typeof e.complianceImplications?e.complianceImplications:void 0,riskLevel:"string"==typeof e.riskLevel?e.riskLevel:void 0}),toAvailabilityDetail:e=>({description:e.description||"",businessImpact:e.businessImpact||"",uptime:e.uptime||"Unknown",recommendations:e.recommendations||[],mttr:"string"==typeof e.mttr?e.mttr:void 0,rto:"string"==typeof e.rto?e.rto:void 0,rpo:"string"==typeof e.rpo?e.rpo:void 0})},Gi=()=>{const[i,a]=e.useState(h.NONE),[s,r]=e.useState(h.NONE),[n,l]=e.useState(h.NONE),[o,c]=e.useState(!0);e.useEffect((()=>{const e=e=>{if(e instanceof CustomEvent&&"test:set-values"===e.type&&e.detail){const{availability:t,integrity:i,confidentiality:s}=e.detail;t&&a(t),i&&r(i),s&&l(s)}};return document.addEventListener("test:set-values",e),()=>{document.removeEventListener("test:set-values",e)}}),[]),e.useEffect((()=>{if("undefined"!=typeof window&&window.matchMedia&&"function"==typeof window.matchMedia)try{o?(document.documentElement.classList.add("dark"),document.getElementById("root")?.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.getElementById("root")?.classList.remove("dark"))}catch(e){}}),[o]);const d=e.useMemo((()=>{const e=[h.NONE,h.LOW,h.MODERATE,h.HIGH,h.VERY_HIGH],t=e.indexOf(i),a=e.indexOf(s),r=e.indexOf(n);return e[Math.round((t+a+r)/3)]||h.NONE}),[i,s,n]);Object.entries(p).reduce(((e,[t,i])=>(e[t]=Ui.toIntegrityDetail(i),e)),{}),Object.entries(g).reduce(((e,[t,i])=>(e[t]=Ui.toConfidentialityDetail(i),e)),{});const m=Object.entries(u).reduce(((e,[t,i])=>(e[t]=Ui.toAvailabilityDetail(i),e)),{});return t.jsx("div",{className:"app-container "+(o?"dark bg-pattern":""),"data-testid":Ge,children:t.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 p-4 transition-colors duration-300",children:t.jsxs("div",{className:"w-full mx-auto",children:[t.jsxs("div",{className:"app-title shadow-lg rounded-xl transition-colors duration-300 dark:security-card p-4 flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{"data-testid":Fe,className:"text-2xl font-bold text-gray-800 dark:text-gray-100 dark:widget-title transition-colors duration-300 flex items-center",children:[t.jsx("img",{src:"https://hack23.github.io/cia-compliance-manager/icon-192.png",alt:"CIA Compliance Manager Logo",style:{height:"48px"},className:"w-auto mr-1"}),$]}),t.jsxs("div",{className:"terminal-text text-xs flex items-center mt-1",style:{color:"#22c55e"},children:[t.jsx("span",{className:"mr-1","data-testid":"app-indicator",style:{color:"#22c55e"},children:"â– "}),t.jsxs("span",{className:"mr-2","data-testid":"app-version",style:{color:"#22c55e"},children:["v","0.8.5"]}),t.jsx("a",{href:"https://github.com/Hack23/cia-compliance-manager",target:"_blank",rel:"noopener noreferrer",className:"hover:underline mr-2","data-testid":"source-link",style:{color:"#22c55e"},children:"Source"}),t.jsx("span",{style:{color:"#22c55e"},children:"|"}),t.jsx("a",{href:"https://hack23.github.io/cia-compliance-manager/documentation.html",target:"_blank",rel:"noopener noreferrer",className:"hover:underline mx-2","data-testid":"docs-link",style:{color:"#22c55e"},children:"Doc"}),t.jsx("span",{style:{color:"#22c55e"},children:"|"}),t.jsx("a",{href:"https://hack23.com/",target:"_blank",rel:"noopener noreferrer",className:"hover:underline","data-testid":"author-link",style:{color:"#22c55e"},children:"Hack23"})]})]}),t.jsx("button",{"data-testid":_e,onClick:()=>{c((e=>{const t=!e;return t?(document.documentElement.classList.add("dark"),document.getElementById("root")?.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.getElementById("root")?.classList.remove("dark")),t}))},className:"px-4 py-2 rounded-md flex items-center transition-all duration-300 "+(o?"bg-black border border-green-500 hover:border-green-400 hover:bg-gray-900 cyberbutton":"bg-blue-500 hover:bg-blue-600 text-white"),children:o?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-2 text-green-400",children:"â˜€ï¸"}),t.jsx("span",{className:"text-green-400 font-mono tracking-wide text-sm uppercase",children:"Light Mode"})]}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"mr-2",children:"ðŸŒ™"})," Dark Mode"]})})]}),t.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-lg rounded-xl p-3 pt-4 mt-3 transition-colors duration-300",children:t.jsxs($i,{children:[t.jsx(Vi,{title:Bt,icon:"SECURITY_LEVEL",testId:"widget-security-level-selection",children:t.jsx(zi,{availabilityLevel:i,integrityLevel:s,confidentialityLevel:n,setAvailability:a,setIntegrity:r,setConfidentiality:l})}),t.jsx(Vi,{title:zt,icon:"SECURITY_SUMMARY",testId:"widget-security-summary",children:t.jsx(wi,{securityLevel:d,availabilityLevel:i,integrityLevel:s,confidentialityLevel:n})}),t.jsx(Vi,{title:qt,icon:"BUSINESS_IMPACT",testId:"widget-business-impact-container",children:t.jsx(hi,{availabilityLevel:i,integrityLevel:s,confidentialityLevel:n,securityLevel:d})}),t.jsx(Vi,{title:Wt,icon:"TECHNICAL_IMPLEMENTATION",testId:"widget-technical-details-container",children:t.jsx(Ri,{availabilityLevel:i,integrityLevel:s,confidentialityLevel:n})}),t.jsx(Vi,{title:Ft,icon:"COST_ESTIMATION",testId:"widget-cost-estimation",children:t.jsx(ji,{availabilityLevel:i,integrityLevel:s,confidentialityLevel:n})}),t.jsx(Vi,{title:_t,icon:"VALUE_CREATION",testId:"widget-value-creation",children:t.jsx(Ti,{securityLevel:d,availabilityLevel:i,integrityLevel:s,confidentialityLevel:n})}),t.jsx(Vi,{title:Gt,icon:"COMPLIANCE_STATUS",testId:"widget-compliance-status",children:t.jsx(vi,{availabilityLevel:i,integrityLevel:s,confidentialityLevel:n})}),t.jsx(Vi,{title:Ut,icon:"SECURITY_VISUALIZATION",testId:"widget-radar-chart",children:t.jsx(Ei,{availabilityLevel:i,integrityLevel:s,confidentialityLevel:n})}),t.jsx(Vi,{title:Jt,icon:"CONFIDENTIALITY_IMPACT",testId:"widget-confidentiality-impact-container",children:t.jsx(fi,{confidentialityLevel:n,integrityLevel:s,availabilityLevel:i})}),t.jsx(Vi,{title:Xt,icon:"INTEGRITY_IMPACT",testId:"widget-integrity-impact-container",children:t.jsx(ki,{integrityLevel:s,availabilityLevel:i,confidentialityLevel:n})}),t.jsx(Vi,{title:Zt,icon:"AVAILABILITY_IMPACT",testId:"widget-availability-impact-container",children:t.jsx(yi,{availabilityLevel:i,integrityLevel:s,confidentialityLevel:n,options:m})}),t.jsx(Vi,{title:Kt,icon:"SECURITY_RESOURCES",testId:"widget-security-resources-container",children:t.jsx(Ii,{securityLevel:d,availabilityLevel:i,integrityLevel:s,confidentialityLevel:n})})]})})]})})})};function _i(){return t.jsx("div",{className:"app-root","data-testid":qe,children:t.jsx("div",{"data-testid":We,children:t.jsx(Gi,{})})})}a.createRoot(document.getElementById("root")).render(t.jsx(i.StrictMode,{children:t.jsx(_i,{})}));
//# sourceMappingURL=index-DwcV0hVR.js.map
