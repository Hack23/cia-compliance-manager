import{r as c,j as e,R as S}from"./react-vendor-BzhlA2NX.js";import{j as C,i as T,x as j,y as L,z as P,A as D,D as B,E as O,F as f,h as W,B as Y,G as F,T as K,H as V,I as G,J as U,K as z,L as X,W as J,a as H,b as Q,c as q,g as Z,d as $,p as ee,M as te,e as x,N as ae,O as _,P as re,Q as E,R as ie,U as R}from"./widgets-assessment-KMPIY7Fx.js";import{M as I}from"./widgets-business-BIF6Qmi4.js";function se(t,a){const{ciaContentService:i}=C();return c.useMemo(()=>{if(T(i))return null;try{const n=i.getComponentDetails(t,a);return T(n)?null:n}catch(n){return console.error(`Error getting ${t} details:`,n),null}},[i,t,a])}function ne(t,a){const{ciaContentService:i}=C();return c.useMemo(()=>{if(T(i))return j(t,a);try{return i.getBusinessImpact(t,a)||j(t,a)}catch(n){return console.error(`Error getting ${t} business impact:`,n),j(t,a)}},[i,t,a])}function be(t){const[a,i]=c.useState({availability:t?.availability??"Moderate",integrity:t?.integrity??"Moderate",confidentiality:t?.confidentiality??"Moderate"}),d=c.useCallback((r,l)=>{i(u=>({...u,[r]:l}))},[]),n=c.useCallback((r="Moderate")=>{i({availability:r,integrity:r,confidentiality:r})},[]),s=c.useCallback(r=>a[r],[a]);return{levels:a,setLevel:d,resetLevels:n,getLevel:s}}function Ie(t,a){const[i,d]=c.useState(()=>{if(typeof window>"u")return a;try{const s=window.localStorage.getItem(t);return s?JSON.parse(s):a}catch(s){return console.warn(`Error reading localStorage key "${t}":`,s),a}}),n=c.useCallback(s=>{try{d(r=>{const l=s instanceof Function?s(r):s;return typeof window<"u"&&window.localStorage.setItem(t,JSON.stringify(l)),l})}catch(r){console.error(`Error saving to localStorage key "${t}":`,r)}},[t]);return c.useEffect(()=>{if(typeof window>"u")return;const s=r=>{if(r.key===t&&r.newValue!==null)try{d(JSON.parse(r.newValue))}catch(l){console.warn(`Error parsing storage event for key "${t}":`,l)}};return window.addEventListener("storage",s),()=>{window.removeEventListener("storage",s)}},[t]),[i,n]}function xe(t){const{shortcuts:a,enabled:i=!0,preventDefault:d=!0,stopPropagation:n=!1}=t,s=c.useRef(a),r=c.useRef({preventDefault:d,stopPropagation:n});c.useEffect(()=>{s.current=a,r.current={preventDefault:d,stopPropagation:n}},[a,d,n]);const l=c.useCallback(u=>{if(!L()||P(u))return;const o=D(u),m=Object.values(s.current).find(p=>{if(p.enabled===!1)return!1;const N=B(p.keys,p.platformKeys);return O(o,N)});if(m){f.debug("Keyboard shortcut triggered",{id:m.id,keys:o,description:m.description}),r.current.preventDefault&&u.preventDefault(),r.current.stopPropagation&&u.stopPropagation();try{m.handler()}catch(p){f.error("Error executing keyboard shortcut handler",{id:m.id,error:p})}}},[]);c.useEffect(()=>{if(!(!i||!L()))return f.debug("Registering keyboard shortcuts"),window.addEventListener("keydown",l),()=>{f.debug("Unregistering keyboard shortcuts"),window.removeEventListener("keydown",l)}},[i,l])}const le=({impact:t,color:a,testId:i="business-impact-section"})=>{const d=t.financial?.riskLevel||t.operational?.riskLevel||"Unknown";return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card","data-testid":i,children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact",e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Risk: ",d]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${i}-summary`,children:t.summary||"No business impact data available"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.financial&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${a}-100 dark:bg-${a}-900 dark:bg-opacity-20 border border-${a}-200 dark:border-${a}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’°"}),e.jsx("span",{className:`font-medium text-${a}-700 dark:text-${a}-300`,children:"Financial Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.financial.description||"No financial impact information available"}),t.financial.annualRevenueLoss&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Annual Revenue Loss: "}),t.financial.annualRevenueLoss]})]}),t.operational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${a}-100 dark:bg-${a}-900 dark:bg-opacity-20 border border-${a}-200 dark:border-${a}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"âš™ï¸"}),e.jsx("span",{className:`font-medium text-${a}-700 dark:text-${a}-300`,children:"Operational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.operational.description||"No operational impact information available"}),t.operational.meanTimeToRecover&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Mean Time to Recover: "}),t.operational.meanTimeToRecover]})]}),t.reputational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${a}-100 dark:bg-${a}-900 dark:bg-opacity-20 border border-${a}-200 dark:border-${a}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ†"}),e.jsx("span",{className:`font-medium text-${a}-700 dark:text-${a}-300`,children:"Reputational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.reputational.description||"No reputational impact information available"}),t.reputational.reputationalImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:t.reputational.reputationalImpact})]}),t.strategic&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${a}-100 dark:bg-${a}-900 dark:bg-opacity-20 border border-${a}-200 dark:border-${a}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),e.jsx("span",{className:`font-medium text-${a}-700 dark:text-${a}-300`,children:"Strategic Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.strategic.description||"No strategic impact information available"}),t.strategic.competitiveAdvantage&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Competitive Advantage: "}),t.strategic.competitiveAdvantage]})]}),t.regulatory&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${a}-100 dark:bg-${a}-900 dark:bg-opacity-20 border border-${a}-200 dark:border-${a}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),e.jsx("span",{className:`font-medium text-${a}-700 dark:text-${a}-300`,children:"Regulatory Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.regulatory.description||"No regulatory impact information available"}),t.regulatory.complianceImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:t.regulatory.complianceImpact}),t.regulatory.complianceViolations&&t.regulatory.complianceViolations.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Potential Violations:"," "]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.regulatory.complianceViolations.map((n,s)=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full bg-${a}-50 text-${a}-700 dark:bg-${a}-900 dark:bg-opacity-50 dark:text-${a}-300`,children:n},s))})]})]})]})]})},v=({title:t,children:a,subtitle:i,icon:d,className:n="",testId:s="widget-section",ariaLabelledBy:r,variant:l="default"})=>{const u={default:"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",primary:"border-primary-light dark:border-primary-dark bg-primary-light/10 dark:bg-primary-dark/20",success:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20",info:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20",warning:"border-yellow-200 dark:border-yellow-800 bg-yellow-50 dark:bg-yellow-900/20",error:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20"},o=r||`${s}-heading`;return e.jsxs("section",{className:`border ${u[l]} ${n}`,style:{padding:F.md,borderRadius:Y.md,boxShadow:W.sm},"data-testid":s,"aria-labelledby":o,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[d&&e.jsx("span",{"aria-hidden":"true",children:d}),e.jsx("h3",{style:{fontSize:K.subheading},className:"font-semibold text-gray-800 dark:text-gray-200",id:o,children:t})]}),i&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:i}),e.jsx("div",{children:a})]})},de=t=>{switch(t){case"availability":return{titleKey:"AVAILABILITY_IMPACT",iconKey:"AVAILABILITY_IMPACT",defaultTitle:"Availability Impact Analysis",defaultIcon:"â±ï¸",color:"blue",textClass:"text-blue-800 dark:text-blue-300",ariaDescription:"Business impact of availability controls including uptime targets and recovery objectives",categoryLabel:"Availability",containerClassName:"cia-availability",contentClassName:"cia-widget",getSecurityBadgeTestId:(a,i)=>i.label("security-level")};case"integrity":return{titleKey:"INTEGRITY_IMPACT",iconKey:"INTEGRITY_IMPACT",defaultTitle:"Integrity Impact Analysis",defaultIcon:"âœ“",color:"green",textClass:"text-green-800 dark:text-green-300",ariaDescription:"Business impact of integrity controls including data accuracy and validation mechanisms",categoryLabel:"Integrity",containerClassName:"",contentClassName:"",getSecurityBadgeTestId:(a,i)=>i.label("security-badge")};case"confidentiality":return{titleKey:"CONFIDENTIALITY_IMPACT",iconKey:"CONFIDENTIALITY_IMPACT",defaultTitle:"Confidentiality Impact Analysis",defaultIcon:"ðŸ”’",color:"purple",textClass:"text-purple-800 dark:text-purple-300",ariaDescription:"Business impact of confidentiality controls including data classification and privacy measures",categoryLabel:"Confidentiality",containerClassName:"overflow-visible",contentClassName:"max-h-[550px] overflow-y-auto pr-1",getSecurityBadgeTestId:(a,i)=>i.label("security-badge")};default:{const a=t;throw new Error(`Unsupported CIA component in ImpactWidget: ${String(a)}`)}}},ce=t=>{switch(t){case"availability":return{prefix:R.AVAILABILITY_IMPACT_PREFIX,widgetIds:ie};case"integrity":return{prefix:E.INTEGRITY_IMPACT_PREFIX,widgetIds:re};case"confidentiality":return{prefix:_.CONFIDENTIALITY_IMPACT_PREFIX,widgetIds:ae};default:{const a=t;throw new Error(`Unsupported CIA component in getTestIds: ${String(a)}`)}}},h=S.memo(({component:t,level:a,className:i="",testId:d,showExtendedDetails:n=!1,onError:s})=>{const r=c.useMemo(()=>de(t),[t]),l=c.useMemo(()=>ce(t),[t]),u=d||l.prefix,o=c.useMemo(()=>V(a||"Moderate"),[a]),{ciaContentService:m,error:p,isLoading:N}=C(),k=c.useCallback(g=>{s&&s(g)},[s]);S.useEffect(()=>{p&&k(p)},[p,k]);const b=se(t,o),A=ne(t,o),w=c.useMemo(()=>{if(!n||!m)return[];try{return m.getRecommendations(t,o)||[]}catch(g){return console.error(`Error getting ${t} recommendations:`,g),[]}},[n,m,t,o]),y=c.useMemo(()=>{switch(t){case"availability":{const g=X(o);return{type:"availability",data:{uptime:b?.uptime||g.uptime,rto:b?.rto||g.rto,rpo:b?.rpo||g.rpo,mttr:b?.mttr||g.mttr,sla:b?.sla||g.sla}}}case"integrity":return{type:"integrity",data:{validationLevel:b?.validationLevel||z(o),errorRate:b?.errorRate||U(o)}};case"confidentiality":{let g;if(m)try{g=m.getInformationSensitivity(o)}catch{g=`${o} Classification`}else g=`${o} Classification`;return{type:"confidentiality",data:{dataClassification:g,privacyImpact:b?.privacyImpact||G(o)}}}default:{const g=t;throw new Error(`Unsupported CIA component in metrics calculation: ${String(g)}`)}}},[t,o,b,m]);return e.jsx(J,{widgetName:`${r.categoryLabel} Impact`,children:e.jsx(H,{title:q[r.titleKey]||r.defaultTitle,icon:Q[r.iconKey]||r.defaultIcon,className:`${i} ${r.containerClassName}`,testId:u,isLoading:N,error:p,children:e.jsxs("div",{className:$("p-md sm:p-lg",r.contentClassName),role:"region","aria-label":Z(r.defaultTitle,r.ariaDescription),children:[e.jsxs("section",{className:"mb-md","aria-labelledby":`${t}-level-heading`,children:[e.jsxs("h3",{id:`${t}-level-heading`,className:"sr-only",children:["Current ",r.categoryLabel," Security Level"]}),e.jsx(ee,{category:r.categoryLabel,level:o,colorClass:te(r.color),textClass:r.textClass,testId:r.getSecurityBadgeTestId(u,l.widgetIds)})]}),A&&e.jsxs("section",{className:"mb-md","aria-labelledby":`${t}-business-impact-heading`,children:[e.jsx("h3",{id:`${t}-business-impact-heading`,className:x.heading,children:"Business Impact"}),e.jsx(le,{impact:A,color:r.color,testId:l.widgetIds.section("business-impact")})]}),y.type==="availability"&&e.jsxs(v,{title:"SLA Metrics",icon:"â±ï¸",variant:"info",className:"mb-md",ariaLabelledBy:"sla-metrics-heading",testId:l.widgetIds.section("sla-metrics"),children:[e.jsxs("div",{className:$(x.grid3Cols,"mb-md"),role:"group","aria-label":"Service level agreement metrics",children:[e.jsx(I,{label:"Uptime Target",value:y.data.uptime,icon:"ðŸ“ˆ",description:"Expected system availability",variant:"info",testId:l.widgetIds.label("uptime")}),e.jsx(I,{label:"Recovery Time Objective",value:y.data.rto,icon:"â±ï¸",description:"Time to restore service",variant:"info",testId:l.widgetIds.label("rto")}),e.jsx(I,{label:"Recovery Point Objective",value:y.data.rpo,icon:"ðŸ’¾",description:"Maximum data loss allowed",variant:"info",testId:l.widgetIds.label("rpo")})]}),e.jsx("div",{className:x.grid2Cols,children:e.jsx(I,{label:"Service Level Agreement",value:y.data.sla,icon:"ðŸ“‹",description:"Support coverage period",variant:"info",testId:l.widgetIds.label("sla")})})]}),y.type==="integrity"&&e.jsx(v,{title:"Data Integrity Metrics",icon:"ðŸ“Š",variant:"success",className:"mb-md",testId:l.widgetIds.section("metrics"),children:e.jsxs("div",{className:x.grid2Cols,children:[e.jsx(I,{label:"Data Validation Controls",value:y.data.validationLevel,icon:"âœ“",variant:"success",testId:l.widgetIds.label("validation")}),e.jsx(I,{label:"Acceptable Error Rate",value:y.data.errorRate,icon:"ðŸ“‰",variant:"success",testId:l.widgetIds.label("error-rate")})]})}),y.type==="confidentiality"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{title:"Data Protection",icon:"ðŸ“Š",variant:"primary",className:"mb-lg",testId:l.widgetIds.section("data-protection"),children:e.jsx("div",{className:x.grid2Cols,children:e.jsx(I,{label:"Data Classification",value:y.data.dataClassification,icon:"ðŸ·ï¸",description:"Level of data sensitivity",variant:"primary",testId:l.widgetIds.label("classification")})})}),e.jsx(v,{title:"Privacy Impact",icon:"ðŸ”’",variant:"primary",className:"mb-lg",testId:l.widgetIds.section("privacy-impact"),children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-md",children:e.jsx(I,{label:"Privacy Impact",value:y.data.privacyImpact,icon:"ðŸ›¡ï¸",variant:"primary",testId:l.widgetIds.label("privacy")})})})]}),n&&t==="integrity"&&w.length>0&&e.jsxs("div",{className:"mt-md",children:[e.jsx("h3",{className:"text-lg font-medium mb-sm",children:"Recommendations"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:w.map((g,M)=>e.jsx("li",{className:"text-sm text-gray-600 dark:text-gray-400",children:g},M))})]})]})})})});h.displayName="ImpactWidget";const oe=({availabilityLevel:t,integrityLevel:a,confidentialityLevel:i,showExtendedDetails:d=!1,className:n="",testId:s=`widget-${R.AVAILABILITY_IMPACT_PREFIX}`,onError:r})=>e.jsx(h,{component:"availability",level:t,className:n,testId:s,showExtendedDetails:d,onError:r}),fe=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),ge=({availabilityLevel:t,integrityLevel:a,confidentialityLevel:i,className:d="",testId:n=`widget-${_.CONFIDENTIALITY_IMPACT_PREFIX}`,showExtendedDetails:s=!1,onError:r})=>e.jsx(h,{component:"confidentiality",level:i,className:d,testId:n,showExtendedDetails:s,onError:r}),ve=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"})),me=({availabilityLevel:t,integrityLevel:a,confidentialityLevel:i,className:d="",testId:n=`widget-${E.INTEGRITY_IMPACT_PREFIX}`,showExtendedDetails:s=!1,onError:r})=>e.jsx(h,{component:"integrity",level:a,className:d,testId:n,showExtendedDetails:s,onError:r}),he=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));export{fe as A,ve as C,he as I,be as a,xe as b,Ie as u};
//# sourceMappingURL=widgets-impact-DxCRs11W.js.map
