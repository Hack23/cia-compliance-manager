import{r as c,j as e}from"./react-vendor-BzhlA2NX.js";import{e as p,i as j,s as f,t as E,v as R,w as D,x as P,y as B,z as y,A as M,B as O,W as N,a as k,D as V,b as I,c as $,g as L,l as C,E as S,F as W,G as Y,H as F,I as K}from"./widgets-assessment-CQA_0dee.js";function T(a,t){const{ciaContentService:l}=p();return c.useMemo(()=>{if(j(l))return null;try{const s=l.getComponentDetails(a,t);return j(s)?null:s}catch(s){return console.error(`Error getting ${a} details:`,s),null}},[l,a,t])}function A(a,t){const{ciaContentService:l}=p();return c.useMemo(()=>{if(j(l))return f(a,t);try{return l.getBusinessImpact(a,t)||f(a,t)}catch(s){return console.error(`Error getting ${a} business impact:`,s),f(a,t)}},[l,a,t])}function H(a){const[t,l]=c.useState({availability:a?.availability??"Moderate",integrity:a?.integrity??"Moderate",confidentiality:a?.confidentiality??"Moderate"}),m=c.useCallback((r,o)=>{l(g=>({...g,[r]:o}))},[]),s=c.useCallback((r="Moderate")=>{l({availability:r,integrity:r,confidentiality:r})},[]),n=c.useCallback(r=>t[r],[t]);return{levels:t,setLevel:m,resetLevels:s,getLevel:n}}function q(a,t){const[l,m]=c.useState(()=>{if(typeof window>"u")return t;try{const n=window.localStorage.getItem(a);return n?JSON.parse(n):t}catch(n){return console.warn(`Error reading localStorage key "${a}":`,n),t}}),s=c.useCallback(n=>{try{m(r=>{const o=n instanceof Function?n(r):n;return typeof window<"u"&&window.localStorage.setItem(a,JSON.stringify(o)),o})}catch(r){console.error(`Error saving to localStorage key "${a}":`,r)}},[a]);return c.useEffect(()=>{if(typeof window>"u")return;const n=r=>{if(r.key===a&&r.newValue!==null)try{m(JSON.parse(r.newValue))}catch(o){console.warn(`Error parsing storage event for key "${a}":`,o)}};return window.addEventListener("storage",n),()=>{window.removeEventListener("storage",n)}},[a]),[l,s]}function Q(a){const{shortcuts:t,enabled:l=!0,preventDefault:m=!0,stopPropagation:s=!1}=a,n=c.useRef(t),r=c.useRef({preventDefault:m,stopPropagation:s});c.useEffect(()=>{n.current=t,r.current={preventDefault:m,stopPropagation:s}},[t,m,s]);const o=c.useCallback(g=>{if(!E()||R(g))return;const u=D(g),i=Object.values(n.current).find(d=>{if(d.enabled===!1)return!1;const x=P(d.keys,d.platformKeys);return B(u,x)});if(i){y.debug("Keyboard shortcut triggered",{id:i.id,keys:u,description:i.description}),r.current.preventDefault&&g.preventDefault(),r.current.stopPropagation&&g.stopPropagation();try{i.handler()}catch(d){y.error("Error executing keyboard shortcut handler",{id:i.id,error:d})}}},[]);c.useEffect(()=>{if(!(!l||!E()))return y.debug("Registering keyboard shortcuts"),window.addEventListener("keydown",o),()=>{y.debug("Unregistering keyboard shortcuts"),window.removeEventListener("keydown",o)}},[l,o])}const w=({impact:a,color:t,testId:l="business-impact-section"})=>{const m=a.financial?.riskLevel||a.operational?.riskLevel||"Unknown";return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card","data-testid":l,children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact",e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Risk: ",m]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${l}-summary`,children:a.summary||"No business impact data available"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.financial&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’°"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Financial Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.financial.description||"No financial impact information available"}),a.financial.annualRevenueLoss&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Annual Revenue Loss: "}),a.financial.annualRevenueLoss]})]}),a.operational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"âš™ï¸"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Operational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.operational.description||"No operational impact information available"}),a.operational.meanTimeToRecover&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Mean Time to Recover: "}),a.operational.meanTimeToRecover]})]}),a.reputational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ†"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Reputational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.reputational.description||"No reputational impact information available"}),a.reputational.reputationalImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:a.reputational.reputationalImpact})]}),a.strategic&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Strategic Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.strategic.description||"No strategic impact information available"}),a.strategic.competitiveAdvantage&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Competitive Advantage: "}),a.strategic.competitiveAdvantage]})]}),a.regulatory&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Regulatory Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.regulatory.description||"No regulatory impact information available"}),a.regulatory.complianceImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:a.regulatory.complianceImpact}),a.regulatory.complianceViolations&&a.regulatory.complianceViolations.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Potential Violations:"," "]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.regulatory.complianceViolations.map((s,n)=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full bg-${t}-50 text-${t}-700 dark:bg-${t}-900 dark:bg-opacity-50 dark:text-${t}-300`,children:s},n))})]})]})]})]})},G=({availabilityLevel:a,integrityLevel:t,confidentialityLevel:l,showExtendedDetails:m=!1,className:s="",testId:n=V.AVAILABILITY_IMPACT_PREFIX})=>{const r=M(a||"Moderate"),{error:o,isLoading:g}=p(),u=T("availability",r),i=A("availability",r),d=c.useMemo(()=>{const x=O(r);return u?{uptime:u.uptime||x.uptime,rto:u.rto||x.rto,rpo:u.rpo||x.rpo,mttr:u.mttr||x.mttr,sla:u.sla||x.sla}:x},[u,r]);return e.jsx(N,{widgetName:"Availability Impact",children:e.jsx(k,{title:$.AVAILABILITY_IMPACT,icon:I.AVAILABILITY_IMPACT||"â±ï¸",className:`${s} cia-availability`,testId:n,isLoading:g,error:o,children:e.jsxs("div",{className:"p-md sm:p-lg cia-widget",role:"region","aria-label":L("Availability Impact Analysis","Business impact of availability controls including uptime targets and recovery objectives"),children:[e.jsxs("section",{className:"mb-4","aria-labelledby":"availability-level-heading",children:[e.jsx("h3",{id:"availability-level-heading",className:"sr-only",children:"Current Availability Security Level"}),e.jsx(C,{category:"Availability",level:r,colorClass:S("blue"),textClass:"text-blue-800 dark:text-blue-300",testId:`${n}-level`})]}),i&&e.jsxs("section",{className:"mb-4","aria-labelledby":"availability-business-impact-heading",children:[e.jsx("h3",{id:"availability-business-impact-heading",className:"text-lg font-medium mb-2",children:"Business Impact"}),e.jsx(w,{impact:i,color:"blue",testId:`${n}-business-impact`})]}),e.jsxs("section",{className:"mb-4","aria-labelledby":"sla-metrics-heading",children:[e.jsxs("h3",{id:"sla-metrics-heading",className:"text-lg font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2","aria-hidden":"true",children:"â±ï¸"}),"SLA Metrics"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",role:"group","aria-label":"Service level agreement metrics",children:[e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Uptime Target"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Uptime target: ${d.uptime}`,children:d.uptime}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Expected system availability"})]}),e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Time Objective"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Recovery time objective: ${d.rto}`,children:d.rto}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Time to restore service"})]}),e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Point Objective"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Recovery point objective: ${d.rpo}`,children:d.rpo}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Maximum data loss allowed"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Service Level Agreement"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Service level agreement: ${d.sla}`,children:d.sla}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Support coverage period"})]})})]})]})})})},Z=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"})),z=({availabilityLevel:a,integrityLevel:t,confidentialityLevel:l,className:m="",testId:s="widget-confidentiality-impact",showExtendedDetails:n=!1,onError:r})=>{const{ciaContentService:o,error:g,isLoading:u}=p(),i=l||"Moderate";c.useEffect(()=>{g&&r&&r(g)},[g,r]);const d=T("confidentiality",i),x=A("confidentiality",i),v=c.useMemo(()=>{if(!o)return`${i} Classification`;try{return o.getInformationSensitivity(i)}catch(b){return console.error("Error getting data classification:",b),`${i} Classification`}},[o,i]),h=c.useMemo(()=>d&&d.privacyImpact?d.privacyImpact:W(i),[d,i]);return e.jsx(N,{widgetName:"Confidentiality Impact",children:e.jsx(k,{title:$.CONFIDENTIALITY_IMPACT,icon:I.CONFIDENTIALITY_IMPACT||"ðŸ”’",className:`${m} overflow-visible`,testId:s,isLoading:u,error:g,children:e.jsx("div",{className:"max-h-[550px] overflow-y-auto pr-1",role:"region","aria-label":L("Confidentiality Impact Analysis","Business impact of confidentiality controls including data classification and privacy measures"),children:e.jsxs("section",{className:"p-md sm:p-lg","aria-labelledby":"confidentiality-impact-heading",children:[e.jsx("h3",{id:"confidentiality-impact-heading",className:"sr-only",children:"Confidentiality Impact Details"}),e.jsx("div",{className:"mb-4",children:e.jsx(C,{category:"Confidentiality",level:i,colorClass:S("purple"),textClass:"text-purple-800 dark:text-purple-300",testId:`${s}-confidentiality-badge`})}),x&&e.jsx(w,{impact:x,color:"purple",testId:`${s}-business-impact`}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2","aria-hidden":"true",children:"ðŸ“Š"}),"Data Protection"]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:e.jsxs("div",{className:"p-md bg-primary-light/10 dark:bg-primary-dark/20 rounded-md border border-primary-light dark:border-primary-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Data Classification"}),e.jsx("div",{className:"text-lg font-bold",children:v}),e.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Level of data sensitivity"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2","aria-hidden":"true",children:"ðŸ”’"}),"Privacy Impact"]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs("div",{className:"p-sm bg-white dark:bg-gray-800 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Privacy Impact:"}),e.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:h})]})})]})]})})})})},ee=Object.freeze(Object.defineProperty({__proto__:null,default:z},Symbol.toStringTag,{value:"Module"})),U=({availabilityLevel:a,integrityLevel:t,confidentialityLevel:l,className:m="",testId:s=K.INTEGRITY_IMPACT_PREFIX,showExtendedDetails:n=!1})=>{const r=M(t||"Moderate"),{ciaContentService:o,error:g,isLoading:u}=p(),i=T("integrity",r),d=A("integrity",r),x=c.useMemo(()=>{try{return!o||!r?[]:o.getRecommendations("integrity",r)||[]}catch(b){return console.error("Error getting recommendations:",b),[]}},[o,r]),v=c.useMemo(()=>i&&i.validationLevel?i.validationLevel:Y(r),[i,r]),h=c.useMemo(()=>i&&i.errorRate?i.errorRate:F(r),[i,r]);return e.jsx(N,{widgetName:"Integrity Impact",children:e.jsx(k,{title:$.INTEGRITY_IMPACT,icon:I.INTEGRITY_IMPACT||"âœ“",className:m,testId:s,isLoading:u,error:g,children:e.jsxs("div",{className:"p-md sm:p-lg",role:"region","aria-label":L("Integrity Impact Analysis","Business impact of integrity controls including data accuracy and validation mechanisms"),children:[e.jsxs("section",{className:"mb-4","aria-labelledby":"integrity-level-heading",children:[e.jsx("h3",{id:"integrity-level-heading",className:"sr-only",children:"Current Integrity Security Level"}),e.jsx(C,{category:"Integrity",level:r,colorClass:S("green"),textClass:"text-green-800 dark:text-green-300",testId:`${s}-integrity-badge`})]}),d&&e.jsx("div",{className:"mt-4","data-testid":`${s}-business-impact-container`,children:e.jsx(w,{impact:d,color:"green",testId:`${s}-business-impact`})}),e.jsxs("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":`${s}-metrics`,children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-green-800 dark:text-green-300",children:"Data Integrity Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-sm bg-white dark:bg-gray-800 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Data Validation Controls:"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:v})]}),e.jsxs("div",{className:"p-sm bg-white dark:bg-gray-800 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Acceptable Error Rate:"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:h})]})]})]}),n&&x.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Recommendations"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:x.map((b,_)=>e.jsx("li",{className:"text-sm text-gray-600 dark:text-gray-400",children:b},_))})]})]})})})},te=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"}));export{Z as A,ee as C,te as I,H as a,Q as b,q as u};
//# sourceMappingURL=widgets-impact-BLnvo-In.js.map
