const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./widgets-assessment-Dx4tYGjQ.js","./react-vendor-BzhlA2NX.js","./chart-BRhaV9pk.js","./widgets-business-Dg26G2rp.js","./widgets-impact-BiombB7R.js","./widgets-implementation-DsRu3nRQ.js","./widgets-visualization-BgqY22kA.js"])))=>i.map(i=>d[i]);
import{r as s,j as e,R as q,a as ie}from"./react-vendor-BzhlA2NX.js";import{e as re,a3 as U,W as C,a as ne,a4 as E,b as le,c as de,g as oe,d as k,P as N,a5 as W,m as F,a6 as P,a7 as B,a8 as J,a9 as ce,aa as O,A as S,ab as me,ac as _,ad as M,ae as w,af as ue,ag as z,ah as d,ai as K,aj as Y,ak as ge}from"./widgets-assessment-Dx4tYGjQ.js";import{u as Z,a as xe,b as he}from"./widgets-impact-BiombB7R.js";import"./chart-BRhaV9pk.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))u(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const t of c.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&u(t)}).observe(document,{childList:!0,subtree:!0});function i(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function u(n){if(n.ep)return;n.ep=!0;const c=i(n);fetch(n.href,c)}})();const ye=({availabilityLevel:r,integrityLevel:a,confidentialityLevel:i,onAvailabilityChange:u,onIntegrityChange:n,onConfidentialityChange:c,className:t="",testId:o=E.root})=>{const{ciaContentService:g}=re(),[f,l]=s.useState(null),[b,v]=s.useState(!1),[h,R]=s.useState("availability"),[m,L]=s.useState(null),[y,j]=s.useState(null),[T,A]=s.useState(null);s.useEffect(()=>{v(!0);try{if(!g)throw new Error("Content service unavailable");const x=h==="availability"?r:h==="integrity"?a:i,p=g.getComponentDetails(h,x)||{description:"No details available",technical:"No technical information available",businessImpact:"No business impact information available",recommendations:[]};j(p),L(null),l(null)}catch(x){console.error("Error loading component details:",x),L(x instanceof Error?x:new Error("Failed to load component details")),l(x instanceof Error?x:new Error("Service error"))}finally{v(!1)}},[g,h,r,a,i]);const V=s.useCallback(x=>{const p=x.target.value;u&&u(p),A("availability"),U(`Availability security level changed to ${p}`,"polite")},[u]),X=s.useCallback(x=>{const p=x.target.value;n&&n(p),A("integrity"),U(`Integrity security level changed to ${p}`,"polite")},[n]),ae=s.useCallback(x=>{const p=x.target.value;c&&c(p),A("confidentiality"),U(`Confidentiality security level changed to ${p}`,"polite")},[c]),$=[P.NONE,P.LOW,P.MODERATE,P.HIGH,P.VERY_HIGH],H=(x,p)=>{switch(x){case"availability":return p==="None"?"No uptime guarantees":p==="Low"?"~95% uptime, 24-48h recovery":p==="Moderate"?"~99% uptime, 4-8h recovery":p==="High"?"~99.9% uptime, 15-60min recovery":p==="Very High"?"~99.99% uptime, <5min recovery":"";case"integrity":return p==="None"?"No validation controls":p==="Low"?"Manual validation with basic checks":p==="Moderate"?"Automated validation with checks":p==="High"?"Cryptographic verification":p==="Very High"?"Blockchain validation":"";case"confidentiality":return p==="None"?"No access controls":p==="Low"?"Basic access control":p==="Moderate"?"RBAC with encryption":p==="High"?"E2E encryption with MFA":p==="Very High"?"Zero-trust architecture":"";default:return"No details available"}},se=x=>{switch(x){case"availability":return"text-blue-600 dark:text-blue-400";case"integrity":return"text-green-600 dark:text-green-400";case"confidentiality":return"text-purple-600 dark:text-purple-400";default:return"text-gray-600 dark:text-gray-400"}};return e.jsx(C,{widgetName:"Security Level",children:e.jsx(ne,{title:de.SECURITY_LEVEL,icon:le.SECURITY_LEVEL,className:t,testId:o,children:e.jsxs("div",{className:"p-sm space-y-sm",role:"region","aria-label":oe("Security Level Configuration","Configure security levels for each CIA component to set your organization's security posture"),children:[e.jsx("div",{className:k(N.section,"p-sm rounded-md","bg-info-light/10 dark:bg-info-dark/20"),children:e.jsx("p",{className:N.body,children:"Configure security levels for each CIA component to set your organization's security posture. Higher levels provide stronger protection but may require more resources to implement."})}),(m||f)&&e.jsxs("div",{className:k(N.card,"mb-sm bg-error-light/10 dark:bg-error-dark/20 text-error-dark dark:text-error-light shadow-none"),children:[e.jsx("h4",{className:"font-medium",children:"Error"}),e.jsx("p",{className:N.body,children:"Unable to load component details. Please try again later."})]}),b&&e.jsx("div",{className:k(N.card,N.loading,"mb-sm bg-info-light/10 dark:bg-info-dark/20 text-info-dark dark:text-info-light shadow-none"),children:e.jsx("p",{className:N.body,children:"Loading security level details..."})}),e.jsxs("div",{className:N.grid2Cols,children:[e.jsxs("div",{children:[e.jsx("h3",{className:N.heading,children:"Configure Security Levels"}),e.jsxs("div",{className:"space-y-sm",children:[e.jsxs("div",{className:k(N.card,"bg-neutral-light/10 dark:bg-neutral-dark/20"),"data-testid":E.section("confidentiality"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-sm",children:[e.jsxs("label",{htmlFor:"confidentiality-select",className:k(N.body,"font-medium flex items-center"),children:[e.jsx("span",{className:"text-purple-500 dark:text-purple-400 mr-sm",children:W.confidentiality}),"Confidentiality"]}),e.jsx(F,{category:"",level:i,colorClass:"bg-purple-100 dark:bg-purple-900/20",textClass:"text-purple-800 dark:text-purple-300",testId:"security-level-widget-confidentiality-badge"})]}),e.jsx("select",{id:"confidentiality-select",className:k("w-full p-sm border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-normal hover:border-purple-400",N.focusVisible),value:i,onChange:ae,"data-testid":B.CONFIDENTIALITY_SELECT,children:$.map(x=>e.jsx("option",{value:x,children:x},`confidentiality-${x}`))}),e.jsxs("div",{className:k(N.labelNormal,"mt-sm"),"data-testid":E.label("confidentiality-summary"),children:[i,":"," ",H("confidentiality",i)]}),e.jsx("button",{className:k(N.buttonPrimary,"mt-sm min-h-[40px]"),onClick:()=>R("confidentiality"),"data-testid":E.button("confidentiality-details"),children:"View details"}),T==="confidentiality"&&e.jsx("div",{className:k(N.labelNormal,"mt-sm text-green-600 dark:text-green-400 animate-pulse"),"data-testid":E.label("confidentiality-changed"),children:"âœ“ Security level updated"})]}),e.jsxs("div",{className:k(N.card,"p-sm"),"data-testid":E.section("integrity"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-sm",children:[e.jsxs("label",{htmlFor:"integrity-select",className:"text-sm font-medium flex items-center",children:[e.jsx("span",{className:"text-green-500 dark:text-green-400 mr-sm",children:W.integrity}),"Integrity"]}),e.jsx(F,{category:"",level:a,colorClass:"bg-green-100 dark:bg-green-900/20",textClass:"text-green-800 dark:text-green-300",testId:"security-level-widget-integrity-badge"})]}),e.jsx("select",{id:"integrity-select",className:"w-full p-sm border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-green-400 focus:border-green-500 focus:ring-2 focus:ring-green-200",value:a,onChange:X,"data-testid":B.INTEGRITY_SELECT,children:$.map(x=>e.jsx("option",{value:x,children:x},`integrity-${x}`))}),e.jsxs("div",{className:"mt-sm text-xs text-gray-600 dark:text-gray-400","data-testid":E.label("integrity-summary"),children:[a,":"," ",H("integrity",a)]}),e.jsx("button",{className:"mt-sm px-4 py-3 sm:px-3 sm:py-2 text-sm sm:text-xs min-h-[40px] bg-green-600 text-white rounded hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600 transition-colors",onClick:()=>R("integrity"),"data-testid":E.button("integrity-details"),children:"View details"}),T==="integrity"&&e.jsx("div",{className:"mt-sm text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":E.label("integrity-changed"),children:"âœ“ Security level updated"})]}),e.jsxs("div",{className:k(N.card,"p-sm"),"data-testid":E.section("availability"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-sm",children:[e.jsxs("label",{htmlFor:"availability-select",className:"text-sm font-medium flex items-center",children:[e.jsx("span",{className:"text-blue-500 dark:text-blue-400 mr-sm",children:W.availability}),"Availability"]}),e.jsx(F,{category:"",level:r,colorClass:"bg-blue-100 dark:bg-blue-900/20",textClass:"text-blue-800 dark:text-blue-300",testId:"security-level-widget-availability-badge"})]}),e.jsx("select",{id:"availability-select",className:"w-full p-sm border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-blue-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",value:r,onChange:V,"data-testid":B.AVAILABILITY_SELECT,children:$.map(x=>e.jsx("option",{value:x,children:x},`availability-${x}`))}),e.jsxs("div",{className:"mt-sm text-xs text-gray-600 dark:text-gray-400","data-testid":E.label("availability-summary"),children:[r,":"," ",H("availability",r)]}),e.jsx("button",{className:"mt-sm px-4 py-3 sm:px-3 sm:py-2 text-sm sm:text-xs min-h-[40px] bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors",onClick:()=>R("availability"),"data-testid":E.button("availability-details"),children:"View details"}),T==="availability"&&e.jsx("div",{className:"mt-sm text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":E.label("availability-changed"),children:"âœ“ Security level updated"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-medium mb-sm text-gray-800 dark:text-gray-200",children:[h.charAt(0).toUpperCase()+h.slice(1)," ","Details"]}),e.jsx("div",{className:k(N.card,"p-sm h-full"),"data-testid":`${h}-details-content`,children:y?e.jsxs("div",{className:"space-y-md",children:[e.jsxs("h4",{className:`font-medium ${se(h)}`,children:[h==="availability"?r:h==="integrity"?a:i," ","Level"]}),e.jsxs("div",{className:"space-y-sm",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-xs",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:y.description||"No description available"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-xs",children:"Technical Implementation"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:y.technical||"No technical details available"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-xs",children:"Business Impact"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:y.businessImpact||"No business impact details available"})]}),h==="availability"&&e.jsxs("div",{className:"mt-md grid grid-cols-2 gap-md",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-sm rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-xs text-blue-700 dark:text-blue-300",children:"Uptime"}),e.jsx("div",{className:"text-sm",children:y.uptime||"N/A"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-sm rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-xs text-blue-700 dark:text-blue-300",children:"Recovery Time"}),e.jsx("div",{className:"text-sm",children:y.rto||"N/A"})]})]}),h==="integrity"&&y.validationMethod&&e.jsxs("div",{className:"mt-md bg-green-50 dark:bg-green-900/20 p-sm rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-xs text-green-700 dark:text-green-300",children:"Validation Method"}),e.jsx("div",{className:"text-sm",children:y.validationMethod})]}),h==="confidentiality"&&y.protectionMethod&&e.jsxs("div",{className:"mt-md bg-purple-50 dark:bg-purple-900/20 p-sm rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-xs text-purple-700 dark:text-purple-300",children:"Protection Method"}),e.jsx("div",{className:"text-sm",children:y.protectionMethod})]})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:e.jsx("p",{children:"No details available for this security level."})})})]})]}),e.jsxs("div",{className:"mt-sm bg-gray-100 dark:bg-gray-800 p-sm rounded-lg",children:[e.jsx("h3",{className:"text-md font-medium mb-sm text-gray-800 dark:text-gray-200",children:"Security Level Overview"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-sm",children:"Higher security levels provide stronger protection but typically require more resources to implement and maintain. Consider your organization's needs and constraints when selecting security levels."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-sm text-xs",children:[e.jsxs("div",{className:"p-sm bg-red-50 dark:bg-red-900/20 rounded",children:[e.jsx("div",{className:"font-medium text-red-700 dark:text-red-300",children:"None"}),e.jsx("div",{className:"text-red-600 dark:text-red-400",children:"Minimal to no security controls"})]}),e.jsxs("div",{className:"p-sm bg-yellow-50 dark:bg-yellow-900/20 rounded",children:[e.jsx("div",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Low"}),e.jsx("div",{className:"text-yellow-600 dark:text-yellow-400",children:"Basic security controls"})]}),e.jsxs("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded",children:[e.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Moderate"}),e.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:"Standard security controls"})]}),e.jsxs("div",{className:"p-sm bg-green-50 dark:bg-green-900/20 rounded",children:[e.jsx("div",{className:"font-medium text-green-700 dark:text-green-300",children:"High"}),e.jsx("div",{className:"text-green-600 dark:text-green-400",children:"Advanced security controls"})]}),e.jsxs("div",{className:"p-sm bg-purple-50 dark:bg-purple-900/20 rounded",children:[e.jsx("div",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Very High"}),e.jsx("div",{className:"text-purple-600 dark:text-purple-400",children:"Maximum security controls"})]})]})]})]})})})},pe={sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-1 text-sm",lg:"px-2.5 py-1.5 text-base"},Q=q.memo(({shortcut:r,size:a="sm",className:i="",platformSpecific:u=!0})=>{const n=u?J():"windows",c=ce(r,n);return e.jsx("span",{className:`inline-flex items-center gap-0.5 ${i}`,"data-testid":O.SHORTCUT_BADGE,"aria-label":`Keyboard shortcut: ${r}`,children:c.map((t,o)=>e.jsxs(q.Fragment,{children:[e.jsx("kbd",{className:`
              ${pe[a]}
              font-mono font-semibold
              bg-gray-100 dark:bg-gray-700
              text-gray-700 dark:text-gray-300
              border border-gray-300 dark:border-gray-600
              rounded shadow-sm
              inline-flex items-center justify-center
              min-w-[1.5em]
            `,"data-testid":O.SHORTCUT_BADGE_KEY,children:t}),o<c.length-1&&e.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs","aria-hidden":"true",children:"+"})]},o))})});Q.displayName="ShortcutBadge";const ee=s.createContext(void 0);function be({children:r,initialShortcuts:a={},defaultEnabled:i=!0}){const[u,n]=s.useState(a),[c,t]=s.useState(i),[o,g]=s.useState(!1),f=J(),l=s.useCallback(m=>{S.debug("Registering keyboard shortcut",{id:m.id,keys:m.keys,description:m.description}),n(L=>({...L,[m.id]:m}))},[]),b=s.useCallback(m=>{S.debug("Unregistering keyboard shortcut",{id:m}),n(L=>{const{[m]:y,...j}=L;return j})},[]),v=s.useCallback(m=>{S.debug("Setting keyboard shortcuts enabled",{enabled:m}),t(m)},[]),h=s.useCallback(m=>{S.debug("Setting keyboard shortcut help visibility",{show:m}),g(m)},[]),R=s.useMemo(()=>({shortcuts:u,registerShortcut:l,unregisterShortcut:b,isEnabled:c,setEnabled:v,platform:f,showHelp:o,setShowHelp:h}),[u,l,b,c,v,f,o,h]);return e.jsx(ee.Provider,{value:R,children:r})}function te(){const r=s.useContext(ee);if(r===void 0)throw new Error("useKeyboardShortcutContext must be used within a KeyboardShortcutProvider");return r}const fe=({isOpen:r,onClose:a,shortcuts:i})=>{const u=te(),n=i||u.shortcuts,c=s.useMemo(()=>{const t={};return Object.values(n).forEach(o=>{const g=o.category;t[g]||(t[g]=[]),t[g].push(o)}),t},[n]);return s.useEffect(()=>{if(!r)return;const t=o=>{o.key==="Escape"&&(a(),o.preventDefault(),o.stopPropagation())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[r,a]),s.useEffect(()=>{if(!r)return;let t;const o=requestAnimationFrame(()=>{const g=document.querySelector('[role="dialog"]');if(!g)return;const f=g.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),l=f[0],b=f[f.length-1],v=h=>{h.key==="Tab"&&(h.shiftKey&&document.activeElement===l?(h.preventDefault(),b?.focus()):!h.shiftKey&&document.activeElement===b&&(h.preventDefault(),l?.focus()))};g.addEventListener("keydown",v),l?.focus(),t=()=>g.removeEventListener("keydown",v)});return()=>{cancelAnimationFrame(o),t?.()}},[r]),r?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",onClick:a,"data-testid":O.HELP_MODAL,"aria-label":"Close keyboard shortcuts dialog by clicking outside",children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"keyboard-shortcuts-title",className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsx("h2",{id:"keyboard-shortcuts-title",className:"text-2xl font-bold text-gray-900 dark:text-white","data-testid":O.HELP_MODAL_TITLE,children:"âŒ¨ï¸ Keyboard Shortcuts"}),e.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Close keyboard shortcuts","data-testid":O.HELP_MODAL_CLOSE,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"overflow-y-auto p-6 flex-1",children:Object.entries(c).map(([t,o])=>e.jsxs("div",{className:"mb-6 last:mb-0","data-testid":O.HELP_MODAL_CATEGORY,children:[e.jsx("h3",{className:"text-subheading font-semibold text-gray-900 dark:text-white mb-3",children:me[t]||t}),e.jsx("div",{className:"space-y-2",children:o.map(g=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors","data-testid":O.HELP_MODAL_SHORTCUT,children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:g.description}),e.jsx(Q,{shortcut:g.keys,size:"md",platformSpecific:!0})]},g.id))})]},t))}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:["Press ",e.jsx(Q,{shortcut:"Escape",size:"sm"})," to close this dialog"]})})]})}):null},I=({lines:r=3,variant:a="default",testId:i="loading-skeleton",className:u=""})=>{const n="animate-pulse",c="bg-gray-200 dark:bg-gray-700 rounded",t={default:{ariaLabel:"Loading content",srText:"Loading...",render:l=>e.jsx(e.Fragment,{children:Array.from({length:r}).map((b,v)=>e.jsx("div",{className:`h-4 ${l}`,"data-testid":`${i}-line-${v}`,"aria-hidden":"true"},`skeleton-line-${v}`))})},summary:{ariaLabel:"Loading summary",srText:"Loading summary...",render:l=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`h-8 ${l} w-3/4`,"aria-hidden":"true"}),e.jsx("div",{className:`h-24 ${l}`,"aria-hidden":"true"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:["summary-metric-1","summary-metric-2","summary-metric-3"].map(b=>e.jsx("div",{className:`h-20 ${l}`,"aria-hidden":"true"},b))})]})},chart:{ariaLabel:"Loading chart",srText:"Loading chart...",render:l=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`h-6 ${l} w-1/2`,"aria-hidden":"true"}),e.jsx("div",{className:`h-64 ${l}`,"aria-hidden":"true"}),e.jsx("div",{className:"flex justify-between gap-4",children:["legend-1","legend-2","legend-3","legend-4"].map(b=>e.jsx("div",{className:`h-4 w-16 ${l}`,"aria-hidden":"true"},b))})]})},list:{ariaLabel:"Loading list",srText:"Loading list...",render:l=>e.jsx(e.Fragment,{children:["list-item-1","list-item-2","list-item-3","list-item-4","list-item-5"].map(b=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`h-10 w-10 ${l} rounded-full`,"aria-hidden":"true"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:`h-4 ${l} w-3/4`,"aria-hidden":"true"}),e.jsx("div",{className:`h-3 ${l} w-1/2`,"aria-hidden":"true"})]})]},b))})},metrics:{ariaLabel:"Loading metrics",srText:"Loading metrics...",render:l=>e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:["metric-1","metric-2","metric-3","metric-4"].map(b=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`h-4 ${l} w-2/3`,"aria-hidden":"true"}),e.jsx("div",{className:`h-8 ${l}`,"aria-hidden":"true"}),e.jsx("div",{className:`h-3 ${l} w-1/2`,"aria-hidden":"true"})]},b))})},tabs:{ariaLabel:"Loading tabs",srText:"Loading tabs...",render:l=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex space-x-2 border-b border-gray-200 dark:border-gray-700",children:["tab-1","tab-2","tab-3","tab-4"].map(b=>e.jsx("div",{className:`h-10 w-24 ${l} mb-[-1px]`,"aria-hidden":"true"},b))}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:`h-6 ${l} w-3/4`,"aria-hidden":"true"}),e.jsx("div",{className:`h-32 ${l}`,"aria-hidden":"true"}),e.jsx("div",{className:`h-4 ${l} w-5/6`,"aria-hidden":"true"}),e.jsx("div",{className:`h-4 ${l} w-4/6`,"aria-hidden":"true"})]})]})}},o=t[a]||t.default,g={default:"space-y-4",summary:"space-y-4",chart:"space-y-4",tabs:"space-y-4",list:"space-y-3",metrics:""},f=g[a]||g.default;return e.jsxs("div",{className:`${n} ${f} ${u}`,"data-testid":i,role:"status","aria-label":o.ariaLabel,children:[o.render(c),e.jsx("span",{className:"sr-only",children:o.srText})]})},ve=s.lazy(()=>_(()=>import("./widgets-assessment-Dx4tYGjQ.js").then(r=>r.al),__vite__mapDeps([0,1,2]),import.meta.url)),Ne=s.lazy(()=>_(()=>import("./widgets-assessment-Dx4tYGjQ.js").then(r=>r.am),__vite__mapDeps([0,1,2]),import.meta.url)),je=s.lazy(()=>_(()=>import("./widgets-business-Dg26G2rp.js").then(r=>r.C),__vite__mapDeps([3,1,0,2]),import.meta.url)),Ee=s.lazy(()=>_(()=>import("./widgets-business-Dg26G2rp.js").then(r=>r.a),__vite__mapDeps([3,1,0,2]),import.meta.url)),ke=s.lazy(()=>_(()=>import("./widgets-business-Dg26G2rp.js").then(r=>r.V),__vite__mapDeps([3,1,0,2]),import.meta.url)),Ce=s.lazy(()=>_(()=>import("./widgets-impact-BiombB7R.js").then(r=>r.A),__vite__mapDeps([4,1,0,2]),import.meta.url)),Le=s.lazy(()=>_(()=>import("./widgets-impact-BiombB7R.js").then(r=>r.C),__vite__mapDeps([4,1,0,2]),import.meta.url)),Ie=s.lazy(()=>_(()=>import("./widgets-impact-BiombB7R.js").then(r=>r.I),__vite__mapDeps([4,1,0,2]),import.meta.url)),we=s.lazy(()=>_(()=>import("./widgets-implementation-DsRu3nRQ.js").then(r=>r.S),__vite__mapDeps([5,1,0,2]),import.meta.url)),_e=s.lazy(()=>_(()=>import("./widgets-visualization-BgqY22kA.js"),__vite__mapDeps([6,1,0,2]),import.meta.url)),Re=s.lazy(()=>_(()=>import("./widgets-implementation-DsRu3nRQ.js").then(r=>r.T),__vite__mapDeps([5,1,0,2]),import.meta.url)),Se=()=>{const r="1.1.11",{showHelp:a,setShowHelp:i}=te(),u={availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},[n,c]=Z("securityLevels",u),{levels:t,setLevel:o}=xe(n);s.useEffect(()=>{c(t)},[t,c]);const g=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,[f,l]=Z("darkMode",g);s.useEffect(()=>{console.log("CIA App Security Levels:",{availability:t.availability,integrity:t.integrity,confidentiality:t.confidentiality})},[t]);const b=s.useCallback(y=>{console.log("CIAClassificationApp: Setting availability level to:",y),o("availability",y)},[o]),v=s.useCallback(y=>{console.log("CIAClassificationApp: Setting integrity level to:",y),o("integrity",y)},[o]),h=s.useCallback(y=>{console.log("CIAClassificationApp: Setting confidentiality level to:",y),o("confidentiality",y)},[o]),R=()=>{l(y=>!y)},m=s.useCallback((y,j)=>{S.error("Widget error caught by error boundary",{error:y,errorInfo:j})},[]),L=s.useMemo(()=>({[M.SHOW_HELP.id]:{...M.SHOW_HELP,handler:()=>i(!0)},[M.SHOW_HELP_ALT.id]:{...M.SHOW_HELP_ALT,handler:()=>i(!0)}}),[i]);return he({shortcuts:L,enabled:!0,preventDefault:!0}),s.useEffect(()=>{f?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[f]),e.jsx("div",{className:"app-container",children:e.jsxs("div",{className:`min-h-screen ${f?"dark bg-gray-900":"bg-gray-100"} p-4 transition-colors duration-300`,children:[e.jsxs("div",{className:"mb-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded-lg shadow-md flex justify-between items-center app-header",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center overflow-hidden mr-1.5",children:e.jsx("img",{src:"./icon-192.png",alt:"CIA Compliance Manager Logo",style:{transform:"scale(0.2)"},"data-testid":w.APP_LOGO})}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("h1",{"data-testid":w.APP_TITLE,className:"text-sm font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300 mr-2",children:ue.APP_TITLE}),e.jsxs("div",{className:"cyber-nav flex items-center flex-wrap",children:[e.jsx("span",{className:"inline-block pulse-dot mr-1","data-testid":w.APP_INDICATOR,children:"â– "}),e.jsxs("span",{className:"mr-1 version-tag","data-testid":w.APP_VERSION,children:["v",r]}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://github.com/Hack23/cia-compliance-manager",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":w.SOURCE_LINK,children:"Source"}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://www.hack23.com/cia-compliance-manager-features.html",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":w.DOCS_LINK,children:"Doc"}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://hack23.com/",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":w.AUTHOR_LINK,children:"Hack23"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>i(!0),className:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 rounded transition-colors",title:"Keyboard Shortcuts (? or Ctrl+/)","data-testid":w.KEYBOARD_SHORTCUTS_BUTTON,children:"âŒ¨ï¸ Shortcuts"}),e.jsx("button",{onClick:R,className:"theme-toggle-btn","data-testid":w.THEME_TOGGLE,children:f?"â˜€ï¸ Light":"ðŸŒ™ Dark"})]})]}),e.jsx("div",{className:"w-full max-w-[1600px] mx-auto",children:e.jsxs("div",{"data-testid":w.DASHBOARD_GRID,className:"dashboard-grid-container",children:[e.jsx("div",{className:"grid-widget-container",children:e.jsx(ye,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,onAvailabilityChange:b,onIntegrityChange:v,onConfidentialityChange:h,testId:"widget-security-level"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Business Impact Analysis",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-business-impact"}),children:e.jsx(ve,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-business-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Security Summary",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-security-summary"}),children:e.jsx(Ne,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-security-summary"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Value Creation",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-value-creation"}),children:e.jsx(ke,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-value-creation"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Cost Estimation",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-cost-estimation"}),children:e.jsx(Ee,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-cost-estimation"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Compliance Status",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-compliance-status"}),children:e.jsx(je,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-compliance-status"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Confidentiality Impact",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-confidentiality-impact"}),children:e.jsx(Le,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-confidentiality-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Integrity Impact",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-integrity-impact"}),children:e.jsx(Ie,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-integrity-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Availability Impact",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-availability-impact"}),children:e.jsx(Ce,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-availability-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Technical Details",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-technical-details"}),children:e.jsx(Re,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-technical-details"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Security Visualization",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-security-visualization"}),children:e.jsx(_e,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-security-visualization"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(C,{widgetName:"Security Resources",onError:m,children:e.jsx(s.Suspense,{fallback:e.jsx(I,{lines:5,className:"p-4",testId:"loading-security-resources"}),children:e.jsx(we,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-security-resources"})})})})]})}),e.jsx(fe,{isOpen:a,onClose:()=>i(!1)})]})})};class D{static instance;static getInstance(){return D.instance||(D.instance=new D),D.instance}constructor(){}logError(a,i,u="medium"){const n={message:a.message,severity:u,context:i,stack:a.stack,timestamp:new Date().toISOString(),userMessage:this.getUserFriendlyMessage(a),recoverable:this.canRecover(a)};switch(u){case"critical":case"high":S.error("[CIA Compliance Manager Error]",{...n,error:a});break;case"medium":S.warn("[CIA Compliance Manager Warning]",{...n,error:a});break;case"low":S.info("[CIA Compliance Manager Info]",{...n,error:a});break;default:S.error("[CIA Compliance Manager Error]",{...n,error:a})}}getUserFriendlyMessage(a){if(z(a)){if(a.code===d.VALIDATION_ERROR){const i=a.context.field;return i?`Please check the ${i} field and try again.`:"Please check your input and try again."}if(K(a)){const i=a.context.statusCode;return i===404?"The requested resource was not found.":i===401||i===403?"You do not have permission to access this resource.":i&&i>=500?"Server error. Please try again later.":"Network connection issue. Please check your connection and try again."}if(Y(a)){const i=a.context.retryAfter;return i?`Operation failed. Please try again in ${i} seconds.`:"Operation failed. Please try again."}switch(a.code){case d.INVALID_SECURITY_LEVEL:case d.INVALID_COMPONENT_TYPE:case d.INVALID_INPUT:case d.MISSING_REQUIRED_FIELD:return"Invalid input provided. Please check your data and try again.";case d.DATA_NOT_FOUND:return"The requested data could not be found.";case d.DATA_PROVIDER_ERROR:case d.CONFIGURATION_ERROR:return"System configuration error. Please contact support.";case d.CALCULATION_ERROR:case d.COMPLIANCE_CHECK_ERROR:case d.ROI_CALCULATION_ERROR:return"Error processing your request. Please try again.";case d.TIMEOUT_ERROR:return"Operation timed out. Please try again.";case d.CONNECTION_ERROR:return"Connection error. Please check your network.";case d.RATE_LIMIT_ERROR:return"Too many requests. Please wait a moment and try again.";case d.INTERNAL_ERROR:case d.UNEXPECTED_ERROR:default:return"An unexpected error occurred. Please try again."}}if(a instanceof Error){const i=a.message.toLowerCase();if(i.includes("network")||i.includes("fetch"))return"Network connection issue. Please check your connection and try again.";if(i.includes("timeout"))return"Operation timed out. Please try again.";if(i.includes("permission")||i.includes("unauthorized"))return"You do not have permission to perform this action."}return"An unexpected error occurred. Please try again."}canRecover(a){if(Y(a)||K(a)||ge(a))return!0;if(z(a))switch(a.code){case d.INVALID_SECURITY_LEVEL:case d.INVALID_COMPONENT_TYPE:case d.INVALID_INPUT:case d.MISSING_REQUIRED_FIELD:case d.DATA_NOT_FOUND:case d.TIMEOUT_ERROR:case d.CONNECTION_ERROR:case d.RATE_LIMIT_ERROR:return!0;default:return!1}if(a instanceof Error){const i=a.message.toLowerCase();if(i.includes("network")||i.includes("timeout")||i.includes("fetch"))return!0}return!1}getErrorSeverity(a){if(z(a)){if(a.code===d.VALIDATION_ERROR)return"low";if(K(a)){const i=a.context.statusCode;return i&&i>=500?"high":"medium"}if(Y(a))return"medium";switch(a.code){case d.INVALID_INPUT:case d.MISSING_REQUIRED_FIELD:return"low";case d.DATA_NOT_FOUND:case d.INVALID_SECURITY_LEVEL:case d.INVALID_COMPONENT_TYPE:case d.TIMEOUT_ERROR:case d.CONNECTION_ERROR:return"medium";case d.DATA_PROVIDER_ERROR:case d.CONFIGURATION_ERROR:case d.CALCULATION_ERROR:case d.COMPLIANCE_CHECK_ERROR:case d.ROI_CALCULATION_ERROR:return"high";case d.INTERNAL_ERROR:case d.UNEXPECTED_ERROR:return"critical";case d.RATE_LIMIT_ERROR:return"medium";default:return"high"}}return"high"}formatErrorForDisplay(a,i=!1){const u=this.getUserFriendlyMessage(a);return i&&a instanceof Error?`${u}

Technical details: ${a.message}`:u}}const G=D.getInstance(),Te=r=>{switch(r){case"top-left":return"top-4 left-4";case"top-center":return"top-4 left-1/2 -translate-x-1/2";case"top-right":return"top-4 right-4";case"bottom-left":return"bottom-4 left-4";case"bottom-center":return"bottom-4 left-1/2 -translate-x-1/2";case"bottom-right":return"bottom-4 right-4";default:return"top-4 right-4"}},Ae=({message:r,title:a="Error",isVisible:i,onDismiss:u,autoHideDuration:n=5e3,position:c="top-right",retry:t,testId:o="error-toast"})=>{const[g,f]=s.useState(!1),l=s.useCallback(()=>{f(!0),setTimeout(()=>{f(!1),u()},300)},[u]);if(s.useEffect(()=>{if(i&&n>0){const v=setTimeout(()=>{l()},n);return()=>clearTimeout(v)}},[i,n,l]),!i&&!g)return null;const b=Te(c);return e.jsxs("div",{className:`fixed ${b} z-50 transform transition-all duration-300 ${g?"opacity-0 scale-95":"opacity-100 scale-100"}`,"data-testid":o,role:"alert","aria-live":"assertive","aria-atomic":"true",children:[e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg border-l-4 border-red-500 dark:border-red-600 overflow-hidden",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-6 w-6 text-red-500 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100","data-testid":`${o}-title`,children:a}),e.jsx("p",{className:"mt-1 text-sm text-gray-700 dark:text-gray-300","data-testid":`${o}-message`,children:r})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{onClick:l,className:"inline-flex text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500 rounded","data-testid":`${o}-close-button`,"aria-label":"Close notification",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]}),t&&e.jsx("div",{className:"mt-3",children:e.jsxs("button",{onClick:()=>{t(),l()},className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 focus:outline-none focus:ring-2 focus:ring-red-500 rounded","data-testid":`${o}-retry-button`,"aria-label":"Retry operation",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Retry"]})})]}),n>0&&i&&!g&&e.jsx("div",{className:"h-1 bg-gray-200 dark:bg-gray-700 overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500 dark:bg-red-600 animate-progress",style:{animation:`progress ${n}ms linear`}})})]}),e.jsx("style",{children:`
        @keyframes progress {
          from {
            width: 100%;
          }
          to {
            width: 0%;
          }
        }
        .animate-progress {
          animation: progress linear;
        }
      `})]})},Oe=s.createContext(void 0),De=({children:r,maxErrors:a=10,defaultToastPosition:i="top-right",defaultAutoHideDuration:u=5e3})=>{const[n,c]=s.useState([]),[t,o]=s.useState(null),[g,f]=s.useState(!1),l=s.useCallback(()=>`error-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,[]),b=s.useCallback((j,T)=>{G.logError(j,T);const A={id:l(),error:j,message:G.getUserFriendlyMessage(j),timestamp:new Date,recoverable:G.canRecover(j),context:T};c(V=>[A,...V].slice(0,a))},[a,l]),v=s.useCallback(j=>{c(T=>T.filter(A=>A.id!==j))},[]),h=s.useCallback(()=>{c([])},[]),R=s.useCallback(j=>{o(j),f(!0)},[]),m=s.useCallback(()=>{f(!1),setTimeout(()=>{o(null)},300)},[]),L=s.useCallback(()=>n[0],[n]),y=s.useMemo(()=>({errors:n,addError:b,clearError:v,clearAllErrors:h,showToast:R,hideToast:m,getLatestError:L}),[n,b,v,h,R,m,L]);return e.jsxs(Oe.Provider,{value:y,children:[r,t&&e.jsx(Ae,{message:t.message,title:t.title,isVisible:g,onDismiss:m,autoHideDuration:t.autoHideDuration??u,position:t.position??i,retry:t.retry})]})};function Pe(){return e.jsx(De,{children:e.jsx(be,{children:e.jsx("div",{className:"app-container","data-testid":w.APP_CONTAINER,children:e.jsx(Se,{})})})})}const Me=ie.createRoot(document.getElementById("root"));Me.render(e.jsx(q.StrictMode,{children:e.jsx(Pe,{})}));
//# sourceMappingURL=index-zA5FWkWJ.js.map
