import{r as g,j as a}from"./react-vendor-BzhlA2NX.js";import{C as ve,R as Qe,a as et,P as tt,L as it,i as rt,p as at,b as nt,c as st}from"./chart-BRhaV9pk.js";const ot="modulepreload",ct=function(i,e){return new URL(i,e).href},Se={},lt=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){let u=function(d){return Promise.all(d.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const o=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),m=c?.nonce||c?.getAttribute("nonce");n=u(t.map(d=>{if(d=ct(d,r),d in Se)return;Se[d]=!0;const h=d.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(r)for(let b=o.length-1;b>=0;b--){const N=o[b];if(N.href===d&&(!h||N.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${f}`))return;const y=document.createElement("link");if(y.rel=h?"stylesheet":ot,h||(y.as="script"),y.crossOrigin="",y.href=d,m&&y.setAttribute("nonce",m),document.head.appendChild(y),h)return new Promise((b,N)=>{y.addEventListener("load",b),y.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})},ut={availability:"â±ï¸",integrity:"âœ“",confidentiality:"ðŸ”’"};function se(i){return ut[i]||"ðŸ”µ"}const ki={MAX_PREVIEW_METRICS:4,MAX_DISPLAYED_GAPS:3},Ni={NONE:"None",LOW:"Low",MODERATE:"Moderate",HIGH:"High",VERY_HIGH:"Very High"},dt={SOC2:"SOC 2",ISO27001:"ISO 27001",PCI_DSS:"PCI DSS",HIPAA:"HIPAA",NIST:"NIST 800-53 High"},Ci={APP_TITLE:"CIA Compliance Manager Dashboard"};new RegExp(Object.values(dt).join("|"));const Le={SECURITY_LEVEL:"ðŸ”",SECURITY_SUMMARY:"ðŸ“Š",BUSINESS_IMPACT_ANALYSIS:"ðŸ“ˆ",COMPLIANCE_STATUS:"ðŸ“‹",SECURITY_RESOURCES:"ðŸ“š",COST_ESTIMATION:"ðŸ’°",VALUE_CREATION:"ðŸ’Ž",TECHNICAL_DETAILS:"âš™ï¸",SECURITY_VISUALIZATION:"ðŸ“ˆ",AVAILABILITY_IMPACT:se("availability"),INTEGRITY_IMPACT:se("integrity"),CONFIDENTIALITY_IMPACT:se("confidentiality")},De={SECURITY_LEVEL:"Security Level Configuration",SECURITY_SUMMARY:"Security Summary",BUSINESS_IMPACT_ANALYSIS:"Business Impact Analysis",COMPLIANCE_STATUS:"Compliance Status",SECURITY_RESOURCES:"Security Resources",COST_ESTIMATION:"Cost Estimation",VALUE_CREATION:"Value Creation",TECHNICAL_DETAILS:"Technical Implementation Details",SECURITY_VISUALIZATION:"Security Visualization",AVAILABILITY_IMPACT:"Availability Impact",INTEGRITY_IMPACT:"Integrity Impact",CONFIDENTIALITY_IMPACT:"Confidentiality Impact"};function R(...i){return i.filter(Boolean).map(e=>e.toLowerCase().replace(/\s+/g,"-")).join("-")}function H(i){const e=i.toLowerCase().replace(/\s+/g,"-");return{root:R("widget",e),section:t=>R("widget",e,"section",t),button:t=>R("widget",e,"button",t),value:t=>R("widget",e,"value",t),label:t=>R("widget",e,"label",t),icon:t=>R("widget",e,"icon",t),input:t=>R("widget",e,"input",t),list:t=>R("widget",e,"list",t),item:t=>R("widget",e,"item",t),card:t=>R("widget",e,"card",t),header:t=>t?R("widget",e,"header",t):R("widget",e,"header"),content:t=>t?R("widget",e,"content",t):R("widget",e,"content"),footer:t=>t?R("widget",e,"footer",t):R("widget",e,"footer")}}const Ri=H("security-level"),Ei=H("value-creation"),Mi=H("cost-estimation"),P=H("business-impact");H("compliance-status");const Y=H("security-summary"),Ai=H("availability-impact"),Ti=H("integrity-impact"),Li=H("confidentiality-impact"),Di=H("technical-details"),ji=H("security-resources"),Hi=H("security-visualization"),Pi={AVAILABILITY_SELECT:"availability-selector",INTEGRITY_SELECT:"integrity-selector",CONFIDENTIALITY_SELECT:"confidentiality-selector"},mt={BUSINESS_IMPACT_WIDGET:"business-impact-widget"},ee={RADAR_CHART:"radar-chart",RADAR_AVAILABILITY_VALUE:"radar-availability-value",RADAR_INTEGRITY_VALUE:"radar-integrity-value",RADAR_CONFIDENTIALITY_VALUE:"radar-confidentiality-value"},Oi={APP_CONTAINER:"app-container",APP_TITLE:"app-title",APP_LOGO:"app-logo",APP_VERSION:"app-version",APP_INDICATOR:"app-indicator",DASHBOARD_GRID:"dashboard-grid",THEME_TOGGLE:"theme-toggle",KEYBOARD_SHORTCUTS_BUTTON:"keyboard-shortcuts-button",SOURCE_LINK:"source-link",DOCS_LINK:"docs-link",AUTHOR_LINK:"author-link"},oe={KEY_VALUE_PAIR:"key-value-pair",KEY_VALUE_KEY:"key-value-key",KEY_VALUE_VALUE:"key-value-value"},ie={WIDGET:"security-summary-widget",AVAILABILITY_CARD:"availability-card",INTEGRITY_CARD:"integrity-card",CONFIDENTIALITY_CARD:"confidentiality-card"},Vi={AVAILABILITY_IMPACT_PREFIX:"widget-availability-impact"},_i={CONFIDENTIALITY_IMPACT_PREFIX:"confidentiality-impact"},$i={INTEGRITY_IMPACT_PREFIX:"integrity-impact"},Ui={WIDGET:"security-resources-widget"},Fi={COMPLIANCE_STATUS_BADGE:"compliance-status-badge",COMPLIANT_FRAMEWORKS_LIST:"compliant-frameworks-list",WIDGET:"compliance-status-widget",COMPLIANCE_SCORE:"compliance-score",COMPLIANCE_SCORE_BAR:"compliance-score-bar",FRAMEWORK_ITEM_PREFIX:"framework-item",PARTIALLY_COMPLIANT_FRAMEWORKS_LIST:"partially-compliant-frameworks-list",NON_COMPLIANT_FRAMEWORKS_LIST:"non-compliant-frameworks-list"};function pt(i){return typeof i=="string"&&["confidentiality","integrity","availability"].includes(i)}const ce={None:0,Low:1,Moderate:2,High:3,"Very High":4},gt=["None","Low","Moderate","High","Very High"],ke="Moderate";function je(i){if(!i)return ke;const e=["None","Low","Moderate","High","Very High"];if(e.includes(i))return i;const t=typeof i=="string"?i.charAt(0).toUpperCase()+i.slice(1).toLowerCase():i;return e.includes(t)?t:ke}function z(i){if(typeof i=="string"&&!["None","Low","Moderate","High","Very High"].includes(i))return 0;const e=je(i);return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[e]??0}function U(i){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[i]||"Unknown"}function He(i,e,t){const r=ce[i]||0,n=ce[e]||0,s=ce[t]||0,o=(r+n+s)/3,c=Math.round(o);return gt[c]||"None"}function ht(i){return{None:"No security controls implemented",Low:"Basic security controls with minimal protection",Moderate:"Standard security controls with adequate protection",High:"Advanced security controls with strong protection","Very High":"Maximum security controls with comprehensive protection"}[i]||"Unknown security level"}const yt={None:0,Low:1,Moderate:2,High:3,"Very High":4};function ft(i){if(typeof i=="string"){const e=i.trim();if(/^none$/i.test(e))return 0;if(/^low$/i.test(e))return 1;if(/^(moderate|medium)$/i.test(e))return 2;if(/^high$/i.test(e))return 3;if(/^very\s*high$/i.test(e))return 4}return yt[i]??0}const V="[CIA-CM]",j={log(...i){return console.log(V,...i),j},debug(i,e){return e!==void 0?console.debug(V,i,e):console.debug(V,i),j},info(i,e){return e!==void 0?console.info(V,i,e):console.info(V,i),j},warn(i,e){return e!==void 0?console.warn(V,i,e):console.warn(V,i),j},error(i,e){return e!==void 0?console.error(V,i,e):console.error(V,i),j}};var Pe=(i=>(i.VALIDATION_ERROR="VALIDATION_ERROR",i.INVALID_SECURITY_LEVEL="INVALID_SECURITY_LEVEL",i.INVALID_COMPONENT_TYPE="INVALID_COMPONENT_TYPE",i.INVALID_INPUT="INVALID_INPUT",i.MISSING_REQUIRED_FIELD="MISSING_REQUIRED_FIELD",i.DATA_NOT_FOUND="DATA_NOT_FOUND",i.DATA_PROVIDER_ERROR="DATA_PROVIDER_ERROR",i.CONFIGURATION_ERROR="CONFIGURATION_ERROR",i.CALCULATION_ERROR="CALCULATION_ERROR",i.COMPLIANCE_CHECK_ERROR="COMPLIANCE_CHECK_ERROR",i.ROI_CALCULATION_ERROR="ROI_CALCULATION_ERROR",i.NETWORK_ERROR="NETWORK_ERROR",i.CONNECTION_ERROR="CONNECTION_ERROR",i.TIMEOUT_ERROR="TIMEOUT_ERROR",i.RETRYABLE_ERROR="RETRYABLE_ERROR",i.RATE_LIMIT_ERROR="RATE_LIMIT_ERROR",i.INTERNAL_ERROR="INTERNAL_ERROR",i.UNEXPECTED_ERROR="UNEXPECTED_ERROR",i))(Pe||{});class Q extends Error{code;context;cause;timestamp;constructor(e,t="INTERNAL_ERROR",r={},n){super(e),this.name="ServiceError",this.code=t,this.context=r,this.cause=n,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,Q)}getFormattedMessage(){const e=[`[${this.code}] ${this.message}`];return this.context.service&&e.push(`Service: ${this.context.service}`),this.context.method&&e.push(`Method: ${this.context.method}`),this.cause&&e.push(`Cause: ${this.cause.message}`),e.join(" | ")}serializeCause(){if(this.cause)return{message:this.cause.message,stack:this.cause.stack}}toJSON(){return{name:this.name,message:this.message,code:this.code,context:this.context,timestamp:this.timestamp.toISOString(),stack:this.stack,cause:this.serializeCause()}}}function re(i,e={}){return new Q(i,"VALIDATION_ERROR",e)}function ne(i){return i instanceof Q}function Bi(i){return ne(i)&&i.code==="VALIDATION_ERROR"}function qi(i){return ne(i)&&(i.code==="NETWORK_ERROR"||i.code==="CONNECTION_ERROR"||i.code==="TIMEOUT_ERROR")}function zi(i){return ne(i)&&(i.code==="RETRYABLE_ERROR"||i.code==="RATE_LIMIT_ERROR")}class ${name="BaseService";dataProvider;constructor(e){if(!e)throw re("Data provider is required",{service:"BaseService",method:"constructor"});this.dataProvider=e}validate(e){return e!=null}validateWithDetails(e){const t=[];return e==null&&t.push("Input cannot be null or undefined"),{valid:t.length===0,errors:t}}handleError(e){if(ne(e))return j.error(e.getFormattedMessage()),e;const t=new Q(e.message,Pe.INTERNAL_ERROR,{service:this.name},e);return j.error(t.getFormattedMessage()),t}validateSecurityLevel(e){const t=["None","Low","Moderate","High","Very High"];if(!t.includes(e))throw re(`Invalid security level: ${e}`,{service:this.name,level:e,validLevels:t.join(", ")});return!0}validateComponent(e){const t=["availability","integrity","confidentiality"];if(!t.includes(e))throw re(`Invalid component type: ${e}`,{service:this.name,component:e,validComponents:t.join(", ")});return!0}isCIAComponentType(e){return["availability","integrity","confidentiality"].includes(e)}getComponentDetails(e,t){try{const r=this.getCIAOptions(e);return r?r[t]:void 0}catch(r){j.warn(`Failed to get component details for ${e} at level ${t}`,r);return}}getCIAOptions(e){switch(e){case"availability":return this.dataProvider.availabilityOptions;case"integrity":return this.dataProvider.integrityOptions;case"confidentiality":return this.dataProvider.confidentialityOptions;default:return{}}}getSecurityLevelDescription(e){switch(e){case"None":return"No security controls";case"Low":return"Basic security controls";case"Moderate":return"Standard security controls";case"High":return"Enhanced security controls";case"Very High":return"Maximum security controls";default:return"Unknown security level"}}getRiskLevelFromSecurityLevel(e){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[e]||"Unknown"}getSecurityLevelValue(e){return ft(e)}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}getDefaultSecurityIcon(e){if(typeof this.dataProvider.getDefaultSecurityIcon=="function"){const t=this.dataProvider.getDefaultSecurityIcon(e);if(t)return t}switch(e){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}getValuePoints(e){if(typeof this.dataProvider.getDefaultValuePoints=="function")try{const t=this.dataProvider.getDefaultValuePoints(e);if(t&&t.length>0)return t}catch(t){j.warn("Error fetching custom value points:",t)}return this.getDefaultValuePoints(e)}getDefaultValuePoints(e){switch(e){case"Very High":return["Maximum security value with comprehensive protection","Enables business in highly regulated industries","Provides competitive advantage through superior security posture","Minimizes risk of data breaches and associated costs","Ensures regulatory compliance across major frameworks"];case"High":return["Strong security value with robust protection","Supports business in moderately regulated industries","Reduces risk of security incidents significantly","Protects sensitive data and critical operations","Meets requirements for most compliance frameworks"];case"Moderate":return["Balanced security value with standard protection","Suitable for most business applications","Reduces common security risks","Protects important business data","Meets basic compliance requirements"];case"Low":return["Basic security value with minimal protection","Suitable for non-critical systems","Addresses obvious security vulnerabilities","Provides foundation for security program","May not meet regulatory requirements"];case"None":return["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"];default:return["Unknown security level","Security value cannot be determined"]}}validateNumericValue(e,t){return Number.isFinite(e)?!0:(this.logOperation("warn",`Invalid ${t} value: ${e}`,{method:t==="currency"?"formatCurrency":"formatPercentage"}),!1)}formatCurrency(e){return this.validateNumericValue(e,"currency")?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e):"$0"}formatPercentage(e){return this.validateNumericValue(e,"percentage")?`${e}%`:"0%"}safeGet(e,t,r){return!e||!(t in e)?r:e[t]}logOperation(e,t,r={}){const n={...r,service:this.name};j[e](t,n)}}const bt={financial:"ðŸ’°",operational:"âš™ï¸",reputational:"ðŸ†",strategic:"ðŸŽ¯",regulatory:"ðŸ“œ",summary:"ðŸ“Š"};class xt extends ${name="BusinessImpactService";constructor(e){super(e)}getBusinessImpact(e,t="Moderate"){this.validateComponent(e),this.validateSecurityLevel(t);const r=je(t),n=this.getCIAOptions(e),s=n?n[r]:void 0;return s?.businessImpactDetails?e==="confidentiality"&&r==="None"?{...s.businessImpactDetails,summary:"Critical risk due to absence of confidentiality controls",financial:{description:s.businessImpactDetails.financial?.description||"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:s.businessImpactDetails.operational?.description||"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:s.businessImpactDetails.reputational?.description||"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:s.businessImpactDetails.regulatory?.description||"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}}:s.businessImpactDetails:this.createDefaultBusinessImpact(e,r)}getCategoryIcon(e){return!e||typeof e!="string"?"â“":bt[e.toLowerCase()]||"â“"}getBusinessImpactDescription(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const r=this.getCIAOptions(e);return(r?r[t]:void 0)?.businessImpact??this.getDefaultBusinessImpactDescription(e,t)}getDetailedDescription(e,t){if(!t)return`No ${e} impact details available`;const r=this.getCategoryIcon(e);return this.formatImpactDetail(t,e,r)}formatImpactDetail(e,t,r){let n=`${r} **${this.capitalizeFirstLetter(t)} Impact**: ${e.description}`;return e.riskLevel&&(n+=`
- Risk Level: ${e.riskLevel}`),t==="financial"&&e.annualRevenueLoss&&(n+=`
- Potential Revenue Loss: ${e.annualRevenueLoss}`),t==="operational"&&e.meanTimeToRecover&&(n+=`
- Mean Time to Recover: ${e.meanTimeToRecover}`),t==="regulatory"&&e.complianceViolations&&e.complianceViolations.length>0&&(n+=`
- Compliance Violations: ${e.complianceViolations.join(", ")}`),t==="strategic"&&e.competitiveAdvantage&&(n+=`
- Competitive Advantage: ${e.competitiveAdvantage}`),e.complianceImpact&&(n+=`
- Compliance Impact: ${e.complianceImpact}`),e.reputationalImpact&&(n+=`
- Reputational Impact: ${e.reputationalImpact}`),n}calculateBusinessImpactLevel(e,t=e,r=e){this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r);const n={None:0,Low:1,Moderate:2,High:3,"Very High":4},s=Math.min(n[e],n[t],n[r]);switch(Object.keys(n).find(c=>n[c]===s)){case"None":return"Critical";case"Low":return"High";case"Moderate":return"Medium";case"High":return"Low";case"Very High":return"Minimal";default:return"Unknown"}}getDefaultBusinessImpactDescription(e,t){return`${this.calculateBusinessImpactLevel(t)} business impact due to ${t.toLowerCase()} ${e} security level`}createDefaultBusinessImpact(e,t){const r=this.getRiskLevelWithSuffix(t);return e==="confidentiality"&&t==="None"?{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure",riskLevel:"Critical Risk"},reputational:{description:"Major reputational damage from failure to protect data",riskLevel:"Critical Risk"}}:{summary:`${e} impact analysis for ${t} level`,financial:{description:`Financial impact for ${t} ${e} security level`,riskLevel:r},operational:{description:`Operational impact for ${t} ${e} security level`,riskLevel:r},reputational:{description:`Reputational impact for ${t} ${e} security level`,riskLevel:r}}}getRiskLevelFromSecurityLevel(e){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[e]||"Unknown"}getRiskLevelWithSuffix(e){return this.getRiskLevelFromSecurityLevel(e)+" Risk"}getDefaultRevenueLoss(e){switch(e){case"None":return">20% of annual revenue";case"Low":return"10-20% of annual revenue";case"Moderate":return"5-10% of annual revenue";case"High":return"1-5% of annual revenue";case"Very High":return"<1% of annual revenue";default:return"Unknown revenue impact"}}getDefaultRecoveryTime(e){switch(e){case"None":return"Unpredictable";case"Low":return"24-48 hours";case"Moderate":return"4-8 hours";case"High":return"1 hour";case"Very High":return"<15 minutes";default:return"Unknown recovery time"}}getCIAOptions(e){switch(e){case"confidentiality":return this.dataProvider.confidentialityOptions;case"integrity":return this.dataProvider.integrityOptions;case"availability":return this.dataProvider.availabilityOptions;default:return{}}}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}impactMapping={None:{financialImpact:"Negligible",operationalImpact:"Minimal",reputationalImpact:"Insignificant"},Low:{financialImpact:"Minor",operationalImpact:"Limited",reputationalImpact:"Localized"},Moderate:{financialImpact:"Significant",operationalImpact:"Substantial",reputationalImpact:"Moderate"},High:{financialImpact:"Major",operationalImpact:"Severe",reputationalImpact:"Extensive"},"Very High":{financialImpact:"Critical",operationalImpact:"Catastrophic",reputationalImpact:"Global"}};getImpactForLevel(e){return this.impactMapping[e]||this.impactMapping.Moderate}}class vt extends ${frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},"FedRAMP Moderate":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"FedRAMP High":{availability:"High",integrity:"High",confidentiality:"High"},"CMMC Level 3":{availability:"Moderate",integrity:"High",confidentiality:"Moderate"},SOX:{availability:"High",integrity:"High",confidentiality:"Moderate"},CCPA:{availability:"Low",integrity:"Moderate",confidentiality:"High"}};constructor(e){super(e)}getComplianceStatus(e,t,r){const n=[],s=[],o=[];for(const h of Object.keys(this.frameworkRequirements)){const f=this.getFrameworkStatus(h,e,t,r);f==="compliant"?n.push(h):f==="partially-compliant"?s.push(h):o.push(h)}let c;n.length>0?o.length===0&&s.length===0?c="Fully compliant with all frameworks":c="Partially Compliant":s.length>0?c="Partially Compliant":c="Non-compliant with all frameworks";const m=this.calculateComplianceScore(n.length,s.length,o.length),u=this.generateRemediationSteps(e,t,r,o,s),d=this.generateRequirements(o,s);return{status:c,compliantFrameworks:n,partiallyCompliantFrameworks:s,nonCompliantFrameworks:o,remediationSteps:u,requirements:d,complianceScore:m}}getComplianceStatusText(e,t=e,r=e){if(e==="Low"&&t==="Low"&&r==="Low")return"Meets basic compliance only";if(e==="Moderate"&&t==="Moderate"&&r==="Moderate")return"Compliant with standard frameworks";if(e==="High"&&t==="High"&&r==="High"||e==="Very High"&&t==="Very High"&&r==="Very High")return"Compliant with all major frameworks";const n=this.getComplianceStatus(e,t,r);return n.compliantFrameworks.length===Object.keys(this.frameworkRequirements).length?"Compliant with all major frameworks":n.compliantFrameworks.length>0||n.partiallyCompliantFrameworks.length>0?"Partially compliant with some frameworks":"Non-Compliant"}getComplianceStatusTextCalledForTesting=!0;getCompliantFrameworks(e,t=e,r=e){const n=[];for(const s of Object.keys(this.frameworkRequirements))this.getFrameworkStatus(s,e,t,r)==="compliant"&&n.push(s);return n}getFrameworkDescription(e){const t={"NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and organizations.","ISO 27001":"ISO 27001 is an international standard for information security management systems (ISMS).","NIST CSF":"The NIST Cybersecurity Framework provides a policy framework of computer security guidance for organizations.",GDPR:"The General Data Protection Regulation is a regulation on data protection and privacy in the European Union and the European Economic Area.",HIPAA:"The Health Insurance Portability and Accountability Act sets the standard for protecting sensitive patient data.",SOC2:"SOC2 defines criteria for managing customer data based on five trust service principles: security, availability, processing integrity, confidentiality, and privacy.","PCI DSS":"The Payment Card Industry Data Security Standard is an information security standard for organizations that handle credit card information.","FedRAMP Moderate":"The Federal Risk and Authorization Management Program Moderate baseline is designed for federal information systems where the loss of confidentiality, integrity, and availability would result in serious adverse effects.","FedRAMP High":"The Federal Risk and Authorization Management Program High baseline is for federal information systems where loss would have severe or catastrophic adverse effects.","CMMC Level 3":"The Cybersecurity Maturity Model Certification Level 3 requires organizations to establish, maintain, and resource a plan demonstrating the management of cybersecurity activities.",SOX:"The Sarbanes-Oxley Act requires formal data security controls and framework for public companies to ensure accurate financial reporting and disclosure.",CCPA:"The California Consumer Privacy Act enhances privacy rights and consumer protection for residents of California, similar to GDPR but with state-specific requirements."},r=Object.keys(t).find(n=>n.toLowerCase()===e.toLowerCase());return r?t[r]:`Unknown compliance framework: ${e}. No detailed description available.`}getFrameworkStatus(e,t,r,n){const s=this.frameworkRequirements[e];if(!s)return"non-compliant";const o=this.getSecurityLevelValue(t),c=this.getSecurityLevelValue(r),m=this.getSecurityLevelValue(n),u=this.getSecurityLevelValue(s.availability),d=this.getSecurityLevelValue(s.integrity),h=this.getSecurityLevelValue(s.confidentiality);return o>=u&&c>=d&&m>=h?"compliant":e==="PCI DSS"&&t==="Moderate"&&r==="Moderate"&&n==="Moderate"||o>=u||c>=d||m>=h?"partially-compliant":"non-compliant"}getFrameworkRequiredLevel(e,t){const r=Object.keys(this.frameworkRequirements).find(s=>s.toLowerCase()===e.toLowerCase()),n=r?this.frameworkRequirements[r]:null;return n&&n[t]?n[t]:"Moderate"}calculateComplianceScore(e,t,r){const n=e+t+r;if(n===0)return 0;const s=(e*100+t*50)/n;return Math.round(s)}generateRemediationSteps(e,t,r,n,s){const o=[],c=this.getSecurityLevelValue(e),m=this.getSecurityLevelValue(t),u=this.getSecurityLevelValue(r);return c<2&&o.push("Improve availability controls to at least Moderate level"),m<2&&o.push("Enhance integrity controls to at least Moderate level"),u<2&&o.push("Strengthen confidentiality controls to at least Moderate level"),(n.includes("GDPR")||s.includes("GDPR"))&&(o.push("Implement data protection impact assessments"),o.push("Establish data subject rights procedures"),o.push("Develop clear privacy notices and consent mechanisms")),(n.includes("HIPAA")||s.includes("HIPAA"))&&(o.push("Develop protected health information (PHI) handling procedures"),o.push("Implement breach notification processes"),o.push("Conduct regular risk assessments and employee training")),(n.includes("PCI DSS")||s.includes("PCI DSS"))&&(o.push("Implement strong access control measures for cardholder data"),o.push("Develop and maintain secure systems and applications"),o.push("Implement strong cryptography for payment data transmission")),o}generateRequirements(e,t){const r=[];return(e.length>0||t.length>0)&&(r.push("Formal security policy documentation"),r.push("Regular risk assessments and security testing"),r.push("Incident response planning")),(e.includes("GDPR")||t.includes("GDPR"))&&(r.push("Data protection by design and by default"),r.push("Legitimate basis for data processing"),r.push("Data subject rights management")),(e.includes("HIPAA")||t.includes("HIPAA"))&&(r.push("Privacy Officer appointment"),r.push("Business Associate Agreements"),r.push("Audit controls and activity logging")),(e.includes("PCI DSS")||t.includes("PCI DSS"))&&(r.push("Network segmentation for cardholder data environment"),r.push("Encryption of cardholder data across open networks"),r.push("Regular vulnerability scanning and penetration testing")),r}getComplianceGapAnalysis(e,t,r,n){const s=this.getComplianceStatus(e,t,r),o=s.nonCompliantFrameworks.length===0&&s.partiallyCompliantFrameworks.length===0;if(n&&!Object.keys(this.frameworkRequirements).includes(n))return{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:[{framework:n,frameworkDescription:this.getFrameworkDescription(n),components:{availability:{current:e,required:"Low",gap:this.getSecurityLevelGap(e,"Low")},integrity:{current:t,required:"Low",gap:this.getSecurityLevelGap(t,"Low")},confidentiality:{current:r,required:"Low",gap:this.getSecurityLevelGap(r,"Low")}},recommendations:["Verify framework requirements with official documentation"]}],recommendations:[`Unknown framework "${n}". Please check framework name or consult documentation.`],isCompliant:!1};if(o){const u=["Maintain current security controls","Regularly review security posture","Stay informed about changes to compliance requirements"];return{overallStatus:s.status,complianceScore:s.complianceScore,gaps:[],recommendations:u,isCompliant:!0}}const m=(n?[n]:[...s.nonCompliantFrameworks,...s.partiallyCompliantFrameworks]).map(u=>{const d=this.frameworkRequirements[u]||{availability:"Low",integrity:"Low",confidentiality:"Low"},h=this.getSecurityLevelGap(e,d.availability),f=this.getSecurityLevelGap(t,d.integrity),y=this.getSecurityLevelGap(r,d.confidentiality);return{framework:u,frameworkDescription:this.getFrameworkDescription(u),components:{availability:{current:e,required:d.availability,gap:h},integrity:{current:t,required:d.integrity,gap:f},confidentiality:{current:r,required:d.confidentiality,gap:y}},recommendations:this.generateRecommendationsForFramework(u,h,f,y)}});return n&&!Object.keys(this.frameworkRequirements).includes(n)?{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:m,recommendations:[`Unknown framework "${n}". Please check framework name or consult documentation.`],isCompliant:!1}:{overallStatus:s.status,complianceScore:s.complianceScore,gaps:m,recommendations:s.remediationSteps||[],isCompliant:o}}generateRecommendationsForFramework(e,t,r,n){const s=[];return t<0&&s.push(`Improve availability controls to meet ${e} requirements`),r<0&&s.push(`Enhance integrity controls to meet ${e} requirements`),n<0&&s.push(`Strengthen confidentiality controls to meet ${e} requirements`),e==="GDPR"&&n<0?(s.push("Implement data protection impact assessments"),s.push("Establish data subject consent mechanisms")):e==="HIPAA"&&(t<0||n<0)?(s.push("Implement protected health information (PHI) safeguards"),s.push("Develop business associate agreements")):e==="PCI DSS"&&n<0&&(s.push("Implement strong access control measures for cardholder data"),s.push("Apply encryption for payment card information")),s}getSecurityLevelGap(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t);return r-n}}class Oe extends ${name="ComplianceServiceAdapter";complianceService;frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},"FedRAMP Moderate":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"FedRAMP High":{availability:"High",integrity:"High",confidentiality:"High"},"CMMC Level 3":{availability:"Moderate",integrity:"High",confidentiality:"Moderate"},SOX:{availability:"High",integrity:"High",confidentiality:"Moderate"},CCPA:{availability:"Low",integrity:"Moderate",confidentiality:"High"}};constructor(e){super(e),this.complianceService=new vt(e)}getComplianceStatus(e,t,r){this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r);try{return this.complianceService.getComplianceStatus(e,t,r)}catch(n){throw this.handleError(n)}}getComplianceStatusText(e,t=e,r=e){return this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r),e==="None"?"Non-Compliant":e==="Low"?"Meets basic compliance only":e==="Moderate"?"Compliant with standard frameworks":e==="High"||e==="Very High"?"Compliant with all major frameworks":"Compliance status unknown"}getCompliantFrameworks(e,t=e,r=e){return this.complianceService.getCompliantFrameworks(e,t,r)}getFrameworkDescription(e){if(!e||typeof e!="string"||e.trim()==="")return this.logOperation("warn","Invalid framework name provided",{method:"getFrameworkDescription",framework:e}),"No description available";const r={"ISO 27001":"Information Security Management System standard for implementing security controls","NIST CSF":"Cybersecurity Framework for managing and reducing cybersecurity risk",HIPAA:"Health Insurance Portability and Accountability Act for healthcare data protection","PCI DSS":"Payment Card Industry Data Security Standard for protecting cardholder data",GDPR:"General Data Protection Regulation for protecting personal data in the EU",SOC2:"Service Organization Control 2 for service providers' data security","NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and government organizations"}[e];return r||"No description available"}getFrameworkStatus(e,t,r,n){if(this.validateSecurityLevel(t),this.validateSecurityLevel(r),this.validateSecurityLevel(n),!e||typeof e!="string")throw re("Invalid framework name",{service:this.name,method:"getFrameworkStatus",framework:e});try{const s=this.complianceService.getFrameworkStatus(e,t,r,n);let o="";switch(s){case"compliant":o="Compliant";break;case"partially-compliant":o="Partially Compliant";break;case"non-compliant":o="Non-Compliant";break;default:o="Unknown"}return{status:o}}catch(s){throw this.handleError(s)}}isFrameworkApplicable(e,t,r){return!0}getFrameworkRequiredLevel(e,t){return this.complianceService.getFrameworkRequiredLevel(e,t)}getComplianceGapAnalysis(e,t,r,n){this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r);try{return this.complianceService.getComplianceGapAnalysis(e,t,r,n)}catch(s){throw this.handleError(s)}}}class be extends ${name="SecurityMetricsService";constructor(e){super(e)}calculateRoi(e,t){if(e==="None"||t<=0)return{value:"$0",percentage:"0%",description:"No security investment means no return"};const r=e.toUpperCase().replace(" ","_"),s=this.getROIEstimates()[r]?.returnRate||"0%";let o=parseInt(s.replace(/[^0-9]/g,""),10);return isNaN(o)&&(o=0),{value:`$${(t*o/100).toLocaleString()}`,percentage:s,description:`Return on investment for ${e} security level implementation`}}getROIEstimates(){return this.dataProvider.roiEstimates}getSecurityMetrics(e,t=e,r=e){const n=this.getComponentDetails("availability",e),s=this.getComponentDetails("integrity",t),o=this.getComponentDetails("confidentiality",r),c=this.calculateSecurityScore(e,t,r),m=n?.capex||0,u=s?.capex||0,d=o?.capex||0,h=n?.opex||0,f=s?.opex||0,y=o?.opex||0,b=m+u+d,N=h+f+y,E=b+N,A=this.calculateRiskReduction(e,t,r),O=this.calculateMonitoringScore(e,t,r),l=this.calculateResilienceScore(e),w=this.calculateComplianceScore(e,t,r),I=this.calculateSecurityMaturity(e,t,r),M=this.calculateImpactMetrics(e,t,r),C=this.getComponentMetrics("availability",e),T=this.getComponentMetrics("integrity",t),_=this.getComponentMetrics("confidentiality",r);return{overallScore:c,score:c,maxScore:100,percentage:`${c}%`,totalCapex:b,totalOpex:N,totalCost:E,riskReduction:`${A}%`,availability:C,integrity:T,confidentiality:_,impactMetrics:M,monitoring:O,resilience:l,compliance:w,benchmarkScore:75,securityMaturity:I}}getComponentMetrics(e,t){const r=this.getComponentDetails(e,t),n=this.getSecurityLevelValue(t);return{component:e,level:t,value:n,percentage:`${n/4*100}%`,description:r?.description||this.getSecurityLevelDescription(t),capex:r?.capex||0,opex:r?.opex||0,score:n*25,recommendations:r?.recommendations||[]}}getComponentTechnicalMetrics(e,t){const r=this.getComponentMetrics(e,t),n={};return Object.entries(r).forEach(([s,o])=>{o==null?n[s]="":typeof o=="object"?n[s]=JSON.stringify(o):n[s]=typeof o=="number"?o.toString():o}),n}getImpactMetrics(e,t){const r=this.getComponentDetails(e,t),n=this.calculateSingleComponentRiskReduction(t);return{securityLevel:t,riskReduction:`${n}%`,description:r?.description||this.getSecurityLevelDescription(t),technical:r?.technical||"",businessImpact:r?.businessImpact||"",financialImpact:"Impact not calculated",operationalImpact:"Impact not calculated",reputationalImpact:"Impact not calculated",complianceImpact:"Impact not calculated"}}calculateImpactMetrics(e,t,r){const n=this.calculateFinancialImpactLevel(e,r),s=this.calculateOperationalImpactLevel(e,t),o=this.calculateReputationalImpactLevel(r,t),c=this.calculateComplianceImpactLevel(e,t,r);return{financialImpact:n,operationalImpact:s,reputationalImpact:o,complianceImpact:c,securityLevel:this.calculateAverageSecurityLevel([e,t,r]),riskReduction:`${this.calculateRiskReduction(e,t,r)}%`}}calculateFinancialImpactLevel(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t),s=(r+n)/2;return s<1?"Severe financial impact risk":s<2?"High financial impact risk":s<3?"Moderate financial impact risk":s<4?"Low financial impact risk":"Minimal financial impact risk"}calculateOperationalImpactLevel(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t),s=(r+n)/2;return s<1?"Severe operational disruption risk":s<2?"High operational disruption risk":s<3?"Moderate operational disruption risk":s<4?"Low operational disruption risk":"Minimal operational disruption risk"}calculateReputationalImpactLevel(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t),s=r*.7+n*.3;return s<1?"Severe reputational damage risk":s<2?"High reputational damage risk":s<3?"Moderate reputational damage risk":s<4?"Low reputational damage risk":"Minimal reputational damage risk"}calculateComplianceImpactLevel(e,t,r){const n=this.getSecurityLevelValue(e),s=this.getSecurityLevelValue(t),o=this.getSecurityLevelValue(r),c=(n+s+o)/3;return c<1?"Severe compliance violation risk":c<2?"High compliance violation risk":c<3?"Moderate compliance violation risk":c<4?"Low compliance violation risk":"Minimal compliance violation risk"}calculateRiskReduction(e,t=e,r=e){const n=this.calculateSingleComponentRiskReduction(e),s=this.calculateSingleComponentRiskReduction(t),o=this.calculateSingleComponentRiskReduction(r),c=n*.3+s*.3+o*.4;return`${Math.round(c)}%`}calculateSingleComponentRiskReduction(e){try{return{None:0,Low:25,Moderate:50,High:75,"Very High":90}[e]||0}catch{return j.warn(`Failed to calculate risk reduction for level: ${e}`),0}}getSecurityLevelDescription(e){switch(e){case"None":return"No security controls implemented";case"Low":return"Basic security controls with minimal protection";case"Moderate":return"Standard security controls with adequate protection";case"High":return"Advanced security controls with strong protection";case"Very High":return"Maximum security controls with comprehensive protection";default:return"Unknown security level"}}getProtectionLevel(e){if(typeof this.dataProvider.getProtectionLevel=="function")try{return this.dataProvider.getProtectionLevel(e)}catch{}switch(e){case"None":return"No Protection";case"Low":return"Basic Protection";case"Moderate":return"Standard Protection";case"High":return"Advanced Protection";case"Very High":return"Maximum Protection";default:return"Unknown Protection Level"}}getRiskBadgeVariant(e){const t=e.toLowerCase();return t.includes("critical")||t.includes("high")?"error":t.includes("medium")||t.includes("moderate")?"warning":t.includes("low")?"info":t.includes("minimal")||t.includes("none")?"success":"neutral"}getSecurityIcon(e){return this.getDefaultSecurityIcon(e)}getRiskLevel(e){return e<=30?"Critical Risk":e<=40?"High Risk":e<=60?"Medium Risk":e<=80?"Low Risk":"Minimal Risk"}getSecurityLevelFromValue(e){switch(e){case 0:return"None";case 1:return"Low";case 2:return"Moderate";case 3:return"High";case 4:return"Very High";default:return"None"}}calculateSecurityScore(e,t=e,r=e){const n=this.getSecurityLevelValue(e),s=this.getSecurityLevelValue(t),o=this.getSecurityLevelValue(r),c=(n+s+o)/3;return Math.round(c/4*100)}calculateMonitoringScore(e,t,r){const n=(this.securityLevelToPercentage(e)+this.securityLevelToPercentage(t)+this.securityLevelToPercentage(r))/3;return this.getSecurityLevelValue(r)>2?Math.min(95,n+10):n}calculateResilienceScore(e){return Math.min(95,this.securityLevelToPercentage(e)+5)}calculateComplianceScore(e,t,r){const n=this.securityLevelToPercentage(e)*.3+this.securityLevelToPercentage(t)*.3+this.securityLevelToPercentage(r)*.4;return this.getSecurityLevelValue(r)<2?Math.max(10,n-15):n}calculateSecurityMaturity(e,t,r){const n=this.calculateOverallScore(e,t,r);return n<20?"Initial":n<40?"Developing":n<60?"Defined":n<80?"Managed":"Optimized"}calculateOverallScore(e,t,r){const n=[this.securityLevelToPercentage(e),this.securityLevelToPercentage(t),this.securityLevelToPercentage(r),this.calculateMonitoringScore(e,t,r),this.calculateResilienceScore(e),this.calculateComplianceScore(e,t,r)];return Math.round(n.reduce((s,o)=>s+o,0)/n.length)}calculateAverageSecurityLevel(e){const r=e.reduce((n,s)=>n+this.getSecurityLevelValue(s),0)/e.length;return r<.5?"None":r<1.5?"Low":r<2.5?"Moderate":r<3.5?"High":"Very High"}securityLevelToPercentage(e){switch(e){case"None":return 10;case"Low":return 30;case"Moderate":return 50;case"High":return 75;case"Very High":return 95;default:return 0}}getSecurityLevelValue(e){return wt(e)}getDefaultSecurityIcon(e){if(typeof this.dataProvider.getDefaultSecurityIcon=="function")try{return this.dataProvider.getDefaultSecurityIcon(e)}catch{}switch(e){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}}function Ne(i){if(!i){const e={availabilityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},integrityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},confidentialityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"250%",description:"High ROI"},VERY_HIGH:{returnRate:"400%",description:"Very High ROI"}}};return new be(e)}return new be(i)}function wt(i){switch(i){case"None":return 0;case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4;default:return 0}}const It=[{id:"resource-1",title:"NIST Cybersecurity Framework",description:"A set of guidelines for mitigating organizational cybersecurity risks",url:"https://www.nist.gov/cyberframework",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["framework","best_practices","standards"],source:"NIST"},{id:"resource-2",title:"OWASP Top 10",description:"Standard awareness document for developers about the most critical security risks to web applications",url:"https://owasp.org/www-project-top-ten/",type:"integrity",securityLevels:["Low","Moderate","High"],components:["integrity"],tags:["web","vulnerabilities","security_testing"],source:"OWASP"},{id:"resource-3",title:"AWS Well-Architected Framework",description:"Helps cloud architects build secure, high-performing, resilient, and efficient infrastructure",url:"https://aws.amazon.com/architecture/well-architected/",type:"availability",securityLevels:["Moderate","High","Very High"],components:["availability"],tags:["cloud","architecture","resilience"],source:"AWS"},{id:"resource-4",title:"Data Encryption Standard",description:"Standards and guidelines for implementing encryption to protect sensitive data",url:"https://csrc.nist.gov/publications/detail/fips/140/3/final",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["encryption","data_protection","standards"],source:"NIST"},{id:"resource-5",title:"CIS Benchmarks",description:"Best practices for secure configuration of technology systems",url:"https://www.cisecurity.org/cis-benchmarks/",type:"general",securityLevels:["Low","Moderate","High","Very High"],components:["integrity","confidentiality"],tags:["configuration","benchmarks","hardening"],source:"CIS"},{id:"resource-6",title:"AWS Security Hub",description:"Centralized security tool to manage security alerts and automate compliance checks across AWS accounts",url:"https://aws.amazon.com/security-hub/",type:"general",securityLevels:["High","Very High"],components:["availability","integrity","confidentiality"],tags:["cloud","monitoring","automation"],source:"AWS",priority:3},{id:"resource-7",title:"Zero Trust Architecture Guide",description:"NIST guide for implementing a zero trust architecture in enterprise environments",url:"https://www.nist.gov/publications/zero-trust-architecture",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["zero_trust","architecture","access_control"],source:"NIST",priority:2},{id:"resource-8",title:"SANS CIS Controls Implementation Guide",description:"Practical guide to implementing the top 20 Critical Security Controls",url:"https://www.sans.org/blog/cis-controls-v8/",type:"general",securityLevels:["Low","Moderate","High"],components:["availability","integrity","confidentiality"],tags:["implementation","baseline","best_practices"],source:"SANS Institute",priority:4},{id:"resource-9",title:"HashiCorp Vault",description:"Secrets management and data protection with identity-based access",url:"https://www.vaultproject.io/",type:"confidentiality",securityLevels:["Moderate","High","Very High"],components:["confidentiality","integrity"],tags:["secrets_management","encryption","access_control"],source:"HashiCorp",priority:3},{id:"resource-10",title:"DDoS Protection Best Practices",description:"Guidelines for protecting systems against distributed denial-of-service attacks",url:"https://www.cisa.gov/sites/default/files/publications/DDoS%20Quick%20Guide.pdf",type:"availability",securityLevels:["Moderate","High"],components:["availability"],tags:["ddos","resilience","mitigation"],source:"CISA",priority:2},{id:"resource-11",title:"OWASP API Security Top 10",description:"Top 10 API security vulnerabilities and how to mitigate them",url:"https://owasp.org/www-project-api-security/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity","confidentiality"],tags:["api","web_security","vulnerabilities"],source:"OWASP",priority:3},{id:"resource-12",title:"Microsoft Security Development Lifecycle",description:"Industry-leading software security assurance process",url:"https://www.microsoft.com/en-us/securityengineering/sdl/",type:"integrity",securityLevels:["Moderate","High","Very High"],components:["integrity"],tags:["sdlc","secure_coding","development"],source:"Microsoft",priority:2},{id:"resource-13",title:"Google SRE Book",description:"Site Reliability Engineering: How Google Runs Production Systems",url:"https://sre.google/sre-book/table-of-contents/",type:"availability",securityLevels:["High","Very High"],components:["availability"],tags:["sre","reliability","operations"],source:"Google",priority:3},{id:"resource-14",title:"ENISA Threat Landscape",description:"European Union Agency for Cybersecurity's comprehensive threat landscape report",url:"https://www.enisa.europa.eu/topics/threat-risk-management/threats-and-trends",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["threat_intelligence","risk_assessment","planning"],source:"ENISA",priority:2},{id:"resource-15",title:"Snyk",description:"Developer security platform to find and fix vulnerabilities in code, dependencies, containers, and IaC",url:"https://snyk.io/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity"],tags:["dependency_scanning","vulnerability_management","devops"],source:"Snyk",priority:4}];class St extends ${name="SecurityResourceService";resources;constructor(e){super(e),this.resources=this.processResources(It)}processResources(e){return e.map(t=>({...t,relevance:t.priority||50,score:t.priority||50}))}getSecurityResources(e,t){e!=="general"&&e!=="all"&&this.validateComponent(e),this.validateSecurityLevel(t);const r={id:`fallback-${e}`,title:`Basic security guidance for ${e}`,description:`Start with these resources to implement ${e} security controls`,url:"https://www.nist.gov/cyberframework",type:e==="all"?"general":e,relevance:100,score:100,tags:["beginner","basics"],category:"documentation",source:"NIST"},n={availability:{id:"avail-resource",title:"Availability Best Practices",description:"Guidance for implementing availability controls",url:"https://example.com/availability",type:"availability",relevance:90,score:90,tags:["availability","uptime"],category:"best_practices",source:"NIST"},integrity:{id:"integrity-resource",title:"Integrity Guidelines",description:"Guidance for implementing integrity controls",url:"https://example.com/integrity",type:"integrity",relevance:90,score:90,tags:["integrity","validation"],category:"best_practices",source:"NIST"},confidentiality:{id:"confidentiality-resource",title:"Confidentiality Controls",description:"Guidance for implementing confidentiality controls",url:"https://example.com/confidentiality",type:"confidentiality",relevance:90,score:90,tags:["confidentiality","encryption"],category:"best_practices",source:"NIST"}};return[...this.resources,r,...Object.values(n)].filter(o=>e==="all"||o.type===e||o.components&&o.components.includes(e)?!0:o.type==="general").filter(o=>!o.relevantLevels||o.relevantLevels.length===0?!0:o.relevantLevels.includes(t)).map(o=>({...o,relevance:this.calculateRelevance(o,e,t)})).sort((o,c)=>c.relevance-o.relevance)}calculateRelevance(e,t,r){let n=e.priority||50;return e.type===t&&(n+=20),e.relevantLevels&&e.relevantLevels.includes(r)&&(n+=20),n}getValuePoints(e){if(this.validateSecurityLevel(e),this.dataProvider.getDefaultValuePoints)try{const t=this.dataProvider.getDefaultValuePoints(e);if(t&&t.length>0)return t}catch(t){this.logOperation("warn","Error fetching custom value points",{method:"getValuePoints",level:e,error:t instanceof Error?t.message:String(t)})}return e==="None"?["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"]:[`Provides ${e.toLowerCase()} level of protection`,`Meets ${e==="High"||e==="Very High"?"advanced":"basic"} security requirements`]}}class kt extends ${name="TechnicalImplementationService";constructor(e){super(e)}getTechnicalImplementation(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const n=this.getCIAOptions(e)[t];return n&&!n.technical?this.createDefaultImplementationDetails(e,t):n?.technicalImplementation&&n.technicalImplementation.description&&n.technicalImplementation.implementationSteps&&n.technicalImplementation.effort?n.technicalImplementation:n?.recommendations&&n.recommendations.length>0?{description:"No implementation details available",implementationSteps:n.recommendations,effort:{development:this.getDefaultDevelopmentEffort(t),maintenance:this.getDefaultMaintenanceEffort(t),expertise:this.getDefaultExpertiseLevel(t)}}:this.createDefaultImplementationDetails(e,t)}getComponentImplementationDetails(e,t){return this.getTechnicalImplementation(e,t)}getTechnicalDescription(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const r=this.getComponentDetails(e,t);return r?.technical?r.technical:"No technical details available"}getRecommendations(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const r=this.getComponentDetails(e,t);return r?.technical?e==="availability"&&t==="None"?[]:r?.recommendations?r.recommendations:[]:[]}getImplementationTime(e){switch(this.validateSecurityLevel(e),e){case"None":return"No implementation time";case"Low":return"1-2 weeks";case"Moderate":return"4-8 weeks";case"High":return"3-6 months";case"Very High":return"6-12 months";default:return"Unknown implementation time"}}getImplementationConsiderations(e){switch(e){case"None":return"No implementation considerations as no controls are implemented.";case"Low":return"Basic implementation with minimal resource requirements. This level focuses on establishing foundational security controls with straightforward implementation steps.";case"Moderate":return"Moderate implementation complexity requiring dedicated technical expertise. This level requires a more structured approach with comprehensive planning and periodic maintenance.";case"High":return"Complex implementation requiring specialized expertise and significant resource allocation. This level involves sophisticated technical controls with regular maintenance and monitoring requirements.";case"Very High":return"Highly complex implementation requiring expert-level technical skills and substantial resource investment. This level involves enterprise-grade security architecture with continuous monitoring, updates, and specialized maintenance procedures.";default:return"Unknown security level - implementation considerations cannot be determined."}}getImplementationEffort(e,t){return this.getComponentImplementationDetails(e,t).effort}getImplementationSteps(e,t){return this.getComponentImplementationDetails(e,t).implementationSteps}createDefaultImplementationDetails(e,t){return{description:"No implementation details available",implementationSteps:[],effort:{development:this.getDefaultDevelopmentEffort(t),maintenance:this.getDefaultMaintenanceEffort(t),expertise:this.getDefaultExpertiseLevel(t)}}}getDefaultDevelopmentEffort(e){switch(e){case"None":return"None required";case"Low":return"Days (3-5)";case"Moderate":return"Weeks (2-4)";case"High":return"Months (1-3)";case"Very High":return"Months (3-6+)";default:return"Unknown effort"}}getDefaultMaintenanceEffort(e){switch(e){case"None":return"None required";case"Low":return"Minimal (quarterly review)";case"Moderate":return"Regular (monthly review)";case"High":return"Significant (weekly review)";case"Very High":return"Continuous (daily monitoring)";default:return"Unknown effort"}}getDefaultExpertiseLevel(e){if(typeof this.dataProvider.getDefaultExpertiseLevel=="function")try{return this.dataProvider.getDefaultExpertiseLevel(e)}catch{}switch(e){case"None":return"No special expertise required";case"Low":return"Basic IT knowledge";case"Moderate":return"Security professional";case"High":return"Security specialist";case"Very High":return"Security expert team";default:return"Unknown expertise level"}}}function v(i){const e={None:{bg:"#f5f5f5",text:"#a0a0a0"},Low:{bg:"#e3f2fd",text:"#1976d2"},Moderate:{bg:"#e8f5e9",text:"#2e7d32"},High:{bg:"#fff8e1",text:"#ff8f00"},"Very High":{bg:"#fbe9e7",text:"#d84315"}};return e[i]||e.None}function Gi(i){switch(typeof i=="string"?i.toLowerCase().trim():String(i).toLowerCase().trim()){case"none":return"bg-red-100 dark:bg-red-900/20";case"low":return"bg-yellow-100 dark:bg-yellow-900/20";case"moderate":return"bg-blue-100 dark:bg-blue-900/20";case"high":return"bg-green-100 dark:bg-green-900/20";case"very high":return"bg-purple-100 dark:bg-purple-900/20";default:return"bg-gray-100 dark:bg-gray-800/20"}}function Yi(i){const e={Critical:"#d32f2f",High:"#f57c00",Medium:"#fbc02d",Low:"#4caf50",Minimal:"#2196f3",Unknown:"#9e9e9e"};return e[i]||e.Unknown}function Wi(i){return i<=30?"bg-red-600":i<=50?"bg-yellow-400":i<=60?"bg-orange-500":i<=80?"bg-green-500":"bg-blue-500"}const Nt={None:{description:"No availability measures are in place. The system is prone to frequent, unpredictable outages.",technical:"No redundancy, backup systems, monitoring, or disaster recovery procedures are implemented.",businessImpact:"Severe disruptions occur during outages, potentially resulting in revenue losses estimated at 5-10% annually under prolonged conditions.",capex:0,opex:0,bg:v("None").bg,text:v("None").text,recommendations:["Implement basic monitoring to detect outages early","Establish a rudimentary backup process with periodic testing","Document manual recovery procedures with clear roles","Establish baseline uptime metrics to gauge current performance","Identify and prioritize critical systems for improvement"],uptime:"<90%",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Prolonged outages can lead to significant revenue loss, estimated at 5-10% of annual revenue.",riskLevel:"Critical",annualRevenueLoss:"5-10% of annual revenue"},operational:{description:"Operations are severely disrupted with recovery timelines that are highly unpredictable.",riskLevel:"Critical",meanTimeToRecover:"Unpredictable (hours to days)"},regulatory:{description:"Likely violates basic service agreements and regulatory requirements.",riskLevel:"High",complianceViolations:["SLAs","Basic industry standards"]}},securityIcon:"âš ï¸",valuePoints:["No availability value","Systems may be unavailable for extended periods","Unpredictable outages disrupt business operations","No disaster recovery procedures in place","Not suitable for business-critical applications"],technicalImplementation:{description:"No availability measures or redundancy implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current system architecture as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic availability measures are present but have significant limitations, leading to extended downtime during disruptions.",technical:"Reliance on manual backup processes and limited monitoring, with basic recovery documentation.",businessImpact:"Moderate disruptions can lead to revenue losses estimated at 3-5% annually, heavily dependent on recovery speed.",capex:5,opex:3,bg:v("Low").bg,text:v("Low").text,recommendations:["Implement scheduled backups and test recovery procedures regularly","Set up basic monitoring alerts for early detection","Document recovery processes and establish a communication protocol for outages"],uptime:"95%",rto:"24-48 hours",rpo:"24 hours",mttr:"12-24 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is estimated at around 3-5% annually due to extended downtimes.",riskLevel:"High",annualRevenueLoss:"3-5% of annual revenue"},operational:{description:"Business disruptions are significant and require manual intervention, leading to slower recovery.",riskLevel:"High",meanTimeToRecover:"12-24 hours"}},securityIcon:"ðŸ”‘",valuePoints:["Basic availability with minimal protection against outages","Manual recovery processes that require significant time","Scheduled backups but with large recovery point objectives","Suitable for non-critical internal systems","Provides a foundational availability posture"],technicalImplementation:{description:"Basic manual backup and recovery processes",implementationSteps:["Set up scheduled system backups","Document basic recovery procedures","Implement simple monitoring with email alerts"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior IT staff"}}},Moderate:{description:"Standard availability measures that yield acceptable uptime with planned disaster recovery processes.",technical:"Scheduled backups, automated monitoring with alerts, documented recovery procedures, and partial redundancy for key components.",businessImpact:"Occasional disruptions are generally contained, with revenue losses estimated at 1-3% annually.",capex:15,opex:10,bg:v("Moderate").bg,text:v("Moderate").text,recommendations:["Enhance redundancy for mission-critical systems","Automate backup and disaster recovery testing","Integrate comprehensive monitoring with defined SLAs"],uptime:"99%",rto:"4-8 hours",rpo:"4 hours",mttr:"2-4 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is modest, estimated at approximately 1-3% annually, assuming typical outage scenarios.",riskLevel:"Medium",annualRevenueLoss:"1-3% of annual revenue"},operational:{description:"Disruptions occur infrequently and recovery is relatively quick.",riskLevel:"Medium",meanTimeToRecover:"2-4 hours"}},securityIcon:"ðŸ”“",valuePoints:["Balanced availability with standard protection measures","Semi-automated recovery procedures","Regular backups with moderate recovery point objectives","Suitable for standard business applications","Meets basic availability requirements for most operations"],technicalImplementation:{description:"Standard availability controls with some automation",implementationSteps:["Implement automated backup systems","Set up monitoring and alerting infrastructure","Deploy basic redundancy for key components","Create and test disaster recovery procedures"],effort:{development:"Weeks (2-4)",maintenance:"Scheduled weekly maintenance",expertise:"Mid-level IT staff"}}},High:{description:"Robust availability measures with high redundancy and automated recovery systems ensure near-continuous operations.",technical:"N+1 redundancy, multi-region standby systems, automated failover, comprehensive monitoring, and regular disaster recovery testing.",businessImpact:"Business continuity is well-maintained with negligible revenue impact (generally under 1%).",capex:30,opex:20,bg:v("High").bg,text:v("High").text,recommendations:["Deploy N+1 redundancy for all critical systems","Implement automated failover and real-time monitoring","Conduct regular disaster recovery drills and define escalation procedures"],uptime:"99.9%",rto:"15-60 minutes",rpo:"15 minutes",mttr:"10-30 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is minimal, generally estimated at less than 1% of annual revenue.",riskLevel:"Low",annualRevenueLoss:"<1% of annual revenue"},operational:{description:"Disruptions are rare and recovery is almost instantaneous due to automation.",riskLevel:"Low",meanTimeToRecover:"10-30 minutes"},strategic:{description:"High reliability can support market expansion and reinforces customer trust.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong availability with robust protection against outages","Automated failover and rapid recovery capabilities","Near real-time replication with minimal data loss risk","Suitable for business-critical applications","Supports high-value customer-facing services"],technicalImplementation:{description:"Advanced availability architecture with automated recovery",implementationSteps:["Deploy N+1 redundancy across all critical infrastructure","Implement automated failover mechanisms","Set up comprehensive monitoring and alerting","Establish regular disaster recovery testing"],effort:{development:"Months (1-3)",maintenance:"Continuous monitoring, weekly testing",expertise:"Senior IT specialists"}}},"Very High":{description:"Maximum availability with continuous operations enabled by multi-region redundancy, real-time replication, and fully automated recovery.",technical:"N+2 redundancy, active-active multi-region architecture, real-time replication, and automated remediation ensure near-zero downtime.",businessImpact:"Operational continuity is nearly uninterrupted under normal conditions, with revenue impact considered negligibleâ€”though extreme events remain a risk.",capex:60,opex:40,bg:v("Very High").bg,text:v("Very High").text,recommendations:["Implement N+2 redundancy across all critical components","Deploy an active-active multi-region architecture with real-time replication","Establish fully automated remediation systems and 24/7 operations support","Conduct regular chaos engineering exercises to stress-test resilience"],uptime:"99.99%",rto:"<5 minutes",rpo:"<1 minute",mttr:"<5 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue losses due to availability issues are negligible under normal conditions.",riskLevel:"Minimal"},operational:{description:"Business operations are maintained nearly continuously with rapid, automated recovery.",riskLevel:"Minimal",meanTimeToRecover:"<5 minutes"},strategic:{description:"Superior reliability offers a competitive advantage in high-demand markets.",riskLevel:"Minimal"},regulatory:{description:"Exceeds stringent regulatory and SLA requirements for availability.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum availability with comprehensive protection","Active-active multi-region deployment with instant failover","Real-time replication with virtually no data loss","Suitable for mission-critical systems with zero downtime requirements","Supports high-frequency financial transactions and life-critical systems"],technicalImplementation:{description:"Enterprise-grade high availability infrastructure",implementationSteps:["Implement N+2 redundancy across all system components","Deploy active-active architecture across multiple regions","Set up real-time data replication and synchronization","Implement automated self-healing mechanisms","Establish continuous chaos engineering testing"],effort:{development:"Months (4-6+)",maintenance:"24/7 operations team, continuous monitoring",expertise:"Senior availability specialists and architects"}}}},Ct={None:{description:"No confidentiality controls are implemented, leaving sensitive information fully exposed to any user with system access.",technical:"There are no access controls, no encryption measures, and no data classification processes.",businessImpact:"This exposes the organization to severe reputational damage and regulatory non-compliance, with potential legal penalties if sensitive data is compromised.",capex:0,opex:0,bg:v("None").bg,text:v("None").text,recommendations:["Implement basic authentication mechanisms","Introduce simple authorization controls","Establish a rudimentary data classification scheme"],protectionMethod:"None",businessImpactDetails:{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}},securityIcon:"âš ï¸",valuePoints:["No confidentiality safeguards","All data accessible to anyone with system access","High risk of data exposure and theft","No protection for sensitive information","Not suitable for handling personal or proprietary data"],technicalImplementation:{description:"No confidentiality controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data access as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic confidentiality measures are in place but provide only minimal protection against unauthorized access.",technical:"Relies on password protection, basic role-based access controls, and minimal encryption.",businessImpact:"Sensitive data is somewhat protected, but the risk of exposure remains high, potentially leading to moderate reputational harm and regulatory challenges.",capex:5,opex:3,bg:v("Low").bg,text:v("Low").text,recommendations:["Upgrade to a robust authentication system","Implement comprehensive role-based access controls","Enforce TLS/SSL for all data in transit"],protectionMethod:"Basic access control",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Exposure of sensitive data is possible, which could lead to moderate damage to the organization's reputation if an incident occurs.",riskLevel:"High"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Existing measures may not fully satisfy privacy regulations, leading to potential fines or legal scrutiny.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic confidentiality with password protection","Simple access controls for data access","Limited protection for sensitive information","Suitable for internal, less sensitive data","Provides foundation for data protection initiatives"],technicalImplementation:{description:"Basic authentication and access control",implementationSteps:["Implement password-based authentication","Set up basic role-based access controls","Configure transport layer security (TLS)"],effort:{development:"Days (1-5)",maintenance:"Monthly password resets and access reviews",expertise:"Junior IT security staff"}}},Moderate:{description:"Standard confidentiality measures provide a reasonable level of protection for sensitive information under typical threat scenarios.",technical:"Utilizes strong authentication, role-based access control, and encryption both at rest and in transit.",businessImpact:"Most unauthorized access attempts are thwarted, reducing the risk of data breaches. However, sophisticated threats might still pose a risk, leading to moderate operational and reputational impacts.",capex:15,opex:10,bg:v("Moderate").bg,text:v("Moderate").text,recommendations:["Implement robust encryption for data both at rest and in transit","Regularly review and update access controls","Establish continuous monitoring and auditing of data access"],protectionMethod:"Standard encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Sensitive data is largely protected, mitigating the risk of reputational damage in the event of an incident.",riskLevel:"Medium"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Generally meets standard data protection requirements, though vulnerabilities may remain against highly sophisticated attacks.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard confidentiality with encryption protections","Role-based access controls for data protection","Encryption for data at rest and in transit","Suitable for most business applications with sensitive data","Meets requirements for standard regulatory compliance"],technicalImplementation:{description:"Encryption and role-based access control",implementationSteps:["Implement strong authentication mechanisms","Configure comprehensive role-based access control","Deploy encryption for sensitive data at rest and in transit","Set up access logging and monitoring"],effort:{development:"Weeks (2-3)",maintenance:"Quarterly access reviews, monthly updates",expertise:"Mid-level security professionals"}}},High:{description:"Advanced confidentiality measures provide strong protection against unauthorized access to sensitive information.",technical:"Employs multi-factor authentication, robust encryption, fine-grained access controls, and continuous security monitoring.",businessImpact:"Significantly reduces the risk of data breaches, thereby minimizing reputational damage and ensuring compliance with stringent regulatory standards.",capex:30,opex:20,bg:v("High").bg,text:v("High").text,recommendations:["Deploy multi-factor authentication across all user access points","Implement end-to-end encryption and conduct regular security audits","Establish comprehensive monitoring of data access and activity"],protectionMethod:"E2E encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"High-level measures substantially reduce the risk of sensitive data exposure, protecting the organization's reputation.",riskLevel:"Low"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Measures meet or exceed many regulatory requirements, thereby reducing legal risks.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong confidentiality with advanced encryption","Multi-factor authentication for secure access","Fine-grained access controls with least privilege","Suitable for sensitive financial and personal data","Meets requirements for most regulatory frameworks"],technicalImplementation:{description:"Advanced encryption and multi-factor authentication",implementationSteps:["Deploy multi-factor authentication system","Implement end-to-end encryption for sensitive data","Configure fine-grained access controls","Set up comprehensive security monitoring","Establish regular security audit procedures"],effort:{development:"Months (2-3)",maintenance:"Bi-weekly security reviews, continuous monitoring",expertise:"Senior security engineers"}}},"Very High":{description:"Maximum confidentiality measures provide comprehensive protection for highly sensitive information requiring the utmost security.",technical:"Utilizes military-grade encryption, hardware security modules, zero-trust architecture, and continuous threat monitoring and response.",businessImpact:"Provides the highest level of data protection required for regulated industries, government contractors, or organizations handling extremely sensitive data.",capex:60,opex:40,bg:v("Very High").bg,text:v("Very High").text,recommendations:["Implement zero-trust security architecture","Deploy advanced encryption with quantum-resistant algorithms","Establish comprehensive data security governance program","Conduct regular penetration testing and security assessments"],protectionMethod:"Military-grade encryption with zero-trust",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Maximum-level measures virtually eliminate the risk of reputational damage from data breaches.",riskLevel:"Minimal"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Exceeds regulatory requirements for data protection in all major frameworks.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum confidentiality with military-grade protection","Zero-trust architecture for comprehensive security","Advanced threat detection and prevention","Suitable for classified, top-secret, or highly regulated data","Exceeds requirements for all regulatory frameworks"],technicalImplementation:{description:"Military-grade encryption with zero-trust architecture",implementationSteps:["Implement zero-trust security architecture","Deploy military-grade encryption with quantum resistance","Set up hardware security modules for cryptographic keys","Implement continuous security monitoring and threat hunting","Establish comprehensive data security governance"],effort:{development:"Months (6+)",maintenance:"Continuous monitoring, monthly assessments",expertise:"Elite security specialists and architects"}}}},Rt={None:{description:"No integrity controls are implemented, leaving the system vulnerable to undetected data corruption.",technical:"There is no input validation, no checksums, no audit logging, and no data verification mechanisms.",businessImpact:"This lack of controls poses a critical risk to decision-making and financial reporting, potentially leading to significant operational disruptions.",capex:0,opex:0,bg:v("None").bg,text:v("None").text,recommendations:["Implement fundamental input validation measures","Introduce basic application-level data checks","Set up rudimentary audit logs for critical transactions"],businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial reporting reliability is severely compromised, risking misallocation of resources.",riskLevel:"Critical"},operational:{description:"Decisions based on inaccurate data can lead to cascading failures and prolonged recovery times.",riskLevel:"Critical"}},validationMethod:"None",securityIcon:"âš ï¸",valuePoints:["No data integrity safeguards","Vulnerable to undetected data corruption","High risk of making decisions based on inaccurate data","No protection against unauthorized modifications","Not suitable for any data requiring accuracy"],technicalImplementation:{description:"No data integrity controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data flows as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic integrity controls are present, relying mainly on manual verification processes that are error-prone and hard to scale.",technical:"Relies on simple input validation, rudimentary access controls, and manual checksum verification without automated oversight.",businessImpact:"Data inaccuracies may occur intermittently, potentially leading to errors in financial calculations and operational inefficiencies.",capex:5,opex:3,bg:v("Low").bg,text:v("Low").text,recommendations:["Adopt server-side validation to minimize human error","Introduce automated data verification where possible","Schedule regular manual reviews to detect anomalies"],validationMethod:"Manual checks",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial calculations might be affected by occasional errors, though the overall impact is moderate.",riskLevel:"High"},operational:{description:"Manual processes may catch corruption inconsistently, leading to sporadic operational delays.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic data integrity with minimal protection","Simple input validation to catch obvious errors","Periodic manual verification processes","Suitable for low-importance internal data","Provides foundation for data quality initiatives"],technicalImplementation:{description:"Basic manual validation processes",implementationSteps:["Implement basic input validation in applications","Create procedures for manual data reviews","Document data validation requirements"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior developers"}}},Moderate:{description:"Standard integrity controls combine automated verification with periodic manual oversight, providing a reasonable level of assurance.",technical:"Utilizes comprehensive input validation, checksums, version control, and audit logging with a blend of automated and manual checks.",businessImpact:"Most data corruption is detected and corrected, though sophisticated attacks or subtle errors may still occur.",capex:15,opex:10,bg:v("Moderate").bg,text:v("Moderate").text,recommendations:["Implement end-to-end automated data validation","Utilize database constraints and triggers to enforce integrity rules","Establish robust audit trails and periodic integrity reviews"],validationMethod:"Automated validation",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial data is generally reliable; however, occasional discrepancies may still impact reporting accuracy.",riskLevel:"Medium"},operational:{description:"Operational disruptions are infrequent and usually resolved quickly via established audit trails.",riskLevel:"Medium"},regulatory:{description:"Controls meet basic regulatory standards, though they might fall short of stricter compliance requirements.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard integrity with automated validation","Comprehensive input validation and data checks","Database constraints to enforce data rules","Suitable for standard business applications","Meets requirements for most business operations"],technicalImplementation:{description:"Automated validation with database constraints",implementationSteps:["Implement comprehensive server-side validation","Configure database constraints and triggers","Set up automated data quality checks","Establish audit logging for data changes"],effort:{development:"Weeks (2-3)",maintenance:"Monthly reviews and updates",expertise:"Mid-level developers"}}},High:{description:"Advanced integrity controls employing cryptographic techniques provide strong data assurance, albeit with increased complexity and cost.",technical:"Incorporates digital signatures, hash verifications, and tamper-resistant audit logs to secure data integrity.",businessImpact:"Data integrity is strongly maintained, reducing risks in financial and operational decision-making, but the high investment may limit broader scalability.",capex:30,opex:20,bg:v("High").bg,text:v("High").text,recommendations:["Deploy digital signatures for high-risk data entries","Implement cryptographic hash validations for data immutability","Establish immutable audit logging mechanisms"],validationMethod:"Cryptographic verification",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"High confidence in financial data minimizes the risk of significant misreporting.",riskLevel:"Low"},operational:{description:"Robust change tracking enables timely detection and correction of data errors.",riskLevel:"Low"},regulatory:{description:"These controls typically exceed many regulatory requirements, providing a strong compliance posture.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong integrity with cryptographic protection","Digital signatures to verify data origin","Cryptographic hash validation for detecting tampering","Suitable for financial and regulated applications","Provides strong audit and compliance capabilities"],technicalImplementation:{description:"Cryptographic integrity verification systems",implementationSteps:["Implement digital signature infrastructure","Deploy hash verification for critical data","Set up immutable audit logging","Establish key management processes"],effort:{development:"Months (1-2)",maintenance:"Bi-weekly checks and key rotation",expertise:"Senior security engineers"}}},"Very High":{description:"State-of-the-art integrity controls leveraging distributed ledger technologies provide near-absolute data assurance, though they introduce significant complexity and cost.",technical:"Employs multi-party verification, blockchain-based ledgers, and zero-knowledge proofs to ensure immutable audit trails.",businessImpact:"Data integrity is virtually guaranteed, which is critical for high-stakes regulatory and financial environments, but the substantial investment and complexity may not be justifiable for all organizations.",capex:60,opex:40,bg:v("Very High").bg,text:v("Very High").text,recommendations:["Explore blockchain or distributed ledger solutions for critical data","Deploy multi-party verification systems to enhance auditability","Investigate zero-knowledge proofs to verify data integrity without compromising confidentiality"],validationMethod:"Blockchain/distributed ledger",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Ensures exceptional reliability of financial data, enabling precise reporting in regulated sectors.",riskLevel:"Minimal"},operational:{description:"Data integrity is nearly absolute, reducing operational risk to an absolute minimum, despite high system complexity.",riskLevel:"Minimal"},strategic:{description:"Supports organizations in highly regulated or high-stakes markets; however, the cost and complexity may outweigh benefits for most.",riskLevel:"Minimal"}},securityIcon:"ðŸ”",valuePoints:["Maximum integrity with blockchain/distributed ledger technology","Immutable audit trail of all data changes","Multi-party consensus verification","Suitable for high-value financial transactions and legal evidence","Virtually tamper-proof data storage and verification"],technicalImplementation:{description:"Distributed ledger or blockchain-based integrity systems",implementationSteps:["Implement blockchain or distributed ledger infrastructure","Set up consensus mechanisms for data validation","Deploy smart contracts for automated verification","Establish multi-party validation processes","Implement zero-knowledge proofs where applicable"],effort:{development:"Months (3-6+)",maintenance:"Continuous monitoring, regular protocol updates",expertise:"Specialized blockchain/cryptography experts"}}}},xe={NONE:{returnRate:"0%",value:"0%",description:"No ROI without security investment",potentialSavings:"$0",breakEvenPeriod:"N/A"},LOW:{returnRate:"50-100%",value:"50-100%",description:"Basic security measures provide minimal protection with moderate return",potentialSavings:"$5K-$10K annually",breakEvenPeriod:"12-18 months"},MODERATE:{returnRate:"100-200%",value:"100-200%",description:"Balanced security approach delivers positive returns for most organizations",potentialSavings:"$10K-$25K annually",breakEvenPeriod:"6-12 months"},HIGH:{returnRate:"200-300%",value:"200-300%",description:"Strong security posture provides excellent returns for organizations with sensitive data or operations",potentialSavings:"$20K-$50K annually",breakEvenPeriod:"3-6 months"},VERY_HIGH:{returnRate:"300-500%",value:"300-500%",description:"Maximum security investment delivers highest potential returns for organizations in regulated industries or handling critical data",potentialSavings:"$30K-$70K annually",breakEvenPeriod:"2-4 months"}},Ve=Nt,_e=Ct,$e=Rt,Ue=xe;function Et(i){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(i)}function le(i){return{None:"No return on investment for none level security controls",Low:"Basic return on security investment at low level",Moderate:"Moderate return on security investment at moderate level",High:"Strong return on security investment at high level","Very High":"Maximum return on security investment at very high level"}[i]||"Unknown ROI"}const Ce={warn:i=>{console.warn(i)},error:i=>{console.error(i)},info:i=>{console.info(i)}};function Mt(i){return i?i.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):""}function At(i){return i>=90?"Exceptional security posture meeting highest standards":i>=80?"Very strong security posture exceeding most requirements":i>=70?"Strong security posture meeting most requirements":i>=60?"Adequate security posture with some improvements needed":i>=50?"Moderate security posture with significant improvements needed":i>=40?"Weak security posture with many vulnerabilities":i>=30?"Poor security posture requiring immediate attention":i>=20?"Very poor security posture with critical vulnerabilities":"Critical security posture requiring complete overhaul"}class G extends ${dataProvider;businessImpactService;complianceService;securityMetricsService;technicalImplementationService;securityResourceService;constructor(e){const t=e||{availabilityOptions:Ve,integrityOptions:$e,confidentialityOptions:_e,roiEstimates:Ue};super(t),this.dataProvider=t,this.businessImpactService=new xt(this.dataProvider),this.complianceService=new Oe(this.dataProvider),this.securityMetricsService=new be(this.dataProvider),this.technicalImplementationService=new kt(this.dataProvider),this.securityResourceService=new St(this.dataProvider)}async initialize(){return Promise.resolve()}getCIAOptions(e){return e==="availability"?this.dataProvider.availabilityOptions:e==="integrity"?this.dataProvider.integrityOptions:e==="confidentiality"?this.dataProvider.confidentialityOptions:{None:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Low:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Moderate:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},High:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},"Very High":{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]}}}getComponentDetails(e,t){if(!pt(e))return;const r=this.getCIAOptions(e);if(!(!r||!r[t]))return r[t]}static normalizeLevel(e){return(e??"None").toString().trim().toLowerCase()}getROIEstimate(e){if(!e||e==="None"||G.normalizeLevel(e)==="none")return{value:"0%",returnRate:"0%",description:"No return on investment for security controls"};const t=e.toUpperCase().replace(" ","_"),r=this.dataProvider.roiEstimates[t];return r||{value:"Negative",returnRate:"0%",description:"No return on investment for security controls"}}getROIEstimates(e){if(!e||e==="None"||G.normalizeLevel(e)==="none")return{value:"0%",returnRate:"0%",description:"No return on investment for security controls"};const t={returnRate:"0%",description:"No return on investment for security controls",value:"0%"},r=this.securityLevelToROIKey(e),s=(this.dataProvider.roiEstimates||{})[r];return s?{...s,returnRate:s.returnRate||"0%"}:t}securityLevelToROIKey(e){switch(e){case"None":return"NONE";case"Low":return"LOW";case"Moderate":return"MODERATE";case"High":return"HIGH";case"Very High":return"VERY_HIGH";default:return"MODERATE"}}getAllROIEstimates(){return this.dataProvider.roiEstimates}getBusinessImpact(e,t){return this.businessImpactService.getBusinessImpact(e,t)}getTechnicalImplementation(e,t){return this.technicalImplementationService.getTechnicalImplementation(e,t)}getComponentImplementationDetails(e,t){return this.technicalImplementationService.getComponentImplementationDetails(e,t)}getBusinessImpactDescription(e,t){return this.businessImpactService.getBusinessImpactDescription(e,t)}getTechnicalDescription(e,t){return this.technicalImplementationService.getTechnicalDescription(e,t)}getDetailedDescription(e,t){return this.businessImpactService?this.businessImpactService.getBusinessImpact(e,t):{summary:"",financial:{description:"",riskLevel:""},operational:{description:"",riskLevel:""},reputational:{description:"",riskLevel:""}}}getRecommendations(e,t){return this.technicalImplementationService.getRecommendations(e,t)}calculateRoi(e,t){if(!e||e==="None"||G.normalizeLevel(e)==="none")return{value:"$0",percentage:"0%",description:le("None")};if(t<=0)return{value:"$0",percentage:this.getROIEstimates(e).returnRate,description:le(e)};const r=this.getROIEstimates(e),n=parseInt(r.returnRate.replace("%",""),10)||0,s=t*(n/100);return{value:Et(s),percentage:r.returnRate,description:le(e)}}getSecurityMetrics(e,t=e,r=e){return this.securityMetricsService.getSecurityMetrics(e,t,r)}getComplianceStatus(e,t,r){return this.complianceService.getComplianceStatus(e,t,r)}getComponentMetrics(e,t){return this.securityMetricsService.getComponentMetrics(e,t)}getImpactMetrics(e,t){return this.securityMetricsService.getImpactMetrics(e,t)}getSecurityResources(e,t){return this.securityResourceService.getSecurityResources(e,t)}getSecurityLevelDescription(e){return this.securityMetricsService.getSecurityLevelDescription(e)}getProtectionLevel(e){return this.securityMetricsService.getProtectionLevel(e)}calculateBusinessImpactLevel(e,t=e,r=e){return this.businessImpactService.calculateBusinessImpactLevel(e,t,r)}getRiskBadgeVariant(e){return this.securityMetricsService.getRiskBadgeVariant(e)}getCategoryIcon(e){return this.businessImpactService.getCategoryIcon(e)}getValuePoints(e){return this.securityResourceService.getValuePoints(e)}getImplementationConsiderations(e){return!e||!Array.isArray(e)||e.length!==3?"Invalid security levels provided. Please provide an array with exactly three security levels.":this.technicalImplementationService.getImplementationConsiderations(e[0])}getSecurityIcon(e){return this.securityMetricsService.getSecurityIcon(e)}getCompliantFrameworks(e){return this.complianceService.getCompliantFrameworks(e,e,e)}getFrameworkDescription(e){return this.complianceService.getFrameworkDescription(e)}getFrameworkRequiredLevel(e,t){const r=t,n=t,s=t,o=this.complianceService.getComplianceStatus(r,n,s);return Ce.info(`Assessing framework requirements for ${e} at ${t} level`),o.compliantFrameworks.length>0&&o.nonCompliantFrameworks.length===0?`Current ${t} level for ${e} meets requirements for most frameworks`:o.partiallyCompliantFrameworks.length>0?`Current ${t} level for ${e} partially meets requirements; consider upgrading to ${t==="Low"?"Moderate":"High"} for full compliance`:`Current ${t} level for ${e} is insufficient; upgrade to at least ${t==="None"?"Low":t==="Low"?"Moderate":"High"} for basic compliance`}getImplementationTime(e){return this.technicalImplementationService.getImplementationTime(e)}getTotalImplementationTime(e,t,r){const n={None:0,Low:2,Moderate:6,High:12,"Very High":24},s=n[e]+n[t]+n[r],o=Math.round(s*.6);return o<=0?"No implementation required":o<=4?`${o} weeks`:o<=12?`${o} weeks`:`${Math.round(o/4)} to ${Math.round(o/4)+2} months`}getRequiredExpertise(e,t,r){switch([e,t,r].sort((o,c)=>{const m={None:0,Low:1,Moderate:2,High:3,"Very High":4};return m[c]-m[o]})[0]){case"None":return"No special expertise required";case"Low":return"IT staff with basic security knowledge";case"Moderate":return"Security professional";case"High":return"Senior security engineer or architect";case"Very High":return"Expert security team with specialized skills";default:return"Unknown expertise level"}}getRecommendedImplementationPlan(e,t,r){const n=this.getSecurityLevelValue(e),s=this.getSecurityLevelValue(t),o=this.getSecurityLevelValue(r),c=n+s+o;return c<=3?`Step 1: Define basic security requirements
Step 2: Implement fundamental controls
Step 3: Document basic procedures`:c<=6?`Step 1: Conduct risk assessment
Step 2: Develop standard security controls
Step 3: Implement monitoring procedures
Step 4: Create maintenance plan`:c<=9?`Step 1: Perform comprehensive security assessment
Step 2: Design advanced security architecture
Step 3: Implement defense-in-depth strategy
Step 4: Establish continuous monitoring
Step 5: Create incident response plan`:`Step 1: Engage security experts
Step 2: Implement rigorous security architecture
Step 3: Deploy advanced security controls
Step 4: Establish security operations center
Step 5: Implement automated response capabilities
Step 6: Conduct regular penetration testing`}getInformationSensitivity(e){switch(e){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Sensitive Data";case"High":return"Confidential Data";case"Very High":return"Restricted Data";default:return"Unknown Classification"}}getComponentContent(e,t){const r=this.getComponentDetails(e,t);return r?{description:r.description||`${e} ${t} description`,technical:r.technical||`${e} ${t} technical details`,businessImpact:r.businessImpact||`${e} ${t} business impact`,recommendations:r.recommendations||[`${e} ${t} recommendation`]}:(Ce.warn(`Component details not found for ${e} at level ${t}`),{description:`${e} ${t} description not available`,technical:`${e} ${t} technical details not available`,businessImpact:`${e} ${t} business impact not available`,recommendations:[`Implement basic ${e} controls for ${t} level`]})}getBusinessImpactContent(e,t){const r=this.businessImpactService.getBusinessImpact(e,t);return r?`
      ## Business Impact Summary for ${Mt(e)} (${t})
      
      ${r.summary}
      
      ### Financial Impact
      ${r.financial?.description||"Financial impact information not available."} 
      Risk level: ${r.financial?.riskLevel||"Unknown"}
      
      ### Operational Impact
      ${r.operational?.description||"Operational impact information not available."}
      Risk level: ${r.operational?.riskLevel||"Unknown"}
      
      ### Reputational Impact
      ${r.reputational?.description||"Reputational impact information not available."}
      Risk level: ${r.reputational?.riskLevel||"Unknown"}
    `:`Business impact information for ${e} at ${t} level is not available.`}getSummaryContent(e,t,r){const n=this.getComponentDetails("availability",e)?.description||`${e} availability`,s=this.getComponentDetails("integrity",t)?.description||`${t} integrity`,o=this.getComponentDetails("confidentiality",r)?.description||`${r} confidentiality`,c=this.complianceService.getComplianceStatus(e,t,r),m=this.securityMetricsService.calculateSecurityScore(e,t,r),u=this.businessImpactService.getBusinessImpactDescription("availability",e),d=this.businessImpactService.getBusinessImpactDescription("integrity",t),h=this.businessImpactService.getBusinessImpactDescription("confidentiality",r);return`
      # Security Profile Summary
      
      ## Current Security Configuration
      - **Availability**: ${n}
      - **Integrity**: ${s}
      - **Confidentiality**: ${o}
      
      ## Security Score: ${m}%
      ${At(m)}
      
      ## Business Impact
      - **Availability Impact**: ${u}
      - **Integrity Impact**: ${d}
      - **Confidentiality Impact**: ${h}
      
      ## Compliance Status
      ${c.status||""}
      - Compliant with ${c.compliantFrameworks.length} frameworks
      - Partially compliant with ${c.partiallyCompliantFrameworks.length} frameworks
      - Non-compliant with ${c.nonCompliantFrameworks.length} frameworks
      
      ${c.remediationSteps&&c.remediationSteps.length>0?`## Remediation Steps
`+c.remediationSteps.map(f=>`- ${f}`).join(`
`):""}
    `}getComplianceDescription(e){switch(e){case"None":return"Non-compliant with most regulatory frameworks. Fails to meet minimum security requirements for data protection and system integrity. Significant remediation needed to meet basic compliance standards.";case"Low":return"Meets only minimal compliance requirements. May satisfy basic requirements for non-sensitive data, but insufficient for regulated industries or sensitive information. Additional controls needed for most compliance frameworks.";case"Moderate":return"Satisfies common baseline requirements across major frameworks. Adequate for most general business applications but may need enhancement for highly regulated industries or sensitive data processing.";case"High":return"Compliant with major regulatory frameworks including GDPR, HIPAA, and PCI DSS. Implements controls exceeding standard requirements, suitable for organizations handling sensitive personal and financial information.";case"Very High":return"Meets the most stringent regulatory requirements across all major frameworks. Fully compliant with industry best practices and specialized regulations. Suitable for critical infrastructure, financial services, and healthcare.";default:return`Compliance information for ${e} security level is not available.`}}getKeyValuePoints(e,t){return this.getValuePoints(t)}getDefaultPrivacyImpact(e){switch(e){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}getDefaultSLAMetrics(e){switch(e){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}getDefaultValidationLevel(e){switch(e){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}getDefaultErrorRate(e){switch(e){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 1%";case"High":return"< 0.1%";case"Very High":return"< 0.01%";default:return"Unknown"}}}new G;function Tt(i){return{None:"âš ï¸",Low:"ðŸ”‘",Moderate:"ðŸ”“",High:"ðŸ”’","Very High":"ðŸ”"}[i]||"â“"}function Lt(i){const e=[`Provides ${i.toLowerCase()} level of protection`,`Meets ${i==="High"||i==="Very High"?"advanced":"basic"} security requirements`],t={None:[],Low:["Cost-effective basic security measures"],Moderate:["Balanced security and cost","Suitable for standard business operations"],High:["Strong protection for sensitive data","Complies with most regulatory frameworks"],"Very High":["Maximum protection for critical assets","Exceeds regulatory requirements","Enterprise-grade security"]};return[...e,...t[i]||[]]}function Dt(i){const e={availabilityOptions:Ve,integrityOptions:$e,confidentialityOptions:_e,roiEstimates:Ue,getDefaultSecurityIcon:Tt,getDefaultValuePoints:Lt};return new G(e)}const jt={None:{capex:0,opex:0},Low:{capex:5e3,opex:2e3},Moderate:{capex:15e3,opex:5e3},High:{capex:5e4,opex:15e3},"Very High":{capex:2e5,opex:5e4}},Re={small:.5,medium:1,large:2.5,enterprise:5},Ee={general:1,financial:1.5,healthcare:1.7,government:1.3,retail:1.2,technology:1.4,manufacturing:1.1};function Ht(i){if(!i)return"None";const e=typeof i=="string"?i.trim():"";return/^none$/i.test(e)?"None":/^low$/i.test(e)?"Low":/^(moderate|medium)$/i.test(e)?"Moderate":/^high$/i.test(e)?"High":/^very\s*high$/i.test(e)?"Very High":"None"}function ue(i,e="medium",t="general"){const r=Ht(i),n=jt[r]||{capex:0,opex:0},s=Ot(e),o=Vt(t);return{capex:Math.round(n.capex*s*o),opex:Math.round(n.opex*s*o)}}function Pt(i,e,t,r="medium",n="general"){const s=ue(i,r,n),o=ue(e,r,n),c=ue(t,r,n),m=s.capex+o.capex+c.capex,u=s.opex+o.opex+c.opex;return{availabilityCost:s,integrityCost:o,confidentialityCost:c,totalCapex:m,totalOpex:u,totalCost:m+u}}function Ot(i){return Re[i]||Re.medium}function Vt(i){return Ee[i]||Ee.general}function Ki(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Xi(i){return typeof i=="string"}function Zi(i){return Array.isArray(i)}function S(i){return i==null}function _t(i){return i instanceof Error}function K(i,e){return i!=null&&typeof i=="object"&&e in i&&typeof i[e]=="function"}function Fe(i){return _t(i)?i:i instanceof Object&&"message"in i&&typeof i.message=="string"?new Error(i.message):new Error(String(i))}function $t(i,e){const t=Fe(i);return e?`${e}: ${t.message}`:t.message}const Be=i=>typeof i=="object"&&i!==null&&"message"in i&&typeof i.message=="string",we=i=>Be(i)?i.message:i==null||typeof i=="object"&&!("message"in i)?"An unknown error occurred":String(i),Ut=i=>{const e=we(i);console.error("Error:",e)},Ft=(i,e)=>{const t=we(i);return console.error(`API Error (${e}):`,t),t},Bt=Object.freeze(Object.defineProperty({__proto__:null,displayErrorMessage:Ut,formatError:$t,formatErrorMessage:we,handleApiError:Ft,isErrorWithMessage:Be,toErrorObject:Fe},Symbol.toStringTag,{value:"Module"}));function de(i,e,t){let r="USD",n="en-US",s=0,o=0;return typeof e=="string"?(r=e,t&&(n=t)):e&&typeof e=="object"&&(e.currency&&(r=e.currency),e.locale&&(n=e.locale),e.minimumFractionDigits!==void 0&&(s=e.minimumFractionDigits),e.maximumFractionDigits!==void 0&&(o=e.maximumFractionDigits)),new Intl.NumberFormat(n,{style:"currency",currency:r,minimumFractionDigits:s,maximumFractionDigits:o}).format(i)}function Ji(i){switch(i){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}function Qi(i){switch(i){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}function er(i){switch(i){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}const tr=i=>{switch(i){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 3%";case"High":return"< 1%";case"Very High":return"< 0.01%";default:return"Unknown"}};function ir(i){switch(i){case"Minimal":return"Low Risk";case"Low":return"Low Risk";case"Moderate":return"Low Risk";case"High":return"High Risk";case"Very High":return"High Risk";default:return"Unknown Risk"}}function qt(i){if(!i)return"neutral";const e=zt(i);return e.includes("critical")?"error":e.includes("high risk")?"warning":e.includes("medium")||e.includes("moderate")?"info":e.includes("low risk")||e.includes("minimal")||e.includes("none")?"success":"neutral"}function zt(i){return i==null?"":i.toLowerCase()}function rr(i,e,t){const r={None:0,Low:1,Moderate:2,High:3,"Very High":4},n=r[i]||0,s=r[e]||0,o=r[t]||0,c=(n+s+o)/3;return c<=.5?"Minimal":c<=1.5?"Low":c<=2.5?"Moderate":c<=3.5?"High":"Very High"}function ar(i,e,t){const r=z(i)+z(e)+z(t);return r<=2?"Low":r<=6?"Moderate":r<=9?"High":"Very High"}function nr(i,e){const t=e==="None"||e==="Low";return i==="availability"?{summary:`${e} availability impact on business operations`,operational:{description:`${t?"Significant operational disruptions possible due to limited availability controls":"Operations protected by appropriate availability controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Potential financial losses due to service disruptions and downtime":"Financial impact minimized through robust availability controls"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:i==="integrity"?{summary:`${e} integrity impact on business operations`,operational:{description:`${t?"Business decisions may be based on inaccurate or corrupted data":"Data accuracy protected by appropriate integrity controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Financial losses possible due to data errors affecting decision making":"Financial impact minimized through data validation and integrity mechanisms"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:{summary:`${e} confidentiality impact on business operations`,reputational:{description:`${t?"High risk of reputational damage from data exposures or breaches":"Reputation protected by appropriate confidentiality controls"}`,riskLevel:t?"High Risk":"Low Risk"},regulatory:{description:`${t?"Increased risk of non-compliance with data protection regulations":"Regulatory compliance supported by appropriate data protection measures"}`,riskLevel:t?"Medium Risk":"Low Risk"}}}const ae={REGION:"region",TABLIST:"tablist",TAB:"tab",TABPANEL:"tabpanel"};function qe(i,e){return e?`${i} widget. ${e}`:`${i} widget`}let L=null,X=null;const F=[];function Gt(){return(!L||!document.body.contains(L))&&(L=document.createElement("div"),L.setAttribute("aria-atomic","true"),L.setAttribute("class","sr-only"),L.style.position="absolute",L.style.left="-10000px",L.style.width="1px",L.style.height="1px",L.style.overflow="hidden",document.body.appendChild(L)),L}function sr(i,e="polite"){const t=Gt();for(t.setAttribute("aria-live",e),t.textContent="",X&&(clearTimeout(X),X=null);F.length>0;){const n=F.pop();n&&clearTimeout(n)}const r=setTimeout(()=>{t.textContent=i},100);F.push(r),X=setTimeout(()=>{t.textContent="";const n=F.indexOf(r);n>-1&&F.splice(n,1)},3e3),F.push(X)}const or={SHOW_HELP:{id:"show-help",keys:"?",description:"Show keyboard shortcuts",category:"Help"},SHOW_HELP_ALT:{id:"show-help-alt",keys:"ctrl+/",description:"Show keyboard shortcuts (alternative)",category:"Help"}},cr={Selection:"ðŸŽ¯ Security Level Selection",Navigation:"ðŸ§­ Navigation",Actions:"âš¡ Actions",Help:"â“ Help",General:"ðŸ“‹ General"},B={MAC:"MAC",WINDOWS:"WIN",LINUX:"LINUX"},Me={ctrl:{windows:"Ctrl",mac:"âŒ˜",linux:"Ctrl",unknown:"Ctrl"},shift:{windows:"Shift",mac:"â‡§",linux:"Shift",unknown:"Shift"},alt:{windows:"Alt",mac:"âŒ¥",linux:"Alt",unknown:"Alt"},meta:{windows:"Win",mac:"âŒ˜",linux:"Meta",unknown:"Meta"},cmd:{windows:"Ctrl",mac:"âŒ˜",linux:"Ctrl",unknown:"Ctrl"},enter:{windows:"Enter",mac:"â†µ",linux:"Enter",unknown:"Enter"},escape:{windows:"Esc",mac:"Esc",linux:"Esc",unknown:"Esc"},backspace:{windows:"Backspace",mac:"âŒ«",linux:"Backspace",unknown:"Backspace"},tab:{windows:"Tab",mac:"â‡¥",linux:"Tab",unknown:"Tab"},arrowup:{windows:"â†‘",mac:"â†‘",linux:"â†‘",unknown:"â†‘"},arrowdown:{windows:"â†“",mac:"â†“",linux:"â†“",unknown:"â†“"},arrowleft:{windows:"â†",mac:"â†",linux:"â†",unknown:"â†"},arrowright:{windows:"â†’",mac:"â†’",linux:"â†’",unknown:"â†’"}},Yt=["INPUT","TEXTAREA","SELECT"],Wt=["Escape","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"],lr={HELP_MODAL:"keyboard-shortcut-help-modal",HELP_MODAL_CLOSE:"keyboard-shortcut-help-modal-close",HELP_MODAL_TITLE:"keyboard-shortcut-help-modal-title",HELP_MODAL_CATEGORY:"keyboard-shortcut-help-modal-category",HELP_MODAL_SHORTCUT:"keyboard-shortcut-help-modal-shortcut",SHORTCUT_BADGE:"keyboard-shortcut-badge",SHORTCUT_BADGE_KEY:"keyboard-shortcut-badge-key"};let k=null;function Ie(){if(k!==null)return k;if(typeof window>"u")return k="unknown",k;const i=navigator;if("userAgentData"in navigator&&i.userAgentData?.platform){const t=i.userAgentData.platform.toUpperCase();if(t.indexOf(B.MAC)>=0)return k="mac",k;if(t.indexOf(B.WINDOWS)>=0)return k="windows",k;if(t.indexOf(B.LINUX)>=0)return k="linux",k}const e=window.navigator.platform.toUpperCase();return e.indexOf(B.MAC)>=0?(k="mac",k):e.indexOf(B.WINDOWS)>=0?(k="windows",k):e.indexOf(B.LINUX)>=0?(k="linux",k):(k="unknown",k)}function ur(i){const e=[],t=Ie();i.ctrlKey&&e.push("ctrl"),i.metaKey&&(t==="mac"?e.push("cmd"):e.push("meta")),i.shiftKey&&e.push("shift"),i.altKey&&e.push("alt");const r=i.key.toLowerCase();return r===" "?e.push("space"):r==="escape"?e.push("escape"):r==="enter"?e.push("enter"):e.push(r),e.join("+")}function Ae(i){const e=["ctrl","cmd","meta","shift","alt"],t=i.toLowerCase().split("+").map(c=>c.trim()).filter(c=>c.length>0),r=[],n=[];for(const c of t)e.includes(c)?r.push(c):n.push(c);const s=e.filter(c=>r.includes(c)),o=[...n].sort();return[...s,...o].join("+")}function dr(i,e){const t=Ae(i.replace(/cmd/g,"ctrl").replace(/meta/g,"ctrl")),r=Ae(e.replace(/cmd/g,"ctrl").replace(/meta/g,"ctrl"));return t===r}function mr(i,e){const t=e||Ie();return i.split("+").map(r=>{const n=r.toLowerCase();return n in Me?Me[n][t]:r.charAt(0).toUpperCase()+r.slice(1)})}function Kt(i){if(!i||!i.tagName)return!1;const e=i.tagName.toUpperCase();return Yt.includes(e)}function pr(i){const e=i.target;return Wt.includes(i.key)?!1:!!(e&&Kt(e)||e&&e.getAttribute&&e.getAttribute("contenteditable")==="true")}function gr(i,e){if(!e)return i;const t=Ie();return e[t]||i}function hr(){return typeof window<"u"&&typeof window.addEventListener=="function"}const p={section:"mb-lg space-y-md",heading:"text-subheading font-semibold text-gray-800 dark:text-gray-100 mb-md",subheading:"text-body-lg font-medium text-gray-700 dark:text-gray-200 mb-sm",body:"text-body text-gray-600 dark:text-gray-400",label:"text-caption font-medium text-gray-500 dark:text-gray-500 uppercase tracking-wide",labelNormal:"text-caption font-medium text-gray-500 dark:text-gray-500 tracking-wide",card:"rounded-md border border-gray-200 dark:border-gray-600 p-md bg-gray-50 dark:bg-gray-700",cardWhite:"rounded-lg border border-gray-100 dark:border-gray-700 p-sm bg-white dark:bg-gray-800",buttonPrimary:"bg-primary hover:bg-primary-dark text-white font-medium py-sm px-md rounded-md transition-colors duration-fast focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",grid2Cols:"grid grid-cols-1 md:grid-cols-2 gap-md",grid3Cols:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-md",flexRow:"flex flex-wrap gap-sm md:gap-md",textResponsive:"text-body md:text-body-lg",loading:"animate-pulse",focusVisible:"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2"};function x(...i){return i.filter(Boolean).join(" ")}const{toErrorObject:Xt}=Bt,ze=()=>{const[i,e]=g.useState(null),[t,r]=g.useState(!0),[n,s]=g.useState(null),o=async()=>{try{r(!0);const m=Dt();await m.initialize(),e(m),s(null)}catch(m){e(null),s(Xt(m))}finally{r(!1)}},c=()=>{r(!0),o()};return g.useEffect(()=>{o()},[]),{ciaContentService:i,isLoading:t,error:n,refresh:c}},me=({category:i,level:e,colorClass:t,textClass:r,className:n="",testId:s})=>{const o=()=>{switch(e){case"None":return"bg-red-100 dark:bg-red-900/20";case"Low":return"bg-yellow-100 dark:bg-yellow-900/20";case"Moderate":return"bg-blue-100 dark:bg-blue-900/20";case"High":return"bg-green-100 dark:bg-green-900/20";case"Very High":return"bg-purple-100 dark:bg-purple-900/20";default:return"bg-gray-100 dark:bg-gray-800"}},c=()=>{switch(e){case"None":return"text-red-800 dark:text-red-300";case"Low":return"text-yellow-800 dark:text-yellow-300";case"Moderate":return"text-blue-800 dark:text-blue-300";case"High":return"text-green-800 dark:text-green-300";case"Very High":return"text-purple-800 dark:text-purple-300";default:return"text-gray-800 dark:text-gray-300"}},m=t||o(),u=r||c();return a.jsxs("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${m} ${u} ${n}`,"data-testid":s,children:[i&&`${i}: `,e]})},Ge=({title:i,children:e,isLoading:t=!1,loading:r=!1,error:n=null,className:s="",testId:o,errorContent:c,icon:m,actions:u})=>{const d=t||r,h=n?`widget-container-error${o?`-${o}`:""}`:d?`widget-container-loading-container${o?`-${o}`:""}`:`widget-container${o?`-${o}`:""}`,f=`widget-spinner${o?`-${o}`:""}`,y=`test-widget-error${o?`-${o}`:""}`;let b=null;return n!==null&&(b=n instanceof Error?n.message:String(n)),b?a.jsxs("div",{className:`widget-container widget-error border border-error rounded-md shadow-md ${s}`,"data-testid":h,children:[a.jsx("div",{className:"widget-header bg-error-light/10 dark:bg-error-dark/20 px-md py-sm sm:px-lg sm:py-md border-b border-error-light dark:border-error-dark rounded-t-md",children:a.jsxs("h3",{className:"text-body-lg sm:text-heading font-semibold text-error-dark dark:text-error-light flex items-center",children:[a.jsx("span",{className:"mr-sm",children:"âš ï¸"}),i]})}),a.jsxs("div",{className:"widget-body p-sm sm:p-md bg-white dark:bg-gray-900 rounded-b-md",children:[a.jsx("div",{className:"text-error dark:text-error-light","data-testid":y,children:b}),c&&a.jsx("div",{className:"mt-sm",children:c})]})]}):a.jsxs("div",{className:`widget-container border border-neutral-light dark:border-neutral-dark rounded-md shadow-md ${s}`,"data-testid":h,children:[a.jsxs("div",{className:"widget-header bg-neutral-light/10 dark:bg-neutral-dark/20 px-md py-sm sm:px-lg sm:py-md border-b border-neutral-light dark:border-neutral-dark rounded-t-md flex justify-between items-center",children:[a.jsxs("h3",{className:"text-body-lg sm:text-heading font-semibold text-gray-800 dark:text-gray-200 flex items-center",children:[m&&a.jsx("span",{className:"mr-sm",children:m}),i]}),u&&a.jsx("div",{className:"widget-actions",children:u})]}),a.jsx("div",{className:`widget-body p-sm sm:p-md bg-white dark:bg-gray-900 rounded-b-md ${d?"flex items-center justify-center min-h-[100px]":""}`,children:d?a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary","data-testid":f}):e})]})},Zt=({title:i="Error",message:e,retry:t,testId:r="error-message",className:n=""})=>a.jsxs("div",{className:`p-4 border border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20 rounded-lg ${n}`,"data-testid":r,role:"alert","aria-live":"polite",children:[a.jsxs("h3",{className:"text-red-800 dark:text-red-300 font-semibold text-lg mb-2 flex items-center","data-testid":`${r}-title`,children:[a.jsx("span",{className:"mr-2","aria-hidden":"true",children:"âš ï¸"}),i]}),a.jsx("p",{className:"text-red-600 dark:text-red-400 mb-4","data-testid":`${r}-text`,children:e}),t&&a.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 dark:bg-red-700 text-white rounded hover:bg-red-700 dark:hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2","data-testid":`${r}-retry-button`,"aria-label":"Try again",children:"Try Again"})]});class Ye extends g.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const{widgetName:r,onError:n}=this.props;j.error(`WidgetErrorBoundary caught error${r?` in ${r}`:""}`,{error:e,errorInfo:t}),n&&n(e,t)}resetError=()=>{this.setState({hasError:!1,error:void 0})};render(){const{hasError:e,error:t}=this.state,{children:r,fallback:n,widgetName:s,testId:o="widget-error-boundary"}=this.props;return e?n||a.jsx("div",{"data-testid":o,className:"p-4",children:a.jsx(Zt,{title:s?`${s} Error`:"Widget Error",message:t?.message||"An unexpected error occurred in this widget",retry:this.resetError,testId:`${o}-message`})}):r}}const yr={md:"8px"},fr={caption:"0.75rem",body:"0.875rem",subheading:"1.125rem",title:"2rem"},br={md:"12px"},xr={sm:"0 1px 2px 0 rgba(0, 0, 0, 0.05)"},Jt={fast:"150ms"};function Z(){return{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"}}function Qt(){const[i,e]=g.useState(!0),[t,r]=g.useState(null),n=g.useMemo(()=>{const s={None:Z(),Low:Z(),Moderate:Z(),High:Z(),"Very High":Z()};return new Oe({availabilityOptions:s,integrityOptions:s,confidentialityOptions:s,roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"300%",description:"High ROI"},VERY_HIGH:{returnRate:"500%",description:"Very high ROI"}}})},[]);return g.useEffect(()=>{let s=!0;return(async()=>{try{n&&s&&e(!1)}catch(c){console.error("Failed to initialize compliance service:",c),s&&(r(c instanceof Error?c:new Error("An error occurred")),e(!1))}})(),()=>{s=!1}},[n]),{isLoading:i,complianceService:n,error:t}}const ei=()=>{const[i,e]=g.useState(null),[t,r]=g.useState(null),[n,s]=g.useState(!0),o=g.useCallback(async()=>{try{s(!0),r(null);const{createDefaultDataProvider:c}=await lt(async()=>{const{createDefaultDataProvider:u}=await import("./dataProviders-CFFatKfO.js");return{createDefaultDataProvider:u}},[],import.meta.url),m=c();e(m)}catch(c){console.error("Error initializing CIA data provider:",c),r(c instanceof Error?c:new Error("Failed to initialize data provider")),e(null)}finally{s(!1)}},[]);return g.useEffect(()=>{o()},[o]),{dataProvider:i,error:t,isLoading:n,refreshDataProvider:o}},ti=()=>{const[i,e]=g.useState(null),[t,r]=g.useState(null),[n,s]=g.useState(!0),{dataProvider:o}=ei(),c=g.useCallback(async()=>{try{s(!0),r(null);const m=o?Ne(o):Ne();e(m)}catch(m){console.error("Error initializing security metrics service:",m),r(m instanceof Error?m:new Error("Failed to initialize security metrics service")),e(null)}finally{s(!1)}},[o]);return g.useEffect(()=>{c()},[c]),{securityMetricsService:i,error:t,isLoading:n,refreshService:c}};function ii(i,e={}){const{initialTab:t,onChange:r}=e,[n,s]=g.useState(t||i[0]?.id||""),o=g.useRef(new Map),c=g.useMemo(()=>i.filter(d=>!d.disabled).map(d=>d.id),[i]),m=g.useCallback(d=>{const h=i.find(f=>f.id===d);h&&!h.disabled&&(s(d),r?.(d))},[i,r]),u=g.useCallback((d,h)=>{if(c.length===0)return;const f=c.indexOf(h);let y;switch(d.key){case"ArrowLeft":d.preventDefault(),y=f>0?f-1:c.length-1;break;case"ArrowRight":d.preventDefault(),y=f<c.length-1?f+1:0;break;case"Home":d.preventDefault(),y=0;break;case"End":d.preventDefault(),y=c.length-1;break;default:return}const b=c[y];m(b),o.current.get(b)?.focus()},[c,m]);return{activeTab:n,selectTab:m,handleKeyDown:u,tabRefs:o}}function pe({label:i,value:e,className:t="",keyClassName:r="",valueClassName:n="",labelClassName:s="",testId:o,iconPrefix:c}){return a.jsxs("div",{className:`p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 ${t}`,"data-testid":o||oe.KEY_VALUE_PAIR,children:[a.jsxs("div",{className:`text-xs font-medium mb-1 text-gray-600 dark:text-gray-400 ${r} ${s}`,"data-testid":oe.KEY_VALUE_KEY,children:[c&&a.jsx("span",{className:"mr-1",children:c}),i]}),a.jsx("div",{className:`text-sm font-medium ${n}`,"data-testid":oe.KEY_VALUE_VALUE,children:e||"N/A"})]})}const J=({status:i,children:e,className:t="",testId:r,size:n="md",variant:s="neutral"})=>{const o=()=>{switch(i){case"success":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"error":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";case"neutral":return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300";case"purple":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},c=()=>{switch(n){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}},m=ri(i);return a.jsx("span",{className:`font-medium rounded-md ${o()} ${c()} ${m} ${t}`,"data-testid":r,children:e})};function ri(i){switch(i){case"error":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"success":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"neutral":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}}const ai=({risk:i,className:e="",testId:t="risk-level-badge",showIcon:r=!1})=>{if(!i)return a.jsx(J,{status:"neutral",className:e,testId:t,children:"Unknown"});const n=i.includes("Risk")?i:`${i} Risk`,s=qt(i);return a.jsxs(J,{status:s,className:e,testId:t,children:[r&&ni(i)," ",n]})};function ni(i){const e=i.toLowerCase();return e.includes("critical")||e.includes("high")?"âš ï¸":e.includes("medium")||e.includes("moderate")?"âš ":e.includes("low")?"â„¹ï¸":e.includes("minimal")||e.includes("none")?"âœ“":"â“"}const We=({tabs:i,initialTab:e,onChange:t,className:r="",testId:n="tab-container"})=>{const{activeTab:s,selectTab:o,handleKeyDown:c,tabRefs:m}=ii(i,{initialTab:e,onChange:t});return a.jsxs("div",{className:r,"data-testid":n,children:[a.jsxs("div",{role:ae.TABLIST,className:"flex space-x-2 border-b border-gray-200 dark:border-gray-700 mb-6","data-testid":`${n}-list`,"aria-label":"Tab navigation",children:[a.jsx("span",{className:"sr-only",id:`${n}-keyboard-instructions`,children:"Use arrow keys to navigate between tabs. Press Enter or Space to activate a tab."}),i.map(u=>{const d=s===u.id;return a.jsx("button",{ref:h=>{h&&m.current.set(u.id,h)},role:ae.TAB,"aria-selected":d,"aria-controls":`${n}-panel-${u.id}`,id:`${n}-tab-${u.id}`,tabIndex:d?0:-1,disabled:u.disabled,onClick:()=>o(u.id),onKeyDown:h=>c(h,u.id),"data-testid":u.testId||`${n}-tab-${u.id}`,"aria-describedby":`${n}-keyboard-instructions`,className:`
                px-4 py-2 font-medium text-sm rounded-t-lg
                transition-colors
                focus:outline-none focus:ring-2 focus:ring-info focus:ring-offset-2
                ${d?"bg-white dark:bg-gray-800 text-info-dark dark:text-info-light border-b-2 border-info-dark dark:border-info-light":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"}
                ${u.disabled?"opacity-50 cursor-not-allowed":"cursor-pointer"}
              `.trim(),style:{transitionDuration:Jt.fast},children:a.jsxs("div",{className:"flex items-center gap-2",children:[u.icon,a.jsx("span",{children:u.label}),u.badge&&a.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-info-light/10 dark:bg-info-dark/20 text-info-dark dark:text-info-light rounded-full",children:u.badge})]})},u.id)})]}),i.map(u=>a.jsx("div",{role:ae.TABPANEL,id:`${n}-panel-${u.id}`,"aria-labelledby":`${n}-tab-${u.id}`,hidden:s!==u.id,"data-testid":`${n}-panel-${u.id}`,className:"focus:outline-none",tabIndex:s===u.id?0:-1,children:s===u.id&&u.content},u.id))]})},si=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,className:r="",testId:n=mt.BUSINESS_IMPACT_WIDGET})=>{const{ciaContentService:s,error:o,isLoading:c}=ze(),m=g.useMemo(()=>{try{if(S(s))return te(i,e,t);if(typeof s.calculateBusinessImpactLevel=="function"){const l=s.calculateBusinessImpactLevel(i,e,t);return S(l)?te(i,e,t):l}return te(i,e,t)}catch(l){return console.error("Error calculating impact level:",l),te(i,e,t)}},[s,i,e,t]),u=g.useMemo(()=>{try{if(S(s))return D("availability",i);if(typeof s.getBusinessImpact=="function"){const l=s.getBusinessImpact("availability",i);return S(l)?D("availability",i):l}return D("availability",i)}catch(l){return console.error("Error getting availability impact:",l),D("availability",i)}},[s,i]),d=g.useMemo(()=>{try{if(S(s))return D("integrity",e);if(typeof s.getBusinessImpact=="function"){const l=s.getBusinessImpact("integrity",e);return S(l)?D("integrity",e):l}return D("integrity",e)}catch(l){return console.error("Error getting integrity impact:",l),D("integrity",e)}},[s,e]),h=g.useMemo(()=>{try{if(S(s))return D("confidentiality",t);if(typeof s.getBusinessImpact=="function"){const l=s.getBusinessImpact("confidentiality",t);return S(l)?D("confidentiality",t):l}return D("confidentiality",t)}catch(l){return console.error("Error getting confidentiality impact:",l),D("confidentiality",t)}},[s,t]),f=(l,w,I)=>{const M={None:0,Low:1,Moderate:2,High:3,"Very High":4},C=M[l]||0,T=M[w]||0,_=M[I]||0,W=C+T+_;return W<=2?"Low":W<=6?"Moderate":W<=9?"High":"Very High"},y=(l,w)=>{const I={Availability:"â±ï¸",Integrity:"âœ…",Confidentiality:"ðŸ”’",Financial:"ðŸ’°",Operational:"âš™ï¸",Reputational:"ðŸ‘¥",Regulatory:"ðŸ“œ"};return a.jsxs("div",{className:x(p.card,"bg-gray-50 dark:bg-gray-800 mb-sm"),"data-testid":P.section(`impact-${l.toLowerCase()}`),children:[a.jsxs("div",{className:"flex justify-between items-center mb-sm",children:[a.jsxs("h3",{className:x(p.subheading,"flex items-center"),children:[a.jsx("span",{className:"mr-sm","aria-hidden":"true",children:I[l]||"ðŸ“Š"}),l," Impact"]}),w.riskLevel&&a.jsx(ai,{risk:w.riskLevel,testId:`${n}-risk-level`})]}),a.jsx("p",{className:p.body,children:w.description||"No description available"})]},`impact-${l}`)},b=g.useMemo(()=>{const l=q(i)+q(e)+q(t);return[{title:"Implementation Effort",description:`${f(i,e,t)} complexity implementation requiring appropriate planning and resources.`,icon:"âš™ï¸"},{title:"Resource Requirements",description:`Security levels of this tier typically require ${l<3?"minimal resources and can be implemented with existing staff.":l<6?"moderate resources including some specialized expertise.":l<9?"significant resources and dedicated security personnel.":"extensive resources and specialized security expertise."}`,icon:"ðŸ‘¥"},{title:"Maintenance Overhead",description:`Ongoing maintenance will require ${l<3?"minimal effort with basic monitoring.":l<6?"regular attention and periodic reviews.":l<9?"dedicated staff time and routine assessments.":"continuous monitoring and regular reassessment."}`,icon:"ðŸ”§"},{title:"Organizational Impact",description:`These security controls will have ${l<3?"minimal impact on business processes.":l<6?"some impact on business processes requiring minor adjustments.":l<9?"moderate impact on business processes requiring training and adaptation.":"significant impact requiring process redesign and extensive training."}`,icon:"ðŸ¢"}]},[i,e,t]),N=g.useMemo(()=>{const l=q(i)+q(e)+q(t);return[{title:"Risk Reduction",description:`${l<3?"Basic protection against common threats.":l<6?"Moderate risk reduction for most business scenarios.":l<9?"Significant protection against advanced threats.":"Comprehensive protection against sophisticated attacks."}`,icon:"ðŸ›¡ï¸"},{title:"Compliance Coverage",description:`These security controls provide ${l<3?"minimal compliance coverage for basic requirements.":l<6?"moderate compliance coverage for common regulations.":l<9?"substantial compliance coverage for most frameworks.":"comprehensive compliance with stringent regulatory requirements."}`,icon:"âœ…"},{title:"Business Enablement",description:`Security at this level ${l<3?"enables basic business operations with minimal protection.":l<6?"supports standard business functions with adequate protection.":l<9?"enables business growth with strong security assurances.":"provides competitive advantage through superior security posture."}`,icon:"ðŸ“ˆ"},{title:"Customer Trust",description:`This security profile ${l<3?"meets minimal customer expectations.":l<6?"satisfies standard customer security requirements.":l<9?"exceeds typical customer security expectations.":"establishes your organization as a security leader in the industry."}`,icon:"ðŸ¤"}]},[i,e,t]),E=()=>a.jsxs("div",{className:x(p.grid3Cols,"mt-sm mb-sm"),children:[a.jsxs("div",{className:x("p-sm rounded text-center",ge(t)),"data-testid":P.section("heatmap-confidentiality"),children:[a.jsx("div",{className:p.labelNormal,children:"Confidentiality"}),a.jsx("div",{className:x(p.body,"font-bold"),children:t})]}),a.jsxs("div",{className:x("p-sm rounded text-center",ge(e)),"data-testid":P.section("heatmap-integrity"),children:[a.jsx("div",{className:p.labelNormal,children:"Integrity"}),a.jsx("div",{className:x(p.body,"font-bold"),children:e})]}),a.jsxs("div",{className:x("p-sm rounded text-center",ge(i)),"data-testid":P.section("heatmap-availability"),children:[a.jsx("div",{className:p.labelNormal,children:"Availability"}),a.jsx("div",{className:x(p.body,"font-bold"),children:i})]})]}),A=()=>a.jsxs("div",{className:x(p.card,"bg-blue-50 dark:bg-blue-900/20 mb-sm shadow-none"),"data-testid":P.section("executive-summary"),children:[a.jsxs("h3",{className:x(p.heading,"flex items-center"),children:[a.jsx("span",{className:"mr-sm","aria-hidden":"true",children:"ðŸ“Š"}),"Executive Summary"]}),a.jsxs("p",{className:x(p.body,"mb-sm"),children:["Current security posture provides"," ",a.jsx("span",{className:"font-medium",children:m})," protection for business operations. Business impacts are most significant in"," ",oi(u,d,h)," ","areas."]}),a.jsxs("div",{className:p.grid3Cols,children:[a.jsx(pe,{label:"Overall Impact",value:m,testId:`${n}-overall-impact`,valueClassName:x("font-medium",ci(m))}),a.jsx(pe,{label:"Implementation Complexity",value:f(i,e,t),testId:`${n}-implementation-complexity`}),a.jsx(pe,{label:"Security Profile",value:i===e&&e===t?i:"Mixed",testId:`${n}-security-profile`})]})]}),O=[{id:"considerations",label:"Implementation Considerations",content:a.jsx("div",{className:p.grid2Cols,"data-testid":P.section("considerations"),children:b.map((l,w)=>a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":P.item(`consideration-${w}`),children:[a.jsxs("div",{className:"flex items-center mb-sm",children:[a.jsx("span",{className:"mr-sm text-blue-500 dark:text-blue-400","aria-hidden":"true",children:l.icon}),a.jsx("h4",{className:"text-body-lg font-medium text-gray-700 dark:text-gray-200",children:l.title})]}),a.jsx("p",{className:p.body,children:l.description})]},`consideration-${w}`))}),testId:P.button("tab-considerations")},{id:"benefits",label:"Business Benefits",content:a.jsx("div",{className:p.grid2Cols,"data-testid":P.section("benefits"),children:N.map((l,w)=>a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":P.item(`benefit-${w}`),children:[a.jsxs("div",{className:"flex items-center mb-sm",children:[a.jsx("span",{className:"mr-sm text-green-500 dark:text-green-400","aria-hidden":"true",children:l.icon}),a.jsx("h4",{className:"text-body-lg font-medium text-gray-700 dark:text-gray-200",children:l.title})]}),a.jsx("p",{className:p.body,children:l.description})]},`benefit-${w}`))}),testId:P.button("tab-benefits")}];return a.jsx(Ye,{widgetName:"Business Impact Analysis",children:a.jsx(Ge,{title:De.BUSINESS_IMPACT_ANALYSIS,icon:Le.BUSINESS_IMPACT_ANALYSIS,className:r,testId:n,isLoading:c,error:o,children:a.jsxs("div",{className:"p-sm space-y-sm",role:"region","aria-label":qe("Business Impact Analysis","Business implications of security measures across financial, operational, reputational and regulatory dimensions"),children:[a.jsxs("section",{className:"mb-sm","aria-labelledby":"business-impacts-heading",children:[a.jsx("h3",{id:"business-impacts-heading",className:p.subheading,children:"Business Impacts by Component"}),h&&a.jsxs("div",{className:"mb-sm",children:[a.jsxs("h4",{className:x(p.subheading,"flex items-center"),children:[a.jsx("span",{className:"mr-sm","aria-hidden":"true",children:"ðŸ”’"}),"Confidentiality Impact"]}),a.jsxs("div",{className:p.grid2Cols,children:[h.reputational&&y("Reputational",h.reputational),h.regulatory&&y("Regulatory",h.regulatory)]})]}),d&&a.jsxs("div",{className:"mb-sm",children:[a.jsxs("h4",{className:x(p.subheading,"flex items-center"),children:[a.jsx("span",{className:"mr-sm","aria-hidden":"true",children:"âœ…"}),"Integrity Impact"]}),a.jsxs("div",{className:p.grid2Cols,children:[d.financial&&y("Financial",d.financial),d.operational&&y("Operational",d.operational)]})]}),u&&a.jsxs("div",{className:"mb-sm",children:[a.jsxs("h4",{className:x(p.subheading,"flex items-center"),children:[a.jsx("span",{className:"mr-sm","aria-hidden":"true",children:"â±ï¸"}),"Availability Impact"]}),a.jsxs("div",{className:p.grid2Cols,children:[u.financial&&y("Financial",u.financial),u.operational&&y("Operational",u.operational)]})]})]}),a.jsx("div",{className:"mb-sm",children:A()}),a.jsxs("div",{className:"mb-sm",children:[a.jsx("h3",{className:p.subheading,children:"Current Security Levels"}),a.jsxs("div",{className:"flex flex-wrap gap-sm",children:[a.jsx(me,{category:"Confidentiality",level:t,colorClass:"bg-purple-100 dark:bg-purple-900/20",textClass:"text-purple-800 dark:text-purple-300",testId:`${n}-confidentiality-badge`}),a.jsx(me,{category:"Integrity",level:e,colorClass:"bg-green-100 dark:bg-green-900/20",textClass:"text-green-800 dark:text-green-300",testId:`${n}-integrity-badge`}),a.jsx(me,{category:"Availability",level:i,colorClass:"bg-blue-100 dark:bg-blue-900/20",textClass:"text-blue-800 dark:text-blue-300",testId:`${n}-availability-badge`})]}),E()]}),a.jsx("div",{className:"mt-sm",children:a.jsx(We,{tabs:O,initialTab:"considerations",testId:`${n}-tabs`})})]})})})};function oi(i,e,t){const r=[];return i?.operational?.riskLevel?.includes("High")&&r.push("operational"),i?.financial?.riskLevel?.includes("High")&&r.push("financial"),e?.operational?.riskLevel?.includes("High")&&r.push("operational"),e?.financial?.riskLevel?.includes("High")&&r.push("financial"),t?.reputational?.riskLevel?.includes("High")&&r.push("reputational"),t?.regulatory?.riskLevel?.includes("High")&&r.push("regulatory"),r.length===0?"minimal":r.length===1?r[0]:r.length===2?`${r[0]} and ${r[1]}`:"multiple"}function q(i){return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[i]||0}function ge(i){switch(i){case"None":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";case"Low":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case"Moderate":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case"High":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300";case"Very High":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}}function ci(i){return i.includes("Low")?"text-green-600 dark:text-green-400":i.includes("Moderate")?"text-yellow-600 dark:text-yellow-400":i.includes("High")?"text-orange-600 dark:text-orange-400":i.includes("Very High")||i.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}function te(i,e,t){const r={None:0,Low:1,Moderate:2,High:3,"Very High":4},n=r[i]||0,s=r[e]||0,o=r[t]||0,c=(n+s+o)/3;return c<=.5?"Minimal":c<=1.5?"Low":c<=2.5?"Moderate":c<=3.5?"High":"Very High"}function D(i,e){const t=e==="None"||e==="Low";return i==="availability"?{summary:`${e} availability impact on business operations`,operational:{description:`${t?"Significant operational disruptions possible due to limited availability controls":"Operations protected by appropriate availability controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Potential financial losses due to service disruptions and downtime":"Financial impact minimized through robust availability controls"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:i==="integrity"?{summary:`${e} integrity impact on business operations`,operational:{description:`${t?"Business decisions may be based on inaccurate or corrupted data":"Data accuracy protected by appropriate integrity controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Financial losses possible due to data errors affecting decision making":"Financial impact minimized through data validation and integrity mechanisms"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:{summary:`${e} confidentiality impact on business operations`,reputational:{description:`${t?"High risk of reputational damage from data exposures or breaches":"Reputation protected by appropriate confidentiality controls"}`,riskLevel:t?"High Risk":"Low Risk"},regulatory:{description:`${t?"Increased risk of non-compliance with data protection regulations":"Regulatory compliance supported by appropriate data protection measures"}`,riskLevel:t?"Medium Risk":"Low Risk"}}}const vr=Object.freeze(Object.defineProperty({__proto__:null,default:si},Symbol.toStringTag,{value:"Module"}));function li(i,e,t){const n=He(i,e,t).toUpperCase().replace(" ","_");return xe[n]||xe.MODERATE}function ui(i){const e=i.toLowerCase();return e==="none"?"error":e==="low"?"warning":e==="moderate"?"info":e==="high"?"success":e==="very high"?"purple":"neutral"}function di(i){return i.includes("Low")?"text-green-600 dark:text-green-400":i.includes("Medium")?"text-yellow-600 dark:text-yellow-400":i.includes("High")?"text-orange-600 dark:text-orange-400":i.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}function Te(i){return i>=80?"Strong compliance position":i>=50?"Moderate compliance position":"Compliance gaps detected"}function mi(i,e,t,r,n){const s=g.useMemo(()=>He(i,e,t),[i,e,t]),o=g.useMemo(()=>ht(s),[s]),c=g.useMemo(()=>{const l=z(i),w=z(e),I=z(t),M=l+w+I;return Math.round(M/12*100)},[i,e,t]),m=g.useMemo(()=>c>=80?"Low Risk":c>=60?"Medium Risk":c>=40?"High Risk":"Critical Risk",[c]),u=g.useMemo(()=>{if(!S(r))try{if(K(r,"getSecurityClassification")){const l=r.getSecurityClassification(s);if(!S(l))return l}}catch(l){console.error("Error fetching security classification:",l)}switch(s){case"None":return"Minimal Security";case"Low":return"Basic Security";case"Moderate":return"Standard Security";case"High":return"Enhanced Security";case"Very High":return"Maximum Security";default:return"Unknown Security Level"}},[r,s]),d=g.useMemo(()=>{if(!S(r)&&K(r,"getInformationSensitivity"))try{const l=r.getInformationSensitivity?.(t);if(!S(l))return l}catch(l){console.error("Error fetching information sensitivity:",l)}switch(t){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Confidential Data";case"High":return"Restricted Data";case"Very High":return"Classified Data";default:return"Unclassified Data"}},[r,t]),h=g.useMemo(()=>{if(!S(r)&&K(r,"getImplementationComplexity"))try{const T=r.getImplementationComplexity(i,e,t);if(!S(T))return T}catch(T){console.error("Error fetching implementation complexity:",T)}const l={None:0,Low:1,Moderate:2,High:3,"Very High":4},w=l[i]||0,I=l[e]||0,M=l[t]||0,C=w+I+M;return C<=3?"Low":C<=6?"Moderate":C<=9?"High":"Very High"},[r,i,e,t]),f=g.useMemo(()=>{try{if(S(n))return null;const l=n.getComplianceStatus?.(i,e,t);return l?{...l,compliantFrameworks:l.compliantFrameworks||[],partiallyCompliantFrameworks:l.partiallyCompliantFrameworks||[],nonCompliantFrameworks:l.nonCompliantFrameworks||[]}:null}catch(l){return console.error("Error fetching compliance status:",l),null}},[n,i,e,t]),y=g.useMemo(()=>c>=80?"Strategic":c>=60?"Advanced":c>=40?"Standard":"Basic",[c]),b=g.useMemo(()=>{switch(y){case"Strategic":return"Enables competitive advantage and innovation";case"Advanced":return"Supports business growth and trusted partnerships";case"Standard":return"Maintains core business operations securely";case"Basic":return"Enables fundamental business activities";default:return"Unknown business maturity level"}},[y]),N=g.useMemo(()=>Pt(i,e,t,"medium","general"),[i,e,t]),E=g.useMemo(()=>{try{if(!S(r)&&K(r,"getTotalImplementationTime")){const l=r.getTotalImplementationTime(i,e,t);if(!S(l))return l}}catch(l){console.error("Error fetching implementation time:",l)}return c>=80?"3-6 months":c>=60?"2-4 months":c>=40?"1-2 months":"2-4 weeks"},[r,c,i,e,t]),A=g.useMemo(()=>{try{if(!S(r)&&K(r,"getRequiredExpertise")){const l=r.getRequiredExpertise(i,e,t);if(!S(l))return l}}catch(l){console.error("Error fetching resource requirements:",l)}return c>=80?"Specialized Team":c>=60?"Dedicated Team":c>=40?"Small Team":"Individual Effort"},[r,c,i,e,t]),O=g.useMemo(()=>{try{return li(i,e,t).value??"N/A"}catch(l){return console.error("Error calculating ROI estimate:",l),"N/A"}},[i,e,t]);return{overallSecurityLevel:s,securityLevelDescription:o,securityScore:c,riskLevel:m,securityClassification:u,dataClassification:d,implementationComplexity:h,complianceStatus:f,businessMaturityLevel:y,businessMaturityDescription:b,costDetails:N,implementationTime:E,requiredResources:A,roiEstimate:O,getStatusVariant:ui,getRiskColorClass:di}}const pi=({businessMaturityLevel:i,businessMaturityDescription:e,securityScore:t,costDetails:r,testId:n,roiEstimate:s})=>a.jsxs("div",{"data-testid":n||Y.section("content-business"),className:"space-y-md",children:[a.jsx("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded-lg mb-sm",children:a.jsx("p",{className:"text-sm",children:"This section summarizes the business value and financial impact of your selected security levels, helping justify security investments to stakeholders."})}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Business Value Summary"}),a.jsxs("div",{className:p.grid2Cols,children:[a.jsxs("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Business Maturity Level"}),a.jsx("div",{className:"text-subheading font-bold text-blue-600 dark:text-blue-400 mt-sm",children:i}),a.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-xs",children:e})]}),a.jsxs("div",{className:"p-sm bg-green-50 dark:bg-green-900/20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Estimated ROI"}),a.jsx("div",{className:"text-subheading font-bold text-green-600 dark:text-green-400 mt-sm",children:s}),a.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-xs",children:t>=80?"Strong return from security investments":t>=60?"Good return from security investments":t>=40?"Basic return, primarily risk avoidance":"Minimal return on investment"})]})]})]}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Cost Summary"}),a.jsxs("div",{className:p.grid3Cols,children:[a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Implementation Cost"}),a.jsx("div",{className:"text-subheading font-bold text-blue-600 dark:text-blue-400",children:de(r.totalCapex)}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"One-time investment"})]}),a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Operational Cost"}),a.jsx("div",{className:"text-subheading font-bold text-green-600 dark:text-green-400",children:de(r.totalOpex)}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Annual expense"})]}),a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Total First-Year Cost"}),a.jsx("div",{className:"text-subheading font-bold text-purple-600 dark:text-purple-400",children:de(r.totalCost)}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Combined implementation and operational costs"})]})]})]}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Business Enablement"}),a.jsx("div",{className:"space-y-sm",children:a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium mb-sm text-gray-800 dark:text-gray-200",children:"Business Capabilities"}),a.jsx("ul",{className:"list-disc pl-5 space-y-xs text-sm",children:t>=80?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Enables digital transformation initiatives"}),a.jsx("li",{children:"Supports secure cloud adoption"}),a.jsx("li",{children:"Facilitates secure partner integrations"}),a.jsx("li",{children:"Provides competitive advantage through security as a value"})]}):t>=60?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Supports most digital business initiatives"}),a.jsx("li",{children:"Enables secure customer data handling"}),a.jsx("li",{children:"Allows controlled partner access"}),a.jsx("li",{children:"Meets most customer security requirements"})]}):t>=40?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Supports basic business operations"}),a.jsx("li",{children:"Enables limited partner interactions"}),a.jsx("li",{children:"Meets minimum customer expectations"})]}):a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Limited security capabilities"}),a.jsx("li",{children:"May restrict business opportunities"}),a.jsx("li",{children:"Potential compliance limitations"})]})})]})})]})]});function he(i,e){return e==="None"?"Not sufficient for most compliance frameworks":e==="Low"?i==="availability"?"Meets basic availability requirements":"Meets basic compliance requirements":e==="Moderate"?i==="availability"?"Satisfies most compliance needs":i==="integrity"?"Satisfies standard compliance expectations":"Satisfies most regulatory requirements":e==="High"?i==="availability"?"Meets high availability standards":i==="integrity"?"Meets advanced compliance standards":"Meets stringent compliance standards":i==="availability"?"Exceeds enterprise requirements":i==="integrity"?"Exceeds regulatory requirements":"Exceeds most compliance requirements"}const gi=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,securityScore:r,complianceStatus:n,testId:s})=>a.jsxs("div",{"data-testid":s||Y.section("content-compliance"),className:"space-y-md",children:[a.jsx("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded-lg mb-sm",children:a.jsx("p",{className:"text-sm",children:"This section summarizes your compliance status based on selected security levels, highlighting alignment with regulatory frameworks and standards."})}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Compliance Status Overview"}),n?a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-sm",children:[a.jsx("span",{className:"font-medium",children:"Compliance Score"}),a.jsxs("span",{className:"text-subheading font-bold",children:[n.complianceScore,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5 mb-sm",children:a.jsx("div",{className:`h-2.5 rounded-full ${(n.complianceScore||0)>=80?"bg-green-500":(n.complianceScore||0)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${n.complianceScore||0}%`}})}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.status||Te(n.complianceScore||0)})]}):a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-sm",children:[a.jsx("span",{className:"font-medium",children:"Compliance Score"}),a.jsxs("span",{className:"text-subheading font-bold",children:[r,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5 mb-sm",children:a.jsx("div",{className:`h-2.5 rounded-full ${r>=80?"bg-green-500":r>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r}%`}})}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Te(r)})]})]}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Framework Compliance Status"}),n?a.jsxs("div",{className:p.grid2Cols,children:[a.jsxs("div",{className:"p-sm bg-green-50 dark:bg-green-900/20 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-green-700 dark:text-green-300 flex items-center justify-between",children:[a.jsx("span",{children:"Compliant"}),a.jsx("span",{className:"text-sm bg-green-100 dark:bg-green-800 px-2 py-0.5 rounded-full",children:n.compliantFrameworks.length})]}),n.compliantFrameworks.length>0?a.jsx("ul",{className:"mt-sm space-y-xs list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:n.compliantFrameworks.map((o,c)=>a.jsx("li",{children:o},`compliant-${c}`))}):a.jsx("p",{className:"mt-sm text-sm text-gray-600 dark:text-gray-400 italic",children:"No fully compliant frameworks"})]}),a.jsxs("div",{className:"p-sm bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300 flex items-center justify-between",children:[a.jsx("span",{children:"Partially Compliant"}),a.jsx("span",{className:"text-sm bg-yellow-100 dark:bg-yellow-800 px-2 py-0.5 rounded-full",children:n.partiallyCompliantFrameworks.length})]}),n.partiallyCompliantFrameworks.length>0?a.jsx("ul",{className:"mt-sm space-y-xs list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:n.partiallyCompliantFrameworks.map((o,c)=>a.jsx("li",{children:o},`partial-${c}`))}):a.jsx("p",{className:"mt-sm text-sm text-gray-600 dark:text-gray-400 italic",children:"No partially compliant frameworks"})]})]}):a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"Detailed compliance information is not available."})]}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Component Compliance Requirements"}),a.jsxs("div",{className:p.grid3Cols,children:[a.jsxs("div",{className:"p-sm bg-purple-50 dark:bg-purple-900/20 rounded",children:[a.jsx("h5",{className:"text-sm font-medium mb-xs text-purple-700 dark:text-purple-300",children:"Confidentiality"}),a.jsxs("p",{className:"text-xs",children:[a.jsx("span",{className:"font-medium",children:"Level:"})," ",t]}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-xs",children:he("confidentiality",t)})]}),a.jsxs("div",{className:"p-sm bg-green-50 dark:bg-green-900/20 rounded",children:[a.jsx("h5",{className:"text-sm font-medium mb-xs text-green-700 dark:text-green-300",children:"Integrity"}),a.jsxs("p",{className:"text-xs",children:[a.jsx("span",{className:"font-medium",children:"Level:"})," ",e]}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-xs",children:he("integrity",e)})]}),a.jsxs("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded",children:[a.jsx("h5",{className:"text-sm font-medium mb-xs text-blue-700 dark:text-blue-300",children:"Availability"}),a.jsxs("p",{className:"text-xs",children:[a.jsx("span",{className:"font-medium",children:"Level:"})," ",i]}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-xs",children:he("availability",i)})]})]})]})]});function ye(i,e){if(i==="confidentiality")switch(e){case"None":return"No data protection controls needed";case"Low":return"Basic access controls and authentication";case"Moderate":return"Role-based access and encryption for sensitive data";case"High":return"Comprehensive encryption and access controls";case"Very High":return"Maximum protection with advanced encryption and zero-trust";default:return"Standard data protection controls"}if(i==="integrity")switch(e){case"None":return"No data validation controls needed";case"Low":return"Basic input validation and error checking";case"Moderate":return"Data validation and cryptographic checksums";case"High":return"Digital signatures and strong validation";case"Very High":return"Formal verification and immutable audit trails";default:return"Standard data integrity controls"}switch(e){case"None":return"No uptime guarantees or redundancy";case"Low":return"Basic backup and recovery procedures";case"Moderate":return"Redundant components and standard backups";case"High":return"High availability clustering and failover";case"Very High":return"Multi-site redundancy and continuous availability";default:return"Standard availability controls"}}function hi(i){switch(i){case"None":return"Unverified";case"Low":return"Basic Validation";case"Moderate":return"Validated";case"High":return"Strongly Validated";case"Very High":return"Formally Verified";default:return"Unknown"}}function yi(i){switch(i){case"None":return"No guarantee";case"Low":return"95%";case"Moderate":return"99%";case"High":return"99.9%";case"Very High":return"99.999%";default:return"Unknown"}}const fi=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,implementationComplexity:r,testId:n,implementationTime:s,requiredResources:o})=>a.jsxs("div",{"data-testid":n||Y.section("content-implementation"),className:"space-y-md",children:[a.jsx("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded-lg mb-sm",children:a.jsx("p",{className:"text-sm",children:"This section summarizes implementation requirements for your selected security levels, helping plan resources, timelines, and technical approaches."})}),a.jsxs("div",{className:x(p.cardWhite,"shadow-sm"),children:[a.jsx("h3",{className:p.subheading,children:"Implementation Overview"}),a.jsxs("div",{className:"mb-sm",children:[a.jsxs("div",{className:"flex items-center justify-between mb-sm",children:[a.jsx("div",{className:"text-body-lg font-medium text-gray-800 dark:text-gray-200",children:"Implementation Complexity:"}),a.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-200",children:r})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:a.jsx("div",{className:`h-2.5 rounded-full ${r==="Low"?"w-1/4 bg-green-500":r==="Moderate"?"w-2/4 bg-yellow-500":r==="High"?"w-3/4 bg-orange-500":"w-full bg-red-500"}`})}),a.jsx("p",{className:"text-body text-gray-600 dark:text-gray-400 mt-sm",children:r==="Low"?"Basic security controls with straightforward implementation":r==="Moderate"?"Standard security measures with moderate implementation effort":r==="High"?"Advanced security controls requiring significant implementation effort":"Comprehensive security framework requiring extensive resources"})]}),a.jsxs("div",{className:p.grid2Cols,children:[a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-body font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Estimated Implementation Time"}),a.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:s}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Typical project timeline"})]}),a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-body font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Required Resources"}),a.jsx("div",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:o}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Resource allocation recommendation"})]})]})]}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Component Implementation Summary"}),a.jsxs("div",{className:p.grid3Cols,children:[a.jsxs("div",{className:"p-sm bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-100 dark:border-purple-800",children:[a.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300 mb-sm",children:"Confidentiality Implementation"}),a.jsx("p",{className:"text-body text-gray-600 dark:text-gray-400",children:ye("confidentiality",t)}),a.jsxs("div",{className:"mt-sm text-xs font-medium text-purple-700 dark:text-purple-300",children:["Level: ",t]})]}),a.jsxs("div",{className:"p-sm bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-100 dark:border-green-800",children:[a.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300 mb-sm",children:"Integrity Implementation"}),a.jsx("p",{className:"text-body text-gray-600 dark:text-gray-400",children:ye("integrity",e)}),a.jsxs("div",{className:"mt-sm text-xs font-medium text-green-700 dark:text-green-300",children:["Level: ",e]})]}),a.jsxs("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800",children:[a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300 mb-sm",children:"Availability Implementation"}),a.jsx("p",{className:"text-body text-gray-600 dark:text-gray-400",children:ye("availability",i)}),a.jsxs("div",{className:"mt-sm text-xs font-medium text-blue-700 dark:text-blue-300",children:["Level: ",i]})]})]})]}),a.jsxs("div",{className:x(p.card,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Implementation Considerations"}),a.jsxs("div",{className:p.grid2Cols,children:[a.jsxs("div",{className:"p-sm bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Success Factors"}),a.jsxs("ul",{className:"mt-sm space-y-xs list-disc list-inside text-sm",children:[a.jsx("li",{children:"Executive sponsorship and support"}),a.jsx("li",{children:"Clear security requirements definition"}),a.jsx("li",{children:"Adequate resource allocation"}),a.jsx("li",{children:"Proper testing and validation"}),a.jsx("li",{children:"Staff training and awareness"})]})]}),a.jsxs("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Key Challenges"}),a.jsxs("ul",{className:"mt-sm space-y-xs list-disc list-inside text-sm",children:[a.jsx("li",{children:"Balancing security with usability"}),a.jsx("li",{children:"Integration with existing systems"}),a.jsx("li",{children:"Managing scope and expectations"}),a.jsx("li",{children:"Maintaining consistent controls"}),a.jsx("li",{children:"Securing necessary expertise"})]})]})]})]})]}),bi=ve.overrides.radar!==void 0;bi||ve.register(Qe,et,tt,it,rt,at,nt,st);const xi=({availabilityLevel:i="None",integrityLevel:e="None",confidentialityLevel:t="None",className:r="",testId:n=ee.RADAR_CHART})=>{const s=g.useRef(null),o=g.useRef(null),[c,m]=g.useState(null),[u,d]=g.useState(document.documentElement.classList.contains("dark")),[h]=g.useState({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t}),f=b=>{switch(b){case"None":return 0;case"Basic":case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4;default:return 0}};g.useEffect(()=>{const b=new MutationObserver(N=>{N.forEach(E=>{if(E.attributeName==="class"&&E.target===document.documentElement){const A=document.documentElement.classList.contains("dark");A!==u&&d(A)}})});return b.observe(document.documentElement,{attributes:!0}),()=>b.disconnect()},[u]),g.useEffect(()=>{if(s.current)try{o.current&&o.current.destroy();const b=s.current?.getContext("2d");if(!b){m("Could not get canvas context");return}const N=f(i),E=f(e),A=f(t),O=u?"rgba(0, 204, 102, 0.2)":"rgba(0, 102, 51, 0.2)",l=u?"#00cc66":"#006633",w=u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",I=u?"#f0f0f0":"#222222";o.current=new ve(b,{type:"radar",data:{labels:["Availability","Integrity","Confidentiality"],datasets:[{label:"Security Profile",data:[N,E,A],backgroundColor:O,borderColor:l,borderWidth:2,pointBackgroundColor:l,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:l}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{r:{angleLines:{color:w},grid:{color:w},pointLabels:{color:I,font:{size:12}},min:0,max:4,ticks:{backdropColor:"transparent",color:I,z:100,stepSize:1,font:{size:10},callback:function(C){return["None","Basic","Moderate","High","Very High"][C]||""}},beginAtZero:!0}},plugins:{legend:{display:!1,labels:{color:u?"#00cc66":"#006633",font:{family:"'Share Tech Mono', monospace",size:12},boxWidth:15,boxHeight:2}},tooltip:{callbacks:{label:function(C){const T=["None","Basic","Moderate","High","Very High"],_=C.raw;return`${C.label}: ${T[_]||""}`}}}}}});const M=()=>{o.current&&o.current.resize()};return window.addEventListener("resize",M),()=>{window.removeEventListener("resize",M),o.current&&o.current.destroy()}}catch(b){m(b instanceof Error?b.message:String(b))}},[i,e,t,u]);const y=r?`radar-chart-container ${r}`.trim():"radar-chart-container";return a.jsxs("div",{className:y,"data-testid":`${n}-container`,children:[c?a.jsxs("div",{"data-testid":`${n}-error`,className:"error-message",children:["Error loading chart: ",c]}):a.jsxs("div",{className:"radar-values flex justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Availability:"})," ",a.jsx("span",{"data-testid":ee.RADAR_AVAILABILITY_VALUE,children:i||"None"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Integrity:"})," ",a.jsx("span",{"data-testid":ee.RADAR_INTEGRITY_VALUE,children:e||"None"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Confidentiality:"})," ",a.jsx("span",{"data-testid":ee.RADAR_CONFIDENTIALITY_VALUE,children:t||"None"})]})]}),a.jsx("canvas",{ref:s,"data-testid":n})]})},fe=({level:i,size:e="md",className:t="",testId:r})=>{const n=()=>{switch(i){case"None":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";case"Low":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"Moderate":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"High":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"Very High":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},s=()=>{switch(e){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}};return a.jsx("span",{className:`font-medium rounded-md ${n()} ${s()} ${t}`,"data-testid":r,children:i})},vi=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,dataClassification:r,implementationComplexity:n,businessMaturityLevel:s,businessMaturityDescription:o,securityScore:c,complianceScore:m,testId:u,getStatusVariant:d})=>a.jsxs("div",{"data-testid":u||Y.section("content-overview"),className:"space-y-sm",children:[a.jsxs("div",{className:x(p.cardWhite,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Security Profile"}),a.jsx("div",{className:"h-[300px]",children:a.jsx(xi,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,testId:`${u}-radar-chart`})})]}),a.jsxs("div",{className:x(p.cardWhite,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Security Components"}),a.jsxs("div",{className:p.grid3Cols,children:[a.jsxs("div",{className:"p-sm bg-purple-50 dark:bg-purple-900/20 rounded-lg border border-purple-100 dark:border-purple-800","data-testid":ie.CONFIDENTIALITY_CARD,children:[a.jsxs("div",{className:"flex items-center mb-sm",children:[a.jsx("span",{className:"text-subheading mr-sm text-purple-500 dark:text-purple-400","aria-hidden":"true",children:"ðŸ”’"}),a.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Confidentiality"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-xs",children:[a.jsx(fe,{level:t}),a.jsx(J,{status:d(U(t)),size:"sm",children:U(t)})]}),a.jsxs("div",{className:"mt-sm text-xs text-gray-600 dark:text-gray-400",children:["Classification:"," ",a.jsx("span",{className:"font-medium",children:r})]})]}),a.jsxs("div",{className:"p-sm bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-100 dark:border-green-800","data-testid":ie.INTEGRITY_CARD,children:[a.jsxs("div",{className:"flex items-center mb-sm",children:[a.jsx("span",{className:"text-subheading mr-sm text-green-500 dark:text-green-400","aria-hidden":"true",children:"âœ“"}),a.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Integrity"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-xs",children:[a.jsx(fe,{level:e}),a.jsx(J,{status:d(U(e)),size:"sm",children:U(e)})]}),a.jsxs("div",{className:"mt-sm text-xs text-gray-600 dark:text-gray-400",children:["Validation Level:"," ",a.jsx("span",{className:"font-medium",children:hi(e)})]})]}),a.jsxs("div",{className:"p-sm bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800","data-testid":ie.AVAILABILITY_CARD,children:[a.jsxs("div",{className:"flex items-center mb-sm",children:[a.jsx("span",{className:"text-subheading mr-sm text-blue-500 dark:text-blue-400","aria-hidden":"true",children:"â±ï¸"}),a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Availability"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-xs",children:[a.jsx(fe,{level:i}),a.jsx(J,{status:d(U(i)),size:"sm",children:U(i)})]}),a.jsxs("div",{className:"mt-sm text-xs text-gray-600 dark:text-gray-400",children:["Uptime Target:"," ",a.jsx("span",{className:"font-medium",children:yi(i)})]})]})]})]}),a.jsxs("div",{className:x(p.cardWhite,"shadow-sm"),children:[a.jsx("h3",{className:"text-subheading font-medium mb-sm text-gray-800 dark:text-gray-100",children:"Key Security Metrics"}),a.jsxs("div",{className:p.grid3Cols,children:[a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Implementation Complexity"}),a.jsx("div",{className:"text-subheading font-bold",children:n}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Based on combined security levels"})]}),a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Business Maturity"}),a.jsx("div",{className:"text-subheading font-bold",children:s}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:o})]}),a.jsxs("div",{className:"p-sm bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-xs text-gray-700 dark:text-gray-200",children:"Compliance Status"}),a.jsxs("div",{className:"text-subheading font-bold",children:[m||c,"%"]}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Overall compliance alignment"})]})]})]})]}),wi=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,className:r="",testId:n=ie.WIDGET})=>{const{ciaContentService:s,error:o,isLoading:c}=ze(),{error:m,isLoading:u}=ti(),{complianceService:d,error:h,isLoading:f}=Qt(),y=c||u||f,b=o||m||h,{securityLevelDescription:N,securityScore:E,riskLevel:A,securityClassification:O,dataClassification:l,implementationComplexity:w,complianceStatus:I,businessMaturityLevel:M,businessMaturityDescription:C,costDetails:T,implementationTime:_,requiredResources:W,roiEstimate:Ke,getStatusVariant:Xe,getRiskColorClass:Ze}=mi(i,e,t,s,d),Je=[{id:"overview",label:"Overview",content:a.jsx(vi,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,dataClassification:l,implementationComplexity:w,businessMaturityLevel:M,businessMaturityDescription:C,securityScore:E,complianceScore:I?.complianceScore,testId:n,getStatusVariant:Xe}),testId:`${n}-tab-overview`},{id:"business",label:"Business Value",content:a.jsx(pi,{businessMaturityLevel:M,businessMaturityDescription:C,securityScore:E,costDetails:T,testId:n,roiEstimate:Ke}),testId:`${n}-tab-business`},{id:"implementation",label:"Implementation",content:a.jsx(fi,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,implementationComplexity:w,testId:n,implementationTime:_,requiredResources:W}),testId:`${n}-tab-implementation`},{id:"compliance",label:"Compliance",badge:I?(I.compliantFrameworks?.length||0)+(I.partiallyCompliantFrameworks?.length||0)+(I.nonCompliantFrameworks?.length||0):void 0,content:a.jsx(gi,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,securityScore:E,complianceStatus:I,testId:n}),testId:`${n}-tab-compliance`}];return a.jsx(Ye,{widgetName:"Security Summary",children:a.jsx(Ge,{title:De.SECURITY_SUMMARY,icon:Le.SECURITY_SUMMARY,className:r,testId:n,isLoading:y,error:b,children:a.jsxs("div",{className:"space-y-sm",role:ae.REGION,"aria-label":qe("Security Summary","Comprehensive executive summary of security posture with key metrics"),children:[a.jsx("section",{className:x(p.section,"p-sm rounded-md shadow-sm border-l-4 border-info dark:border-info-light","bg-info-light/10 dark:bg-info-dark/20"),"aria-labelledby":"security-classification-heading","data-testid":Y.section("classification-banner"),children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("h2",{id:"security-classification-heading",className:x(p.heading,"flex items-center gap-sm"),children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-full bg-info dark:bg-info-light pulse-dot","aria-hidden":"true"}),O]}),a.jsx("p",{className:p.body,id:"security-classification-description",children:N})]}),a.jsxs("div",{className:"text-right",role:"group","aria-label":"Security metrics",children:[a.jsx("div",{className:p.label,id:"security-score-label",children:"Security Score"}),a.jsxs("div",{className:"font-bold text-title text-info dark:text-info-light","aria-labelledby":"security-score-label","aria-live":"polite",children:[E,"%"]}),a.jsx("div",{className:x(p.body,"font-medium",Ze(A)),"data-testid":Y.label("risk-level"),"aria-label":`Risk level: ${A}`,role:"status",children:A})]})]})}),a.jsx(We,{tabs:Je,initialTab:"overview",testId:`${n}-tabs`})]})})})},wr=Object.freeze(Object.defineProperty({__proto__:null,default:wi},Symbol.toStringTag,{value:"Module"}));export{ae as $,j as A,xr as B,Fi as C,br as D,yr as E,je as F,Qi as G,tr as H,er as I,Ji as J,Gi as K,p as L,Li as M,_i as N,Ti as O,$i as P,Ai as Q,Vi as R,J as S,fr as T,ki as U,Ei as V,Ye as W,Ui as X,ji as Y,Ki as Z,Di as _,Ge as a,We as a0,ti as a1,ir as a2,Hi as a3,Yi as a4,Wi as a5,xi as a6,sr as a7,Ri as a8,ut as a9,Ni as aa,Pi as ab,Ie as ac,mr as ad,lr as ae,cr as af,lt as ag,or as ah,Oi as ai,Ci as aj,ne as ak,Pe as al,qi as am,zi as an,Bi as ao,vr as ap,wr as aq,Le as b,De as c,x as d,ze as e,Pt as f,qe as g,ar as h,S as i,z as j,Mi as k,de as l,me as m,Zi as n,Xi as o,rr as p,K as q,fe as r,li as s,nr as t,Qt as u,hr as v,pr as w,ur as x,gr as y,dr as z};
//# sourceMappingURL=widgets-assessment-BVabzYXG.js.map
