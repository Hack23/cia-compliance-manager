import{r as g,j as e}from"./react-vendor-BzhlA2NX.js";import{P as v,A as o,j as a,Q as f,W as S,a as w,b as I,c as C,g as R,R as V,T as A,U as T,q as m,o as z}from"./widgets-assessment-CQA_0dee.js";import"./chart-BRhaV9pk.js";const U=({availabilityLevel:s,integrityLevel:r,confidentialityLevel:t,className:x="",testId:u="security-visualization-widget"})=>{const{error:h,isLoading:b}=v(),d=g.useMemo(()=>{const i=o(s),c=o(r),n=o(t),j=a(i),p=a(c),k=a(n),N=j+p+k;return Math.round(N/12*100)},[s,r,t]),l=g.useMemo(()=>{const i=z(s,r,t);return f(i)},[s,r,t]),y=()=>{const i=a(s),c=a(r),n=a(t);return s===r&&r===t&&(s==="High"||s==="Very High")?e.jsx("div",{"data-testid":"balanced-recommendation",className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg mt-4",children:e.jsx("p",{className:"text-sm",children:"Your security posture is well-balanced with strong controls across all CIA components."})}):e.jsxs("div",{className:"space-y-2 mt-4","data-testid":"security-recommendations",children:[i<2&&e.jsx("div",{className:"p-sm bg-info-light/10 dark:bg-info-dark/20 rounded",children:e.jsx("p",{className:"text-sm",children:"Consider improving availability controls to ensure business continuity."})}),c<3&&e.jsx("div",{className:"p-sm bg-success-light/10 dark:bg-success-dark/20 rounded",children:e.jsx("p",{className:"text-sm",children:"Enhance data validation mechanisms and change management to improve integrity."})}),n<2&&e.jsx("div",{className:"p-sm bg-primary-light/10 dark:bg-primary-dark/20 rounded-md",children:e.jsx("p",{className:"text-sm",children:"Strengthen access controls and data protection to improve confidentiality."})})]})};return e.jsx(S,{widgetName:"Security Visualization",children:e.jsx(w,{title:C.SECURITY_VISUALIZATION,icon:I.SECURITY_VISUALIZATION,className:x,testId:u,isLoading:b,error:h,children:e.jsxs("div",{className:"p-md sm:p-lg",role:"region","aria-label":R("Security Visualization","Visual representation of security posture with CIA triad metrics, security score, and risk level"),children:[e.jsxs("section",{className:"mb-6","aria-labelledby":"security-posture-heading",children:[e.jsx("h3",{id:"security-posture-heading",className:"text-lg font-medium mb-3",children:"Security Posture"}),e.jsxs("div",{className:"p-md bg-neutral-light/10 dark:bg-neutral-dark/20 rounded-md",role:"group","aria-label":"Security metrics",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Security Score"}),e.jsx("div",{className:"text-3xl font-bold","data-testid":"security-score-value","aria-label":`Security score: ${d} out of 100`,children:d})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Risk Level"}),e.jsx("div",{className:`text-xl font-bold ${V(l)}`,"data-testid":"risk-level",role:"status","aria-label":`Risk level: ${l}`,children:l})]})]}),e.jsxs("div",{className:"mb-2","aria-label":"Security score visualization",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Security Level"}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${A(d)}`,style:{width:`${d}%`},"data-testid":"security-score-bar"})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mt-1",children:[e.jsx("div",{children:"Critical"}),e.jsx("div",{children:"High"}),e.jsx("div",{children:"Medium"}),e.jsx("div",{children:"Low"}),e.jsx("div",{children:"Minimal"})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Components"}),e.jsx("div",{className:"p-md bg-white dark:bg-gray-800 rounded-md border border-neutral-light dark:border-neutral-dark",children:e.jsx(T,{availabilityLevel:s,integrityLevel:r,confidentialityLevel:t,testId:`${u}-radar-chart`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Component Details"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-md bg-primary-light/10 dark:bg-primary-dark/20 rounded-md","data-testid":"confidentiality-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-primary-dark dark:text-primary-light",children:"Confidentiality"}),e.jsx(m,{level:t,testId:"confidentiality-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${a(t)/4*100}%`},"data-testid":"confidentiality-gauge"})})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":"integrity-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-green-800 dark:text-green-300",children:"Integrity"}),e.jsx(m,{level:r,testId:"integrity-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${a(r)/4*100}%`},"data-testid":"integrity-gauge"})})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","data-testid":"availability-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-blue-800 dark:text-blue-300",children:"Availability"}),e.jsx(m,{level:s,testId:"availability-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full",style:{width:`${a(s)/4*100}%`},"data-testid":"availability-gauge"})})]})]})]}),y(),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mt-4",children:[e.jsx("h3",{className:"text-md font-medium mb-2",children:"Security Visualization Key"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"The security score represents your overall security posture based on your CIA triad levels. The risk level indicates the potential business risk associated with your current security posture."}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 text-xs",children:[e.jsx("div",{className:"p-1 bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300 rounded text-center",children:"Critical Risk"}),e.jsx("div",{className:"p-1 bg-orange-100 text-orange-800 dark:bg-orange-900 dark:bg-opacity-30 dark:text-orange-300 rounded text-center",children:"High Risk"}),e.jsx("div",{className:"p-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300 rounded text-center",children:"Medium Risk"}),e.jsx("div",{className:"p-1 bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300 rounded text-center",children:"Low Risk"}),e.jsx("div",{className:"p-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300 rounded text-center",children:"Minimal Risk"})]})]})]})})})};export{U as default};
//# sourceMappingURL=widgets-visualization-XpSuktuw.js.map
