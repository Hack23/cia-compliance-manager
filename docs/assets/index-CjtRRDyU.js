const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./widgets-assessment-29On9S3B.js","./react-vendor-BzhlA2NX.js","./chart-BRhaV9pk.js","./widgets-business-D7qMJ3X_.js","./widgets-impact-DO1JXM6x.js","./widgets-implementation-C_zdtplH.js","./widgets-visualization-tL4nrDWu.js"])))=>i.map(i=>d[i]);
import{r,j as e,R as Y,a as ae}from"./react-vendor-BzhlA2NX.js";import{e as re,a2 as H,W as j,a as ie,b as se,c as ne,g as le,a3 as k,a4 as U,l as W,a5 as O,a6 as $,a7 as X,a8 as oe,a9 as A,A as L,aa as de,ab as _,ac as D,ad as I,ae as ce,af as B,ag as l,ah as z,ai as F,aj as ue}from"./widgets-assessment-29On9S3B.js";import{u as Q,a as me,b as ge}from"./widgets-impact-DO1JXM6x.js";import"./chart-BRhaV9pk.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))m(n);new MutationObserver(n=>{for(const d of n)if(d.type==="childList")for(const t of d.addedNodes)t.tagName==="LINK"&&t.rel==="modulepreload"&&m(t)}).observe(document,{childList:!0,subtree:!0});function i(n){const d={};return n.integrity&&(d.integrity=n.integrity),n.referrerPolicy&&(d.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?d.credentials="include":n.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function m(n){if(n.ep)return;n.ep=!0;const d=i(n);fetch(n.href,d)}})();const xe=({availabilityLevel:s,integrityLevel:a,confidentialityLevel:i,onAvailabilityChange:m,onIntegrityChange:n,onConfidentialityChange:d,className:t="",testId:o="security-level-widget"})=>{const{ciaContentService:x}=re(),[p,b]=r.useState(null),[v,f]=r.useState(!1),[g,w]=r.useState("availability"),[c,E]=r.useState(null),[h,N]=r.useState(null),[R,S]=r.useState(null);r.useEffect(()=>{f(!0);try{if(!x)throw new Error("Content service unavailable");const u=g==="availability"?s:g==="integrity"?a:i,y=x.getComponentDetails(g,u)||{description:"No details available",technical:"No technical information available",businessImpact:"No business impact information available",recommendations:[]};N(y),E(null),b(null)}catch(u){console.error("Error loading component details:",u),E(u instanceof Error?u:new Error("Failed to load component details")),b(u instanceof Error?u:new Error("Service error"))}finally{f(!1)}},[x,g,s,a,i]);const P=r.useCallback(u=>{const y=u.target.value;m&&m(y),S("availability"),H(`Availability security level changed to ${y}`,"polite")},[m]),q=r.useCallback(u=>{const y=u.target.value;n&&n(y),S("integrity"),H(`Integrity security level changed to ${y}`,"polite")},[n]),ee=r.useCallback(u=>{const y=u.target.value;d&&d(y),S("confidentiality"),H(`Confidentiality security level changed to ${y}`,"polite")},[d]),M=[O.NONE,O.LOW,O.MODERATE,O.HIGH,O.VERY_HIGH],V=(u,y)=>{switch(u){case"availability":return y==="None"?"No uptime guarantees":y==="Low"?"~95% uptime, 24-48h recovery":y==="Moderate"?"~99% uptime, 4-8h recovery":y==="High"?"~99.9% uptime, 15-60min recovery":y==="Very High"?"~99.99% uptime, <5min recovery":"";case"integrity":return y==="None"?"No validation controls":y==="Low"?"Manual validation with basic checks":y==="Moderate"?"Automated validation with checks":y==="High"?"Cryptographic verification":y==="Very High"?"Blockchain validation":"";case"confidentiality":return y==="None"?"No access controls":y==="Low"?"Basic access control":y==="Moderate"?"RBAC with encryption":y==="High"?"E2E encryption with MFA":y==="Very High"?"Zero-trust architecture":"";default:return"No details available"}},te=u=>{switch(u){case"availability":return"text-blue-600 dark:text-blue-400";case"integrity":return"text-green-600 dark:text-green-400";case"confidentiality":return"text-purple-600 dark:text-purple-400";default:return"text-gray-600 dark:text-gray-400"}};return e.jsx(j,{widgetName:"Security Level",children:e.jsx(ie,{title:ne.SECURITY_LEVEL,icon:se.SECURITY_LEVEL,className:t,testId:o,children:e.jsxs("div",{className:"p-md sm:p-lg",role:"region","aria-label":le("Security Level Configuration","Configure security levels for each CIA component to set your organization's security posture"),children:[e.jsx("div",{className:"mb-md p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md",children:e.jsx("p",{className:"text-body",children:"Configure security levels for each CIA component to set your organization's security posture. Higher levels provide stronger protection but may require more resources to implement."})}),(c||p)&&e.jsxs("div",{className:"p-md mb-md bg-error-light/10 dark:bg-error-dark/20 text-error-dark dark:text-error-light rounded-md",children:[e.jsx("h4",{className:"font-medium",children:"Error"}),e.jsx("p",{className:"text-body",children:"Unable to load component details. Please try again later."})]}),v&&e.jsx("div",{className:"p-md mb-md bg-info-light/10 dark:bg-info-dark/20 text-info-dark dark:text-info-light rounded-md",children:e.jsx("p",{className:"text-body",children:"Loading security level details..."})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-heading font-medium mb-md",children:"Configure Security Levels"}),e.jsxs("div",{className:"space-y-md",children:[e.jsxs("div",{className:"p-md bg-neutral-light/10 dark:bg-neutral-dark/20 rounded-md border border-neutral-light dark:border-neutral-dark","data-testid":k.section("confidentiality"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-sm",children:[e.jsxs("label",{htmlFor:"confidentiality-select",className:"text-body font-medium flex items-center",children:[e.jsx("span",{className:"text-purple-500 dark:text-purple-400 mr-sm",children:U.confidentiality}),"Confidentiality"]}),e.jsx(W,{category:"",level:i,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:"security-level-widget-confidentiality-badge"})]}),e.jsx("select",{id:"confidentiality-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-purple-400 focus:border-purple-500 focus:ring-2 focus:ring-purple-200",value:i,onChange:ee,"data-testid":$.CONFIDENTIALITY_SELECT,children:M.map(u=>e.jsx("option",{value:u,children:u},`confidentiality-${u}`))}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":k.label("confidentiality-summary"),children:[i,":"," ",V("confidentiality",i)]}),e.jsx("button",{className:"mt-2 px-4 py-3 sm:px-3 sm:py-2 text-sm sm:text-xs min-h-[44px] min-w-[44px] bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors",onClick:()=>w("confidentiality"),"data-testid":k.button("confidentiality-details"),children:"View details"}),R==="confidentiality"&&e.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":k.label("confidentiality-changed"),children:"âœ“ Security level updated"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":k.section("integrity"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{htmlFor:"integrity-select",className:"text-sm font-medium flex items-center",children:[e.jsx("span",{className:"text-green-500 dark:text-green-400 mr-2",children:U.integrity}),"Integrity"]}),e.jsx(W,{category:"",level:a,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:"security-level-widget-integrity-badge"})]}),e.jsx("select",{id:"integrity-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-green-400 focus:border-green-500 focus:ring-2 focus:ring-green-200",value:a,onChange:q,"data-testid":$.INTEGRITY_SELECT,children:M.map(u=>e.jsx("option",{value:u,children:u},`integrity-${u}`))}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":k.label("integrity-summary"),children:[a,":"," ",V("integrity",a)]}),e.jsx("button",{className:"mt-2 px-4 py-3 sm:px-3 sm:py-2 text-sm sm:text-xs min-h-[44px] min-w-[44px] bg-green-600 text-white rounded hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600 transition-colors",onClick:()=>w("integrity"),"data-testid":k.button("integrity-details"),children:"View details"}),R==="integrity"&&e.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":k.label("integrity-changed"),children:"âœ“ Security level updated"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":k.section("availability"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{htmlFor:"availability-select",className:"text-sm font-medium flex items-center",children:[e.jsx("span",{className:"text-blue-500 dark:text-blue-400 mr-2",children:U.availability}),"Availability"]}),e.jsx(W,{category:"",level:s,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:"security-level-widget-availability-badge"})]}),e.jsx("select",{id:"availability-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-blue-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",value:s,onChange:P,"data-testid":$.AVAILABILITY_SELECT,children:M.map(u=>e.jsx("option",{value:u,children:u},`availability-${u}`))}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":k.label("availability-summary"),children:[s,":"," ",V("availability",s)]}),e.jsx("button",{className:"mt-2 px-4 py-3 sm:px-3 sm:py-2 text-sm sm:text-xs min-h-[44px] min-w-[44px] bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors",onClick:()=>w("availability"),"data-testid":k.button("availability-details"),children:"View details"}),R==="availability"&&e.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":k.label("availability-changed"),children:"âœ“ Security level updated"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-medium mb-4",children:[g.charAt(0).toUpperCase()+g.slice(1)," ","Details"]}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 h-full","data-testid":`${g}-details-content`,children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:`font-medium ${te(g)}`,children:[g==="availability"?s:g==="integrity"?a:i," ","Level"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:h.description||"No description available"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Technical Implementation"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:h.technical||"No technical details available"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Business Impact"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:h.businessImpact||"No business impact details available"})]}),g==="availability"&&e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Uptime"}),e.jsx("div",{className:"text-sm",children:h.uptime||"N/A"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Time"}),e.jsx("div",{className:"text-sm",children:h.rto||"N/A"})]})]}),g==="integrity"&&h.validationMethod&&e.jsxs("div",{className:"mt-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-green-700 dark:text-green-300",children:"Validation Method"}),e.jsx("div",{className:"text-sm",children:h.validationMethod})]}),g==="confidentiality"&&h.protectionMethod&&e.jsxs("div",{className:"mt-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Protection Method"}),e.jsx("div",{className:"text-sm",children:h.protectionMethod})]})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:e.jsx("p",{children:"No details available for this security level."})})})]})]}),e.jsxs("div",{className:"mt-6 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-md font-medium mb-2",children:"Security Level Overview"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Higher security levels provide stronger protection but typically require more resources to implement and maintain. Consider your organization's needs and constraints when selecting security levels."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-xs",children:[e.jsxs("div",{className:"p-2 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-red-700 dark:text-red-300",children:"None"}),e.jsx("div",{className:"text-red-600 dark:text-red-400",children:"Minimal to no security controls"})]}),e.jsxs("div",{className:"p-2 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Low"}),e.jsx("div",{className:"text-yellow-600 dark:text-yellow-400",children:"Basic security controls"})]}),e.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Moderate"}),e.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:"Standard security controls"})]}),e.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-green-700 dark:text-green-300",children:"High"}),e.jsx("div",{className:"text-green-600 dark:text-green-400",children:"Advanced security controls"})]}),e.jsxs("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Very High"}),e.jsx("div",{className:"text-purple-600 dark:text-purple-400",children:"Maximum security controls"})]})]})]})]})})})},he={sm:"px-1.5 py-0.5 text-xs",md:"px-2 py-1 text-sm",lg:"px-2.5 py-1.5 text-base"},G=Y.memo(({shortcut:s,size:a="sm",className:i="",platformSpecific:m=!0})=>{const n=m?X():"windows",d=oe(s,n);return e.jsx("span",{className:`inline-flex items-center gap-0.5 ${i}`,"data-testid":A.SHORTCUT_BADGE,"aria-label":`Keyboard shortcut: ${s}`,children:d.map((t,o)=>e.jsxs(Y.Fragment,{children:[e.jsx("kbd",{className:`
              ${he[a]}
              font-mono font-semibold
              bg-gray-100 dark:bg-gray-700
              text-gray-700 dark:text-gray-300
              border border-gray-300 dark:border-gray-600
              rounded shadow-sm
              inline-flex items-center justify-center
              min-w-[1.5em]
            `,"data-testid":A.SHORTCUT_BADGE_KEY,children:t}),o<d.length-1&&e.jsx("span",{className:"text-gray-400 dark:text-gray-500 text-xs","aria-hidden":"true",children:"+"})]},o))})});G.displayName="ShortcutBadge";const Z=r.createContext(void 0);function ye({children:s,initialShortcuts:a={},defaultEnabled:i=!0}){const[m,n]=r.useState(a),[d,t]=r.useState(i),[o,x]=r.useState(!1),p=X(),b=r.useCallback(c=>{L.debug("Registering keyboard shortcut",{id:c.id,keys:c.keys,description:c.description}),n(E=>({...E,[c.id]:c}))},[]),v=r.useCallback(c=>{L.debug("Unregistering keyboard shortcut",{id:c}),n(E=>{const{[c]:h,...N}=E;return N})},[]),f=r.useCallback(c=>{L.debug("Setting keyboard shortcuts enabled",{enabled:c}),t(c)},[]),g=r.useCallback(c=>{L.debug("Setting keyboard shortcut help visibility",{show:c}),x(c)},[]),w=r.useMemo(()=>({shortcuts:m,registerShortcut:b,unregisterShortcut:v,isEnabled:d,setEnabled:f,platform:p,showHelp:o,setShowHelp:g}),[m,b,v,d,f,p,o,g]);return e.jsx(Z.Provider,{value:w,children:s})}function J(){const s=r.useContext(Z);if(s===void 0)throw new Error("useKeyboardShortcutContext must be used within a KeyboardShortcutProvider");return s}const pe=({isOpen:s,onClose:a,shortcuts:i})=>{const m=J(),n=i||m.shortcuts,d=r.useMemo(()=>{const t={};return Object.values(n).forEach(o=>{const x=o.category;t[x]||(t[x]=[]),t[x].push(o)}),t},[n]);return r.useEffect(()=>{if(!s)return;const t=o=>{o.key==="Escape"&&(a(),o.preventDefault(),o.stopPropagation())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[s,a]),r.useEffect(()=>{if(!s)return;let t;const o=requestAnimationFrame(()=>{const x=document.querySelector('[role="dialog"]');if(!x)return;const p=x.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),b=p[0],v=p[p.length-1],f=g=>{g.key==="Tab"&&(g.shiftKey&&document.activeElement===b?(g.preventDefault(),v?.focus()):!g.shiftKey&&document.activeElement===v&&(g.preventDefault(),b?.focus()))};x.addEventListener("keydown",f),b?.focus(),t=()=>x.removeEventListener("keydown",f)});return()=>{cancelAnimationFrame(o),t?.()}},[s]),s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",onClick:a,"data-testid":A.HELP_MODAL,"aria-label":"Close keyboard shortcuts dialog by clicking outside",children:e.jsxs("div",{role:"dialog","aria-modal":"true","aria-labelledby":"keyboard-shortcuts-title",className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsx("h2",{id:"keyboard-shortcuts-title",className:"text-2xl font-bold text-gray-900 dark:text-white","data-testid":A.HELP_MODAL_TITLE,children:"âŒ¨ï¸ Keyboard Shortcuts"}),e.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors","aria-label":"Close keyboard shortcuts","data-testid":A.HELP_MODAL_CLOSE,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"overflow-y-auto p-6 flex-1",children:Object.entries(d).map(([t,o])=>e.jsxs("div",{className:"mb-6 last:mb-0","data-testid":A.HELP_MODAL_CATEGORY,children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:de[t]||t}),e.jsx("div",{className:"space-y-2",children:o.map(x=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors","data-testid":A.HELP_MODAL_SHORTCUT,children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:x.description}),e.jsx(G,{shortcut:x.keys,size:"md",platformSpecific:!0})]},x.id))})]},t))}),e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:["Press ",e.jsx(G,{shortcut:"Escape",size:"sm"})," to close this dialog"]})})]})}):null},C=({lines:s=3,testId:a="loading-skeleton",className:i=""})=>e.jsxs("div",{className:`animate-pulse space-y-4 ${i}`,"data-testid":a,role:"status","aria-label":"Loading content",children:[Array.from({length:s}).map((m,n)=>e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded","data-testid":`${a}-line-${n}`,"aria-hidden":"true"},`skeleton-line-${n}`)),e.jsx("span",{className:"sr-only",children:"Loading..."})]}),be=r.lazy(()=>_(()=>import("./widgets-assessment-29On9S3B.js").then(s=>s.ak),__vite__mapDeps([0,1,2]),import.meta.url)),fe=r.lazy(()=>_(()=>import("./widgets-assessment-29On9S3B.js").then(s=>s.al),__vite__mapDeps([0,1,2]),import.meta.url)),ve=r.lazy(()=>_(()=>import("./widgets-business-D7qMJ3X_.js").then(s=>s.C),__vite__mapDeps([3,1,0,2]),import.meta.url)),Ne=r.lazy(()=>_(()=>import("./widgets-business-D7qMJ3X_.js").then(s=>s.a),__vite__mapDeps([3,1,0,2]),import.meta.url)),ke=r.lazy(()=>_(()=>import("./widgets-business-D7qMJ3X_.js").then(s=>s.V),__vite__mapDeps([3,1,0,2]),import.meta.url)),je=r.lazy(()=>_(()=>import("./widgets-impact-DO1JXM6x.js").then(s=>s.A),__vite__mapDeps([4,1,0,2]),import.meta.url)),Ee=r.lazy(()=>_(()=>import("./widgets-impact-DO1JXM6x.js").then(s=>s.C),__vite__mapDeps([4,1,0,2]),import.meta.url)),Ce=r.lazy(()=>_(()=>import("./widgets-impact-DO1JXM6x.js").then(s=>s.I),__vite__mapDeps([4,1,0,2]),import.meta.url)),Ie=r.lazy(()=>_(()=>import("./widgets-implementation-C_zdtplH.js").then(s=>s.S),__vite__mapDeps([5,1,0,2]),import.meta.url)),_e=r.lazy(()=>_(()=>import("./widgets-visualization-tL4nrDWu.js"),__vite__mapDeps([6,1,0,2]),import.meta.url)),we=r.lazy(()=>_(()=>import("./widgets-implementation-C_zdtplH.js").then(s=>s.T),__vite__mapDeps([5,1,0,2]),import.meta.url)),Le=()=>{const s="1.1.3",{showHelp:a,setShowHelp:i}=J(),m={availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},[n,d]=Q("securityLevels",m),{levels:t,setLevel:o}=me(n);r.useEffect(()=>{d(t)},[t,d]);const x=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,[p,b]=Q("darkMode",x);r.useEffect(()=>{console.log("CIA App Security Levels:",{availability:t.availability,integrity:t.integrity,confidentiality:t.confidentiality})},[t]);const v=r.useCallback(h=>{console.log("CIAClassificationApp: Setting availability level to:",h),o("availability",h)},[o]),f=r.useCallback(h=>{console.log("CIAClassificationApp: Setting integrity level to:",h),o("integrity",h)},[o]),g=r.useCallback(h=>{console.log("CIAClassificationApp: Setting confidentiality level to:",h),o("confidentiality",h)},[o]),w=()=>{b(h=>!h)},c=r.useCallback((h,N)=>{L.error("Widget error caught by error boundary",{error:h,errorInfo:N})},[]),E=r.useMemo(()=>({[D.SHOW_HELP.id]:{...D.SHOW_HELP,handler:()=>i(!0)},[D.SHOW_HELP_ALT.id]:{...D.SHOW_HELP_ALT,handler:()=>i(!0)}}),[i]);return ge({shortcuts:E,enabled:!0,preventDefault:!0}),r.useEffect(()=>{p?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[p]),e.jsx("div",{className:"app-container",children:e.jsxs("div",{className:`min-h-screen ${p?"dark bg-gray-900":"bg-gray-100"} p-4 transition-colors duration-300`,children:[e.jsxs("div",{className:"mb-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded-lg shadow-md flex justify-between items-center app-header",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center overflow-hidden mr-1.5",children:e.jsx("img",{src:"./icon-192.png",alt:"CIA Compliance Manager Logo",style:{transform:"scale(0.2)"},"data-testid":I.APP_LOGO})}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("h1",{"data-testid":I.APP_TITLE,className:"text-sm font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300 mr-2",children:ce.APP_TITLE}),e.jsxs("div",{className:"cyber-nav flex items-center flex-wrap",children:[e.jsx("span",{className:"inline-block pulse-dot mr-1","data-testid":I.APP_INDICATOR,children:"â– "}),e.jsxs("span",{className:"mr-1 version-tag","data-testid":I.APP_VERSION,children:["v",s]}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://github.com/Hack23/cia-compliance-manager",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":I.SOURCE_LINK,children:"Source"}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://www.hack23.com/cia-compliance-manager-features.html",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":I.DOCS_LINK,children:"Doc"}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://hack23.com/",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":I.AUTHOR_LINK,children:"Hack23"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>i(!0),className:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 rounded transition-colors",title:"Keyboard Shortcuts (? or Ctrl+/)","data-testid":I.KEYBOARD_SHORTCUTS_BUTTON,children:"âŒ¨ï¸ Shortcuts"}),e.jsx("button",{onClick:w,className:"theme-toggle-btn","data-testid":I.THEME_TOGGLE,children:p?"â˜€ï¸ Light":"ðŸŒ™ Dark"})]})]}),e.jsx("div",{className:"w-full max-w-[1600px] mx-auto",children:e.jsxs("div",{"data-testid":I.DASHBOARD_GRID,className:"dashboard-grid-container",children:[e.jsx("div",{className:"grid-widget-container",children:e.jsx(xe,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,onAvailabilityChange:v,onIntegrityChange:f,onConfidentialityChange:g,testId:"widget-security-level"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Business Impact Analysis",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-business-impact"}),children:e.jsx(be,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-business-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Security Summary",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-security-summary"}),children:e.jsx(fe,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-security-summary"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Value Creation",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-value-creation"}),children:e.jsx(ke,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-value-creation"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Cost Estimation",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-cost-estimation"}),children:e.jsx(Ne,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-cost-estimation"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Compliance Status",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-compliance-status"}),children:e.jsx(ve,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-compliance-status"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Confidentiality Impact",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-confidentiality-impact"}),children:e.jsx(Ee,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-confidentiality-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Integrity Impact",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-integrity-impact"}),children:e.jsx(Ce,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-integrity-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Availability Impact",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-availability-impact"}),children:e.jsx(je,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-availability-impact"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Technical Details",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-technical-details"}),children:e.jsx(we,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-technical-details"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Security Visualization",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-security-visualization"}),children:e.jsx(_e,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-security-visualization"})})})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(j,{widgetName:"Security Resources",onError:c,children:e.jsx(r.Suspense,{fallback:e.jsx(C,{lines:5,className:"p-4",testId:"loading-security-resources"}),children:e.jsx(Ie,{availabilityLevel:t.availability,integrityLevel:t.integrity,confidentialityLevel:t.confidentiality,testId:"widget-security-resources"})})})})]})}),e.jsx(pe,{isOpen:a,onClose:()=>i(!1)})]})})};class T{static instance;static getInstance(){return T.instance||(T.instance=new T),T.instance}constructor(){}logError(a,i,m="medium"){const n={message:a.message,severity:m,context:i,stack:a.stack,timestamp:new Date().toISOString(),userMessage:this.getUserFriendlyMessage(a),recoverable:this.canRecover(a)};switch(m){case"critical":case"high":L.error("[CIA Compliance Manager Error]",{...n,error:a});break;case"medium":L.warn("[CIA Compliance Manager Warning]",{...n,error:a});break;case"low":L.info("[CIA Compliance Manager Info]",{...n,error:a});break;default:L.error("[CIA Compliance Manager Error]",{...n,error:a})}}getUserFriendlyMessage(a){if(B(a)){if(a.code===l.VALIDATION_ERROR){const i=a.context.field;return i?`Please check the ${i} field and try again.`:"Please check your input and try again."}if(z(a)){const i=a.context.statusCode;return i===404?"The requested resource was not found.":i===401||i===403?"You do not have permission to access this resource.":i&&i>=500?"Server error. Please try again later.":"Network connection issue. Please check your connection and try again."}if(F(a)){const i=a.context.retryAfter;return i?`Operation failed. Please try again in ${i} seconds.`:"Operation failed. Please try again."}switch(a.code){case l.INVALID_SECURITY_LEVEL:case l.INVALID_COMPONENT_TYPE:case l.INVALID_INPUT:case l.MISSING_REQUIRED_FIELD:return"Invalid input provided. Please check your data and try again.";case l.DATA_NOT_FOUND:return"The requested data could not be found.";case l.DATA_PROVIDER_ERROR:case l.CONFIGURATION_ERROR:return"System configuration error. Please contact support.";case l.CALCULATION_ERROR:case l.COMPLIANCE_CHECK_ERROR:case l.ROI_CALCULATION_ERROR:return"Error processing your request. Please try again.";case l.TIMEOUT_ERROR:return"Operation timed out. Please try again.";case l.CONNECTION_ERROR:return"Connection error. Please check your network.";case l.RATE_LIMIT_ERROR:return"Too many requests. Please wait a moment and try again.";case l.INTERNAL_ERROR:case l.UNEXPECTED_ERROR:default:return"An unexpected error occurred. Please try again."}}if(a instanceof Error){const i=a.message.toLowerCase();if(i.includes("network")||i.includes("fetch"))return"Network connection issue. Please check your connection and try again.";if(i.includes("timeout"))return"Operation timed out. Please try again.";if(i.includes("permission")||i.includes("unauthorized"))return"You do not have permission to perform this action."}return"An unexpected error occurred. Please try again."}canRecover(a){if(F(a)||z(a)||ue(a))return!0;if(B(a))switch(a.code){case l.INVALID_SECURITY_LEVEL:case l.INVALID_COMPONENT_TYPE:case l.INVALID_INPUT:case l.MISSING_REQUIRED_FIELD:case l.DATA_NOT_FOUND:case l.TIMEOUT_ERROR:case l.CONNECTION_ERROR:case l.RATE_LIMIT_ERROR:return!0;default:return!1}if(a instanceof Error){const i=a.message.toLowerCase();if(i.includes("network")||i.includes("timeout")||i.includes("fetch"))return!0}return!1}getErrorSeverity(a){if(B(a)){if(a.code===l.VALIDATION_ERROR)return"low";if(z(a)){const i=a.context.statusCode;return i&&i>=500?"high":"medium"}if(F(a))return"medium";switch(a.code){case l.INVALID_INPUT:case l.MISSING_REQUIRED_FIELD:return"low";case l.DATA_NOT_FOUND:case l.INVALID_SECURITY_LEVEL:case l.INVALID_COMPONENT_TYPE:case l.TIMEOUT_ERROR:case l.CONNECTION_ERROR:return"medium";case l.DATA_PROVIDER_ERROR:case l.CONFIGURATION_ERROR:case l.CALCULATION_ERROR:case l.COMPLIANCE_CHECK_ERROR:case l.ROI_CALCULATION_ERROR:return"high";case l.INTERNAL_ERROR:case l.UNEXPECTED_ERROR:return"critical";case l.RATE_LIMIT_ERROR:return"medium";default:return"high"}}return"high"}formatErrorForDisplay(a,i=!1){const m=this.getUserFriendlyMessage(a);return i&&a instanceof Error?`${m}

Technical details: ${a.message}`:m}}const K=T.getInstance(),Re=s=>{switch(s){case"top-left":return"top-4 left-4";case"top-center":return"top-4 left-1/2 -translate-x-1/2";case"top-right":return"top-4 right-4";case"bottom-left":return"bottom-4 left-4";case"bottom-center":return"bottom-4 left-1/2 -translate-x-1/2";case"bottom-right":return"bottom-4 right-4";default:return"top-4 right-4"}},Se=({message:s,title:a="Error",isVisible:i,onDismiss:m,autoHideDuration:n=5e3,position:d="top-right",retry:t,testId:o="error-toast"})=>{const[x,p]=r.useState(!1),b=r.useCallback(()=>{p(!0),setTimeout(()=>{p(!1),m()},300)},[m]);if(r.useEffect(()=>{if(i&&n>0){const f=setTimeout(()=>{b()},n);return()=>clearTimeout(f)}},[i,n,b]),!i&&!x)return null;const v=Re(d);return e.jsxs("div",{className:`fixed ${v} z-50 transform transition-all duration-300 ${x?"opacity-0 scale-95":"opacity-100 scale-100"}`,"data-testid":o,role:"alert","aria-live":"assertive","aria-atomic":"true",children:[e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg border-l-4 border-red-500 dark:border-red-600 overflow-hidden",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-6 w-6 text-red-500 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100","data-testid":`${o}-title`,children:a}),e.jsx("p",{className:"mt-1 text-sm text-gray-700 dark:text-gray-300","data-testid":`${o}-message`,children:s})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{onClick:b,className:"inline-flex text-gray-400 hover:text-gray-500 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none focus:ring-2 focus:ring-red-500 rounded","data-testid":`${o}-close-button`,"aria-label":"Close notification",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]}),t&&e.jsx("div",{className:"mt-3",children:e.jsxs("button",{onClick:()=>{t(),b()},className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 focus:outline-none focus:ring-2 focus:ring-red-500 rounded","data-testid":`${o}-retry-button`,"aria-label":"Retry operation",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Retry"]})})]}),n>0&&i&&!x&&e.jsx("div",{className:"h-1 bg-gray-200 dark:bg-gray-700 overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500 dark:bg-red-600 animate-progress",style:{animation:`progress ${n}ms linear`}})})]}),e.jsx("style",{children:`
        @keyframes progress {
          from {
            width: 100%;
          }
          to {
            width: 0%;
          }
        }
        .animate-progress {
          animation: progress linear;
        }
      `})]})},Ae=r.createContext(void 0),Te=({children:s,maxErrors:a=10,defaultToastPosition:i="top-right",defaultAutoHideDuration:m=5e3})=>{const[n,d]=r.useState([]),[t,o]=r.useState(null),[x,p]=r.useState(!1),b=r.useCallback(()=>`error-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,[]),v=r.useCallback((N,R)=>{K.logError(N,R);const S={id:b(),error:N,message:K.getUserFriendlyMessage(N),timestamp:new Date,recoverable:K.canRecover(N),context:R};d(P=>[S,...P].slice(0,a))},[a,b]),f=r.useCallback(N=>{d(R=>R.filter(S=>S.id!==N))},[]),g=r.useCallback(()=>{d([])},[]),w=r.useCallback(N=>{o(N),p(!0)},[]),c=r.useCallback(()=>{p(!1),setTimeout(()=>{o(null)},300)},[]),E=r.useCallback(()=>n[0],[n]),h=r.useMemo(()=>({errors:n,addError:v,clearError:f,clearAllErrors:g,showToast:w,hideToast:c,getLatestError:E}),[n,v,f,g,w,c,E]);return e.jsxs(Ae.Provider,{value:h,children:[s,t&&e.jsx(Se,{message:t.message,title:t.title,isVisible:x,onDismiss:c,autoHideDuration:t.autoHideDuration??m,position:t.position??i,retry:t.retry})]})};function Oe(){return e.jsx(Te,{children:e.jsx(ye,{children:e.jsx("div",{className:"app-container","data-testid":I.APP_CONTAINER,children:e.jsx(Le,{})})})})}const De=ae.createRoot(document.getElementById("root"));De.render(e.jsx(Y.StrictMode,{children:e.jsx(Oe,{})}));
//# sourceMappingURL=index-CjtRRDyU.js.map
