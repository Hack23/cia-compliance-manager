import{r as c,j as t,R as L}from"./react-vendor-BzhlA2NX.js";import{e as w,i as C,t as j,v as _,w as O,x as W,y as Y,z as F,A as I,B as $,D as R,T as h,E as K,F as V,G,H as U,I as z,J as X,W as J,a as H,b as Q,c as q,g as Z,d as E,m as ee,K as te,L as f,M as ae,N as M,O as re,P,Q as se,R as D}from"./widgets-assessment-D7kXuOip.js";function ie(e,a){const{ciaContentService:s}=w();return c.useMemo(()=>{if(C(s))return null;try{const n=s.getComponentDetails(e,a);return C(n)?null:n}catch(n){return console.error(`Error getting ${e} details:`,n),null}},[s,e,a])}function ne(e,a){const{ciaContentService:s}=w();return c.useMemo(()=>{if(C(s))return j(e,a);try{return s.getBusinessImpact(e,a)||j(e,a)}catch(n){return console.error(`Error getting ${e} business impact:`,n),j(e,a)}},[s,e,a])}function Ie(e){const[a,s]=c.useState({availability:e?.availability??"Moderate",integrity:e?.integrity??"Moderate",confidentiality:e?.confidentiality??"Moderate"}),o=c.useCallback((r,l)=>{s(m=>({...m,[r]:l}))},[]),n=c.useCallback((r="Moderate")=>{s({availability:r,integrity:r,confidentiality:r})},[]),i=c.useCallback(r=>a[r],[a]);return{levels:a,setLevel:o,resetLevels:n,getLevel:i}}function ve(e,a){const[s,o]=c.useState(()=>{if(typeof window>"u")return a;try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):a}catch(i){return console.warn(`Error reading localStorage key "${e}":`,i),a}}),n=c.useCallback(i=>{try{o(r=>{const l=i instanceof Function?i(r):i;return typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(l)),l})}catch(r){console.error(`Error saving to localStorage key "${e}":`,r)}},[e]);return c.useEffect(()=>{if(typeof window>"u")return;const i=r=>{if(r.key===e&&r.newValue!==null)try{o(JSON.parse(r.newValue))}catch(l){console.warn(`Error parsing storage event for key "${e}":`,l)}};return window.addEventListener("storage",i),()=>{window.removeEventListener("storage",i)}},[e]),[s,n]}function he(e){const{shortcuts:a,enabled:s=!0,preventDefault:o=!0,stopPropagation:n=!1}=e,i=c.useRef(a),r=c.useRef({preventDefault:o,stopPropagation:n});c.useEffect(()=>{i.current=a,r.current={preventDefault:o,stopPropagation:n}},[a,o,n]);const l=c.useCallback(m=>{if(!_()||O(m))return;const d=W(m),u=Object.values(i.current).find(y=>{if(y.enabled===!1)return!1;const N=Y(y.keys,y.platformKeys);return F(d,N)});if(u){I.debug("Keyboard shortcut triggered",{id:u.id,keys:d,description:u.description}),r.current.preventDefault&&m.preventDefault(),r.current.stopPropagation&&m.stopPropagation();try{u.handler()}catch(y){I.error("Error executing keyboard shortcut handler",{id:u.id,error:y})}}},[]);c.useEffect(()=>{if(!(!s||!_()))return I.debug("Registering keyboard shortcuts"),window.addEventListener("keydown",l),()=>{I.debug("Unregistering keyboard shortcuts"),window.removeEventListener("keydown",l)}},[s,l])}const le=e=>{switch(e){case"blue":return"bg-blue-100 dark:bg-blue-900 border-blue-200 dark:border-blue-800";case"green":return"bg-green-100 dark:bg-green-900 border-green-200 dark:border-green-800";case"orange":return"bg-orange-100 dark:bg-orange-900 border-orange-200 dark:border-orange-800";default:{const a=e;throw new Error(`Unsupported color: ${String(a)}`)}}},oe=e=>{switch(e){case"blue":return"text-blue-700 dark:text-blue-300";case"green":return"text-green-700 dark:text-green-300";case"orange":return"text-orange-700 dark:text-orange-300";default:{const a=e;throw new Error(`Unsupported color: ${String(a)}`)}}},de=e=>{switch(e){case"blue":return"bg-blue-50 text-blue-700 dark:bg-blue-900 dark:bg-opacity-50 dark:text-blue-300";case"green":return"bg-green-50 text-green-700 dark:bg-green-900 dark:bg-opacity-50 dark:text-green-300";case"orange":return"bg-orange-50 text-orange-700 dark:bg-orange-900 dark:bg-opacity-50 dark:text-orange-300";default:{const a=e;throw new Error(`Unsupported color: ${String(a)}`)}}},ce=({impact:e,color:a,testId:s="business-impact-section"})=>{const o=e.financial?.riskLevel||e.operational?.riskLevel||"Unknown",n=le(a),i=oe(a),r=de(a);return t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card","data-testid":s,children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact",t.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Risk: ",o]})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${s}-summary`,children:e.summary||"No business impact data available"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.financial&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’°"}),t.jsx("span",{className:`font-medium ${i}`,children:"Financial Impact"})]}),t.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300",children:e.financial.description||"No financial impact information available"}),e.financial.annualRevenueLoss&&t.jsxs("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Annual Revenue Loss: "}),e.financial.annualRevenueLoss]})]}),e.operational&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),t.jsx("span",{className:`font-medium ${i}`,children:"Operational Impact"})]}),t.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300",children:e.operational.description||"No operational impact information available"}),e.operational.meanTimeToRecover&&t.jsxs("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Mean Time to Recover: "}),e.operational.meanTimeToRecover]})]}),e.reputational&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ†"}),t.jsx("span",{className:`font-medium ${i}`,children:"Reputational Impact"})]}),t.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300",children:e.reputational.description||"No reputational impact information available"}),e.reputational.reputationalImpact&&t.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:e.reputational.reputationalImpact})]}),e.strategic&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),t.jsx("span",{className:`font-medium ${i}`,children:"Strategic Impact"})]}),t.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300",children:e.strategic.description||"No strategic impact information available"}),e.strategic.competitiveAdvantage&&t.jsxs("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Competitive Advantage: "}),e.strategic.competitiveAdvantage]})]}),e.regulatory&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),t.jsx("span",{className:`font-medium ${i}`,children:"Regulatory Impact"})]}),t.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300",children:e.regulatory.description||"No regulatory impact information available"}),e.regulatory.complianceImpact&&t.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 mt-1",children:e.regulatory.complianceImpact}),e.regulatory.complianceViolations&&e.regulatory.complianceViolations.length>0&&t.jsxs("div",{className:"mt-1",children:[t.jsxs("span",{className:"text-xs font-medium text-gray-700 dark:text-gray-300",children:["Potential Violations:"," "]}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.regulatory.complianceViolations.map((l,m)=>t.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${r}`,children:l},m))})]})]})]})]})},p=({label:e,value:a,unit:s,icon:o,description:n,variant:i="default",testId:r="metric-card",className:l="",ariaLabel:m})=>{const u={default:{container:"border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",value:"text-gray-800 dark:text-gray-200",label:"text-gray-700 dark:text-gray-300",description:"text-gray-600 dark:text-gray-400"},primary:{container:"border-primary-light dark:border-primary-dark bg-primary-light/10 dark:bg-primary-dark/20",value:"text-primary-dark dark:text-primary-light",label:"text-primary-dark dark:text-primary-light",description:"text-primary-dark/70 dark:text-primary-light/70"},success:{container:"border-green-300 dark:border-green-700 bg-green-50 dark:bg-green-900/20",value:"text-green-700 dark:text-green-300",label:"text-green-700 dark:text-green-300",description:"text-green-600 dark:text-green-400"},warning:{container:"border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",value:"text-yellow-700 dark:text-yellow-300",label:"text-yellow-700 dark:text-yellow-300",description:"text-yellow-600 dark:text-yellow-400"},error:{container:"border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20",value:"text-red-700 dark:text-red-300",label:"text-red-700 dark:text-red-300",description:"text-red-600 dark:text-red-400"},info:{container:"border-blue-300 dark:border-blue-700 bg-blue-50 dark:bg-blue-900/20",value:"text-blue-700 dark:text-blue-300",label:"text-blue-700 dark:text-blue-300",description:"text-blue-600 dark:text-blue-400"}}[i];return t.jsxs("div",{className:`p-4 border ${u.container} ${l}`,style:{borderRadius:R.md,boxShadow:$.sm},"data-testid":r,"aria-label":m||`${e}: ${a}${s||""}`,children:[t.jsxs("div",{className:`flex items-center ${o?"justify-between":"justify-end"} mb-2`,children:[o&&t.jsx("span",{className:"text-xl","aria-hidden":"true",children:o}),t.jsxs("span",{className:`text-2xl font-bold ${u.value}`,style:{fontSize:h.title},"data-testid":`${r}-value`,children:[a,s&&t.jsx("span",{className:s.startsWith(" ")?"":"ml-1",children:s})]})]}),t.jsx("p",{className:`text-sm font-medium mb-1 ${u.label}`,style:{fontSize:h.body},"data-testid":`${r}-label`,children:e}),n&&t.jsx("p",{className:`text-xs ${u.description}`,style:{fontSize:h.caption},"data-testid":`${r}-description`,children:n})]})},v=({title:e,children:a,subtitle:s,icon:o,className:n="",testId:i="widget-section",ariaLabelledBy:r,variant:l="default"})=>{const m={default:"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",primary:"border-primary-light dark:border-primary-dark bg-primary-light/10 dark:bg-primary-dark/20",success:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20",info:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20",warning:"border-yellow-200 dark:border-yellow-800 bg-yellow-50 dark:bg-yellow-900/20",error:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20"},d=r||`${i}-heading`;return t.jsxs("section",{className:`border ${m[l]} ${n}`,style:{padding:K.md,borderRadius:R.md,boxShadow:$.sm},"data-testid":i,"aria-labelledby":d,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o&&t.jsx("span",{"aria-hidden":"true",children:o}),t.jsx("h3",{style:{fontSize:h.subheading},className:"font-semibold text-gray-800 dark:text-gray-200",id:d,children:e})]}),s&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:s}),t.jsx("div",{children:a})]})},ge=e=>{switch(e){case"availability":return{titleKey:"AVAILABILITY_IMPACT",iconKey:"AVAILABILITY_IMPACT",defaultTitle:"Availability Impact Analysis",defaultIcon:"â±ï¸",color:"blue",textClass:"text-blue-800 dark:text-blue-300",ariaDescription:"Business impact of availability controls including uptime targets and recovery objectives",categoryLabel:"Availability",containerClassName:"cia-availability",contentClassName:"cia-widget",getSecurityBadgeTestId:(a,s)=>s.label("security-level")};case"integrity":return{titleKey:"INTEGRITY_IMPACT",iconKey:"INTEGRITY_IMPACT",defaultTitle:"Integrity Impact Analysis",defaultIcon:"âœ“",color:"green",textClass:"text-green-800 dark:text-green-300",ariaDescription:"Business impact of integrity controls including data accuracy and validation mechanisms",categoryLabel:"Integrity",containerClassName:"",contentClassName:"",getSecurityBadgeTestId:(a,s)=>s.label("security-badge")};case"confidentiality":return{titleKey:"CONFIDENTIALITY_IMPACT",iconKey:"CONFIDENTIALITY_IMPACT",defaultTitle:"Confidentiality Impact Analysis",defaultIcon:"ðŸ”’",color:"orange",textClass:"text-orange-800 dark:text-orange-300",ariaDescription:"Business impact of confidentiality controls including data classification and privacy measures",categoryLabel:"Confidentiality",containerClassName:"overflow-visible",contentClassName:"max-h-[550px] overflow-y-auto pr-1",getSecurityBadgeTestId:(a,s)=>s.label("security-badge")};default:{const a=e;throw new Error(`Unsupported CIA component in ImpactWidget: ${String(a)}`)}}},ue=e=>{switch(e){case"availability":return{prefix:D.AVAILABILITY_IMPACT_PREFIX,widgetIds:se};case"integrity":return{prefix:P.INTEGRITY_IMPACT_PREFIX,widgetIds:re};case"confidentiality":return{prefix:M.CONFIDENTIALITY_IMPACT_PREFIX,widgetIds:ae};default:{const a=e;throw new Error(`Unsupported CIA component in getTestIds: ${String(a)}`)}}},me=e=>{switch(e){case"blue":return"border-blue-500";case"green":return"border-green-500";case"orange":return"border-orange-500";default:{const a=e;throw new Error(`Unsupported color: ${String(a)}`)}}},k=L.memo(({component:e,level:a,className:s="",testId:o,showExtendedDetails:n=!1,onError:i})=>{const r=c.useMemo(()=>ge(e),[e]),l=c.useMemo(()=>ue(e),[e]),m=o||l.prefix,d=c.useMemo(()=>V(a||"Moderate"),[a]),{ciaContentService:u,error:y,isLoading:N}=w(),T=c.useCallback(g=>{i&&i(g)},[i]);L.useEffect(()=>{y&&T(y)},[y,T]);const x=ie(e,d),S=ne(e,d),A=c.useMemo(()=>{if(!n||!u)return[];try{return u.getRecommendations(e,d)||[]}catch(g){return console.error(`Error getting ${e} recommendations:`,g),[]}},[n,u,e,d]),b=c.useMemo(()=>{switch(e){case"availability":{const g=X(d);return{type:"availability",data:{uptime:x?.uptime||g.uptime,rto:x?.rto||g.rto,rpo:x?.rpo||g.rpo,mttr:x?.mttr||g.mttr,sla:x?.sla||g.sla}}}case"integrity":return{type:"integrity",data:{validationLevel:x?.validationLevel||z(d),errorRate:x?.errorRate||U(d)}};case"confidentiality":{let g;if(u)try{g=u.getInformationSensitivity(d)}catch{g=`${d} Classification`}else g=`${d} Classification`;return{type:"confidentiality",data:{dataClassification:g,privacyImpact:x?.privacyImpact||G(d)}}}default:{const g=e;throw new Error(`Unsupported CIA component in metrics calculation: ${String(g)}`)}}},[e,d,x,u]);return t.jsx(J,{widgetName:`${r.categoryLabel} Impact`,children:t.jsx(H,{title:q[r.titleKey]||r.defaultTitle,icon:Q[r.iconKey]||r.defaultIcon,className:`${s} ${r.containerClassName}`,testId:m,isLoading:N,error:y,children:t.jsxs("div",{className:E("p-sm sm:p-md border-l-4",me(r.color),r.contentClassName),role:"region","aria-label":Z(r.defaultTitle,r.ariaDescription),children:[t.jsxs("section",{className:"mb-md","aria-labelledby":`${e}-level-heading`,children:[t.jsxs("h3",{id:`${e}-level-heading`,className:"sr-only",children:["Current ",r.categoryLabel," Security Level"]}),t.jsx(ee,{category:r.categoryLabel,level:d,colorClass:te(r.color),textClass:r.textClass,testId:r.getSecurityBadgeTestId(m,l.widgetIds)})]}),S&&t.jsxs("section",{className:"mb-sm","aria-labelledby":`${e}-business-impact-heading`,children:[t.jsx("h3",{id:`${e}-business-impact-heading`,className:f.heading,children:"Business Impact"}),t.jsx(ce,{impact:S,color:r.color,testId:l.widgetIds.section("business-impact")})]}),b.type==="availability"&&t.jsxs(v,{title:"SLA Metrics",icon:"â±ï¸",variant:"info",className:"mb-md",ariaLabelledBy:"sla-metrics-heading",testId:l.widgetIds.section("sla-metrics"),children:[t.jsxs("div",{className:E(f.grid3Cols,"mb-md"),role:"group","aria-label":"Service level agreement metrics",children:[t.jsx(p,{label:"Uptime Target",value:b.data.uptime,icon:"ðŸ“ˆ",description:"Expected system availability",variant:"info",testId:l.widgetIds.label("uptime")}),t.jsx(p,{label:"Recovery Time Objective",value:b.data.rto,icon:"â±ï¸",description:"Time to restore service",variant:"info",testId:l.widgetIds.label("rto")}),t.jsx(p,{label:"Recovery Point Objective",value:b.data.rpo,icon:"ðŸ’¾",description:"Maximum data loss allowed",variant:"info",testId:l.widgetIds.label("rpo")})]}),t.jsx("div",{className:f.grid2Cols,children:t.jsx(p,{label:"Service Level Agreement",value:b.data.sla,icon:"ðŸ“‹",description:"Support coverage period",variant:"info",testId:l.widgetIds.label("sla")})})]}),b.type==="integrity"&&t.jsx(v,{title:"Data Integrity Metrics",icon:"ðŸ“Š",variant:"success",className:"mb-md",testId:l.widgetIds.section("metrics"),children:t.jsxs("div",{className:f.grid2Cols,children:[t.jsx(p,{label:"Data Validation Controls",value:b.data.validationLevel,icon:"âœ“",variant:"success",testId:l.widgetIds.label("validation")}),t.jsx(p,{label:"Acceptable Error Rate",value:b.data.errorRate,icon:"ðŸ“‰",variant:"success",testId:l.widgetIds.label("error-rate")})]})}),b.type==="confidentiality"&&t.jsxs(t.Fragment,{children:[t.jsx(v,{title:"Data Protection",icon:"ðŸ“Š",variant:"primary",className:"mb-lg",testId:l.widgetIds.section("data-protection"),children:t.jsx("div",{className:f.grid2Cols,children:t.jsx(p,{label:"Data Classification",value:b.data.dataClassification,icon:"ðŸ·ï¸",description:"Level of data sensitivity",variant:"primary",testId:l.widgetIds.label("classification")})})}),t.jsx(v,{title:"Privacy Impact",icon:"ðŸ”’",variant:"primary",className:"mb-lg",testId:l.widgetIds.section("privacy-impact"),children:t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-md",children:t.jsx(p,{label:"Privacy Impact",value:b.data.privacyImpact,icon:"ðŸ›¡ï¸",variant:"primary",testId:l.widgetIds.label("privacy")})})})]}),n&&e==="integrity"&&A.length>0&&t.jsxs("div",{className:"mt-md",children:[t.jsx("h3",{className:"text-lg font-medium mb-sm",children:"Recommendations"}),t.jsx("ul",{className:"list-disc pl-5 space-y-1",children:A.map((g,B)=>t.jsx("li",{className:"text-sm text-gray-600 dark:text-gray-400",children:g},B))})]})]})})})});k.displayName="ImpactWidget";const be=({availabilityLevel:e,integrityLevel:a,confidentialityLevel:s,showExtendedDetails:o=!1,className:n="",testId:i=`widget-${D.AVAILABILITY_IMPACT_PREFIX}`,onError:r})=>t.jsx(k,{component:"availability",level:e,className:n,testId:i,showExtendedDetails:o,onError:r}),ke=Object.freeze(Object.defineProperty({__proto__:null,default:be},Symbol.toStringTag,{value:"Module"})),ye=({availabilityLevel:e,integrityLevel:a,confidentialityLevel:s,className:o="",testId:n=`widget-${M.CONFIDENTIALITY_IMPACT_PREFIX}`,showExtendedDetails:i=!1,onError:r})=>t.jsx(k,{component:"confidentiality",level:s,className:o,testId:n,showExtendedDetails:i,onError:r}),Ne=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"})),xe=({availabilityLevel:e,integrityLevel:a,confidentialityLevel:s,className:o="",testId:n=`widget-${P.INTEGRITY_IMPACT_PREFIX}`,showExtendedDetails:i=!1,onError:r})=>t.jsx(k,{component:"integrity",level:a,className:o,testId:n,showExtendedDetails:i,onError:r}),je=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"}));export{ke as A,Ne as C,je as I,Ie as a,he as b,ve as u};
//# sourceMappingURL=widgets-impact-BmLnqqgr.js.map
