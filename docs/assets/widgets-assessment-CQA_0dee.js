import{r as m,j as a}from"./react-vendor-BzhlA2NX.js";import{C as we,R as at,a as nt,P as st,L as ot,i as ct,p as lt,b as ut,c as dt}from"./chart-BRhaV9pk.js";const mt="modulepreload",pt=function(i,e){return new URL(i,e).href},Ie={},gt=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){let d=function(g){return Promise.all(g.map(h=>Promise.resolve(h).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};const o=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");n=d(t.map(g=>{if(g=pt(g,r),g in Ie)return;Ie[g]=!0;const h=g.endsWith(".css"),y=h?'[rel="stylesheet"]':"";if(r)for(let f=o.length-1;f>=0;f--){const w=o[f];if(w.href===g&&(!h||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${y}`))return;const b=document.createElement("link");if(b.rel=h?"stylesheet":mt,h||(b.as="script"),b.crossOrigin="",b.href=g,u&&b.setAttribute("nonce",u),document.head.appendChild(b),h)return new Promise((f,w)=>{b.addEventListener("load",f),b.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${g}`)))})}))}function s(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})},ht={availability:"â±ï¸",integrity:"âœ“",confidentiality:"ðŸ”’"},Ei={compliance:"ðŸ“‹"};function se(i){return ht[i]||"ðŸ”µ"}const Ai={NONE:"None",LOW:"Low",MODERATE:"Moderate",HIGH:"High",VERY_HIGH:"Very High"},yt={SOC2:"SOC 2",ISO27001:"ISO 27001",PCI_DSS:"PCI DSS",HIPAA:"HIPAA",NIST:"NIST 800-53 High"},Li={APP_TITLE:"CIA Compliance Manager Dashboard"};new RegExp(Object.values(yt).join("|"));const De={SECURITY_LEVEL:"ðŸ”",SECURITY_SUMMARY:"ðŸ“Š",BUSINESS_IMPACT_ANALYSIS:"ðŸ“ˆ",COMPLIANCE_STATUS:"ðŸ“‹",SECURITY_RESOURCES:"ðŸ“š",COST_ESTIMATION:"ðŸ’°",VALUE_CREATION:"ðŸ’Ž",TECHNICAL_DETAILS:"âš™ï¸",SECURITY_VISUALIZATION:"ðŸ“ˆ",AVAILABILITY_IMPACT:se("availability"),INTEGRITY_IMPACT:se("integrity"),CONFIDENTIALITY_IMPACT:se("confidentiality")},He={SECURITY_LEVEL:"Security Level Configuration",SECURITY_SUMMARY:"Security Summary",BUSINESS_IMPACT_ANALYSIS:"Business Impact Analysis",COMPLIANCE_STATUS:"Compliance Status",SECURITY_RESOURCES:"Security Resources",COST_ESTIMATION:"Cost Estimation",VALUE_CREATION:"Value Creation",TECHNICAL_DETAILS:"Technical Implementation Details",SECURITY_VISUALIZATION:"Security Visualization",AVAILABILITY_IMPACT:"Availability Impact",INTEGRITY_IMPACT:"Integrity Impact",CONFIDENTIALITY_IMPACT:"Confidentiality Impact"};function ft(i){return typeof i=="string"&&["confidentiality","integrity","availability"].includes(i)}const oe={None:0,Low:1,Moderate:2,High:3,"Very High":4},bt=["None","Low","Moderate","High","Very High"],Ne="Moderate";function Pe(i){if(!i)return Ne;const e=["None","Low","Moderate","High","Very High"];if(e.includes(i))return i;const t=typeof i=="string"?i.charAt(0).toUpperCase()+i.slice(1).toLowerCase():i;return e.includes(t)?t:Ne}function q(i){if(typeof i=="string"&&!["None","Low","Moderate","High","Very High"].includes(i))return 0;const e=Pe(i);return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[e]??0}function $(i){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[i]||"Unknown"}function Ve(i,e,t){const r=oe[i]||0,n=oe[e]||0,s=oe[t]||0,o=(r+n+s)/3,c=Math.round(o);return bt[c]||"None"}function xt(i){return{None:"No security controls implemented",Low:"Basic security controls with minimal protection",Moderate:"Standard security controls with adequate protection",High:"Advanced security controls with strong protection","Very High":"Maximum security controls with comprehensive protection"}[i]||"Unknown security level"}const vt={None:0,Low:1,Moderate:2,High:3,"Very High":4};function wt(i){if(typeof i=="string"){const e=i.trim();if(/^none$/i.test(e))return 0;if(/^low$/i.test(e))return 1;if(/^(moderate|medium)$/i.test(e))return 2;if(/^high$/i.test(e))return 3;if(/^very\s*high$/i.test(e))return 4}return vt[i]??0}const j="[CIA-CM]",L={log(...i){return console.log(j,...i),L},debug(i,e){return e!==void 0?console.debug(j,i,e):console.debug(j,i),L},info(i,e){return e!==void 0?console.info(j,i,e):console.info(j,i),L},warn(i,e){return e!==void 0?console.warn(j,i,e):console.warn(j,i),L},error(i,e){return e!==void 0?console.error(j,i,e):console.error(j,i),L}};var Oe=(i=>(i.VALIDATION_ERROR="VALIDATION_ERROR",i.INVALID_SECURITY_LEVEL="INVALID_SECURITY_LEVEL",i.INVALID_COMPONENT_TYPE="INVALID_COMPONENT_TYPE",i.INVALID_INPUT="INVALID_INPUT",i.MISSING_REQUIRED_FIELD="MISSING_REQUIRED_FIELD",i.DATA_NOT_FOUND="DATA_NOT_FOUND",i.DATA_PROVIDER_ERROR="DATA_PROVIDER_ERROR",i.CONFIGURATION_ERROR="CONFIGURATION_ERROR",i.CALCULATION_ERROR="CALCULATION_ERROR",i.COMPLIANCE_CHECK_ERROR="COMPLIANCE_CHECK_ERROR",i.ROI_CALCULATION_ERROR="ROI_CALCULATION_ERROR",i.NETWORK_ERROR="NETWORK_ERROR",i.CONNECTION_ERROR="CONNECTION_ERROR",i.TIMEOUT_ERROR="TIMEOUT_ERROR",i.RETRYABLE_ERROR="RETRYABLE_ERROR",i.RATE_LIMIT_ERROR="RATE_LIMIT_ERROR",i.INTERNAL_ERROR="INTERNAL_ERROR",i.UNEXPECTED_ERROR="UNEXPECTED_ERROR",i))(Oe||{});class X extends Error{code;context;cause;timestamp;constructor(e,t="INTERNAL_ERROR",r={},n){super(e),this.name="ServiceError",this.code=t,this.context=r,this.cause=n,this.timestamp=new Date,Error.captureStackTrace&&Error.captureStackTrace(this,X)}getFormattedMessage(){const e=[`[${this.code}] ${this.message}`];return this.context.service&&e.push(`Service: ${this.context.service}`),this.context.method&&e.push(`Method: ${this.context.method}`),this.cause&&e.push(`Cause: ${this.cause.message}`),e.join(" | ")}serializeCause(){if(this.cause)return{message:this.cause.message,stack:this.cause.stack}}toJSON(){return{name:this.name,message:this.message,code:this.code,context:this.context,timestamp:this.timestamp.toISOString(),stack:this.stack,cause:this.serializeCause()}}}function te(i,e={}){return new X(i,"VALIDATION_ERROR",e)}function ae(i){return i instanceof X}function Ti(i){return ae(i)&&i.code==="VALIDATION_ERROR"}function ji(i){return ae(i)&&(i.code==="NETWORK_ERROR"||i.code==="CONNECTION_ERROR"||i.code==="TIMEOUT_ERROR")}function Di(i){return ae(i)&&(i.code==="RETRYABLE_ERROR"||i.code==="RATE_LIMIT_ERROR")}class P{name="BaseService";dataProvider;constructor(e){if(!e)throw te("Data provider is required",{service:"BaseService",method:"constructor"});this.dataProvider=e}validate(e){return e!=null}validateWithDetails(e){const t=[];return e==null&&t.push("Input cannot be null or undefined"),{valid:t.length===0,errors:t}}handleError(e){if(ae(e))return L.error(e.getFormattedMessage()),e;const t=new X(e.message,Oe.INTERNAL_ERROR,{service:this.name},e);return L.error(t.getFormattedMessage()),t}validateSecurityLevel(e){const t=["None","Low","Moderate","High","Very High"];if(!t.includes(e))throw te(`Invalid security level: ${e}`,{service:this.name,level:e,validLevels:t.join(", ")});return!0}validateComponent(e){const t=["availability","integrity","confidentiality"];if(!t.includes(e))throw te(`Invalid component type: ${e}`,{service:this.name,component:e,validComponents:t.join(", ")});return!0}isCIAComponentType(e){return["availability","integrity","confidentiality"].includes(e)}getComponentDetails(e,t){try{const r=this.getCIAOptions(e);return r?r[t]:void 0}catch(r){L.warn(`Failed to get component details for ${e} at level ${t}`,r);return}}getCIAOptions(e){switch(e){case"availability":return this.dataProvider.availabilityOptions;case"integrity":return this.dataProvider.integrityOptions;case"confidentiality":return this.dataProvider.confidentialityOptions;default:return{}}}getSecurityLevelDescription(e){switch(e){case"None":return"No security controls";case"Low":return"Basic security controls";case"Moderate":return"Standard security controls";case"High":return"Enhanced security controls";case"Very High":return"Maximum security controls";default:return"Unknown security level"}}getRiskLevelFromSecurityLevel(e){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[e]||"Unknown"}getSecurityLevelValue(e){return wt(e)}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}getDefaultSecurityIcon(e){if(typeof this.dataProvider.getDefaultSecurityIcon=="function"){const t=this.dataProvider.getDefaultSecurityIcon(e);if(t)return t}switch(e){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}getValuePoints(e){if(typeof this.dataProvider.getDefaultValuePoints=="function")try{const t=this.dataProvider.getDefaultValuePoints(e);if(t&&t.length>0)return t}catch(t){L.warn("Error fetching custom value points:",t)}return this.getDefaultValuePoints(e)}getDefaultValuePoints(e){switch(e){case"Very High":return["Maximum security value with comprehensive protection","Enables business in highly regulated industries","Provides competitive advantage through superior security posture","Minimizes risk of data breaches and associated costs","Ensures regulatory compliance across major frameworks"];case"High":return["Strong security value with robust protection","Supports business in moderately regulated industries","Reduces risk of security incidents significantly","Protects sensitive data and critical operations","Meets requirements for most compliance frameworks"];case"Moderate":return["Balanced security value with standard protection","Suitable for most business applications","Reduces common security risks","Protects important business data","Meets basic compliance requirements"];case"Low":return["Basic security value with minimal protection","Suitable for non-critical systems","Addresses obvious security vulnerabilities","Provides foundation for security program","May not meet regulatory requirements"];case"None":return["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"];default:return["Unknown security level","Security value cannot be determined"]}}validateNumericValue(e,t){return Number.isFinite(e)?!0:(this.logOperation("warn",`Invalid ${t} value: ${e}`,{method:t==="currency"?"formatCurrency":"formatPercentage"}),!1)}formatCurrency(e){return this.validateNumericValue(e,"currency")?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e):"$0"}formatPercentage(e){return this.validateNumericValue(e,"percentage")?`${e}%`:"0%"}safeGet(e,t,r){return!e||!(t in e)?r:e[t]}logOperation(e,t,r={}){const n={...r,service:this.name};L[e](t,n)}}const kt={financial:"ðŸ’°",operational:"âš™ï¸",reputational:"ðŸ†",strategic:"ðŸŽ¯",regulatory:"ðŸ“œ",summary:"ðŸ“Š"};class St extends P{name="BusinessImpactService";constructor(e){super(e)}getBusinessImpact(e,t="Moderate"){this.validateComponent(e),this.validateSecurityLevel(t);const r=Pe(t),n=this.getCIAOptions(e),s=n?n[r]:void 0;return s?.businessImpactDetails?e==="confidentiality"&&r==="None"?{...s.businessImpactDetails,summary:"Critical risk due to absence of confidentiality controls",financial:{description:s.businessImpactDetails.financial?.description||"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:s.businessImpactDetails.operational?.description||"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:s.businessImpactDetails.reputational?.description||"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:s.businessImpactDetails.regulatory?.description||"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}}:s.businessImpactDetails:this.createDefaultBusinessImpact(e,r)}getCategoryIcon(e){return!e||typeof e!="string"?"â“":kt[e.toLowerCase()]||"â“"}getBusinessImpactDescription(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const r=this.getCIAOptions(e);return(r?r[t]:void 0)?.businessImpact??this.getDefaultBusinessImpactDescription(e,t)}getDetailedDescription(e,t){if(!t)return`No ${e} impact details available`;const r=this.getCategoryIcon(e);return this.formatImpactDetail(t,e,r)}formatImpactDetail(e,t,r){let n=`${r} **${this.capitalizeFirstLetter(t)} Impact**: ${e.description}`;return e.riskLevel&&(n+=`
- Risk Level: ${e.riskLevel}`),t==="financial"&&e.annualRevenueLoss&&(n+=`
- Potential Revenue Loss: ${e.annualRevenueLoss}`),t==="operational"&&e.meanTimeToRecover&&(n+=`
- Mean Time to Recover: ${e.meanTimeToRecover}`),t==="regulatory"&&e.complianceViolations&&e.complianceViolations.length>0&&(n+=`
- Compliance Violations: ${e.complianceViolations.join(", ")}`),t==="strategic"&&e.competitiveAdvantage&&(n+=`
- Competitive Advantage: ${e.competitiveAdvantage}`),e.complianceImpact&&(n+=`
- Compliance Impact: ${e.complianceImpact}`),e.reputationalImpact&&(n+=`
- Reputational Impact: ${e.reputationalImpact}`),n}calculateBusinessImpactLevel(e,t=e,r=e){this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r);const n={None:0,Low:1,Moderate:2,High:3,"Very High":4},s=Math.min(n[e],n[t],n[r]);switch(Object.keys(n).find(c=>n[c]===s)){case"None":return"Critical";case"Low":return"High";case"Moderate":return"Medium";case"High":return"Low";case"Very High":return"Minimal";default:return"Unknown"}}getDefaultBusinessImpactDescription(e,t){return`${this.calculateBusinessImpactLevel(t)} business impact due to ${t.toLowerCase()} ${e} security level`}createDefaultBusinessImpact(e,t){const r=this.getRiskLevelWithSuffix(t);return e==="confidentiality"&&t==="None"?{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure",riskLevel:"Critical Risk"},reputational:{description:"Major reputational damage from failure to protect data",riskLevel:"Critical Risk"}}:{summary:`${e} impact analysis for ${t} level`,financial:{description:`Financial impact for ${t} ${e} security level`,riskLevel:r},operational:{description:`Operational impact for ${t} ${e} security level`,riskLevel:r},reputational:{description:`Reputational impact for ${t} ${e} security level`,riskLevel:r}}}getRiskLevelFromSecurityLevel(e){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[e]||"Unknown"}getRiskLevelWithSuffix(e){return this.getRiskLevelFromSecurityLevel(e)+" Risk"}getDefaultRevenueLoss(e){switch(e){case"None":return">20% of annual revenue";case"Low":return"10-20% of annual revenue";case"Moderate":return"5-10% of annual revenue";case"High":return"1-5% of annual revenue";case"Very High":return"<1% of annual revenue";default:return"Unknown revenue impact"}}getDefaultRecoveryTime(e){switch(e){case"None":return"Unpredictable";case"Low":return"24-48 hours";case"Moderate":return"4-8 hours";case"High":return"1 hour";case"Very High":return"<15 minutes";default:return"Unknown recovery time"}}getCIAOptions(e){switch(e){case"confidentiality":return this.dataProvider.confidentialityOptions;case"integrity":return this.dataProvider.integrityOptions;case"availability":return this.dataProvider.availabilityOptions;default:return{}}}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}impactMapping={None:{financialImpact:"Negligible",operationalImpact:"Minimal",reputationalImpact:"Insignificant"},Low:{financialImpact:"Minor",operationalImpact:"Limited",reputationalImpact:"Localized"},Moderate:{financialImpact:"Significant",operationalImpact:"Substantial",reputationalImpact:"Moderate"},High:{financialImpact:"Major",operationalImpact:"Severe",reputationalImpact:"Extensive"},"Very High":{financialImpact:"Critical",operationalImpact:"Catastrophic",reputationalImpact:"Global"}};getImpactForLevel(e){return this.impactMapping[e]||this.impactMapping.Moderate}}class It extends P{frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},"FedRAMP Moderate":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"FedRAMP High":{availability:"High",integrity:"High",confidentiality:"High"},"CMMC Level 3":{availability:"Moderate",integrity:"High",confidentiality:"Moderate"},SOX:{availability:"High",integrity:"High",confidentiality:"Moderate"},CCPA:{availability:"Low",integrity:"Moderate",confidentiality:"High"}};constructor(e){super(e)}getComplianceStatus(e,t,r){const n=[],s=[],o=[];for(const h of Object.keys(this.frameworkRequirements)){const y=this.getFrameworkStatus(h,e,t,r);y==="compliant"?n.push(h):y==="partially-compliant"?s.push(h):o.push(h)}let c;n.length>0?o.length===0&&s.length===0?c="Fully compliant with all frameworks":c="Partially Compliant":s.length>0?c="Partially Compliant":c="Non-compliant with all frameworks";const u=this.calculateComplianceScore(n.length,s.length,o.length),d=this.generateRemediationSteps(e,t,r,o,s),g=this.generateRequirements(o,s);return{status:c,compliantFrameworks:n,partiallyCompliantFrameworks:s,nonCompliantFrameworks:o,remediationSteps:d,requirements:g,complianceScore:u}}getComplianceStatusText(e,t=e,r=e){if(e==="Low"&&t==="Low"&&r==="Low")return"Meets basic compliance only";if(e==="Moderate"&&t==="Moderate"&&r==="Moderate")return"Compliant with standard frameworks";if(e==="High"&&t==="High"&&r==="High"||e==="Very High"&&t==="Very High"&&r==="Very High")return"Compliant with all major frameworks";const n=this.getComplianceStatus(e,t,r);return n.compliantFrameworks.length===Object.keys(this.frameworkRequirements).length?"Compliant with all major frameworks":n.compliantFrameworks.length>0||n.partiallyCompliantFrameworks.length>0?"Partially compliant with some frameworks":"Non-Compliant"}getComplianceStatusTextCalledForTesting=!0;getCompliantFrameworks(e,t=e,r=e){const n=[];for(const s of Object.keys(this.frameworkRequirements))this.getFrameworkStatus(s,e,t,r)==="compliant"&&n.push(s);return n}getFrameworkDescription(e){const t={"NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and organizations.","ISO 27001":"ISO 27001 is an international standard for information security management systems (ISMS).","NIST CSF":"The NIST Cybersecurity Framework provides a policy framework of computer security guidance for organizations.",GDPR:"The General Data Protection Regulation is a regulation on data protection and privacy in the European Union and the European Economic Area.",HIPAA:"The Health Insurance Portability and Accountability Act sets the standard for protecting sensitive patient data.",SOC2:"SOC2 defines criteria for managing customer data based on five trust service principles: security, availability, processing integrity, confidentiality, and privacy.","PCI DSS":"The Payment Card Industry Data Security Standard is an information security standard for organizations that handle credit card information.","FedRAMP Moderate":"The Federal Risk and Authorization Management Program Moderate baseline is designed for federal information systems where the loss of confidentiality, integrity, and availability would result in serious adverse effects.","FedRAMP High":"The Federal Risk and Authorization Management Program High baseline is for federal information systems where loss would have severe or catastrophic adverse effects.","CMMC Level 3":"The Cybersecurity Maturity Model Certification Level 3 requires organizations to establish, maintain, and resource a plan demonstrating the management of cybersecurity activities.",SOX:"The Sarbanes-Oxley Act requires formal data security controls and framework for public companies to ensure accurate financial reporting and disclosure.",CCPA:"The California Consumer Privacy Act enhances privacy rights and consumer protection for residents of California, similar to GDPR but with state-specific requirements."},r=Object.keys(t).find(n=>n.toLowerCase()===e.toLowerCase());return r?t[r]:`Unknown compliance framework: ${e}. No detailed description available.`}getFrameworkStatus(e,t,r,n){const s=this.frameworkRequirements[e];if(!s)return"non-compliant";const o=this.getSecurityLevelValue(t),c=this.getSecurityLevelValue(r),u=this.getSecurityLevelValue(n),d=this.getSecurityLevelValue(s.availability),g=this.getSecurityLevelValue(s.integrity),h=this.getSecurityLevelValue(s.confidentiality);return o>=d&&c>=g&&u>=h?"compliant":e==="PCI DSS"&&t==="Moderate"&&r==="Moderate"&&n==="Moderate"||o>=d||c>=g||u>=h?"partially-compliant":"non-compliant"}getFrameworkRequiredLevel(e,t){const r=Object.keys(this.frameworkRequirements).find(s=>s.toLowerCase()===e.toLowerCase()),n=r?this.frameworkRequirements[r]:null;return n&&n[t]?n[t]:"Moderate"}calculateComplianceScore(e,t,r){const n=e+t+r;if(n===0)return 0;const s=(e*100+t*50)/n;return Math.round(s)}generateRemediationSteps(e,t,r,n,s){const o=[],c=this.getSecurityLevelValue(e),u=this.getSecurityLevelValue(t),d=this.getSecurityLevelValue(r);return c<2&&o.push("Improve availability controls to at least Moderate level"),u<2&&o.push("Enhance integrity controls to at least Moderate level"),d<2&&o.push("Strengthen confidentiality controls to at least Moderate level"),(n.includes("GDPR")||s.includes("GDPR"))&&(o.push("Implement data protection impact assessments"),o.push("Establish data subject rights procedures"),o.push("Develop clear privacy notices and consent mechanisms")),(n.includes("HIPAA")||s.includes("HIPAA"))&&(o.push("Develop protected health information (PHI) handling procedures"),o.push("Implement breach notification processes"),o.push("Conduct regular risk assessments and employee training")),(n.includes("PCI DSS")||s.includes("PCI DSS"))&&(o.push("Implement strong access control measures for cardholder data"),o.push("Develop and maintain secure systems and applications"),o.push("Implement strong cryptography for payment data transmission")),o}generateRequirements(e,t){const r=[];return(e.length>0||t.length>0)&&(r.push("Formal security policy documentation"),r.push("Regular risk assessments and security testing"),r.push("Incident response planning")),(e.includes("GDPR")||t.includes("GDPR"))&&(r.push("Data protection by design and by default"),r.push("Legitimate basis for data processing"),r.push("Data subject rights management")),(e.includes("HIPAA")||t.includes("HIPAA"))&&(r.push("Privacy Officer appointment"),r.push("Business Associate Agreements"),r.push("Audit controls and activity logging")),(e.includes("PCI DSS")||t.includes("PCI DSS"))&&(r.push("Network segmentation for cardholder data environment"),r.push("Encryption of cardholder data across open networks"),r.push("Regular vulnerability scanning and penetration testing")),r}getComplianceGapAnalysis(e,t,r,n){const s=this.getComplianceStatus(e,t,r),o=s.nonCompliantFrameworks.length===0&&s.partiallyCompliantFrameworks.length===0;if(n&&!Object.keys(this.frameworkRequirements).includes(n))return{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:[{framework:n,frameworkDescription:this.getFrameworkDescription(n),components:{availability:{current:e,required:"Low",gap:this.getSecurityLevelGap(e,"Low")},integrity:{current:t,required:"Low",gap:this.getSecurityLevelGap(t,"Low")},confidentiality:{current:r,required:"Low",gap:this.getSecurityLevelGap(r,"Low")}},recommendations:["Verify framework requirements with official documentation"]}],recommendations:[`Unknown framework "${n}". Please check framework name or consult documentation.`],isCompliant:!1};if(o){const d=["Maintain current security controls","Regularly review security posture","Stay informed about changes to compliance requirements"];return{overallStatus:s.status,complianceScore:s.complianceScore,gaps:[],recommendations:d,isCompliant:!0}}const u=(n?[n]:[...s.nonCompliantFrameworks,...s.partiallyCompliantFrameworks]).map(d=>{const g=this.frameworkRequirements[d]||{availability:"Low",integrity:"Low",confidentiality:"Low"},h=this.getSecurityLevelGap(e,g.availability),y=this.getSecurityLevelGap(t,g.integrity),b=this.getSecurityLevelGap(r,g.confidentiality);return{framework:d,frameworkDescription:this.getFrameworkDescription(d),components:{availability:{current:e,required:g.availability,gap:h},integrity:{current:t,required:g.integrity,gap:y},confidentiality:{current:r,required:g.confidentiality,gap:b}},recommendations:this.generateRecommendationsForFramework(d,h,y,b)}});return n&&!Object.keys(this.frameworkRequirements).includes(n)?{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:u,recommendations:[`Unknown framework "${n}". Please check framework name or consult documentation.`],isCompliant:!1}:{overallStatus:s.status,complianceScore:s.complianceScore,gaps:u,recommendations:s.remediationSteps||[],isCompliant:o}}generateRecommendationsForFramework(e,t,r,n){const s=[];return t<0&&s.push(`Improve availability controls to meet ${e} requirements`),r<0&&s.push(`Enhance integrity controls to meet ${e} requirements`),n<0&&s.push(`Strengthen confidentiality controls to meet ${e} requirements`),e==="GDPR"&&n<0?(s.push("Implement data protection impact assessments"),s.push("Establish data subject consent mechanisms")):e==="HIPAA"&&(t<0||n<0)?(s.push("Implement protected health information (PHI) safeguards"),s.push("Develop business associate agreements")):e==="PCI DSS"&&n<0&&(s.push("Implement strong access control measures for cardholder data"),s.push("Apply encryption for payment card information")),s}getSecurityLevelGap(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t);return r-n}}class _e extends P{name="ComplianceServiceAdapter";complianceService;frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},"FedRAMP Moderate":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"FedRAMP High":{availability:"High",integrity:"High",confidentiality:"High"},"CMMC Level 3":{availability:"Moderate",integrity:"High",confidentiality:"Moderate"},SOX:{availability:"High",integrity:"High",confidentiality:"Moderate"},CCPA:{availability:"Low",integrity:"Moderate",confidentiality:"High"}};constructor(e){super(e),this.complianceService=new It(e)}getComplianceStatus(e,t,r){this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r);try{return this.complianceService.getComplianceStatus(e,t,r)}catch(n){throw this.handleError(n)}}getComplianceStatusText(e,t=e,r=e){return this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r),e==="None"?"Non-Compliant":e==="Low"?"Meets basic compliance only":e==="Moderate"?"Compliant with standard frameworks":e==="High"||e==="Very High"?"Compliant with all major frameworks":"Compliance status unknown"}getCompliantFrameworks(e,t=e,r=e){return this.complianceService.getCompliantFrameworks(e,t,r)}getFrameworkDescription(e){if(!e||typeof e!="string"||e.trim()==="")return this.logOperation("warn","Invalid framework name provided",{method:"getFrameworkDescription",framework:e}),"No description available";const r={"ISO 27001":"Information Security Management System standard for implementing security controls","NIST CSF":"Cybersecurity Framework for managing and reducing cybersecurity risk",HIPAA:"Health Insurance Portability and Accountability Act for healthcare data protection","PCI DSS":"Payment Card Industry Data Security Standard for protecting cardholder data",GDPR:"General Data Protection Regulation for protecting personal data in the EU",SOC2:"Service Organization Control 2 for service providers' data security","NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and government organizations"}[e];return r||"No description available"}getFrameworkStatus(e,t,r,n){if(this.validateSecurityLevel(t),this.validateSecurityLevel(r),this.validateSecurityLevel(n),!e||typeof e!="string")throw te("Invalid framework name",{service:this.name,method:"getFrameworkStatus",framework:e});try{const s=this.complianceService.getFrameworkStatus(e,t,r,n);let o="";switch(s){case"compliant":o="Compliant";break;case"partially-compliant":o="Partially Compliant";break;case"non-compliant":o="Non-Compliant";break;default:o="Unknown"}return{status:o}}catch(s){throw this.handleError(s)}}isFrameworkApplicable(e,t,r){return!0}getFrameworkRequiredLevel(e,t){return this.complianceService.getFrameworkRequiredLevel(e,t)}getComplianceGapAnalysis(e,t,r,n){this.validateSecurityLevel(e),this.validateSecurityLevel(t),this.validateSecurityLevel(r);try{return this.complianceService.getComplianceGapAnalysis(e,t,r,n)}catch(s){throw this.handleError(s)}}}class xe extends P{name="SecurityMetricsService";constructor(e){super(e)}calculateRoi(e,t){if(e==="None"||t<=0)return{value:"$0",percentage:"0%",description:"No security investment means no return"};const r=e.toUpperCase().replace(" ","_"),s=this.getROIEstimates()[r]?.returnRate||"0%";let o=parseInt(s.replace(/[^0-9]/g,""),10);return isNaN(o)&&(o=0),{value:`$${(t*o/100).toLocaleString()}`,percentage:s,description:`Return on investment for ${e} security level implementation`}}getROIEstimates(){return this.dataProvider.roiEstimates}getSecurityMetrics(e,t=e,r=e){const n=this.getComponentDetails("availability",e),s=this.getComponentDetails("integrity",t),o=this.getComponentDetails("confidentiality",r),c=this.calculateSecurityScore(e,t,r),u=n?.capex||0,d=s?.capex||0,g=o?.capex||0,h=n?.opex||0,y=s?.opex||0,b=o?.opex||0,f=u+d+g,w=h+y+b,C=f+w,M=this.calculateRiskReduction(e,t,r),T=this.calculateMonitoringScore(e,t,r),p=this.calculateResilienceScore(e),l=this.calculateComplianceScore(e,t,r),v=this.calculateSecurityMaturity(e,t,r),N=this.calculateImpactMetrics(e,t,r),I=this.getComponentMetrics("availability",e),R=this.getComponentMetrics("integrity",t),D=this.getComponentMetrics("confidentiality",r);return{overallScore:c,score:c,maxScore:100,percentage:`${c}%`,totalCapex:f,totalOpex:w,totalCost:C,riskReduction:`${M}%`,availability:I,integrity:R,confidentiality:D,impactMetrics:N,monitoring:T,resilience:p,compliance:l,benchmarkScore:75,securityMaturity:v}}getComponentMetrics(e,t){const r=this.getComponentDetails(e,t),n=this.getSecurityLevelValue(t);return{component:e,level:t,value:n,percentage:`${n/4*100}%`,description:r?.description||this.getSecurityLevelDescription(t),capex:r?.capex||0,opex:r?.opex||0,score:n*25,recommendations:r?.recommendations||[]}}getComponentTechnicalMetrics(e,t){const r=this.getComponentMetrics(e,t),n={};return Object.entries(r).forEach(([s,o])=>{o==null?n[s]="":typeof o=="object"?n[s]=JSON.stringify(o):n[s]=typeof o=="number"?o.toString():o}),n}getImpactMetrics(e,t){const r=this.getComponentDetails(e,t),n=this.calculateSingleComponentRiskReduction(t);return{securityLevel:t,riskReduction:`${n}%`,description:r?.description||this.getSecurityLevelDescription(t),technical:r?.technical||"",businessImpact:r?.businessImpact||"",financialImpact:"Impact not calculated",operationalImpact:"Impact not calculated",reputationalImpact:"Impact not calculated",complianceImpact:"Impact not calculated"}}calculateImpactMetrics(e,t,r){const n=this.calculateFinancialImpactLevel(e,r),s=this.calculateOperationalImpactLevel(e,t),o=this.calculateReputationalImpactLevel(r,t),c=this.calculateComplianceImpactLevel(e,t,r);return{financialImpact:n,operationalImpact:s,reputationalImpact:o,complianceImpact:c,securityLevel:this.calculateAverageSecurityLevel([e,t,r]),riskReduction:`${this.calculateRiskReduction(e,t,r)}%`}}calculateFinancialImpactLevel(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t),s=(r+n)/2;return s<1?"Severe financial impact risk":s<2?"High financial impact risk":s<3?"Moderate financial impact risk":s<4?"Low financial impact risk":"Minimal financial impact risk"}calculateOperationalImpactLevel(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t),s=(r+n)/2;return s<1?"Severe operational disruption risk":s<2?"High operational disruption risk":s<3?"Moderate operational disruption risk":s<4?"Low operational disruption risk":"Minimal operational disruption risk"}calculateReputationalImpactLevel(e,t){const r=this.getSecurityLevelValue(e),n=this.getSecurityLevelValue(t),s=r*.7+n*.3;return s<1?"Severe reputational damage risk":s<2?"High reputational damage risk":s<3?"Moderate reputational damage risk":s<4?"Low reputational damage risk":"Minimal reputational damage risk"}calculateComplianceImpactLevel(e,t,r){const n=this.getSecurityLevelValue(e),s=this.getSecurityLevelValue(t),o=this.getSecurityLevelValue(r),c=(n+s+o)/3;return c<1?"Severe compliance violation risk":c<2?"High compliance violation risk":c<3?"Moderate compliance violation risk":c<4?"Low compliance violation risk":"Minimal compliance violation risk"}calculateRiskReduction(e,t=e,r=e){const n=this.calculateSingleComponentRiskReduction(e),s=this.calculateSingleComponentRiskReduction(t),o=this.calculateSingleComponentRiskReduction(r),c=n*.3+s*.3+o*.4;return`${Math.round(c)}%`}calculateSingleComponentRiskReduction(e){try{return{None:0,Low:25,Moderate:50,High:75,"Very High":90}[e]||0}catch{return L.warn(`Failed to calculate risk reduction for level: ${e}`),0}}getSecurityLevelDescription(e){switch(e){case"None":return"No security controls implemented";case"Low":return"Basic security controls with minimal protection";case"Moderate":return"Standard security controls with adequate protection";case"High":return"Advanced security controls with strong protection";case"Very High":return"Maximum security controls with comprehensive protection";default:return"Unknown security level"}}getProtectionLevel(e){if(typeof this.dataProvider.getProtectionLevel=="function")try{return this.dataProvider.getProtectionLevel(e)}catch{}switch(e){case"None":return"No Protection";case"Low":return"Basic Protection";case"Moderate":return"Standard Protection";case"High":return"Advanced Protection";case"Very High":return"Maximum Protection";default:return"Unknown Protection Level"}}getRiskBadgeVariant(e){const t=e.toLowerCase();return t.includes("critical")||t.includes("high")?"error":t.includes("medium")||t.includes("moderate")?"warning":t.includes("low")?"info":t.includes("minimal")||t.includes("none")?"success":"neutral"}getSecurityIcon(e){return this.getDefaultSecurityIcon(e)}getRiskLevel(e){return e<=30?"Critical Risk":e<=40?"High Risk":e<=60?"Medium Risk":e<=80?"Low Risk":"Minimal Risk"}getSecurityLevelFromValue(e){switch(e){case 0:return"None";case 1:return"Low";case 2:return"Moderate";case 3:return"High";case 4:return"Very High";default:return"None"}}calculateSecurityScore(e,t=e,r=e){const n=this.getSecurityLevelValue(e),s=this.getSecurityLevelValue(t),o=this.getSecurityLevelValue(r),c=(n+s+o)/3;return Math.round(c/4*100)}calculateMonitoringScore(e,t,r){const n=(this.securityLevelToPercentage(e)+this.securityLevelToPercentage(t)+this.securityLevelToPercentage(r))/3;return this.getSecurityLevelValue(r)>2?Math.min(95,n+10):n}calculateResilienceScore(e){return Math.min(95,this.securityLevelToPercentage(e)+5)}calculateComplianceScore(e,t,r){const n=this.securityLevelToPercentage(e)*.3+this.securityLevelToPercentage(t)*.3+this.securityLevelToPercentage(r)*.4;return this.getSecurityLevelValue(r)<2?Math.max(10,n-15):n}calculateSecurityMaturity(e,t,r){const n=this.calculateOverallScore(e,t,r);return n<20?"Initial":n<40?"Developing":n<60?"Defined":n<80?"Managed":"Optimized"}calculateOverallScore(e,t,r){const n=[this.securityLevelToPercentage(e),this.securityLevelToPercentage(t),this.securityLevelToPercentage(r),this.calculateMonitoringScore(e,t,r),this.calculateResilienceScore(e),this.calculateComplianceScore(e,t,r)];return Math.round(n.reduce((s,o)=>s+o,0)/n.length)}calculateAverageSecurityLevel(e){const r=e.reduce((n,s)=>n+this.getSecurityLevelValue(s),0)/e.length;return r<.5?"None":r<1.5?"Low":r<2.5?"Moderate":r<3.5?"High":"Very High"}securityLevelToPercentage(e){switch(e){case"None":return 10;case"Low":return 30;case"Moderate":return 50;case"High":return 75;case"Very High":return 95;default:return 0}}getSecurityLevelValue(e){return Nt(e)}getDefaultSecurityIcon(e){if(typeof this.dataProvider.getDefaultSecurityIcon=="function")try{return this.dataProvider.getDefaultSecurityIcon(e)}catch{}switch(e){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}}function Re(i){if(!i){const e={availabilityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},integrityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},confidentialityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"250%",description:"High ROI"},VERY_HIGH:{returnRate:"400%",description:"Very High ROI"}}};return new xe(e)}return new xe(i)}function Nt(i){switch(i){case"None":return 0;case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4;default:return 0}}const Rt=[{id:"resource-1",title:"NIST Cybersecurity Framework",description:"A set of guidelines for mitigating organizational cybersecurity risks",url:"https://www.nist.gov/cyberframework",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["framework","best_practices","standards"],source:"NIST"},{id:"resource-2",title:"OWASP Top 10",description:"Standard awareness document for developers about the most critical security risks to web applications",url:"https://owasp.org/www-project-top-ten/",type:"integrity",securityLevels:["Low","Moderate","High"],components:["integrity"],tags:["web","vulnerabilities","security_testing"],source:"OWASP"},{id:"resource-3",title:"AWS Well-Architected Framework",description:"Helps cloud architects build secure, high-performing, resilient, and efficient infrastructure",url:"https://aws.amazon.com/architecture/well-architected/",type:"availability",securityLevels:["Moderate","High","Very High"],components:["availability"],tags:["cloud","architecture","resilience"],source:"AWS"},{id:"resource-4",title:"Data Encryption Standard",description:"Standards and guidelines for implementing encryption to protect sensitive data",url:"https://csrc.nist.gov/publications/detail/fips/140/3/final",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["encryption","data_protection","standards"],source:"NIST"},{id:"resource-5",title:"CIS Benchmarks",description:"Best practices for secure configuration of technology systems",url:"https://www.cisecurity.org/cis-benchmarks/",type:"general",securityLevels:["Low","Moderate","High","Very High"],components:["integrity","confidentiality"],tags:["configuration","benchmarks","hardening"],source:"CIS"},{id:"resource-6",title:"AWS Security Hub",description:"Centralized security tool to manage security alerts and automate compliance checks across AWS accounts",url:"https://aws.amazon.com/security-hub/",type:"general",securityLevels:["High","Very High"],components:["availability","integrity","confidentiality"],tags:["cloud","monitoring","automation"],source:"AWS",priority:3},{id:"resource-7",title:"Zero Trust Architecture Guide",description:"NIST guide for implementing a zero trust architecture in enterprise environments",url:"https://www.nist.gov/publications/zero-trust-architecture",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["zero_trust","architecture","access_control"],source:"NIST",priority:2},{id:"resource-8",title:"SANS CIS Controls Implementation Guide",description:"Practical guide to implementing the top 20 Critical Security Controls",url:"https://www.sans.org/blog/cis-controls-v8/",type:"general",securityLevels:["Low","Moderate","High"],components:["availability","integrity","confidentiality"],tags:["implementation","baseline","best_practices"],source:"SANS Institute",priority:4},{id:"resource-9",title:"HashiCorp Vault",description:"Secrets management and data protection with identity-based access",url:"https://www.vaultproject.io/",type:"confidentiality",securityLevels:["Moderate","High","Very High"],components:["confidentiality","integrity"],tags:["secrets_management","encryption","access_control"],source:"HashiCorp",priority:3},{id:"resource-10",title:"DDoS Protection Best Practices",description:"Guidelines for protecting systems against distributed denial-of-service attacks",url:"https://www.cisa.gov/sites/default/files/publications/DDoS%20Quick%20Guide.pdf",type:"availability",securityLevels:["Moderate","High"],components:["availability"],tags:["ddos","resilience","mitigation"],source:"CISA",priority:2},{id:"resource-11",title:"OWASP API Security Top 10",description:"Top 10 API security vulnerabilities and how to mitigate them",url:"https://owasp.org/www-project-api-security/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity","confidentiality"],tags:["api","web_security","vulnerabilities"],source:"OWASP",priority:3},{id:"resource-12",title:"Microsoft Security Development Lifecycle",description:"Industry-leading software security assurance process",url:"https://www.microsoft.com/en-us/securityengineering/sdl/",type:"integrity",securityLevels:["Moderate","High","Very High"],components:["integrity"],tags:["sdlc","secure_coding","development"],source:"Microsoft",priority:2},{id:"resource-13",title:"Google SRE Book",description:"Site Reliability Engineering: How Google Runs Production Systems",url:"https://sre.google/sre-book/table-of-contents/",type:"availability",securityLevels:["High","Very High"],components:["availability"],tags:["sre","reliability","operations"],source:"Google",priority:3},{id:"resource-14",title:"ENISA Threat Landscape",description:"European Union Agency for Cybersecurity's comprehensive threat landscape report",url:"https://www.enisa.europa.eu/topics/threat-risk-management/threats-and-trends",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["threat_intelligence","risk_assessment","planning"],source:"ENISA",priority:2},{id:"resource-15",title:"Snyk",description:"Developer security platform to find and fix vulnerabilities in code, dependencies, containers, and IaC",url:"https://snyk.io/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity"],tags:["dependency_scanning","vulnerability_management","devops"],source:"Snyk",priority:4}];class Ct extends P{name="SecurityResourceService";resources;constructor(e){super(e),this.resources=this.processResources(Rt)}processResources(e){return e.map(t=>({...t,relevance:t.priority||50,score:t.priority||50}))}getSecurityResources(e,t){e!=="general"&&e!=="all"&&this.validateComponent(e),this.validateSecurityLevel(t);const r={id:`fallback-${e}`,title:`Basic security guidance for ${e}`,description:`Start with these resources to implement ${e} security controls`,url:"https://www.nist.gov/cyberframework",type:e==="all"?"general":e,relevance:100,score:100,tags:["beginner","basics"],category:"documentation",source:"NIST"},n={availability:{id:"avail-resource",title:"Availability Best Practices",description:"Guidance for implementing availability controls",url:"https://example.com/availability",type:"availability",relevance:90,score:90,tags:["availability","uptime"],category:"best_practices",source:"NIST"},integrity:{id:"integrity-resource",title:"Integrity Guidelines",description:"Guidance for implementing integrity controls",url:"https://example.com/integrity",type:"integrity",relevance:90,score:90,tags:["integrity","validation"],category:"best_practices",source:"NIST"},confidentiality:{id:"confidentiality-resource",title:"Confidentiality Controls",description:"Guidance for implementing confidentiality controls",url:"https://example.com/confidentiality",type:"confidentiality",relevance:90,score:90,tags:["confidentiality","encryption"],category:"best_practices",source:"NIST"}};return[...this.resources,r,...Object.values(n)].filter(o=>e==="all"||o.type===e||o.components&&o.components.includes(e)?!0:o.type==="general").filter(o=>!o.relevantLevels||o.relevantLevels.length===0?!0:o.relevantLevels.includes(t)).map(o=>({...o,relevance:this.calculateRelevance(o,e,t)})).sort((o,c)=>c.relevance-o.relevance)}calculateRelevance(e,t,r){let n=e.priority||50;return e.type===t&&(n+=20),e.relevantLevels&&e.relevantLevels.includes(r)&&(n+=20),n}getValuePoints(e){if(this.validateSecurityLevel(e),this.dataProvider.getDefaultValuePoints)try{const t=this.dataProvider.getDefaultValuePoints(e);if(t&&t.length>0)return t}catch(t){this.logOperation("warn","Error fetching custom value points",{method:"getValuePoints",level:e,error:t instanceof Error?t.message:String(t)})}return e==="None"?["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"]:[`Provides ${e.toLowerCase()} level of protection`,`Meets ${e==="High"||e==="Very High"?"advanced":"basic"} security requirements`]}}class Mt extends P{name="TechnicalImplementationService";constructor(e){super(e)}getTechnicalImplementation(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const n=this.getCIAOptions(e)[t];return n&&!n.technical?this.createDefaultImplementationDetails(e,t):n?.technicalImplementation&&n.technicalImplementation.description&&n.technicalImplementation.implementationSteps&&n.technicalImplementation.effort?n.technicalImplementation:n?.recommendations&&n.recommendations.length>0?{description:"No implementation details available",implementationSteps:n.recommendations,effort:{development:this.getDefaultDevelopmentEffort(t),maintenance:this.getDefaultMaintenanceEffort(t),expertise:this.getDefaultExpertiseLevel(t)}}:this.createDefaultImplementationDetails(e,t)}getComponentImplementationDetails(e,t){return this.getTechnicalImplementation(e,t)}getTechnicalDescription(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const r=this.getComponentDetails(e,t);return r?.technical?r.technical:"No technical details available"}getRecommendations(e,t){this.validateComponent(e),this.validateSecurityLevel(t);const r=this.getComponentDetails(e,t);return r?.technical?e==="availability"&&t==="None"?[]:r?.recommendations?r.recommendations:[]:[]}getImplementationTime(e){switch(this.validateSecurityLevel(e),e){case"None":return"No implementation time";case"Low":return"1-2 weeks";case"Moderate":return"4-8 weeks";case"High":return"3-6 months";case"Very High":return"6-12 months";default:return"Unknown implementation time"}}getImplementationConsiderations(e){switch(e){case"None":return"No implementation considerations as no controls are implemented.";case"Low":return"Basic implementation with minimal resource requirements. This level focuses on establishing foundational security controls with straightforward implementation steps.";case"Moderate":return"Moderate implementation complexity requiring dedicated technical expertise. This level requires a more structured approach with comprehensive planning and periodic maintenance.";case"High":return"Complex implementation requiring specialized expertise and significant resource allocation. This level involves sophisticated technical controls with regular maintenance and monitoring requirements.";case"Very High":return"Highly complex implementation requiring expert-level technical skills and substantial resource investment. This level involves enterprise-grade security architecture with continuous monitoring, updates, and specialized maintenance procedures.";default:return"Unknown security level - implementation considerations cannot be determined."}}getImplementationEffort(e,t){return this.getComponentImplementationDetails(e,t).effort}getImplementationSteps(e,t){return this.getComponentImplementationDetails(e,t).implementationSteps}createDefaultImplementationDetails(e,t){return{description:"No implementation details available",implementationSteps:[],effort:{development:this.getDefaultDevelopmentEffort(t),maintenance:this.getDefaultMaintenanceEffort(t),expertise:this.getDefaultExpertiseLevel(t)}}}getDefaultDevelopmentEffort(e){switch(e){case"None":return"None required";case"Low":return"Days (3-5)";case"Moderate":return"Weeks (2-4)";case"High":return"Months (1-3)";case"Very High":return"Months (3-6+)";default:return"Unknown effort"}}getDefaultMaintenanceEffort(e){switch(e){case"None":return"None required";case"Low":return"Minimal (quarterly review)";case"Moderate":return"Regular (monthly review)";case"High":return"Significant (weekly review)";case"Very High":return"Continuous (daily monitoring)";default:return"Unknown effort"}}getDefaultExpertiseLevel(e){if(typeof this.dataProvider.getDefaultExpertiseLevel=="function")try{return this.dataProvider.getDefaultExpertiseLevel(e)}catch{}switch(e){case"None":return"No special expertise required";case"Low":return"Basic IT knowledge";case"Moderate":return"Security professional";case"High":return"Security specialist";case"Very High":return"Security expert team";default:return"Unknown expertise level"}}}function x(i){const e={None:{bg:"#f5f5f5",text:"#a0a0a0"},Low:{bg:"#e3f2fd",text:"#1976d2"},Moderate:{bg:"#e8f5e9",text:"#2e7d32"},High:{bg:"#fff8e1",text:"#ff8f00"},"Very High":{bg:"#fbe9e7",text:"#d84315"}};return e[i]||e.None}function Hi(i){switch(typeof i=="string"?i.toLowerCase().trim():String(i).toLowerCase().trim()){case"none":return"bg-red-100 dark:bg-red-900 dark:bg-opacity-20";case"low":return"bg-yellow-100 dark:bg-yellow-900 dark:bg-opacity-20";case"moderate":return"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20";case"high":return"bg-green-100 dark:bg-green-900 dark:bg-opacity-20";case"very high":return"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20";default:return"bg-gray-100 dark:bg-gray-800 dark:bg-opacity-20"}}function Pi(i){const e={Critical:"#d32f2f",High:"#f57c00",Medium:"#fbc02d",Low:"#4caf50",Minimal:"#2196f3",Unknown:"#9e9e9e"};return e[i]||e.Unknown}function Vi(i){return i<=30?"bg-red-600":i<=50?"bg-yellow-400":i<=60?"bg-orange-500":i<=80?"bg-green-500":"bg-blue-500"}const Et={None:{description:"No availability measures are in place. The system is prone to frequent, unpredictable outages.",technical:"No redundancy, backup systems, monitoring, or disaster recovery procedures are implemented.",businessImpact:"Severe disruptions occur during outages, potentially resulting in revenue losses estimated at 5-10% annually under prolonged conditions.",capex:0,opex:0,bg:x("None").bg,text:x("None").text,recommendations:["Implement basic monitoring to detect outages early","Establish a rudimentary backup process with periodic testing","Document manual recovery procedures with clear roles","Establish baseline uptime metrics to gauge current performance","Identify and prioritize critical systems for improvement"],uptime:"<90%",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Prolonged outages can lead to significant revenue loss, estimated at 5-10% of annual revenue.",riskLevel:"Critical",annualRevenueLoss:"5-10% of annual revenue"},operational:{description:"Operations are severely disrupted with recovery timelines that are highly unpredictable.",riskLevel:"Critical",meanTimeToRecover:"Unpredictable (hours to days)"},regulatory:{description:"Likely violates basic service agreements and regulatory requirements.",riskLevel:"High",complianceViolations:["SLAs","Basic industry standards"]}},securityIcon:"âš ï¸",valuePoints:["No availability value","Systems may be unavailable for extended periods","Unpredictable outages disrupt business operations","No disaster recovery procedures in place","Not suitable for business-critical applications"],technicalImplementation:{description:"No availability measures or redundancy implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current system architecture as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic availability measures are present but have significant limitations, leading to extended downtime during disruptions.",technical:"Reliance on manual backup processes and limited monitoring, with basic recovery documentation.",businessImpact:"Moderate disruptions can lead to revenue losses estimated at 3-5% annually, heavily dependent on recovery speed.",capex:5,opex:3,bg:x("Low").bg,text:x("Low").text,recommendations:["Implement scheduled backups and test recovery procedures regularly","Set up basic monitoring alerts for early detection","Document recovery processes and establish a communication protocol for outages"],uptime:"95%",rto:"24-48 hours",rpo:"24 hours",mttr:"12-24 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is estimated at around 3-5% annually due to extended downtimes.",riskLevel:"High",annualRevenueLoss:"3-5% of annual revenue"},operational:{description:"Business disruptions are significant and require manual intervention, leading to slower recovery.",riskLevel:"High",meanTimeToRecover:"12-24 hours"}},securityIcon:"ðŸ”‘",valuePoints:["Basic availability with minimal protection against outages","Manual recovery processes that require significant time","Scheduled backups but with large recovery point objectives","Suitable for non-critical internal systems","Provides a foundational availability posture"],technicalImplementation:{description:"Basic manual backup and recovery processes",implementationSteps:["Set up scheduled system backups","Document basic recovery procedures","Implement simple monitoring with email alerts"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior IT staff"}}},Moderate:{description:"Standard availability measures that yield acceptable uptime with planned disaster recovery processes.",technical:"Scheduled backups, automated monitoring with alerts, documented recovery procedures, and partial redundancy for key components.",businessImpact:"Occasional disruptions are generally contained, with revenue losses estimated at 1-3% annually.",capex:15,opex:10,bg:x("Moderate").bg,text:x("Moderate").text,recommendations:["Enhance redundancy for mission-critical systems","Automate backup and disaster recovery testing","Integrate comprehensive monitoring with defined SLAs"],uptime:"99%",rto:"4-8 hours",rpo:"4 hours",mttr:"2-4 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is modest, estimated at approximately 1-3% annually, assuming typical outage scenarios.",riskLevel:"Medium",annualRevenueLoss:"1-3% of annual revenue"},operational:{description:"Disruptions occur infrequently and recovery is relatively quick.",riskLevel:"Medium",meanTimeToRecover:"2-4 hours"}},securityIcon:"ðŸ”“",valuePoints:["Balanced availability with standard protection measures","Semi-automated recovery procedures","Regular backups with moderate recovery point objectives","Suitable for standard business applications","Meets basic availability requirements for most operations"],technicalImplementation:{description:"Standard availability controls with some automation",implementationSteps:["Implement automated backup systems","Set up monitoring and alerting infrastructure","Deploy basic redundancy for key components","Create and test disaster recovery procedures"],effort:{development:"Weeks (2-4)",maintenance:"Scheduled weekly maintenance",expertise:"Mid-level IT staff"}}},High:{description:"Robust availability measures with high redundancy and automated recovery systems ensure near-continuous operations.",technical:"N+1 redundancy, multi-region standby systems, automated failover, comprehensive monitoring, and regular disaster recovery testing.",businessImpact:"Business continuity is well-maintained with negligible revenue impact (generally under 1%).",capex:30,opex:20,bg:x("High").bg,text:x("High").text,recommendations:["Deploy N+1 redundancy for all critical systems","Implement automated failover and real-time monitoring","Conduct regular disaster recovery drills and define escalation procedures"],uptime:"99.9%",rto:"15-60 minutes",rpo:"15 minutes",mttr:"10-30 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is minimal, generally estimated at less than 1% of annual revenue.",riskLevel:"Low",annualRevenueLoss:"<1% of annual revenue"},operational:{description:"Disruptions are rare and recovery is almost instantaneous due to automation.",riskLevel:"Low",meanTimeToRecover:"10-30 minutes"},strategic:{description:"High reliability can support market expansion and reinforces customer trust.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong availability with robust protection against outages","Automated failover and rapid recovery capabilities","Near real-time replication with minimal data loss risk","Suitable for business-critical applications","Supports high-value customer-facing services"],technicalImplementation:{description:"Advanced availability architecture with automated recovery",implementationSteps:["Deploy N+1 redundancy across all critical infrastructure","Implement automated failover mechanisms","Set up comprehensive monitoring and alerting","Establish regular disaster recovery testing"],effort:{development:"Months (1-3)",maintenance:"Continuous monitoring, weekly testing",expertise:"Senior IT specialists"}}},"Very High":{description:"Maximum availability with continuous operations enabled by multi-region redundancy, real-time replication, and fully automated recovery.",technical:"N+2 redundancy, active-active multi-region architecture, real-time replication, and automated remediation ensure near-zero downtime.",businessImpact:"Operational continuity is nearly uninterrupted under normal conditions, with revenue impact considered negligibleâ€”though extreme events remain a risk.",capex:60,opex:40,bg:x("Very High").bg,text:x("Very High").text,recommendations:["Implement N+2 redundancy across all critical components","Deploy an active-active multi-region architecture with real-time replication","Establish fully automated remediation systems and 24/7 operations support","Conduct regular chaos engineering exercises to stress-test resilience"],uptime:"99.99%",rto:"<5 minutes",rpo:"<1 minute",mttr:"<5 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue losses due to availability issues are negligible under normal conditions.",riskLevel:"Minimal"},operational:{description:"Business operations are maintained nearly continuously with rapid, automated recovery.",riskLevel:"Minimal",meanTimeToRecover:"<5 minutes"},strategic:{description:"Superior reliability offers a competitive advantage in high-demand markets.",riskLevel:"Minimal"},regulatory:{description:"Exceeds stringent regulatory and SLA requirements for availability.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum availability with comprehensive protection","Active-active multi-region deployment with instant failover","Real-time replication with virtually no data loss","Suitable for mission-critical systems with zero downtime requirements","Supports high-frequency financial transactions and life-critical systems"],technicalImplementation:{description:"Enterprise-grade high availability infrastructure",implementationSteps:["Implement N+2 redundancy across all system components","Deploy active-active architecture across multiple regions","Set up real-time data replication and synchronization","Implement automated self-healing mechanisms","Establish continuous chaos engineering testing"],effort:{development:"Months (4-6+)",maintenance:"24/7 operations team, continuous monitoring",expertise:"Senior availability specialists and architects"}}}},At={None:{description:"No confidentiality controls are implemented, leaving sensitive information fully exposed to any user with system access.",technical:"There are no access controls, no encryption measures, and no data classification processes.",businessImpact:"This exposes the organization to severe reputational damage and regulatory non-compliance, with potential legal penalties if sensitive data is compromised.",capex:0,opex:0,bg:x("None").bg,text:x("None").text,recommendations:["Implement basic authentication mechanisms","Introduce simple authorization controls","Establish a rudimentary data classification scheme"],protectionMethod:"None",businessImpactDetails:{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}},securityIcon:"âš ï¸",valuePoints:["No confidentiality safeguards","All data accessible to anyone with system access","High risk of data exposure and theft","No protection for sensitive information","Not suitable for handling personal or proprietary data"],technicalImplementation:{description:"No confidentiality controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data access as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic confidentiality measures are in place but provide only minimal protection against unauthorized access.",technical:"Relies on password protection, basic role-based access controls, and minimal encryption.",businessImpact:"Sensitive data is somewhat protected, but the risk of exposure remains high, potentially leading to moderate reputational harm and regulatory challenges.",capex:5,opex:3,bg:x("Low").bg,text:x("Low").text,recommendations:["Upgrade to a robust authentication system","Implement comprehensive role-based access controls","Enforce TLS/SSL for all data in transit"],protectionMethod:"Basic access control",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Exposure of sensitive data is possible, which could lead to moderate damage to the organization's reputation if an incident occurs.",riskLevel:"High"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Existing measures may not fully satisfy privacy regulations, leading to potential fines or legal scrutiny.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic confidentiality with password protection","Simple access controls for data access","Limited protection for sensitive information","Suitable for internal, less sensitive data","Provides foundation for data protection initiatives"],technicalImplementation:{description:"Basic authentication and access control",implementationSteps:["Implement password-based authentication","Set up basic role-based access controls","Configure transport layer security (TLS)"],effort:{development:"Days (1-5)",maintenance:"Monthly password resets and access reviews",expertise:"Junior IT security staff"}}},Moderate:{description:"Standard confidentiality measures provide a reasonable level of protection for sensitive information under typical threat scenarios.",technical:"Utilizes strong authentication, role-based access control, and encryption both at rest and in transit.",businessImpact:"Most unauthorized access attempts are thwarted, reducing the risk of data breaches. However, sophisticated threats might still pose a risk, leading to moderate operational and reputational impacts.",capex:15,opex:10,bg:x("Moderate").bg,text:x("Moderate").text,recommendations:["Implement robust encryption for data both at rest and in transit","Regularly review and update access controls","Establish continuous monitoring and auditing of data access"],protectionMethod:"Standard encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Sensitive data is largely protected, mitigating the risk of reputational damage in the event of an incident.",riskLevel:"Medium"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Generally meets standard data protection requirements, though vulnerabilities may remain against highly sophisticated attacks.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard confidentiality with encryption protections","Role-based access controls for data protection","Encryption for data at rest and in transit","Suitable for most business applications with sensitive data","Meets requirements for standard regulatory compliance"],technicalImplementation:{description:"Encryption and role-based access control",implementationSteps:["Implement strong authentication mechanisms","Configure comprehensive role-based access control","Deploy encryption for sensitive data at rest and in transit","Set up access logging and monitoring"],effort:{development:"Weeks (2-3)",maintenance:"Quarterly access reviews, monthly updates",expertise:"Mid-level security professionals"}}},High:{description:"Advanced confidentiality measures provide strong protection against unauthorized access to sensitive information.",technical:"Employs multi-factor authentication, robust encryption, fine-grained access controls, and continuous security monitoring.",businessImpact:"Significantly reduces the risk of data breaches, thereby minimizing reputational damage and ensuring compliance with stringent regulatory standards.",capex:30,opex:20,bg:x("High").bg,text:x("High").text,recommendations:["Deploy multi-factor authentication across all user access points","Implement end-to-end encryption and conduct regular security audits","Establish comprehensive monitoring of data access and activity"],protectionMethod:"E2E encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"High-level measures substantially reduce the risk of sensitive data exposure, protecting the organization's reputation.",riskLevel:"Low"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Measures meet or exceed many regulatory requirements, thereby reducing legal risks.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong confidentiality with advanced encryption","Multi-factor authentication for secure access","Fine-grained access controls with least privilege","Suitable for sensitive financial and personal data","Meets requirements for most regulatory frameworks"],technicalImplementation:{description:"Advanced encryption and multi-factor authentication",implementationSteps:["Deploy multi-factor authentication system","Implement end-to-end encryption for sensitive data","Configure fine-grained access controls","Set up comprehensive security monitoring","Establish regular security audit procedures"],effort:{development:"Months (2-3)",maintenance:"Bi-weekly security reviews, continuous monitoring",expertise:"Senior security engineers"}}},"Very High":{description:"Maximum confidentiality measures provide comprehensive protection for highly sensitive information requiring the utmost security.",technical:"Utilizes military-grade encryption, hardware security modules, zero-trust architecture, and continuous threat monitoring and response.",businessImpact:"Provides the highest level of data protection required for regulated industries, government contractors, or organizations handling extremely sensitive data.",capex:60,opex:40,bg:x("Very High").bg,text:x("Very High").text,recommendations:["Implement zero-trust security architecture","Deploy advanced encryption with quantum-resistant algorithms","Establish comprehensive data security governance program","Conduct regular penetration testing and security assessments"],protectionMethod:"Military-grade encryption with zero-trust",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Maximum-level measures virtually eliminate the risk of reputational damage from data breaches.",riskLevel:"Minimal"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Exceeds regulatory requirements for data protection in all major frameworks.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum confidentiality with military-grade protection","Zero-trust architecture for comprehensive security","Advanced threat detection and prevention","Suitable for classified, top-secret, or highly regulated data","Exceeds requirements for all regulatory frameworks"],technicalImplementation:{description:"Military-grade encryption with zero-trust architecture",implementationSteps:["Implement zero-trust security architecture","Deploy military-grade encryption with quantum resistance","Set up hardware security modules for cryptographic keys","Implement continuous security monitoring and threat hunting","Establish comprehensive data security governance"],effort:{development:"Months (6+)",maintenance:"Continuous monitoring, monthly assessments",expertise:"Elite security specialists and architects"}}}},Lt={None:{description:"No integrity controls are implemented, leaving the system vulnerable to undetected data corruption.",technical:"There is no input validation, no checksums, no audit logging, and no data verification mechanisms.",businessImpact:"This lack of controls poses a critical risk to decision-making and financial reporting, potentially leading to significant operational disruptions.",capex:0,opex:0,bg:x("None").bg,text:x("None").text,recommendations:["Implement fundamental input validation measures","Introduce basic application-level data checks","Set up rudimentary audit logs for critical transactions"],businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial reporting reliability is severely compromised, risking misallocation of resources.",riskLevel:"Critical"},operational:{description:"Decisions based on inaccurate data can lead to cascading failures and prolonged recovery times.",riskLevel:"Critical"}},validationMethod:"None",securityIcon:"âš ï¸",valuePoints:["No data integrity safeguards","Vulnerable to undetected data corruption","High risk of making decisions based on inaccurate data","No protection against unauthorized modifications","Not suitable for any data requiring accuracy"],technicalImplementation:{description:"No data integrity controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data flows as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic integrity controls are present, relying mainly on manual verification processes that are error-prone and hard to scale.",technical:"Relies on simple input validation, rudimentary access controls, and manual checksum verification without automated oversight.",businessImpact:"Data inaccuracies may occur intermittently, potentially leading to errors in financial calculations and operational inefficiencies.",capex:5,opex:3,bg:x("Low").bg,text:x("Low").text,recommendations:["Adopt server-side validation to minimize human error","Introduce automated data verification where possible","Schedule regular manual reviews to detect anomalies"],validationMethod:"Manual checks",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial calculations might be affected by occasional errors, though the overall impact is moderate.",riskLevel:"High"},operational:{description:"Manual processes may catch corruption inconsistently, leading to sporadic operational delays.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic data integrity with minimal protection","Simple input validation to catch obvious errors","Periodic manual verification processes","Suitable for low-importance internal data","Provides foundation for data quality initiatives"],technicalImplementation:{description:"Basic manual validation processes",implementationSteps:["Implement basic input validation in applications","Create procedures for manual data reviews","Document data validation requirements"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior developers"}}},Moderate:{description:"Standard integrity controls combine automated verification with periodic manual oversight, providing a reasonable level of assurance.",technical:"Utilizes comprehensive input validation, checksums, version control, and audit logging with a blend of automated and manual checks.",businessImpact:"Most data corruption is detected and corrected, though sophisticated attacks or subtle errors may still occur.",capex:15,opex:10,bg:x("Moderate").bg,text:x("Moderate").text,recommendations:["Implement end-to-end automated data validation","Utilize database constraints and triggers to enforce integrity rules","Establish robust audit trails and periodic integrity reviews"],validationMethod:"Automated validation",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial data is generally reliable; however, occasional discrepancies may still impact reporting accuracy.",riskLevel:"Medium"},operational:{description:"Operational disruptions are infrequent and usually resolved quickly via established audit trails.",riskLevel:"Medium"},regulatory:{description:"Controls meet basic regulatory standards, though they might fall short of stricter compliance requirements.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard integrity with automated validation","Comprehensive input validation and data checks","Database constraints to enforce data rules","Suitable for standard business applications","Meets requirements for most business operations"],technicalImplementation:{description:"Automated validation with database constraints",implementationSteps:["Implement comprehensive server-side validation","Configure database constraints and triggers","Set up automated data quality checks","Establish audit logging for data changes"],effort:{development:"Weeks (2-3)",maintenance:"Monthly reviews and updates",expertise:"Mid-level developers"}}},High:{description:"Advanced integrity controls employing cryptographic techniques provide strong data assurance, albeit with increased complexity and cost.",technical:"Incorporates digital signatures, hash verifications, and tamper-resistant audit logs to secure data integrity.",businessImpact:"Data integrity is strongly maintained, reducing risks in financial and operational decision-making, but the high investment may limit broader scalability.",capex:30,opex:20,bg:x("High").bg,text:x("High").text,recommendations:["Deploy digital signatures for high-risk data entries","Implement cryptographic hash validations for data immutability","Establish immutable audit logging mechanisms"],validationMethod:"Cryptographic verification",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"High confidence in financial data minimizes the risk of significant misreporting.",riskLevel:"Low"},operational:{description:"Robust change tracking enables timely detection and correction of data errors.",riskLevel:"Low"},regulatory:{description:"These controls typically exceed many regulatory requirements, providing a strong compliance posture.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong integrity with cryptographic protection","Digital signatures to verify data origin","Cryptographic hash validation for detecting tampering","Suitable for financial and regulated applications","Provides strong audit and compliance capabilities"],technicalImplementation:{description:"Cryptographic integrity verification systems",implementationSteps:["Implement digital signature infrastructure","Deploy hash verification for critical data","Set up immutable audit logging","Establish key management processes"],effort:{development:"Months (1-2)",maintenance:"Bi-weekly checks and key rotation",expertise:"Senior security engineers"}}},"Very High":{description:"State-of-the-art integrity controls leveraging distributed ledger technologies provide near-absolute data assurance, though they introduce significant complexity and cost.",technical:"Employs multi-party verification, blockchain-based ledgers, and zero-knowledge proofs to ensure immutable audit trails.",businessImpact:"Data integrity is virtually guaranteed, which is critical for high-stakes regulatory and financial environments, but the substantial investment and complexity may not be justifiable for all organizations.",capex:60,opex:40,bg:x("Very High").bg,text:x("Very High").text,recommendations:["Explore blockchain or distributed ledger solutions for critical data","Deploy multi-party verification systems to enhance auditability","Investigate zero-knowledge proofs to verify data integrity without compromising confidentiality"],validationMethod:"Blockchain/distributed ledger",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Ensures exceptional reliability of financial data, enabling precise reporting in regulated sectors.",riskLevel:"Minimal"},operational:{description:"Data integrity is nearly absolute, reducing operational risk to an absolute minimum, despite high system complexity.",riskLevel:"Minimal"},strategic:{description:"Supports organizations in highly regulated or high-stakes markets; however, the cost and complexity may outweigh benefits for most.",riskLevel:"Minimal"}},securityIcon:"ðŸ”",valuePoints:["Maximum integrity with blockchain/distributed ledger technology","Immutable audit trail of all data changes","Multi-party consensus verification","Suitable for high-value financial transactions and legal evidence","Virtually tamper-proof data storage and verification"],technicalImplementation:{description:"Distributed ledger or blockchain-based integrity systems",implementationSteps:["Implement blockchain or distributed ledger infrastructure","Set up consensus mechanisms for data validation","Deploy smart contracts for automated verification","Establish multi-party validation processes","Implement zero-knowledge proofs where applicable"],effort:{development:"Months (3-6+)",maintenance:"Continuous monitoring, regular protocol updates",expertise:"Specialized blockchain/cryptography experts"}}}},ve={NONE:{returnRate:"0%",value:"0%",description:"No ROI without security investment",potentialSavings:"$0",breakEvenPeriod:"N/A"},LOW:{returnRate:"50-100%",value:"50-100%",description:"Basic security measures provide minimal protection with moderate return",potentialSavings:"$5K-$10K annually",breakEvenPeriod:"12-18 months"},MODERATE:{returnRate:"100-200%",value:"100-200%",description:"Balanced security approach delivers positive returns for most organizations",potentialSavings:"$10K-$25K annually",breakEvenPeriod:"6-12 months"},HIGH:{returnRate:"200-300%",value:"200-300%",description:"Strong security posture provides excellent returns for organizations with sensitive data or operations",potentialSavings:"$20K-$50K annually",breakEvenPeriod:"3-6 months"},VERY_HIGH:{returnRate:"300-500%",value:"300-500%",description:"Maximum security investment delivers highest potential returns for organizations in regulated industries or handling critical data",potentialSavings:"$30K-$70K annually",breakEvenPeriod:"2-4 months"}},$e=Et,Ue=At,Be=Lt,Fe=ve;function Tt(i){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(i)}function ce(i){return{None:"No return on investment for none level security controls",Low:"Basic return on security investment at low level",Moderate:"Moderate return on security investment at moderate level",High:"Strong return on security investment at high level","Very High":"Maximum return on security investment at very high level"}[i]||"Unknown ROI"}const Ce={warn:i=>{console.warn(i)},error:i=>{console.error(i)},info:i=>{console.info(i)}};function jt(i){return i?i.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):""}function Dt(i){return i>=90?"Exceptional security posture meeting highest standards":i>=80?"Very strong security posture exceeding most requirements":i>=70?"Strong security posture meeting most requirements":i>=60?"Adequate security posture with some improvements needed":i>=50?"Moderate security posture with significant improvements needed":i>=40?"Weak security posture with many vulnerabilities":i>=30?"Poor security posture requiring immediate attention":i>=20?"Very poor security posture with critical vulnerabilities":"Critical security posture requiring complete overhaul"}class z extends P{dataProvider;businessImpactService;complianceService;securityMetricsService;technicalImplementationService;securityResourceService;constructor(e){const t=e||{availabilityOptions:$e,integrityOptions:Be,confidentialityOptions:Ue,roiEstimates:Fe};super(t),this.dataProvider=t,this.businessImpactService=new St(this.dataProvider),this.complianceService=new _e(this.dataProvider),this.securityMetricsService=new xe(this.dataProvider),this.technicalImplementationService=new Mt(this.dataProvider),this.securityResourceService=new Ct(this.dataProvider)}async initialize(){return Promise.resolve()}getCIAOptions(e){return e==="availability"?this.dataProvider.availabilityOptions:e==="integrity"?this.dataProvider.integrityOptions:e==="confidentiality"?this.dataProvider.confidentialityOptions:{None:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Low:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Moderate:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},High:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},"Very High":{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]}}}getComponentDetails(e,t){if(!ft(e))return;const r=this.getCIAOptions(e);if(!(!r||!r[t]))return r[t]}static normalizeLevel(e){return(e??"None").toString().trim().toLowerCase()}getROIEstimate(e){if(!e||e==="None"||z.normalizeLevel(e)==="none")return{value:"0%",returnRate:"0%",description:"No return on investment for security controls"};const t=e.toUpperCase().replace(" ","_"),r=this.dataProvider.roiEstimates[t];return r||{value:"Negative",returnRate:"0%",description:"No return on investment for security controls"}}getROIEstimates(e){if(!e||e==="None"||z.normalizeLevel(e)==="none")return{value:"0%",returnRate:"0%",description:"No return on investment for security controls"};const t={returnRate:"0%",description:"No return on investment for security controls",value:"0%"},r=this.securityLevelToROIKey(e),s=(this.dataProvider.roiEstimates||{})[r];return s?{...s,returnRate:s.returnRate||"0%"}:t}securityLevelToROIKey(e){switch(e){case"None":return"NONE";case"Low":return"LOW";case"Moderate":return"MODERATE";case"High":return"HIGH";case"Very High":return"VERY_HIGH";default:return"MODERATE"}}getAllROIEstimates(){return this.dataProvider.roiEstimates}getBusinessImpact(e,t){return this.businessImpactService.getBusinessImpact(e,t)}getTechnicalImplementation(e,t){return this.technicalImplementationService.getTechnicalImplementation(e,t)}getComponentImplementationDetails(e,t){return this.technicalImplementationService.getComponentImplementationDetails(e,t)}getBusinessImpactDescription(e,t){return this.businessImpactService.getBusinessImpactDescription(e,t)}getTechnicalDescription(e,t){return this.technicalImplementationService.getTechnicalDescription(e,t)}getDetailedDescription(e,t){return this.businessImpactService?this.businessImpactService.getBusinessImpact(e,t):{summary:"",financial:{description:"",riskLevel:""},operational:{description:"",riskLevel:""},reputational:{description:"",riskLevel:""}}}getRecommendations(e,t){return this.technicalImplementationService.getRecommendations(e,t)}calculateRoi(e,t){if(!e||e==="None"||z.normalizeLevel(e)==="none")return{value:"$0",percentage:"0%",description:ce("None")};if(t<=0)return{value:"$0",percentage:this.getROIEstimates(e).returnRate,description:ce(e)};const r=this.getROIEstimates(e),n=parseInt(r.returnRate.replace("%",""),10)||0,s=t*(n/100);return{value:Tt(s),percentage:r.returnRate,description:ce(e)}}getSecurityMetrics(e,t=e,r=e){return this.securityMetricsService.getSecurityMetrics(e,t,r)}getComplianceStatus(e,t,r){return this.complianceService.getComplianceStatus(e,t,r)}getComponentMetrics(e,t){return this.securityMetricsService.getComponentMetrics(e,t)}getImpactMetrics(e,t){return this.securityMetricsService.getImpactMetrics(e,t)}getSecurityResources(e,t){return this.securityResourceService.getSecurityResources(e,t)}getSecurityLevelDescription(e){return this.securityMetricsService.getSecurityLevelDescription(e)}getProtectionLevel(e){return this.securityMetricsService.getProtectionLevel(e)}calculateBusinessImpactLevel(e,t=e,r=e){return this.businessImpactService.calculateBusinessImpactLevel(e,t,r)}getRiskBadgeVariant(e){return this.securityMetricsService.getRiskBadgeVariant(e)}getCategoryIcon(e){return this.businessImpactService.getCategoryIcon(e)}getValuePoints(e){return this.securityResourceService.getValuePoints(e)}getImplementationConsiderations(e){return!e||!Array.isArray(e)||e.length!==3?"Invalid security levels provided. Please provide an array with exactly three security levels.":this.technicalImplementationService.getImplementationConsiderations(e[0])}getSecurityIcon(e){return this.securityMetricsService.getSecurityIcon(e)}getCompliantFrameworks(e){return this.complianceService.getCompliantFrameworks(e,e,e)}getFrameworkDescription(e){return this.complianceService.getFrameworkDescription(e)}getFrameworkRequiredLevel(e,t){const r=t,n=t,s=t,o=this.complianceService.getComplianceStatus(r,n,s);return Ce.info(`Assessing framework requirements for ${e} at ${t} level`),o.compliantFrameworks.length>0&&o.nonCompliantFrameworks.length===0?`Current ${t} level for ${e} meets requirements for most frameworks`:o.partiallyCompliantFrameworks.length>0?`Current ${t} level for ${e} partially meets requirements; consider upgrading to ${t==="Low"?"Moderate":"High"} for full compliance`:`Current ${t} level for ${e} is insufficient; upgrade to at least ${t==="None"?"Low":t==="Low"?"Moderate":"High"} for basic compliance`}getImplementationTime(e){return this.technicalImplementationService.getImplementationTime(e)}getTotalImplementationTime(e,t,r){const n={None:0,Low:2,Moderate:6,High:12,"Very High":24},s=n[e]+n[t]+n[r],o=Math.round(s*.6);return o<=0?"No implementation required":o<=4?`${o} weeks`:o<=12?`${o} weeks`:`${Math.round(o/4)} to ${Math.round(o/4)+2} months`}getRequiredExpertise(e,t,r){switch([e,t,r].sort((o,c)=>{const u={None:0,Low:1,Moderate:2,High:3,"Very High":4};return u[c]-u[o]})[0]){case"None":return"No special expertise required";case"Low":return"IT staff with basic security knowledge";case"Moderate":return"Security professional";case"High":return"Senior security engineer or architect";case"Very High":return"Expert security team with specialized skills";default:return"Unknown expertise level"}}getRecommendedImplementationPlan(e,t,r){const n=this.getSecurityLevelValue(e),s=this.getSecurityLevelValue(t),o=this.getSecurityLevelValue(r),c=n+s+o;return c<=3?`Step 1: Define basic security requirements
Step 2: Implement fundamental controls
Step 3: Document basic procedures`:c<=6?`Step 1: Conduct risk assessment
Step 2: Develop standard security controls
Step 3: Implement monitoring procedures
Step 4: Create maintenance plan`:c<=9?`Step 1: Perform comprehensive security assessment
Step 2: Design advanced security architecture
Step 3: Implement defense-in-depth strategy
Step 4: Establish continuous monitoring
Step 5: Create incident response plan`:`Step 1: Engage security experts
Step 2: Implement rigorous security architecture
Step 3: Deploy advanced security controls
Step 4: Establish security operations center
Step 5: Implement automated response capabilities
Step 6: Conduct regular penetration testing`}getInformationSensitivity(e){switch(e){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Sensitive Data";case"High":return"Confidential Data";case"Very High":return"Restricted Data";default:return"Unknown Classification"}}getComponentContent(e,t){const r=this.getComponentDetails(e,t);return r?{description:r.description||`${e} ${t} description`,technical:r.technical||`${e} ${t} technical details`,businessImpact:r.businessImpact||`${e} ${t} business impact`,recommendations:r.recommendations||[`${e} ${t} recommendation`]}:(Ce.warn(`Component details not found for ${e} at level ${t}`),{description:`${e} ${t} description not available`,technical:`${e} ${t} technical details not available`,businessImpact:`${e} ${t} business impact not available`,recommendations:[`Implement basic ${e} controls for ${t} level`]})}getBusinessImpactContent(e,t){const r=this.businessImpactService.getBusinessImpact(e,t);return r?`
      ## Business Impact Summary for ${jt(e)} (${t})
      
      ${r.summary}
      
      ### Financial Impact
      ${r.financial?.description||"Financial impact information not available."} 
      Risk level: ${r.financial?.riskLevel||"Unknown"}
      
      ### Operational Impact
      ${r.operational?.description||"Operational impact information not available."}
      Risk level: ${r.operational?.riskLevel||"Unknown"}
      
      ### Reputational Impact
      ${r.reputational?.description||"Reputational impact information not available."}
      Risk level: ${r.reputational?.riskLevel||"Unknown"}
    `:`Business impact information for ${e} at ${t} level is not available.`}getSummaryContent(e,t,r){const n=this.getComponentDetails("availability",e)?.description||`${e} availability`,s=this.getComponentDetails("integrity",t)?.description||`${t} integrity`,o=this.getComponentDetails("confidentiality",r)?.description||`${r} confidentiality`,c=this.complianceService.getComplianceStatus(e,t,r),u=this.securityMetricsService.calculateSecurityScore(e,t,r),d=this.businessImpactService.getBusinessImpactDescription("availability",e),g=this.businessImpactService.getBusinessImpactDescription("integrity",t),h=this.businessImpactService.getBusinessImpactDescription("confidentiality",r);return`
      # Security Profile Summary
      
      ## Current Security Configuration
      - **Availability**: ${n}
      - **Integrity**: ${s}
      - **Confidentiality**: ${o}
      
      ## Security Score: ${u}%
      ${Dt(u)}
      
      ## Business Impact
      - **Availability Impact**: ${d}
      - **Integrity Impact**: ${g}
      - **Confidentiality Impact**: ${h}
      
      ## Compliance Status
      ${c.status||""}
      - Compliant with ${c.compliantFrameworks.length} frameworks
      - Partially compliant with ${c.partiallyCompliantFrameworks.length} frameworks
      - Non-compliant with ${c.nonCompliantFrameworks.length} frameworks
      
      ${c.remediationSteps&&c.remediationSteps.length>0?`## Remediation Steps
`+c.remediationSteps.map(y=>`- ${y}`).join(`
`):""}
    `}getComplianceDescription(e){switch(e){case"None":return"Non-compliant with most regulatory frameworks. Fails to meet minimum security requirements for data protection and system integrity. Significant remediation needed to meet basic compliance standards.";case"Low":return"Meets only minimal compliance requirements. May satisfy basic requirements for non-sensitive data, but insufficient for regulated industries or sensitive information. Additional controls needed for most compliance frameworks.";case"Moderate":return"Satisfies common baseline requirements across major frameworks. Adequate for most general business applications but may need enhancement for highly regulated industries or sensitive data processing.";case"High":return"Compliant with major regulatory frameworks including GDPR, HIPAA, and PCI DSS. Implements controls exceeding standard requirements, suitable for organizations handling sensitive personal and financial information.";case"Very High":return"Meets the most stringent regulatory requirements across all major frameworks. Fully compliant with industry best practices and specialized regulations. Suitable for critical infrastructure, financial services, and healthcare.";default:return`Compliance information for ${e} security level is not available.`}}getKeyValuePoints(e,t){return this.getValuePoints(t)}getDefaultPrivacyImpact(e){switch(e){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}getDefaultSLAMetrics(e){switch(e){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}getDefaultValidationLevel(e){switch(e){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}getDefaultErrorRate(e){switch(e){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 1%";case"High":return"< 0.1%";case"Very High":return"< 0.01%";default:return"Unknown"}}}new z;function Ht(i){return{None:"âš ï¸",Low:"ðŸ”‘",Moderate:"ðŸ”“",High:"ðŸ”’","Very High":"ðŸ”"}[i]||"â“"}function Pt(i){const e=[`Provides ${i.toLowerCase()} level of protection`,`Meets ${i==="High"||i==="Very High"?"advanced":"basic"} security requirements`],t={None:[],Low:["Cost-effective basic security measures"],Moderate:["Balanced security and cost","Suitable for standard business operations"],High:["Strong protection for sensitive data","Complies with most regulatory frameworks"],"Very High":["Maximum protection for critical assets","Exceeds regulatory requirements","Enterprise-grade security"]};return[...e,...t[i]||[]]}function Vt(i){const e={availabilityOptions:$e,integrityOptions:Be,confidentialityOptions:Ue,roiEstimates:Fe,getDefaultSecurityIcon:Ht,getDefaultValuePoints:Pt};return new z(e)}const Ot={None:{capex:0,opex:0},Low:{capex:5e3,opex:2e3},Moderate:{capex:15e3,opex:5e3},High:{capex:5e4,opex:15e3},"Very High":{capex:2e5,opex:5e4}},Me={small:.5,medium:1,large:2.5,enterprise:5},Ee={general:1,financial:1.5,healthcare:1.7,government:1.3,retail:1.2,technology:1.4,manufacturing:1.1};function _t(i){if(!i)return"None";const e=typeof i=="string"?i.trim():"";return/^none$/i.test(e)?"None":/^low$/i.test(e)?"Low":/^(moderate|medium)$/i.test(e)?"Moderate":/^high$/i.test(e)?"High":/^very\s*high$/i.test(e)?"Very High":"None"}function le(i,e="medium",t="general"){const r=_t(i),n=Ot[r]||{capex:0,opex:0},s=Ut(e),o=Bt(t);return{capex:Math.round(n.capex*s*o),opex:Math.round(n.opex*s*o)}}function $t(i,e,t,r="medium",n="general"){const s=le(i,r,n),o=le(e,r,n),c=le(t,r,n),u=s.capex+o.capex+c.capex,d=s.opex+o.opex+c.opex;return{availabilityCost:s,integrityCost:o,confidentialityCost:c,totalCapex:u,totalOpex:d,totalCost:u+d}}function Ut(i){return Me[i]||Me.medium}function Bt(i){return Ee[i]||Ee.general}function Oi(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function _i(i){return typeof i=="string"}function $i(i){return Array.isArray(i)}function k(i){return i==null}function Ft(i){return i instanceof Error}function G(i,e){return i!=null&&typeof i=="object"&&e in i&&typeof i[e]=="function"}function qe(i){return Ft(i)?i:i instanceof Object&&"message"in i&&typeof i.message=="string"?new Error(i.message):new Error(String(i))}function qt(i,e){const t=qe(i);return e?`${e}: ${t.message}`:t.message}const ze=i=>typeof i=="object"&&i!==null&&"message"in i&&typeof i.message=="string",ke=i=>ze(i)?i.message:i==null||typeof i=="object"&&!("message"in i)?"An unknown error occurred":String(i),zt=i=>{const e=ke(i);console.error("Error:",e)},Gt=(i,e)=>{const t=ke(i);return console.error(`API Error (${e}):`,t),t},Yt=Object.freeze(Object.defineProperty({__proto__:null,displayErrorMessage:zt,formatError:qt,formatErrorMessage:ke,handleApiError:Gt,isErrorWithMessage:ze,toErrorObject:qe},Symbol.toStringTag,{value:"Module"}));function ue(i,e,t){let r="USD",n="en-US",s=0,o=0;return typeof e=="string"?(r=e,t&&(n=t)):e&&typeof e=="object"&&(e.currency&&(r=e.currency),e.locale&&(n=e.locale),e.minimumFractionDigits!==void 0&&(s=e.minimumFractionDigits),e.maximumFractionDigits!==void 0&&(o=e.maximumFractionDigits)),new Intl.NumberFormat(n,{style:"currency",currency:r,minimumFractionDigits:s,maximumFractionDigits:o}).format(i)}function Ui(i){switch(i){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}function Bi(i){switch(i){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}function Fi(i){switch(i){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}const qi=i=>{switch(i){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 3%";case"High":return"< 1%";case"Very High":return"< 0.01%";default:return"Unknown"}};function zi(i){switch(i){case"Minimal":return"Low Risk";case"Low":return"Low Risk";case"Moderate":return"Low Risk";case"High":return"High Risk";case"Very High":return"High Risk";default:return"Unknown Risk"}}function Wt(i){if(!i)return"neutral";const e=Kt(i);return e.includes("critical")?"error":e.includes("high risk")?"warning":e.includes("medium")||e.includes("moderate")?"info":e.includes("low risk")||e.includes("minimal")||e.includes("none")?"success":"neutral"}function Kt(i){return i==null?"":i.toLowerCase()}function Gi(i,e,t){const r={None:0,Low:1,Moderate:2,High:3,"Very High":4},n=r[i]||0,s=r[e]||0,o=r[t]||0,c=(n+s+o)/3;return c<=.5?"Minimal":c<=1.5?"Low":c<=2.5?"Moderate":c<=3.5?"High":"Very High"}function Yi(i,e,t){const r=q(i)+q(e)+q(t);return r<=2?"Low":r<=6?"Moderate":r<=9?"High":"Very High"}function Wi(i,e){const t=e==="None"||e==="Low";return i==="availability"?{summary:`${e} availability impact on business operations`,operational:{description:`${t?"Significant operational disruptions possible due to limited availability controls":"Operations protected by appropriate availability controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Potential financial losses due to service disruptions and downtime":"Financial impact minimized through robust availability controls"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:i==="integrity"?{summary:`${e} integrity impact on business operations`,operational:{description:`${t?"Business decisions may be based on inaccurate or corrupted data":"Data accuracy protected by appropriate integrity controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Financial losses possible due to data errors affecting decision making":"Financial impact minimized through data validation and integrity mechanisms"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:{summary:`${e} confidentiality impact on business operations`,reputational:{description:`${t?"High risk of reputational damage from data exposures or breaches":"Reputation protected by appropriate confidentiality controls"}`,riskLevel:t?"High Risk":"Low Risk"},regulatory:{description:`${t?"Increased risk of non-compliance with data protection regulations":"Regulatory compliance supported by appropriate data protection measures"}`,riskLevel:t?"Medium Risk":"Low Risk"}}}const re={REGION:"region",TABLIST:"tablist",TAB:"tab",TABPANEL:"tabpanel"};function Ge(i,e){return e?`${i} widget. ${e}`:`${i} widget`}function Xt(i,e,t){return{role:re.TAB,"aria-selected":e,"aria-controls":t,id:i,tabIndex:e?0:-1}}function J(i,e,t){const r={role:re.TABPANEL,id:i,"aria-labelledby":e,tabIndex:0};return t&&(r.hidden=!0),r}function Zt(i,e,t,r,n="vertical"){const{key:s}=i;let o=e;n==="vertical"?s==="ArrowDown"?(o=Math.min(e+1,t-1),i.preventDefault()):s==="ArrowUp"&&(o=Math.max(e-1,0),i.preventDefault()):s==="ArrowRight"?(o=Math.min(e+1,t-1),i.preventDefault()):s==="ArrowLeft"&&(o=Math.max(e-1,0),i.preventDefault()),s==="Home"?(o=0,i.preventDefault()):s==="End"&&(o=t-1,i.preventDefault()),o!==e&&r(o)}let E=null,Y=null;const U=[];function Jt(){return(!E||!document.body.contains(E))&&(E=document.createElement("div"),E.setAttribute("aria-atomic","true"),E.setAttribute("class","sr-only"),E.style.position="absolute",E.style.left="-10000px",E.style.width="1px",E.style.height="1px",E.style.overflow="hidden",document.body.appendChild(E)),E}function Ki(i,e="polite"){const t=Jt();for(t.setAttribute("aria-live",e),t.textContent="",Y&&(clearTimeout(Y),Y=null);U.length>0;){const n=U.pop();n&&clearTimeout(n)}const r=setTimeout(()=>{t.textContent=i},100);U.push(r),Y=setTimeout(()=>{t.textContent="";const n=U.indexOf(r);n>-1&&U.splice(n,1)},3e3),U.push(Y)}const Xi={SHOW_HELP:{id:"show-help",keys:"?",description:"Show keyboard shortcuts",category:"Help"},SHOW_HELP_ALT:{id:"show-help-alt",keys:"ctrl+/",description:"Show keyboard shortcuts (alternative)",category:"Help"}},Zi={Selection:"ðŸŽ¯ Security Level Selection",Navigation:"ðŸ§­ Navigation",Actions:"âš¡ Actions",Help:"â“ Help",General:"ðŸ“‹ General"},B={MAC:"MAC",WINDOWS:"WIN",LINUX:"LINUX"},Ae={ctrl:{windows:"Ctrl",mac:"âŒ˜",linux:"Ctrl",unknown:"Ctrl"},shift:{windows:"Shift",mac:"â‡§",linux:"Shift",unknown:"Shift"},alt:{windows:"Alt",mac:"âŒ¥",linux:"Alt",unknown:"Alt"},meta:{windows:"Win",mac:"âŒ˜",linux:"Meta",unknown:"Meta"},cmd:{windows:"Ctrl",mac:"âŒ˜",linux:"Ctrl",unknown:"Ctrl"},enter:{windows:"Enter",mac:"â†µ",linux:"Enter",unknown:"Enter"},escape:{windows:"Esc",mac:"Esc",linux:"Esc",unknown:"Esc"},backspace:{windows:"Backspace",mac:"âŒ«",linux:"Backspace",unknown:"Backspace"},tab:{windows:"Tab",mac:"â‡¥",linux:"Tab",unknown:"Tab"},arrowup:{windows:"â†‘",mac:"â†‘",linux:"â†‘",unknown:"â†‘"},arrowdown:{windows:"â†“",mac:"â†“",linux:"â†“",unknown:"â†“"},arrowleft:{windows:"â†",mac:"â†",linux:"â†",unknown:"â†"},arrowright:{windows:"â†’",mac:"â†’",linux:"â†’",unknown:"â†’"}},Qt=["INPUT","TEXTAREA","SELECT"],ei=["Escape","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"],Ji={HELP_MODAL:"keyboard-shortcut-help-modal",HELP_MODAL_CLOSE:"keyboard-shortcut-help-modal-close",HELP_MODAL_TITLE:"keyboard-shortcut-help-modal-title",HELP_MODAL_CATEGORY:"keyboard-shortcut-help-modal-category",HELP_MODAL_SHORTCUT:"keyboard-shortcut-help-modal-shortcut",SHORTCUT_BADGE:"keyboard-shortcut-badge",SHORTCUT_BADGE_KEY:"keyboard-shortcut-badge-key"};let S=null;function Se(){if(S!==null)return S;if(typeof window>"u")return S="unknown",S;const i=navigator;if("userAgentData"in navigator&&i.userAgentData?.platform){const t=i.userAgentData.platform.toUpperCase();if(t.indexOf(B.MAC)>=0)return S="mac",S;if(t.indexOf(B.WINDOWS)>=0)return S="windows",S;if(t.indexOf(B.LINUX)>=0)return S="linux",S}const e=window.navigator.platform.toUpperCase();return e.indexOf(B.MAC)>=0?(S="mac",S):e.indexOf(B.WINDOWS)>=0?(S="windows",S):e.indexOf(B.LINUX)>=0?(S="linux",S):(S="unknown",S)}function Qi(i){const e=[],t=Se();i.ctrlKey&&e.push("ctrl"),i.metaKey&&(t==="mac"?e.push("cmd"):e.push("meta")),i.shiftKey&&e.push("shift"),i.altKey&&e.push("alt");const r=i.key.toLowerCase();return r===" "?e.push("space"):r==="escape"?e.push("escape"):r==="enter"?e.push("enter"):e.push(r),e.join("+")}function Le(i){const e=["ctrl","cmd","meta","shift","alt"],t=i.toLowerCase().split("+").map(c=>c.trim()).filter(c=>c.length>0),r=[],n=[];for(const c of t)e.includes(c)?r.push(c):n.push(c);const s=e.filter(c=>r.includes(c)),o=[...n].sort();return[...s,...o].join("+")}function er(i,e){const t=Le(i.replace(/cmd/g,"ctrl").replace(/meta/g,"ctrl")),r=Le(e.replace(/cmd/g,"ctrl").replace(/meta/g,"ctrl"));return t===r}function tr(i,e){const t=e||Se();return i.split("+").map(r=>{const n=r.toLowerCase();return n in Ae?Ae[n][t]:r.charAt(0).toUpperCase()+r.slice(1)})}function ti(i){if(!i||!i.tagName)return!1;const e=i.tagName.toUpperCase();return Qt.includes(e)}function ir(i){const e=i.target;return ei.includes(i.key)?!1:!!(e&&ti(e)||e&&e.getAttribute&&e.getAttribute("contenteditable")==="true")}function rr(i,e){if(!e)return i;const t=Se();return e[t]||i}function ar(){return typeof window<"u"&&typeof window.addEventListener=="function"}const{toErrorObject:ii}=Yt,Ye=()=>{const[i,e]=m.useState(null),[t,r]=m.useState(!0),[n,s]=m.useState(null),o=async()=>{try{r(!0);const u=Vt();await u.initialize(),e(u),s(null)}catch(u){e(null),s(ii(u))}finally{r(!1)}},c=()=>{r(!0),o()};return m.useEffect(()=>{o()},[]),{ciaContentService:i,isLoading:t,error:n,refresh:c}},de=({category:i,level:e,colorClass:t,textClass:r,className:n="",testId:s})=>{const o=()=>{switch(e){case"None":return"bg-red-100 dark:bg-red-900 dark:bg-opacity-20";case"Low":return"bg-yellow-100 dark:bg-yellow-900 dark:bg-opacity-20";case"Moderate":return"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20";case"High":return"bg-green-100 dark:bg-green-900 dark:bg-opacity-20";case"Very High":return"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20";default:return"bg-gray-100 dark:bg-gray-800"}},c=()=>{switch(e){case"None":return"text-red-800 dark:text-red-300";case"Low":return"text-yellow-800 dark:text-yellow-300";case"Moderate":return"text-blue-800 dark:text-blue-300";case"High":return"text-green-800 dark:text-green-300";case"Very High":return"text-purple-800 dark:text-purple-300";default:return"text-gray-800 dark:text-gray-300"}},u=t||o(),d=r||c();return a.jsxs("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${u} ${d} ${n}`,"data-testid":s,children:[i&&`${i}: `,e]})},We=({title:i,children:e,isLoading:t=!1,loading:r=!1,error:n=null,className:s="",testId:o,errorContent:c,icon:u,actions:d})=>{const g=t||r,h=n?`widget-container-error${o?`-${o}`:""}`:g?`widget-container-loading-container${o?`-${o}`:""}`:`widget-container${o?`-${o}`:""}`,y=`widget-spinner${o?`-${o}`:""}`,b=`test-widget-error${o?`-${o}`:""}`;let f=null;return n!==null&&(f=n instanceof Error?n.message:String(n)),f?a.jsxs("div",{className:`widget-container widget-error border border-error rounded-md shadow-md ${s}`,"data-testid":h,children:[a.jsx("div",{className:"widget-header bg-error-light/10 dark:bg-error-dark/20 px-md py-sm sm:px-lg sm:py-md border-b border-error-light dark:border-error-dark rounded-t-md",children:a.jsxs("h3",{className:"text-body-lg sm:text-heading font-semibold text-error-dark dark:text-error-light flex items-center",children:[a.jsx("span",{className:"mr-sm",children:"âš ï¸"}),i]})}),a.jsxs("div",{className:"widget-body p-md sm:p-lg bg-white dark:bg-gray-900 rounded-b-md",children:[a.jsx("div",{className:"text-error dark:text-error-light","data-testid":b,children:f}),c&&a.jsx("div",{className:"mt-md",children:c})]})]}):a.jsxs("div",{className:`widget-container border border-neutral-light dark:border-neutral-dark rounded-md shadow-md ${s}`,"data-testid":h,children:[a.jsxs("div",{className:"widget-header bg-neutral-light/10 dark:bg-neutral-dark/20 px-md py-sm sm:px-lg sm:py-md border-b border-neutral-light dark:border-neutral-dark rounded-t-md flex justify-between items-center",children:[a.jsxs("h3",{className:"text-body-lg sm:text-heading font-semibold text-gray-800 dark:text-gray-200 flex items-center",children:[u&&a.jsx("span",{className:"mr-sm",children:u}),i]}),d&&a.jsx("div",{className:"widget-actions",children:d})]}),a.jsx("div",{className:`widget-body p-md sm:p-lg bg-white dark:bg-gray-900 rounded-b-md ${g?"flex items-center justify-center min-h-[100px]":""}`,children:g?a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary","data-testid":y}):e})]})},ri=({title:i="Error",message:e,retry:t,testId:r="error-message",className:n=""})=>a.jsxs("div",{className:`p-4 border border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded-lg ${n}`,"data-testid":r,role:"alert","aria-live":"polite",children:[a.jsxs("h3",{className:"text-red-800 dark:text-red-300 font-semibold text-lg mb-2 flex items-center","data-testid":`${r}-title`,children:[a.jsx("span",{className:"mr-2","aria-hidden":"true",children:"âš ï¸"}),i]}),a.jsx("p",{className:"text-red-600 dark:text-red-400 mb-4","data-testid":`${r}-text`,children:e}),t&&a.jsx("button",{onClick:t,className:"px-4 py-2 bg-red-600 dark:bg-red-700 text-white rounded hover:bg-red-700 dark:hover:bg-red-600 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2","data-testid":`${r}-retry-button`,"aria-label":"Try again",children:"Try Again"})]});class Ke extends m.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){const{widgetName:r,onError:n}=this.props;L.error(`WidgetErrorBoundary caught error${r?` in ${r}`:""}`,{error:e,errorInfo:t}),n&&n(e,t)}resetError=()=>{this.setState({hasError:!1,error:void 0})};render(){const{hasError:e,error:t}=this.state,{children:r,fallback:n,widgetName:s,testId:o="widget-error-boundary"}=this.props;return e?n||a.jsx("div",{"data-testid":o,className:"p-4",children:a.jsx(ri,{title:s?`${s} Error`:"Widget Error",message:t?.message||"An unexpected error occurred in this widget",retry:this.resetError,testId:`${o}-message`})}):r}}const ai={BUSINESS_IMPACT_WIDGET:"business-impact-widget"},Q={RADAR_CHART:"radar-chart",RADAR_AVAILABILITY_VALUE:"radar-availability-value",RADAR_INTEGRITY_VALUE:"radar-integrity-value",RADAR_CONFIDENTIALITY_VALUE:"radar-confidentiality-value"},nr={APP_CONTAINER:"app-container",APP_TITLE:"app-title"},me={KEY_VALUE_PAIR:"key-value-pair",KEY_VALUE_KEY:"key-value-key",KEY_VALUE_VALUE:"key-value-value"},ie={WIDGET:"security-summary-widget",AVAILABILITY_CARD:"availability-card",INTEGRITY_CARD:"integrity-card",CONFIDENTIALITY_CARD:"confidentiality-card"},sr={AVAILABILITY_IMPACT_PREFIX:"widget-availability-impact"},or={INTEGRITY_IMPACT_PREFIX:"integrity-impact"},cr={WIDGET:"security-resources-widget"},lr={COMPLIANCE_STATUS_BADGE:"compliance-status-badge",COMPLIANT_FRAMEWORKS_LIST:"compliant-frameworks-list",WIDGET:"compliance-status-widget",COMPLIANCE_STATUS_SUMMARY:"compliance-status-summary",COMPLIANCE_SCORE:"compliance-score",COMPLIANCE_SCORE_BAR:"compliance-score-bar",FRAMEWORK_ITEM_PREFIX:"framework-item",PARTIALLY_COMPLIANT_FRAMEWORKS_LIST:"partially-compliant-frameworks-list",NON_COMPLIANT_FRAMEWORKS_LIST:"non-compliant-frameworks-list",FRAMEWORK_GAP_ANALYSIS:"framework-gap-analysis",NO_GAP_ANALYSIS:"no-gap-analysis",COMPLIANCE_TIPS_LIST:"compliance-tips-list"},Te={CONTENT_REGION:"content-region",WIDGET_KEYBOARD_INSTRUCTIONS:"widget-keyboard-instructions"};function W(){return{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"}}function ni(){const[i,e]=m.useState(!0),[t,r]=m.useState(null),n=m.useMemo(()=>{const s={None:W(),Low:W(),Moderate:W(),High:W(),"Very High":W()};return new _e({availabilityOptions:s,integrityOptions:s,confidentialityOptions:s,roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"300%",description:"High ROI"},VERY_HIGH:{returnRate:"500%",description:"Very high ROI"}}})},[]);return m.useEffect(()=>{let s=!0;return(async()=>{try{n&&s&&e(!1)}catch(c){console.error("Failed to initialize compliance service:",c),s&&(r(c instanceof Error?c:new Error("An error occurred")),e(!1))}})(),()=>{s=!1}},[n]),{isLoading:i,complianceService:n,error:t}}const si=()=>{const[i,e]=m.useState(null),[t,r]=m.useState(null),[n,s]=m.useState(!0),o=m.useCallback(async()=>{try{s(!0),r(null);const{createDefaultDataProvider:c}=await gt(async()=>{const{createDefaultDataProvider:d}=await import("./dataProviders-CFFatKfO.js");return{createDefaultDataProvider:d}},[],import.meta.url),u=c();e(u)}catch(c){console.error("Error initializing CIA data provider:",c),r(c instanceof Error?c:new Error("Failed to initialize data provider")),e(null)}finally{s(!1)}},[]);return m.useEffect(()=>{o()},[o]),{dataProvider:i,error:t,isLoading:n,refreshDataProvider:o}},oi=()=>{const[i,e]=m.useState(null),[t,r]=m.useState(null),[n,s]=m.useState(!0),{dataProvider:o}=si(),c=m.useCallback(async()=>{try{s(!0),r(null);const u=o?Re(o):Re();e(u)}catch(u){console.error("Error initializing security metrics service:",u),r(u instanceof Error?u:new Error("Failed to initialize security metrics service")),e(null)}finally{s(!1)}},[o]);return m.useEffect(()=>{c()},[c]),{securityMetricsService:i,error:t,isLoading:n,refreshService:c}};function pe({label:i,value:e,className:t="",keyClassName:r="",valueClassName:n="",labelClassName:s="",testId:o,iconPrefix:c}){return a.jsxs("div",{className:`p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 ${t}`,"data-testid":o||me.KEY_VALUE_PAIR,children:[a.jsxs("div",{className:`text-xs font-medium mb-1 text-gray-600 dark:text-gray-400 ${r} ${s}`,"data-testid":me.KEY_VALUE_KEY,children:[c&&a.jsx("span",{className:"mr-1",children:c}),i]}),a.jsx("div",{className:`text-sm font-medium ${n}`,"data-testid":me.KEY_VALUE_VALUE,children:e||"N/A"})]})}const K=({status:i,children:e,className:t="",testId:r,size:n="md",variant:s="neutral"})=>{const o=()=>{switch(i){case"success":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300";case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300";case"neutral":return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300";case"purple":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-30 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},c=()=>{switch(n){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}},u=ci(i);return a.jsx("span",{className:`font-medium rounded-md ${o()} ${c()} ${u} ${t}`,"data-testid":r,children:e})};function ci(i){switch(i){case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-20 dark:text-red-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-20 dark:text-yellow-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-20 dark:text-blue-300";case"success":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-20 dark:text-green-300";case"neutral":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}}const li=({risk:i,className:e="",testId:t="risk-level-badge",showIcon:r=!1})=>{if(!i)return a.jsx(K,{status:"neutral",className:e,testId:t,children:"Unknown"});const n=i.includes("Risk")?i:`${i} Risk`,s=Wt(i);return a.jsxs(K,{status:s,className:e,testId:t,children:[r&&ui(i)," ",n]})};function ui(i){const e=i.toLowerCase();return e.includes("critical")||e.includes("high")?"âš ï¸":e.includes("medium")||e.includes("moderate")?"âš ":e.includes("low")?"â„¹ï¸":e.includes("minimal")||e.includes("none")?"âœ“":"â“"}const di=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,className:r="",testId:n=ai.BUSINESS_IMPACT_WIDGET})=>{const{ciaContentService:s,error:o,isLoading:c}=Ye(),[u,d]=m.useState("considerations"),g=m.useMemo(()=>{try{if(k(s))return ee(i,e,t);if(typeof s.calculateBusinessImpactLevel=="function"){const l=s.calculateBusinessImpactLevel(i,e,t);return k(l)?ee(i,e,t):l}return ee(i,e,t)}catch(l){return console.error("Error calculating impact level:",l),ee(i,e,t)}},[s,i,e,t]),h=m.useMemo(()=>{try{if(k(s))return A("availability",i);if(typeof s.getBusinessImpact=="function"){const l=s.getBusinessImpact("availability",i);return k(l)?A("availability",i):l}return A("availability",i)}catch(l){return console.error("Error getting availability impact:",l),A("availability",i)}},[s,i]),y=m.useMemo(()=>{try{if(k(s))return A("integrity",e);if(typeof s.getBusinessImpact=="function"){const l=s.getBusinessImpact("integrity",e);return k(l)?A("integrity",e):l}return A("integrity",e)}catch(l){return console.error("Error getting integrity impact:",l),A("integrity",e)}},[s,e]),b=m.useMemo(()=>{try{if(k(s))return A("confidentiality",t);if(typeof s.getBusinessImpact=="function"){const l=s.getBusinessImpact("confidentiality",t);return k(l)?A("confidentiality",t):l}return A("confidentiality",t)}catch(l){return console.error("Error getting confidentiality impact:",l),A("confidentiality",t)}},[s,t]),f=(l,v,N)=>{const I={None:0,Low:1,Moderate:2,High:3,"Very High":4},R=I[l]||0,D=I[v]||0,Z=I[N]||0,V=R+D+Z;return V<=2?"Low":V<=6?"Moderate":V<=9?"High":"Very High"},w=(l,v)=>{const N={Availability:"â±ï¸",Integrity:"âœ…",Confidentiality:"ðŸ”’",Financial:"ðŸ’°",Operational:"âš™ï¸",Reputational:"ðŸ‘¥",Regulatory:"ðŸ“œ"};return a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg mb-3","data-testid":`${n}-impact-${l.toLowerCase()}`,children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("h3",{className:"text-md font-medium flex items-center",children:[a.jsx("span",{className:"mr-2",children:N[l]||"ðŸ“Š"}),l," Impact"]}),v.riskLevel&&a.jsx(li,{risk:v.riskLevel,testId:`${n}-risk-level`})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:v.description||"No description available"})]},`impact-${l}`)},C=m.useMemo(()=>{const l=F(i)+F(e)+F(t);return[{title:"Implementation Effort",description:`${f(i,e,t)} complexity implementation requiring appropriate planning and resources.`,icon:"âš™ï¸"},{title:"Resource Requirements",description:`Security levels of this tier typically require ${l<3?"minimal resources and can be implemented with existing staff.":l<6?"moderate resources including some specialized expertise.":l<9?"significant resources and dedicated security personnel.":"extensive resources and specialized security expertise."}`,icon:"ðŸ‘¥"},{title:"Maintenance Overhead",description:`Ongoing maintenance will require ${l<3?"minimal effort with basic monitoring.":l<6?"regular attention and periodic reviews.":l<9?"dedicated staff time and routine assessments.":"continuous monitoring and regular reassessment."}`,icon:"ðŸ”§"},{title:"Organizational Impact",description:`These security controls will have ${l<3?"minimal impact on business processes.":l<6?"some impact on business processes requiring minor adjustments.":l<9?"moderate impact on business processes requiring training and adaptation.":"significant impact requiring process redesign and extensive training."}`,icon:"ðŸ¢"}]},[i,e,t]),M=m.useMemo(()=>{const l=F(i)+F(e)+F(t);return[{title:"Risk Reduction",description:`${l<3?"Basic protection against common threats.":l<6?"Moderate risk reduction for most business scenarios.":l<9?"Significant protection against advanced threats.":"Comprehensive protection against sophisticated attacks."}`,icon:"ðŸ›¡ï¸"},{title:"Compliance Coverage",description:`These security controls provide ${l<3?"minimal compliance coverage for basic requirements.":l<6?"moderate compliance coverage for common regulations.":l<9?"substantial compliance coverage for most frameworks.":"comprehensive compliance with stringent regulatory requirements."}`,icon:"âœ…"},{title:"Business Enablement",description:`Security at this level ${l<3?"enables basic business operations with minimal protection.":l<6?"supports standard business functions with adequate protection.":l<9?"enables business growth with strong security assurances.":"provides competitive advantage through superior security posture."}`,icon:"ðŸ“ˆ"},{title:"Customer Trust",description:`This security profile ${l<3?"meets minimal customer expectations.":l<6?"satisfies standard customer security requirements.":l<9?"exceeds typical customer security expectations.":"establishes your organization as a security leader in the industry."}`,icon:"ðŸ¤"}]},[i,e,t]),T=()=>a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 mt-4 mb-4",children:[a.jsxs("div",{className:`p-2 sm:p-3 rounded text-center ${ge(t)}`,"data-testid":`${n}-heatmap-confidentiality`,children:[a.jsx("div",{className:"text-xs sm:text-sm font-medium",children:"Confidentiality"}),a.jsx("div",{className:"text-sm sm:text-base font-bold",children:t})]}),a.jsxs("div",{className:`p-2 sm:p-3 rounded text-center ${ge(e)}`,"data-testid":`${n}-heatmap-integrity`,children:[a.jsx("div",{className:"text-xs sm:text-sm font-medium",children:"Integrity"}),a.jsx("div",{className:"text-sm sm:text-base font-bold",children:e})]}),a.jsxs("div",{className:`p-2 sm:p-3 rounded text-center ${ge(i)}`,"data-testid":`${n}-heatmap-availability`,children:[a.jsx("div",{className:"text-xs sm:text-sm font-medium",children:"Availability"}),a.jsx("div",{className:"text-sm sm:text-base font-bold",children:i})]})]}),p=()=>a.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4","data-testid":`${n}-executive-summary`,children:[a.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[a.jsx("span",{className:"mr-2",children:"ðŸ“Š"}),"Executive Summary"]}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Current security posture provides"," ",a.jsx("span",{className:"font-medium",children:g})," protection for business operations. Business impacts are most significant in"," ",mi(h,y,b)," ","areas."]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[a.jsx(pe,{label:"Overall Impact",value:g,testId:`${n}-overall-impact`,valueClassName:`font-medium ${pi(g)}`}),a.jsx(pe,{label:"Implementation Complexity",value:f(i,e,t),testId:`${n}-implementation-complexity`}),a.jsx(pe,{label:"Security Profile",value:i===e&&e===t?i:"Mixed",testId:`${n}-security-profile`})]})]});return a.jsx(Ke,{widgetName:"Business Impact Analysis",children:a.jsx(We,{title:He.BUSINESS_IMPACT_ANALYSIS,icon:De.BUSINESS_IMPACT_ANALYSIS,className:r,testId:n,isLoading:c,error:o,children:a.jsxs("div",{className:"p-4",role:"region","aria-label":Ge("Business Impact Analysis","Business implications of security measures across financial, operational, reputational and regulatory dimensions"),children:[a.jsxs("section",{className:"mb-4","aria-labelledby":"business-impacts-heading",children:[a.jsx("h3",{id:"business-impacts-heading",className:"text-lg font-medium mb-3",children:"Business Impacts by Component"}),b&&a.jsxs("div",{className:"mb-3",children:[a.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[a.jsx("span",{className:"mr-2","aria-hidden":"true",children:"ðŸ”’"}),"Confidentiality Impact"]}),b.reputational&&w("Reputational",b.reputational),b.regulatory&&w("Regulatory",b.regulatory)]}),y&&a.jsxs("div",{className:"mb-3",children:[a.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[a.jsx("span",{className:"mr-2",children:"âœ…"}),"Integrity Impact"]}),y.financial&&w("Financial",y.financial),y.operational&&w("Operational",y.operational)]}),h&&a.jsxs("div",{className:"mb-3",children:[a.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[a.jsx("span",{className:"mr-2","aria-hidden":"true",children:"â±ï¸"}),"Availability Impact"]}),h.financial&&w("Financial",h.financial),h.operational&&w("Operational",h.operational)]})]}),a.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:a.jsx("p",{className:"text-sm",children:p()})}),a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"text-lg font-medium mb-2",children:"Current Security Levels"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx(de,{category:"Confidentiality",level:t,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:`${n}-confidentiality-badge`}),a.jsx(de,{category:"Integrity",level:e,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:`${n}-integrity-badge`}),a.jsx(de,{category:"Availability",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:`${n}-availability-badge`})]}),T()]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("button",{className:`py-3 px-4 sm:py-2 font-medium text-sm sm:text-base min-h-[44px] ${u==="considerations"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>d("considerations"),"data-testid":`${n}-tab-considerations`,children:"Implementation Considerations"}),a.jsx("button",{className:`py-3 px-4 sm:py-2 font-medium text-sm sm:text-base min-h-[44px] ${u==="benefits"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>d("benefits"),"data-testid":`${n}-tab-benefits`,children:"Business Benefits"})]})}),u==="considerations"?a.jsx("div",{className:"grid grid-cols-1 gap-4","data-testid":`${n}-considerations`,children:C.map((l,v)=>a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":`${n}-consideration-${v}`,children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx("span",{className:"mr-2 text-blue-500",children:l.icon}),a.jsx("h4",{className:"text-md font-medium",children:l.title})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:l.description})]},`consideration-${v}`))}):a.jsx("div",{className:"grid grid-cols-1 gap-4","data-testid":`${n}-benefits`,children:M.map((l,v)=>a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":`${n}-benefit-${v}`,children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx("span",{className:"mr-2 text-green-500",children:l.icon}),a.jsx("h4",{className:"text-md font-medium",children:l.title})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:l.description})]},`benefit-${v}`))})]})]})})})};function mi(i,e,t){const r=[];return i?.operational?.riskLevel?.includes("High")&&r.push("operational"),i?.financial?.riskLevel?.includes("High")&&r.push("financial"),e?.operational?.riskLevel?.includes("High")&&r.push("operational"),e?.financial?.riskLevel?.includes("High")&&r.push("financial"),t?.reputational?.riskLevel?.includes("High")&&r.push("reputational"),t?.regulatory?.riskLevel?.includes("High")&&r.push("regulatory"),r.length===0?"minimal":r.length===1?r[0]:r.length===2?`${r[0]} and ${r[1]}`:"multiple"}function F(i){return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[i]||0}function ge(i){switch(i){case"None":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";case"Low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300";case"Moderate":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300";case"High":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:bg-opacity-30 dark:text-orange-300";case"Very High":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}}function pi(i){return i.includes("Low")?"text-green-600 dark:text-green-400":i.includes("Moderate")?"text-yellow-600 dark:text-yellow-400":i.includes("High")?"text-orange-600 dark:text-orange-400":i.includes("Very High")||i.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}function ee(i,e,t){const r={None:0,Low:1,Moderate:2,High:3,"Very High":4},n=r[i]||0,s=r[e]||0,o=r[t]||0,c=(n+s+o)/3;return c<=.5?"Minimal":c<=1.5?"Low":c<=2.5?"Moderate":c<=3.5?"High":"Very High"}function A(i,e){const t=e==="None"||e==="Low";return i==="availability"?{summary:`${e} availability impact on business operations`,operational:{description:`${t?"Significant operational disruptions possible due to limited availability controls":"Operations protected by appropriate availability controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Potential financial losses due to service disruptions and downtime":"Financial impact minimized through robust availability controls"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:i==="integrity"?{summary:`${e} integrity impact on business operations`,operational:{description:`${t?"Business decisions may be based on inaccurate or corrupted data":"Data accuracy protected by appropriate integrity controls"}`,riskLevel:t?"High Risk":"Low Risk"},financial:{description:`${t?"Financial losses possible due to data errors affecting decision making":"Financial impact minimized through data validation and integrity mechanisms"}`,riskLevel:t?"Medium Risk":"Low Risk"}}:{summary:`${e} confidentiality impact on business operations`,reputational:{description:`${t?"High risk of reputational damage from data exposures or breaches":"Reputation protected by appropriate confidentiality controls"}`,riskLevel:t?"High Risk":"Low Risk"},regulatory:{description:`${t?"Increased risk of non-compliance with data protection regulations":"Regulatory compliance supported by appropriate data protection measures"}`,riskLevel:t?"Medium Risk":"Low Risk"}}}const ur=Object.freeze(Object.defineProperty({__proto__:null,default:di},Symbol.toStringTag,{value:"Module"}));function gi(i,e,t){const n=Ve(i,e,t).toUpperCase().replace(" ","_");return ve[n]||ve.MODERATE}function hi(i){const e=i.toLowerCase();return e==="none"?"error":e==="low"?"warning":e==="moderate"?"info":e==="high"?"success":e==="very high"?"purple":"neutral"}function yi(i){return i.includes("Low")?"text-green-600 dark:text-green-400":i.includes("Medium")?"text-yellow-600 dark:text-yellow-400":i.includes("High")?"text-orange-600 dark:text-orange-400":i.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}function je(i){return i>=80?"Strong compliance position":i>=50?"Moderate compliance position":"Compliance gaps detected"}function fi(i,e,t,r,n){const s=m.useMemo(()=>Ve(i,e,t),[i,e,t]),o=m.useMemo(()=>xt(s),[s]),c=m.useMemo(()=>{const p=q(i),l=q(e),v=q(t),N=p+l+v;return Math.round(N/12*100)},[i,e,t]),u=m.useMemo(()=>c>=80?"Low Risk":c>=60?"Medium Risk":c>=40?"High Risk":"Critical Risk",[c]),d=m.useMemo(()=>{if(!k(r))try{if(G(r,"getSecurityClassification")){const p=r.getSecurityClassification(s);if(!k(p))return p}}catch(p){console.error("Error fetching security classification:",p)}switch(s){case"None":return"Minimal Security";case"Low":return"Basic Security";case"Moderate":return"Standard Security";case"High":return"Enhanced Security";case"Very High":return"Maximum Security";default:return"Unknown Security Level"}},[r,s]),g=m.useMemo(()=>{if(!k(r)&&G(r,"getInformationSensitivity"))try{const p=r.getInformationSensitivity?.(t);if(!k(p))return p}catch(p){console.error("Error fetching information sensitivity:",p)}switch(t){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Confidential Data";case"High":return"Restricted Data";case"Very High":return"Classified Data";default:return"Unclassified Data"}},[r,t]),h=m.useMemo(()=>{if(!k(r)&&G(r,"getImplementationComplexity"))try{const R=r.getImplementationComplexity(i,e,t);if(!k(R))return R}catch(R){console.error("Error fetching implementation complexity:",R)}const p={None:0,Low:1,Moderate:2,High:3,"Very High":4},l=p[i]||0,v=p[e]||0,N=p[t]||0,I=l+v+N;return I<=3?"Low":I<=6?"Moderate":I<=9?"High":"Very High"},[r,i,e,t]),y=m.useMemo(()=>{try{if(k(n))return null;const p=n.getComplianceStatus?.(i,e,t);return p?{...p,compliantFrameworks:p.compliantFrameworks||[],partiallyCompliantFrameworks:p.partiallyCompliantFrameworks||[],nonCompliantFrameworks:p.nonCompliantFrameworks||[]}:null}catch(p){return console.error("Error fetching compliance status:",p),null}},[n,i,e,t]),b=m.useMemo(()=>c>=80?"Strategic":c>=60?"Advanced":c>=40?"Standard":"Basic",[c]),f=m.useMemo(()=>{switch(b){case"Strategic":return"Enables competitive advantage and innovation";case"Advanced":return"Supports business growth and trusted partnerships";case"Standard":return"Maintains core business operations securely";case"Basic":return"Enables fundamental business activities";default:return"Unknown business maturity level"}},[b]),w=m.useMemo(()=>$t(i,e,t,"medium","general"),[i,e,t]),C=m.useMemo(()=>{try{if(!k(r)&&G(r,"getTotalImplementationTime")){const p=r.getTotalImplementationTime(i,e,t);if(!k(p))return p}}catch(p){console.error("Error fetching implementation time:",p)}return c>=80?"3-6 months":c>=60?"2-4 months":c>=40?"1-2 months":"2-4 weeks"},[r,c,i,e,t]),M=m.useMemo(()=>{try{if(!k(r)&&G(r,"getRequiredExpertise")){const p=r.getRequiredExpertise(i,e,t);if(!k(p))return p}}catch(p){console.error("Error fetching resource requirements:",p)}return c>=80?"Specialized Team":c>=60?"Dedicated Team":c>=40?"Small Team":"Individual Effort"},[r,c,i,e,t]),T=m.useMemo(()=>{try{return gi(i,e,t).value??"N/A"}catch(p){return console.error("Error calculating ROI estimate:",p),"N/A"}},[i,e,t]);return{overallSecurityLevel:s,securityLevelDescription:o,securityScore:c,riskLevel:u,securityClassification:d,dataClassification:g,implementationComplexity:h,complianceStatus:y,businessMaturityLevel:b,businessMaturityDescription:f,costDetails:w,implementationTime:C,requiredResources:M,roiEstimate:T,getStatusVariant:hi,getRiskColorClass:yi}}const bi=({businessMaturityLevel:i,businessMaturityDescription:e,securityScore:t,costDetails:r,testId:n,roiEstimate:s})=>a.jsxs("div",{"data-testid":`${n}-content-business`,className:"space-y-4",children:[a.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:a.jsx("p",{className:"text-sm",children:"This section summarizes the business value and financial impact of your selected security levels, helping justify security investments to stakeholders."})}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Business Value Summary"}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Business Maturity Level"}),a.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:i}),a.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1",children:e})]}),a.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Estimated ROI"}),a.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400 mt-2",children:s}),a.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:t>=80?"Strong return from security investments":t>=60?"Good return from security investments":t>=40?"Basic return, primarily risk avoidance":"Minimal return on investment"})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Cost Summary"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Implementation Cost"}),a.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:ue(r.totalCapex)}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"One-time investment"})]}),a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Operational Cost"}),a.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:ue(r.totalOpex)}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Annual expense"})]}),a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Total First-Year Cost"}),a.jsx("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:ue(r.totalCost)}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Combined implementation and operational costs"})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Business Enablement"}),a.jsx("div",{className:"space-y-3",children:a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Business Capabilities"}),a.jsx("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:t>=80?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Enables digital transformation initiatives"}),a.jsx("li",{children:"Supports secure cloud adoption"}),a.jsx("li",{children:"Facilitates secure partner integrations"}),a.jsx("li",{children:"Provides competitive advantage through security as a value"})]}):t>=60?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Supports most digital business initiatives"}),a.jsx("li",{children:"Enables secure customer data handling"}),a.jsx("li",{children:"Allows controlled partner access"}),a.jsx("li",{children:"Meets most customer security requirements"})]}):t>=40?a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Supports basic business operations"}),a.jsx("li",{children:"Enables limited partner interactions"}),a.jsx("li",{children:"Meets minimum customer expectations"})]}):a.jsxs(a.Fragment,{children:[a.jsx("li",{children:"Limited security capabilities"}),a.jsx("li",{children:"May restrict business opportunities"}),a.jsx("li",{children:"Potential compliance limitations"})]})})]})})]})]});function he(i,e){return e==="None"?"Not sufficient for most compliance frameworks":e==="Low"?i==="availability"?"Meets basic availability requirements":"Meets basic compliance requirements":e==="Moderate"?i==="availability"?"Satisfies most compliance needs":i==="integrity"?"Satisfies standard compliance expectations":"Satisfies most regulatory requirements":e==="High"?i==="availability"?"Meets high availability standards":i==="integrity"?"Meets advanced compliance standards":"Meets stringent compliance standards":i==="availability"?"Exceeds enterprise requirements":i==="integrity"?"Exceeds regulatory requirements":"Exceeds most compliance requirements"}const xi=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,securityScore:r,complianceStatus:n,testId:s})=>a.jsxs("div",{"data-testid":`${s}-content-compliance`,className:"space-y-4",children:[a.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:a.jsx("p",{className:"text-sm",children:"This section summarizes your compliance status based on selected security levels, highlighting alignment with regulatory frameworks and standards."})}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Compliance Status Overview"}),n?a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"font-medium",children:"Compliance Score"}),a.jsxs("span",{className:"text-xl font-bold",children:[n.complianceScore,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5 mb-2",children:a.jsx("div",{className:`h-2.5 rounded-full ${(n.complianceScore||0)>=80?"bg-green-500":(n.complianceScore||0)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${n.complianceScore||0}%`}})}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:n.status||je(n.complianceScore||0)})]}):a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsx("span",{className:"font-medium",children:"Compliance Score"}),a.jsxs("span",{className:"text-xl font-bold",children:[r,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5 mb-2",children:a.jsx("div",{className:`h-2.5 rounded-full ${r>=80?"bg-green-500":r>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${r}%`}})}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:je(r)})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Framework Compliance Status"}),n?a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-green-700 dark:text-green-300 flex items-center justify-between",children:[a.jsx("span",{children:"Compliant"}),a.jsx("span",{className:"text-sm bg-green-100 dark:bg-green-800 px-2 py-0.5 rounded-full",children:n.compliantFrameworks.length})]}),n.compliantFrameworks.length>0?a.jsx("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:n.compliantFrameworks.map((o,c)=>a.jsx("li",{children:o},`compliant-${c}`))}):a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 italic",children:"No fully compliant frameworks"})]}),a.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg",children:[a.jsxs("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300 flex items-center justify-between",children:[a.jsx("span",{children:"Partially Compliant"}),a.jsx("span",{className:"text-sm bg-yellow-100 dark:bg-yellow-800 px-2 py-0.5 rounded-full",children:n.partiallyCompliantFrameworks.length})]}),n.partiallyCompliantFrameworks.length>0?a.jsx("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:n.partiallyCompliantFrameworks.map((o,c)=>a.jsx("li",{children:o},`partial-${c}`))}):a.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 italic",children:"No partially compliant frameworks"})]})]}):a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"Detailed compliance information is not available."})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Component Compliance Requirements"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[a.jsx("h5",{className:"text-sm font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Confidentiality"}),a.jsxs("p",{className:"text-xs",children:[a.jsx("span",{className:"font-medium",children:"Level:"})," ",t]}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:he("confidentiality",t)})]}),a.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[a.jsx("h5",{className:"text-sm font-medium mb-1 text-green-700 dark:text-green-300",children:"Integrity"}),a.jsxs("p",{className:"text-xs",children:[a.jsx("span",{className:"font-medium",children:"Level:"})," ",e]}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:he("integrity",e)})]}),a.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[a.jsx("h5",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Availability"}),a.jsxs("p",{className:"text-xs",children:[a.jsx("span",{className:"font-medium",children:"Level:"})," ",i]}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:he("availability",i)})]})]})]})]});function ye(i,e){if(i==="confidentiality")switch(e){case"None":return"No data protection controls needed";case"Low":return"Basic access controls and authentication";case"Moderate":return"Role-based access and encryption for sensitive data";case"High":return"Comprehensive encryption and access controls";case"Very High":return"Maximum protection with advanced encryption and zero-trust";default:return"Standard data protection controls"}if(i==="integrity")switch(e){case"None":return"No data validation controls needed";case"Low":return"Basic input validation and error checking";case"Moderate":return"Data validation and cryptographic checksums";case"High":return"Digital signatures and strong validation";case"Very High":return"Formal verification and immutable audit trails";default:return"Standard data integrity controls"}switch(e){case"None":return"No uptime guarantees or redundancy";case"Low":return"Basic backup and recovery procedures";case"Moderate":return"Redundant components and standard backups";case"High":return"High availability clustering and failover";case"Very High":return"Multi-site redundancy and continuous availability";default:return"Standard availability controls"}}function vi(i){switch(i){case"None":return"Unverified";case"Low":return"Basic Validation";case"Moderate":return"Validated";case"High":return"Strongly Validated";case"Very High":return"Formally Verified";default:return"Unknown"}}function wi(i){switch(i){case"None":return"No guarantee";case"Low":return"95%";case"Moderate":return"99%";case"High":return"99.9%";case"Very High":return"99.999%";default:return"Unknown"}}const ki=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,implementationComplexity:r,testId:n,implementationTime:s,requiredResources:o})=>a.jsxs("div",{"data-testid":`${n}-content-implementation`,className:"space-y-4",children:[a.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:a.jsx("p",{className:"text-sm",children:"This section summarizes implementation requirements for your selected security levels, helping plan resources, timelines, and technical approaches."})}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Implementation Overview"}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-md font-medium",children:"Implementation Complexity:"}),a.jsx("div",{className:"font-medium",children:r})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:a.jsx("div",{className:`h-2.5 rounded-full ${r==="Low"?"w-1/4 bg-green-500":r==="Moderate"?"w-2/4 bg-yellow-500":r==="High"?"w-3/4 bg-orange-500":"w-full bg-red-500"}`})}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:r==="Low"?"Basic security controls with straightforward implementation":r==="Moderate"?"Standard security measures with moderate implementation effort":r==="High"?"Advanced security controls requiring significant implementation effort":"Comprehensive security framework requiring extensive resources"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Estimated Implementation Time"}),a.jsx("div",{className:"text-lg font-bold",children:s}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Typical project timeline"})]}),a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Required Resources"}),a.jsx("div",{className:"text-lg font-bold",children:o}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Resource allocation recommendation"})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Component Implementation Summary"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[a.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Confidentiality Implementation"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ye("confidentiality",t)}),a.jsxs("div",{className:"mt-2 text-xs font-medium text-purple-700 dark:text-purple-300",children:["Level: ",t]})]}),a.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800",children:[a.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300 mb-2",children:"Integrity Implementation"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ye("integrity",e)}),a.jsxs("div",{className:"mt-2 text-xs font-medium text-green-700 dark:text-green-300",children:["Level: ",e]})]}),a.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Availability Implementation"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:ye("availability",i)}),a.jsxs("div",{className:"mt-2 text-xs font-medium text-blue-700 dark:text-blue-300",children:["Level: ",i]})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Implementation Considerations"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Success Factors"}),a.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm",children:[a.jsx("li",{children:"Executive sponsorship and support"}),a.jsx("li",{children:"Clear security requirements definition"}),a.jsx("li",{children:"Adequate resource allocation"}),a.jsx("li",{children:"Proper testing and validation"}),a.jsx("li",{children:"Staff training and awareness"})]})]}),a.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Key Challenges"}),a.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm",children:[a.jsx("li",{children:"Balancing security with usability"}),a.jsx("li",{children:"Integration with existing systems"}),a.jsx("li",{children:"Managing scope and expectations"}),a.jsx("li",{children:"Maintaining consistent controls"}),a.jsx("li",{children:"Securing necessary expertise"})]})]})]})]})]}),Si=we.overrides.radar!==void 0;Si||we.register(at,nt,st,ot,ct,lt,ut,dt);const Ii=({availabilityLevel:i="None",integrityLevel:e="None",confidentialityLevel:t="None",className:r="",testId:n=Q.RADAR_CHART})=>{const s=m.useRef(null),o=m.useRef(null),[c,u]=m.useState(null),[d,g]=m.useState(document.documentElement.classList.contains("dark")),[h]=m.useState({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t}),y=f=>{switch(f){case"None":return 0;case"Basic":case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4;default:return 0}};m.useEffect(()=>{const f=new MutationObserver(w=>{w.forEach(C=>{if(C.attributeName==="class"&&C.target===document.documentElement){const M=document.documentElement.classList.contains("dark");M!==d&&g(M)}})});return f.observe(document.documentElement,{attributes:!0}),()=>f.disconnect()},[d]),m.useEffect(()=>{if(s.current)try{o.current&&o.current.destroy();const f=s.current?.getContext("2d");if(!f){u("Could not get canvas context");return}const w=y(i),C=y(e),M=y(t),T=d?"rgba(0, 204, 102, 0.2)":"rgba(0, 102, 51, 0.2)",p=d?"#00cc66":"#006633",l=d?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",v=d?"#f0f0f0":"#222222";o.current=new we(f,{type:"radar",data:{labels:["Availability","Integrity","Confidentiality"],datasets:[{label:"Security Profile",data:[w,C,M],backgroundColor:T,borderColor:p,borderWidth:2,pointBackgroundColor:p,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:p}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{r:{angleLines:{color:l},grid:{color:l},pointLabels:{color:v,font:{size:12}},min:0,max:4,ticks:{backdropColor:"transparent",color:v,z:100,stepSize:1,font:{size:10},callback:function(I){return["None","Basic","Moderate","High","Very High"][I]||""}},beginAtZero:!0}},plugins:{legend:{display:!1,labels:{color:d?"#00cc66":"#006633",font:{family:"'Share Tech Mono', monospace",size:12},boxWidth:15,boxHeight:2}},tooltip:{callbacks:{label:function(I){const R=["None","Basic","Moderate","High","Very High"],D=I.raw;return`${I.label}: ${R[D]||""}`}}}}}});const N=()=>{o.current&&o.current.resize()};return window.addEventListener("resize",N),()=>{window.removeEventListener("resize",N),o.current&&o.current.destroy()}}catch(f){u(f instanceof Error?f.message:String(f))}},[i,e,t,d]);const b=r?`radar-chart-container ${r}`.trim():"radar-chart-container";return a.jsxs("div",{className:b,"data-testid":`${n}-container`,children:[c?a.jsxs("div",{"data-testid":`${n}-error`,className:"error-message",children:["Error loading chart: ",c]}):a.jsxs("div",{className:"radar-values flex justify-between mb-2",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Availability:"})," ",a.jsx("span",{"data-testid":Q.RADAR_AVAILABILITY_VALUE,children:i||"None"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Integrity:"})," ",a.jsx("span",{"data-testid":Q.RADAR_INTEGRITY_VALUE,children:e||"None"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Confidentiality:"})," ",a.jsx("span",{"data-testid":Q.RADAR_CONFIDENTIALITY_VALUE,children:t||"None"})]})]}),a.jsx("canvas",{ref:s,"data-testid":n})]})},fe=({level:i,size:e="md",className:t="",testId:r})=>{const n=()=>{switch(i){case"None":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-20 dark:text-red-300";case"Low":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-20 dark:text-yellow-300";case"Moderate":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-20 dark:text-blue-300";case"High":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-20 dark:text-green-300";case"Very High":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},s=()=>{switch(e){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}};return a.jsx("span",{className:`font-medium rounded-md ${n()} ${s()} ${t}`,"data-testid":r,children:i})},Ni=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,dataClassification:r,implementationComplexity:n,businessMaturityLevel:s,businessMaturityDescription:o,securityScore:c,complianceScore:u,testId:d,getStatusVariant:g})=>a.jsxs("div",{"data-testid":`${d}-content-overview`,className:"space-y-4",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Security Profile"}),a.jsx("div",{className:"h-[300px]",children:a.jsx(Ii,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,testId:`${d}-radar-chart`})})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Security Components"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800","data-testid":ie.CONFIDENTIALITY_CARD,children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx("span",{className:"text-xl mr-2 text-purple-500 dark:text-purple-400",children:"ðŸ”’"}),a.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Confidentiality"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(fe,{level:t}),a.jsx(K,{status:g($(t)),size:"sm",children:$(t)})]}),a.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Classification:"," ",a.jsx("span",{className:"font-medium",children:r})]})]}),a.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800","data-testid":ie.INTEGRITY_CARD,children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx("span",{className:"text-xl mr-2 text-green-500 dark:text-green-400",children:"âœ“"}),a.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Integrity"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(fe,{level:e}),a.jsx(K,{status:g($(e)),size:"sm",children:$(e)})]}),a.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Validation Level:"," ",a.jsx("span",{className:"font-medium",children:vi(e)})]})]}),a.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800","data-testid":ie.AVAILABILITY_CARD,children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx("span",{className:"text-xl mr-2 text-blue-500 dark:text-blue-400",children:"â±ï¸"}),a.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Availability"})]}),a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx(fe,{level:i}),a.jsx(K,{status:g($(i)),size:"sm",children:$(i)})]}),a.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Uptime Target:"," ",a.jsx("span",{className:"font-medium",children:wi(i)})]})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Key Security Metrics"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Implementation Complexity"}),a.jsx("div",{className:"text-lg font-bold",children:n}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Based on combined security levels"})]}),a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Business Maturity"}),a.jsx("div",{className:"text-lg font-bold",children:s}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:o})]}),a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[a.jsx("div",{className:"text-sm font-medium mb-1",children:"Compliance Status"}),a.jsxs("div",{className:"text-lg font-bold",children:[u||c,"%"]}),a.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Overall compliance alignment"})]})]})]})]}),be=[{id:"overview",label:"Overview"},{id:"business",label:"Business Value"},{id:"implementation",label:"Implementation"},{id:"compliance",label:"Compliance"}],Ri=({availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,className:r="",testId:n=ie.WIDGET})=>{const[s,o]=m.useState("overview"),c=m.useRef(null),u=(H,ne)=>{Zt(H,ne,be.length,O=>{o(be[O].id);const _=c.current?.querySelectorAll('button[role="tab"]');_&&_[O]&&_[O].focus()},"horizontal")},{ciaContentService:d,error:g,isLoading:h}=Ye(),{error:y,isLoading:b}=oi(),{complianceService:f,error:w,isLoading:C}=ni(),M=h||b||C,T=g||y||w,{securityLevelDescription:p,securityScore:l,riskLevel:v,securityClassification:N,dataClassification:I,implementationComplexity:R,complianceStatus:D,businessMaturityLevel:Z,businessMaturityDescription:V,costDetails:Xe,implementationTime:Ze,requiredResources:Je,roiEstimate:Qe,getStatusVariant:et,getRiskColorClass:tt}=fi(i,e,t,d,f);return a.jsx(Ke,{widgetName:"Security Summary",children:a.jsx(We,{title:He.SECURITY_SUMMARY,icon:De.SECURITY_SUMMARY,className:r,testId:n,isLoading:M,error:T,children:a.jsxs("div",{className:"p-md sm:p-lg",role:re.REGION,"aria-label":Ge("Security Summary","Comprehensive executive summary of security posture with key metrics"),children:[a.jsx("section",{className:"mb-md p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border-l-4 border-info dark:border-info-light shadow-md","aria-labelledby":"security-classification-heading","data-testid":`${n}-classification-banner`,children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("h2",{id:"security-classification-heading",className:"text-heading font-semibold flex items-center gap-sm",children:[a.jsx("span",{className:"inline-block w-3 h-3 rounded-full bg-info dark:bg-info-light pulse-dot","aria-hidden":"true"}),N]}),a.jsx("p",{className:"text-body text-neutral dark:text-neutral-light",id:"security-classification-description",children:p})]}),a.jsxs("div",{className:"text-right",role:"group","aria-label":"Security metrics",children:[a.jsx("div",{className:"text-caption text-neutral dark:text-neutral-light",id:"security-score-label",children:"Security Score"}),a.jsxs("div",{className:"font-bold text-title text-info dark:text-info-light","aria-labelledby":"security-score-label","aria-live":"polite",children:[l,"%"]}),a.jsx("div",{className:`text-body font-medium ${tt(v)}`,"data-testid":`${n}-risk-level`,"aria-label":`Risk level: ${v}`,role:"status",children:v})]})]})}),a.jsx("div",{className:"border-b border-neutral-light dark:border-neutral-dark mb-md",children:a.jsxs("nav",{ref:c,className:"flex flex-wrap -mb-px gap-sm","aria-label":"Security Summary Tabs",role:re.TABLIST,"data-testid":Te.WIDGET_KEYBOARD_INSTRUCTIONS,children:[a.jsx("span",{className:"sr-only",id:"tab-keyboard-instructions",children:"Use arrow keys to navigate between tabs. Press Enter or Space to activate a tab."}),be.map((H,ne)=>{const O=s===H.id,_=`${n}-tab-${H.id}`,it=`${n}-panel-${H.id}`;return a.jsx("button",{className:`py-sm px-md text-body font-medium border-b-2 transition-all duration-normal ${O?"border-primary text-primary dark:text-primary-light dark:border-primary-light":"border-transparent text-neutral hover:text-neutral-dark dark:text-neutral-light dark:hover:text-white hover:border-neutral-light"}`,onClick:()=>{o(H.id)},onKeyDown:rt=>u(rt,ne),"data-testid":_,...Xt(_,O,it),"aria-describedby":"tab-keyboard-instructions",children:H.label},H.id)})]})}),a.jsxs("div",{className:"tab-content",children:[a.jsx("div",{...J(`${n}-panel-overview`,`${n}-tab-overview`,s!=="overview"),"data-testid":Te.CONTENT_REGION,children:s==="overview"&&a.jsx(Ni,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,dataClassification:I,implementationComplexity:R,businessMaturityLevel:Z,businessMaturityDescription:V,securityScore:l,complianceScore:D?.complianceScore,testId:n,getStatusVariant:et})}),a.jsx("div",{...J(`${n}-panel-business`,`${n}-tab-business`,s!=="business"),children:s==="business"&&a.jsx(bi,{businessMaturityLevel:Z,businessMaturityDescription:V,securityScore:l,costDetails:Xe,testId:n,roiEstimate:Qe})}),a.jsx("div",{...J(`${n}-panel-implementation`,`${n}-tab-implementation`,s!=="implementation"),children:s==="implementation"&&a.jsx(ki,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,implementationComplexity:R,testId:n,implementationTime:Ze,requiredResources:Je})}),a.jsx("div",{...J(`${n}-panel-compliance`,`${n}-tab-compliance`,s!=="compliance"),children:s==="compliance"&&a.jsx(xi,{availabilityLevel:i,integrityLevel:e,confidentialityLevel:t,securityScore:l,complianceStatus:D,testId:n})})]})]})})})},dr=Object.freeze(Object.defineProperty({__proto__:null,default:Ri},Symbol.toStringTag,{value:"Module"}));export{Ji as $,Pe as A,Ui as B,lr as C,sr as D,Hi as E,Bi as F,Fi as G,qi as H,or as I,Oi as J,cr as K,re as L,Xt as M,J as N,Zt as O,oi as P,zi as Q,Pi as R,Ei as S,Vi as T,Ii as U,Ki as V,Ke as W,ht as X,Ai as Y,Se as Z,tr as _,We as a,Zi as a0,gt as a1,Xi as a2,Li as a3,nr as a4,ae as a5,Oe as a6,ji as a7,Di as a8,Ti as a9,ur as aa,dr as ab,De as b,He as c,K as d,Ye as e,$t as f,Ge as g,Yi as h,k as i,q as j,ue as k,de as l,$i as m,_i as n,Gi as o,G as p,fe as q,gi as r,Wi as s,ar as t,ni as u,ir as v,Qi as w,rr as x,er as y,L as z};
//# sourceMappingURL=widgets-assessment-CQA_0dee.js.map
