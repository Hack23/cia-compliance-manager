import{r as c,j as e}from"./react-vendor-BzhlA2NX.js";import{e as p,i as N,t as f,v as _,w as B,x as O,y as W,z as V,A as y,B as R,D as Y,W as j,a as I,E as G,b as k,c as L,g as C,l as T,F as w,G as S,H as F,I as M,J as K,K as z,L as J,M as D}from"./widgets-assessment-29On9S3B.js";function $(a,t){const{ciaContentService:l}=p();return c.useMemo(()=>{if(N(l))return null;try{const i=l.getComponentDetails(a,t);return N(i)?null:i}catch(i){return console.error(`Error getting ${a} details:`,i),null}},[l,a,t])}function A(a,t){const{ciaContentService:l}=p();return c.useMemo(()=>{if(N(l))return f(a,t);try{return l.getBusinessImpact(a,t)||f(a,t)}catch(i){return console.error(`Error getting ${a} business impact:`,i),f(a,t)}},[l,a,t])}function Z(a){const[t,l]=c.useState({availability:a?.availability??"Moderate",integrity:a?.integrity??"Moderate",confidentiality:a?.confidentiality??"Moderate"}),m=c.useCallback((s,o)=>{l(g=>({...g,[s]:o}))},[]),i=c.useCallback((s="Moderate")=>{l({availability:s,integrity:s,confidentiality:s})},[]),n=c.useCallback(s=>t[s],[t]);return{levels:t,setLevel:m,resetLevels:i,getLevel:n}}function ee(a,t){const[l,m]=c.useState(()=>{if(typeof window>"u")return t;try{const n=window.localStorage.getItem(a);return n?JSON.parse(n):t}catch(n){return console.warn(`Error reading localStorage key "${a}":`,n),t}}),i=c.useCallback(n=>{try{m(s=>{const o=n instanceof Function?n(s):n;return typeof window<"u"&&window.localStorage.setItem(a,JSON.stringify(o)),o})}catch(s){console.error(`Error saving to localStorage key "${a}":`,s)}},[a]);return c.useEffect(()=>{if(typeof window>"u")return;const n=s=>{if(s.key===a&&s.newValue!==null)try{m(JSON.parse(s.newValue))}catch(o){console.warn(`Error parsing storage event for key "${a}":`,o)}};return window.addEventListener("storage",n),()=>{window.removeEventListener("storage",n)}},[a]),[l,i]}function te(a){const{shortcuts:t,enabled:l=!0,preventDefault:m=!0,stopPropagation:i=!1}=a,n=c.useRef(t),s=c.useRef({preventDefault:m,stopPropagation:i});c.useEffect(()=>{n.current=t,s.current={preventDefault:m,stopPropagation:i}},[t,m,i]);const o=c.useCallback(g=>{if(!_()||B(g))return;const u=O(g),r=Object.values(n.current).find(d=>{if(d.enabled===!1)return!1;const x=W(d.keys,d.platformKeys);return V(u,x)});if(r){y.debug("Keyboard shortcut triggered",{id:r.id,keys:u,description:r.description}),s.current.preventDefault&&g.preventDefault(),s.current.stopPropagation&&g.stopPropagation();try{r.handler()}catch(d){y.error("Error executing keyboard shortcut handler",{id:r.id,error:d})}}},[]);c.useEffect(()=>{if(!(!l||!_()))return y.debug("Registering keyboard shortcuts"),window.addEventListener("keydown",o),()=>{y.debug("Unregistering keyboard shortcuts"),window.removeEventListener("keydown",o)}},[l,o])}const E=({impact:a,color:t,testId:l="business-impact-section"})=>{const m=a.financial?.riskLevel||a.operational?.riskLevel||"Unknown";return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card","data-testid":l,children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact",e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Risk: ",m]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${l}-summary`,children:a.summary||"No business impact data available"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.financial&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’°"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Financial Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.financial.description||"No financial impact information available"}),a.financial.annualRevenueLoss&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Annual Revenue Loss: "}),a.financial.annualRevenueLoss]})]}),a.operational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"âš™ï¸"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Operational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.operational.description||"No operational impact information available"}),a.operational.meanTimeToRecover&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Mean Time to Recover: "}),a.operational.meanTimeToRecover]})]}),a.reputational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ†"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Reputational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.reputational.description||"No reputational impact information available"}),a.reputational.reputationalImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:a.reputational.reputationalImpact})]}),a.strategic&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Strategic Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.strategic.description||"No strategic impact information available"}),a.strategic.competitiveAdvantage&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Competitive Advantage: "}),a.strategic.competitiveAdvantage]})]}),a.regulatory&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Regulatory Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.regulatory.description||"No regulatory impact information available"}),a.regulatory.complianceImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:a.regulatory.complianceImpact}),a.regulatory.complianceViolations&&a.regulatory.complianceViolations.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Potential Violations:"," "]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.regulatory.complianceViolations.map((i,n)=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full bg-${t}-50 text-${t}-700 dark:bg-${t}-900 dark:bg-opacity-50 dark:text-${t}-300`,children:i},n))})]})]})]})]})},U=({availabilityLevel:a,integrityLevel:t,confidentialityLevel:l,showExtendedDetails:m=!1,className:i="",testId:n=G.AVAILABILITY_IMPACT_PREFIX})=>{const s=R(a||"Moderate"),{error:o,isLoading:g}=p(),u=$("availability",s),r=A("availability",s),d=c.useMemo(()=>{const x=Y(s);return u?{uptime:u.uptime||x.uptime,rto:u.rto||x.rto,rpo:u.rpo||x.rpo,mttr:u.mttr||x.mttr,sla:u.sla||x.sla}:x},[u,s]);return e.jsx(j,{widgetName:"Availability Impact",children:e.jsx(I,{title:L.AVAILABILITY_IMPACT,icon:k.AVAILABILITY_IMPACT||"â±ï¸",className:`${i} cia-availability`,testId:n,isLoading:g,error:o,children:e.jsxs("div",{className:"p-md sm:p-lg cia-widget",role:"region","aria-label":C("Availability Impact Analysis","Business impact of availability controls including uptime targets and recovery objectives"),children:[e.jsxs("section",{className:"mb-4","aria-labelledby":"availability-level-heading",children:[e.jsx("h3",{id:"availability-level-heading",className:"sr-only",children:"Current Availability Security Level"}),e.jsx(T,{category:"Availability",level:s,colorClass:S("blue"),textClass:"text-blue-800 dark:text-blue-300",testId:w.label("security-level")})]}),r&&e.jsxs("section",{className:"mb-4","aria-labelledby":"availability-business-impact-heading",children:[e.jsx("h3",{id:"availability-business-impact-heading",className:"text-lg font-medium mb-2",children:"Business Impact"}),e.jsx(E,{impact:r,color:"blue",testId:w.section("business-impact")})]}),e.jsxs("section",{className:"mb-4","aria-labelledby":"sla-metrics-heading",children:[e.jsxs("h3",{id:"sla-metrics-heading",className:"text-lg font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2","aria-hidden":"true",children:"â±ï¸"}),"SLA Metrics"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",role:"group","aria-label":"Service level agreement metrics",children:[e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Uptime Target"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Uptime target: ${d.uptime}`,children:d.uptime}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Expected system availability"})]}),e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Time Objective"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Recovery time objective: ${d.rto}`,children:d.rto}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Time to restore service"})]}),e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Point Objective"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Recovery point objective: ${d.rpo}`,children:d.rpo}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Maximum data loss allowed"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Service Level Agreement"}),e.jsx("div",{className:"text-lg font-bold","aria-label":`Service level agreement: ${d.sla}`,children:d.sla}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Support coverage period"})]})})]})]})})})},ae=Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"})),X=({availabilityLevel:a,integrityLevel:t,confidentialityLevel:l,className:m="",testId:i="widget-confidentiality-impact",showExtendedDetails:n=!1,onError:s})=>{const{ciaContentService:o,error:g,isLoading:u}=p(),r=l||"Moderate";c.useEffect(()=>{g&&s&&s(g)},[g,s]);const d=$("confidentiality",r),x=A("confidentiality",r),v=c.useMemo(()=>{if(!o)return`${r} Classification`;try{return o.getInformationSensitivity(r)}catch(b){return console.error("Error getting data classification:",b),`${r} Classification`}},[o,r]),h=c.useMemo(()=>d&&d.privacyImpact?d.privacyImpact:F(r),[d,r]);return e.jsx(j,{widgetName:"Confidentiality Impact",children:e.jsx(I,{title:L.CONFIDENTIALITY_IMPACT,icon:k.CONFIDENTIALITY_IMPACT||"ðŸ”’",className:`${m} overflow-visible`,testId:i,isLoading:u,error:g,children:e.jsx("div",{className:"max-h-[550px] overflow-y-auto pr-1",role:"region","aria-label":C("Confidentiality Impact Analysis","Business impact of confidentiality controls including data classification and privacy measures"),children:e.jsxs("section",{className:"p-md sm:p-lg","aria-labelledby":"confidentiality-impact-heading",children:[e.jsx("h3",{id:"confidentiality-impact-heading",className:"sr-only",children:"Confidentiality Impact Details"}),e.jsx("div",{className:"mb-4",children:e.jsx(T,{category:"Confidentiality",level:r,colorClass:S("purple"),textClass:"text-purple-800 dark:text-purple-300",testId:M.label("security-badge")})}),x&&e.jsx(E,{impact:x,color:"purple",testId:M.section("business-impact")}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2","aria-hidden":"true",children:"ðŸ“Š"}),"Data Protection"]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:e.jsxs("div",{className:"p-md bg-primary-light/10 dark:bg-primary-dark/20 rounded-md border border-primary-light dark:border-primary-dark",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Data Classification"}),e.jsx("div",{className:"text-lg font-bold",children:v}),e.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Level of data sensitivity"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2","aria-hidden":"true",children:"ðŸ”’"}),"Privacy Impact"]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:e.jsxs("div",{className:"p-sm bg-white dark:bg-gray-800 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Privacy Impact:"}),e.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:h})]})})]})]})})})})},se=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"})),H=({availabilityLevel:a,integrityLevel:t,confidentialityLevel:l,className:m="",testId:i=J.INTEGRITY_IMPACT_PREFIX,showExtendedDetails:n=!1})=>{const s=R(t||"Moderate"),{ciaContentService:o,error:g,isLoading:u}=p(),r=$("integrity",s),d=A("integrity",s),x=c.useMemo(()=>{try{return!o||!s?[]:o.getRecommendations("integrity",s)||[]}catch(b){return console.error("Error getting recommendations:",b),[]}},[o,s]),v=c.useMemo(()=>r&&r.validationLevel?r.validationLevel:K(s),[r,s]),h=c.useMemo(()=>r&&r.errorRate?r.errorRate:z(s),[r,s]);return e.jsx(j,{widgetName:"Integrity Impact",children:e.jsx(I,{title:L.INTEGRITY_IMPACT,icon:k.INTEGRITY_IMPACT||"âœ“",className:m,testId:i,isLoading:u,error:g,children:e.jsxs("div",{className:"p-md sm:p-lg",role:"region","aria-label":C("Integrity Impact Analysis","Business impact of integrity controls including data accuracy and validation mechanisms"),children:[e.jsxs("section",{className:"mb-4","aria-labelledby":"integrity-level-heading",children:[e.jsx("h3",{id:"integrity-level-heading",className:"sr-only",children:"Current Integrity Security Level"}),e.jsx(T,{category:"Integrity",level:s,colorClass:S("green"),textClass:"text-green-800 dark:text-green-300",testId:`${i}-integrity-badge`})]}),d&&e.jsx("div",{className:"mt-4","data-testid":D.section("business-impact"),children:e.jsx(E,{impact:d,color:"green",testId:`${i}-business-impact`})}),e.jsxs("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":D.section("metrics"),children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-green-800 dark:text-green-300",children:"Data Integrity Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-sm bg-white dark:bg-gray-800 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Data Validation Controls:"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:v})]}),e.jsxs("div",{className:"p-sm bg-white dark:bg-gray-800 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Acceptable Error Rate:"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:h})]})]})]}),n&&x.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Recommendations"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:x.map((b,P)=>e.jsx("li",{className:"text-sm text-gray-600 dark:text-gray-400",children:b},P))})]})]})})})},re=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{ae as A,se as C,re as I,Z as a,te as b,ee as u};
//# sourceMappingURL=widgets-impact-DO1JXM6x.js.map
