import{r as u,j as e,R as lt,a as dt}from"./react-CuJ5a7Ye.js";import{C as ut}from"./vendor-Bw1PsH28.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();const he={availability:"â±ï¸",integrity:"âœ“",confidentiality:"ðŸ”’"},mt={compliance:"ðŸ“‹"};function Ne(i){return he[i]||"ðŸ”µ"}const oe={NONE:"None",LOW:"Low",MODERATE:"Moderate",HIGH:"High",VERY_HIGH:"Very High"},gt={SOC2:"SOC 2",ISO27001:"ISO 27001",PCI_DSS:"PCI DSS",HIPAA:"HIPAA",NIST:"NIST 800-53 High"},pt={APP_TITLE:"CIA Compliance Manager Dashboard"};new RegExp(Object.values(gt).join("|"));const _={SECURITY_LEVEL:"ðŸ”",SECURITY_SUMMARY:"ðŸ“Š",BUSINESS_IMPACT_ANALYSIS:"ðŸ“ˆ",COMPLIANCE_STATUS:"ðŸ“‹",SECURITY_RESOURCES:"ðŸ“š",COST_ESTIMATION:"ðŸ’°",VALUE_CREATION:"ðŸ’Ž",TECHNICAL_DETAILS:"âš™ï¸",SECURITY_VISUALIZATION:"ðŸ“ˆ",AVAILABILITY_IMPACT:Ne("availability"),INTEGRITY_IMPACT:Ne("integrity"),CONFIDENTIALITY_IMPACT:Ne("confidentiality")},F={SECURITY_LEVEL:"Security Level Configuration",SECURITY_SUMMARY:"Security Summary",BUSINESS_IMPACT_ANALYSIS:"Business Impact Analysis",COMPLIANCE_STATUS:"Compliance Status",SECURITY_RESOURCES:"Security Resources",COST_ESTIMATION:"Cost Estimation",VALUE_CREATION:"Value Creation",TECHNICAL_DETAILS:"Technical Implementation Details",SECURITY_VISUALIZATION:"Security Visualization",AVAILABILITY_IMPACT:"Availability Impact",INTEGRITY_IMPACT:"Integrity Impact",CONFIDENTIALITY_IMPACT:"Confidentiality Impact"},ht={BUSINESS_IMPACT_WIDGET:"business-impact-widget"},me={RADAR_CHART:"radar-chart",RADAR_AVAILABILITY_VALUE:"radar-availability-value",RADAR_INTEGRITY_VALUE:"radar-integrity-value",RADAR_CONFIDENTIALITY_VALUE:"radar-confidentiality-value"},We={APP_CONTAINER:"app-container",APP_TITLE:"app-title"},je={KEY_VALUE_PAIR:"key-value-pair",KEY_VALUE_KEY:"key-value-key",KEY_VALUE_VALUE:"key-value-value"},ge={WIDGET:"security-summary-widget",AVAILABILITY_CARD:"availability-card",INTEGRITY_CARD:"integrity-card",CONFIDENTIALITY_CARD:"confidentiality-card"},xt={AVAILABILITY_IMPACT_PREFIX:"widget-availability-impact"},yt={INTEGRITY_IMPACT_PREFIX:"integrity-impact"},bt={WIDGET:"security-resources-widget"},L={COMPLIANCE_STATUS_BADGE:"compliance-status-badge",COMPLIANT_FRAMEWORKS_LIST:"compliant-frameworks-list",WIDGET:"compliance-status-widget",COMPLIANCE_STATUS_SUMMARY:"compliance-status-summary",COMPLIANCE_SCORE:"compliance-score",COMPLIANCE_SCORE_BAR:"compliance-score-bar",FRAMEWORK_ITEM_PREFIX:"framework-item",PARTIALLY_COMPLIANT_FRAMEWORKS_LIST:"partially-compliant-frameworks-list",NON_COMPLIANT_FRAMEWORKS_LIST:"non-compliant-frameworks-list",FRAMEWORK_GAP_ANALYSIS:"framework-gap-analysis",NO_GAP_ANALYSIS:"no-gap-analysis",COMPLIANCE_TIPS_LIST:"compliance-tips-list"};function ft(i){return typeof i=="string"&&["confidentiality","integrity","availability"].includes(i)}const we={None:0,Low:1,Moderate:2,High:3,"Very High":4},vt=["None","Low","Moderate","High","Very High"],Le="Moderate";function J(i){if(!i)return Le;const t=["None","Low","Moderate","High","Very High"];if(t.includes(i))return i;const r=typeof i=="string"?i.charAt(0).toUpperCase()+i.slice(1).toLowerCase():i;return t.includes(r)?r:Le}function T(i){if(typeof i=="string"&&!["None","Low","Moderate","High","Very High"].includes(i))return 0;const t=J(i);return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[t]??0}function ie(i){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[i]||"Unknown"}function Ke(i,t,r){const a=we[i]||0,s=we[t]||0,n=we[r]||0,l=(a+s+n)/3,o=Math.round(l);return vt[o]||"None"}function kt(i){return{None:"No security controls implemented",Low:"Basic security controls with minimal protection",Moderate:"Standard security controls with adequate protection",High:"Advanced security controls with strong protection","Very High":"Maximum security controls with comprehensive protection"}[i]||"Unknown security level"}const Nt={None:0,Low:1,Moderate:2,High:3,"Very High":4};function jt(i){if(typeof i=="string"){const t=i.trim();if(/^none$/i.test(t))return 0;if(/^low$/i.test(t))return 1;if(/^(moderate|medium)$/i.test(t))return 2;if(/^high$/i.test(t))return 3;if(/^very\s*high$/i.test(t))return 4}return Nt[i]??0}const Y="[CIA-CM]",Z={log(...i){return console.log(Y,...i),Z},debug(i,t){return t!==void 0?console.debug(Y,i,t):console.debug(Y,i),Z},info(i,t){return t!==void 0?console.info(Y,i,t):console.info(Y,i),Z},warn(i,t){return t!==void 0?console.warn(Y,i,t):console.warn(Y,i),Z},error(i,t){return t!==void 0?console.error(Y,i,t):console.error(Y,i),Z}};class ee{dataProvider;constructor(t){this.dataProvider=t}isCIAComponentType(t){return["availability","integrity","confidentiality"].includes(t)}getComponentDetails(t,r){try{const a=this.getCIAOptions(t);return a?a[r]:void 0}catch(a){Z.warn(`Failed to get component details for ${t} at level ${r}`,a);return}}getCIAOptions(t){switch(t){case"availability":return this.dataProvider.availabilityOptions;case"integrity":return this.dataProvider.integrityOptions;case"confidentiality":return this.dataProvider.confidentialityOptions;default:return{}}}getSecurityLevelDescription(t){switch(t){case"None":return"No security controls";case"Low":return"Basic security controls";case"Moderate":return"Standard security controls";case"High":return"Enhanced security controls";case"Very High":return"Maximum security controls";default:return"Unknown security level"}}getRiskLevelFromSecurityLevel(t){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[t]||"Unknown"}getSecurityLevelValue(t){return jt(t)}capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}getDefaultSecurityIcon(t){if(typeof this.dataProvider.getDefaultSecurityIcon=="function"){const r=this.dataProvider.getDefaultSecurityIcon(t);if(r)return r}switch(t){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}getValuePoints(t){if(typeof this.dataProvider.getDefaultValuePoints=="function")try{const r=this.dataProvider.getDefaultValuePoints(t);if(r&&r.length>0)return r}catch(r){Z.warn("Error fetching custom value points:",r)}return this.getDefaultValuePoints(t)}getDefaultValuePoints(t){switch(t){case"Very High":return["Maximum security value with comprehensive protection","Enables business in highly regulated industries","Provides competitive advantage through superior security posture","Minimizes risk of data breaches and associated costs","Ensures regulatory compliance across major frameworks"];case"High":return["Strong security value with robust protection","Supports business in moderately regulated industries","Reduces risk of security incidents significantly","Protects sensitive data and critical operations","Meets requirements for most compliance frameworks"];case"Moderate":return["Balanced security value with standard protection","Suitable for most business applications","Reduces common security risks","Protects important business data","Meets basic compliance requirements"];case"Low":return["Basic security value with minimal protection","Suitable for non-critical systems","Addresses obvious security vulnerabilities","Provides foundation for security program","May not meet regulatory requirements"];case"None":return["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"];default:return["Unknown security level","Security value cannot be determined"]}}formatCurrency(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t)}formatPercentage(t){return`${t}%`}}const wt={financial:"ðŸ’°",operational:"âš™ï¸",reputational:"ðŸ†",strategic:"ðŸŽ¯",regulatory:"ðŸ“œ",summary:"ðŸ“Š"};class St extends ee{constructor(t){super(t)}getBusinessImpact(t,r="Moderate"){const a=J(r),s=this.getCIAOptions(t),n=s?s[a]:void 0;return n?.businessImpactDetails?t==="confidentiality"&&a==="None"?{...n.businessImpactDetails,summary:"Critical risk due to absence of confidentiality controls",financial:{description:n.businessImpactDetails.financial?.description||"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:n.businessImpactDetails.operational?.description||"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:n.businessImpactDetails.reputational?.description||"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:n.businessImpactDetails.regulatory?.description||"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}}:n.businessImpactDetails:this.createDefaultBusinessImpact(t,a)}getCategoryIcon(t){return wt[t.toLowerCase()]||"â“"}getBusinessImpactDescription(t,r){const a=this.getCIAOptions(t);return(a?a[r]:void 0)?.businessImpact??this.getDefaultBusinessImpactDescription(t,r)}getDetailedDescription(t,r){if(!r)return`No ${t} impact details available`;const a=this.getCategoryIcon(t);return this.formatImpactDetail(r,t,a)}formatImpactDetail(t,r,a){let s=`${a} **${this.capitalizeFirstLetter(r)} Impact**: ${t.description}`;return t.riskLevel&&(s+=`
- Risk Level: ${t.riskLevel}`),r==="financial"&&t.annualRevenueLoss&&(s+=`
- Potential Revenue Loss: ${t.annualRevenueLoss}`),r==="operational"&&t.meanTimeToRecover&&(s+=`
- Mean Time to Recover: ${t.meanTimeToRecover}`),r==="regulatory"&&t.complianceViolations&&t.complianceViolations.length>0&&(s+=`
- Compliance Violations: ${t.complianceViolations.join(", ")}`),r==="strategic"&&t.competitiveAdvantage&&(s+=`
- Competitive Advantage: ${t.competitiveAdvantage}`),t.complianceImpact&&(s+=`
- Compliance Impact: ${t.complianceImpact}`),t.reputationalImpact&&(s+=`
- Reputational Impact: ${t.reputationalImpact}`),s}calculateBusinessImpactLevel(t,r=t,a=t){const s={None:0,Low:1,Moderate:2,High:3,"Very High":4},n=Math.min(s[t],s[r],s[a]);switch(Object.keys(s).find(o=>s[o]===n)){case"None":return"Critical";case"Low":return"High";case"Moderate":return"Medium";case"High":return"Low";case"Very High":return"Minimal";default:return"Unknown"}}getDefaultBusinessImpactDescription(t,r){return`${this.calculateBusinessImpactLevel(r)} business impact due to ${r.toLowerCase()} ${t} security level`}createDefaultBusinessImpact(t,r){const a=this.getRiskLevelWithSuffix(r);return t==="confidentiality"&&r==="None"?{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure",riskLevel:"Critical Risk"},reputational:{description:"Major reputational damage from failure to protect data",riskLevel:"Critical Risk"}}:{summary:`${t} impact analysis for ${r} level`,financial:{description:`Financial impact for ${r} ${t} security level`,riskLevel:a},operational:{description:`Operational impact for ${r} ${t} security level`,riskLevel:a},reputational:{description:`Reputational impact for ${r} ${t} security level`,riskLevel:a}}}getRiskLevelFromSecurityLevel(t){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[t]||"Unknown"}getRiskLevelWithSuffix(t){return this.getRiskLevelFromSecurityLevel(t)+" Risk"}getDefaultRevenueLoss(t){switch(t){case"None":return">20% of annual revenue";case"Low":return"10-20% of annual revenue";case"Moderate":return"5-10% of annual revenue";case"High":return"1-5% of annual revenue";case"Very High":return"<1% of annual revenue";default:return"Unknown revenue impact"}}getDefaultRecoveryTime(t){switch(t){case"None":return"Unpredictable";case"Low":return"24-48 hours";case"Moderate":return"4-8 hours";case"High":return"1 hour";case"Very High":return"<15 minutes";default:return"Unknown recovery time"}}getCIAOptions(t){switch(t){case"confidentiality":return this.dataProvider.confidentialityOptions;case"integrity":return this.dataProvider.integrityOptions;case"availability":return this.dataProvider.availabilityOptions;default:return{}}}capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}impactMapping={None:{financialImpact:"Negligible",operationalImpact:"Minimal",reputationalImpact:"Insignificant"},Low:{financialImpact:"Minor",operationalImpact:"Limited",reputationalImpact:"Localized"},Moderate:{financialImpact:"Significant",operationalImpact:"Substantial",reputationalImpact:"Moderate"},High:{financialImpact:"Major",operationalImpact:"Severe",reputationalImpact:"Extensive"},"Very High":{financialImpact:"Critical",operationalImpact:"Catastrophic",reputationalImpact:"Global"}};getImpactForLevel(t){return this.impactMapping[t]||this.impactMapping.Moderate}}class It extends ee{frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},"FedRAMP Moderate":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"FedRAMP High":{availability:"High",integrity:"High",confidentiality:"High"},"CMMC Level 3":{availability:"Moderate",integrity:"High",confidentiality:"Moderate"},SOX:{availability:"High",integrity:"High",confidentiality:"Moderate"},CCPA:{availability:"Low",integrity:"Moderate",confidentiality:"High"}};constructor(t){super(t)}getComplianceStatus(t,r,a){const s=[],n=[],l=[];for(const h of Object.keys(this.frameworkRequirements)){const b=this.getFrameworkStatus(h,t,r,a);b==="compliant"?s.push(h):b==="partially-compliant"?n.push(h):l.push(h)}let o;s.length>0?l.length===0&&n.length===0?o="Fully compliant with all frameworks":o="Partially Compliant":n.length>0?o="Partially Compliant":o="Non-compliant with all frameworks";const m=this.calculateComplianceScore(s.length,n.length,l.length),x=this.generateRemediationSteps(t,r,a,l,n),p=this.generateRequirements(l,n);return{status:o,compliantFrameworks:s,partiallyCompliantFrameworks:n,nonCompliantFrameworks:l,remediationSteps:x,requirements:p,complianceScore:m}}getComplianceStatusText(t,r=t,a=t){if(t==="Low"&&r==="Low"&&a==="Low")return"Meets basic compliance only";if(t==="Moderate"&&r==="Moderate"&&a==="Moderate")return"Compliant with standard frameworks";if(t==="High"&&r==="High"&&a==="High"||t==="Very High"&&r==="Very High"&&a==="Very High")return"Compliant with all major frameworks";const s=this.getComplianceStatus(t,r,a);return s.compliantFrameworks.length===Object.keys(this.frameworkRequirements).length?"Compliant with all major frameworks":s.compliantFrameworks.length>0||s.partiallyCompliantFrameworks.length>0?"Partially compliant with some frameworks":"Non-Compliant"}getComplianceStatusTextCalledForTesting=!0;getCompliantFrameworks(t,r=t,a=t){const s=[];for(const n of Object.keys(this.frameworkRequirements))this.getFrameworkStatus(n,t,r,a)==="compliant"&&s.push(n);return s}getFrameworkDescription(t){const r={"NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and organizations.","ISO 27001":"ISO 27001 is an international standard for information security management systems (ISMS).","NIST CSF":"The NIST Cybersecurity Framework provides a policy framework of computer security guidance for organizations.",GDPR:"The General Data Protection Regulation is a regulation on data protection and privacy in the European Union and the European Economic Area.",HIPAA:"The Health Insurance Portability and Accountability Act sets the standard for protecting sensitive patient data.",SOC2:"SOC2 defines criteria for managing customer data based on five trust service principles: security, availability, processing integrity, confidentiality, and privacy.","PCI DSS":"The Payment Card Industry Data Security Standard is an information security standard for organizations that handle credit card information.","FedRAMP Moderate":"The Federal Risk and Authorization Management Program Moderate baseline is designed for federal information systems where the loss of confidentiality, integrity, and availability would result in serious adverse effects.","FedRAMP High":"The Federal Risk and Authorization Management Program High baseline is for federal information systems where loss would have severe or catastrophic adverse effects.","CMMC Level 3":"The Cybersecurity Maturity Model Certification Level 3 requires organizations to establish, maintain, and resource a plan demonstrating the management of cybersecurity activities.",SOX:"The Sarbanes-Oxley Act requires formal data security controls and framework for public companies to ensure accurate financial reporting and disclosure.",CCPA:"The California Consumer Privacy Act enhances privacy rights and consumer protection for residents of California, similar to GDPR but with state-specific requirements."},a=Object.keys(r).find(s=>s.toLowerCase()===t.toLowerCase());return a?r[a]:`Unknown compliance framework: ${t}. No detailed description available.`}getFrameworkStatus(t,r,a,s){const n=this.frameworkRequirements[t];if(!n)return"non-compliant";const l=this.getSecurityLevelValue(r),o=this.getSecurityLevelValue(a),m=this.getSecurityLevelValue(s),x=this.getSecurityLevelValue(n.availability),p=this.getSecurityLevelValue(n.integrity),h=this.getSecurityLevelValue(n.confidentiality);return l>=x&&o>=p&&m>=h?"compliant":t==="PCI DSS"&&r==="Moderate"&&a==="Moderate"&&s==="Moderate"||l>=x||o>=p||m>=h?"partially-compliant":"non-compliant"}getFrameworkRequiredLevel(t,r){const a=Object.keys(this.frameworkRequirements).find(n=>n.toLowerCase()===t.toLowerCase()),s=a?this.frameworkRequirements[a]:null;return s&&s[r]?s[r]:"Moderate"}calculateComplianceScore(t,r,a){const s=t+r+a;if(s===0)return 0;const n=(t*100+r*50)/s;return Math.round(n)}generateRemediationSteps(t,r,a,s,n){const l=[],o=this.getSecurityLevelValue(t),m=this.getSecurityLevelValue(r),x=this.getSecurityLevelValue(a);return o<2&&l.push("Improve availability controls to at least Moderate level"),m<2&&l.push("Enhance integrity controls to at least Moderate level"),x<2&&l.push("Strengthen confidentiality controls to at least Moderate level"),(s.includes("GDPR")||n.includes("GDPR"))&&(l.push("Implement data protection impact assessments"),l.push("Establish data subject rights procedures"),l.push("Develop clear privacy notices and consent mechanisms")),(s.includes("HIPAA")||n.includes("HIPAA"))&&(l.push("Develop protected health information (PHI) handling procedures"),l.push("Implement breach notification processes"),l.push("Conduct regular risk assessments and employee training")),(s.includes("PCI DSS")||n.includes("PCI DSS"))&&(l.push("Implement strong access control measures for cardholder data"),l.push("Develop and maintain secure systems and applications"),l.push("Implement strong cryptography for payment data transmission")),l}generateRequirements(t,r){const a=[];return(t.length>0||r.length>0)&&(a.push("Formal security policy documentation"),a.push("Regular risk assessments and security testing"),a.push("Incident response planning")),(t.includes("GDPR")||r.includes("GDPR"))&&(a.push("Data protection by design and by default"),a.push("Legitimate basis for data processing"),a.push("Data subject rights management")),(t.includes("HIPAA")||r.includes("HIPAA"))&&(a.push("Privacy Officer appointment"),a.push("Business Associate Agreements"),a.push("Audit controls and activity logging")),(t.includes("PCI DSS")||r.includes("PCI DSS"))&&(a.push("Network segmentation for cardholder data environment"),a.push("Encryption of cardholder data across open networks"),a.push("Regular vulnerability scanning and penetration testing")),a}getComplianceGapAnalysis(t,r,a,s){const n=this.getComplianceStatus(t,r,a),l=n.nonCompliantFrameworks.length===0&&n.partiallyCompliantFrameworks.length===0;if(s&&!Object.keys(this.frameworkRequirements).includes(s))return{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:[{framework:s,frameworkDescription:this.getFrameworkDescription(s),components:{availability:{current:t,required:"Low",gap:this.getSecurityLevelGap(t,"Low")},integrity:{current:r,required:"Low",gap:this.getSecurityLevelGap(r,"Low")},confidentiality:{current:a,required:"Low",gap:this.getSecurityLevelGap(a,"Low")}},recommendations:["Verify framework requirements with official documentation"]}],recommendations:[`Unknown framework "${s}". Please check framework name or consult documentation.`],isCompliant:!1};if(l){const x=["Maintain current security controls","Regularly review security posture","Stay informed about changes to compliance requirements"];return{overallStatus:n.status,complianceScore:n.complianceScore,gaps:[],recommendations:x,isCompliant:!0}}const m=(s?[s]:[...n.nonCompliantFrameworks,...n.partiallyCompliantFrameworks]).map(x=>{const p=this.frameworkRequirements[x]||{availability:"Low",integrity:"Low",confidentiality:"Low"},h=this.getSecurityLevelGap(t,p.availability),b=this.getSecurityLevelGap(r,p.integrity),g=this.getSecurityLevelGap(a,p.confidentiality);return{framework:x,frameworkDescription:this.getFrameworkDescription(x),components:{availability:{current:t,required:p.availability,gap:h},integrity:{current:r,required:p.integrity,gap:b},confidentiality:{current:a,required:p.confidentiality,gap:g}},recommendations:this.generateRecommendationsForFramework(x,h,b,g)}});return s&&!Object.keys(this.frameworkRequirements).includes(s)?{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:m,recommendations:[`Unknown framework "${s}". Please check framework name or consult documentation.`],isCompliant:!1}:{overallStatus:n.status,complianceScore:n.complianceScore,gaps:m,recommendations:n.remediationSteps||[],isCompliant:l}}generateRecommendationsForFramework(t,r,a,s){const n=[];return r<0&&n.push(`Improve availability controls to meet ${t} requirements`),a<0&&n.push(`Enhance integrity controls to meet ${t} requirements`),s<0&&n.push(`Strengthen confidentiality controls to meet ${t} requirements`),t==="GDPR"&&s<0?(n.push("Implement data protection impact assessments"),n.push("Establish data subject consent mechanisms")):t==="HIPAA"&&(r<0||s<0)?(n.push("Implement protected health information (PHI) safeguards"),n.push("Develop business associate agreements")):t==="PCI DSS"&&s<0&&(n.push("Implement strong access control measures for cardholder data"),n.push("Apply encryption for payment card information")),n}getSecurityLevelGap(t,r){const a=this.getSecurityLevelValue(t),s=this.getSecurityLevelValue(r);return a-s}}class Xe extends ee{complianceService;frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},"FedRAMP Moderate":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"FedRAMP High":{availability:"High",integrity:"High",confidentiality:"High"},"CMMC Level 3":{availability:"Moderate",integrity:"High",confidentiality:"Moderate"},SOX:{availability:"High",integrity:"High",confidentiality:"Moderate"},CCPA:{availability:"Low",integrity:"Moderate",confidentiality:"High"}};constructor(t){super(t),this.complianceService=new It(t)}getComplianceStatus(t,r,a){return this.complianceService.getComplianceStatus(t,r,a)}getComplianceStatusText(t,r=t,a=t){return t==="None"?"Non-Compliant":t==="Low"?"Meets basic compliance only":t==="Moderate"?"Compliant with standard frameworks":t==="High"||t==="Very High"?"Compliant with all major frameworks":"Compliance status unknown"}getCompliantFrameworks(t,r=t,a=t){return this.complianceService.getCompliantFrameworks(t,r,a)}getFrameworkDescription(t){const a={"ISO 27001":"Information Security Management System standard for implementing security controls","NIST CSF":"Cybersecurity Framework for managing and reducing cybersecurity risk",HIPAA:"Health Insurance Portability and Accountability Act for healthcare data protection","PCI DSS":"Payment Card Industry Data Security Standard for protecting cardholder data",GDPR:"General Data Protection Regulation for protecting personal data in the EU",SOC2:"Service Organization Control 2 for service providers' data security","NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and government organizations"}[t];return a||"No description available"}getFrameworkStatus(t,r,a,s){const n=this.complianceService.getFrameworkStatus(t,r,a,s);let l="";switch(n){case"compliant":l="Compliant";break;case"partially-compliant":l="Partially Compliant";break;case"non-compliant":l="Non-Compliant";break;default:l="Unknown"}return{status:l}}isFrameworkApplicable(t,r,a){return!0}getFrameworkRequiredLevel(t,r){return this.complianceService.getFrameworkRequiredLevel(t,r)}getComplianceGapAnalysis(t,r,a,s){return this.complianceService.getComplianceGapAnalysis(t,r,a,s)}}class He extends ee{constructor(t){super(t)}calculateRoi(t,r){if(t==="None"||r<=0)return{value:"$0",percentage:"0%",description:"No security investment means no return"};const a=t.toUpperCase().replace(" ","_"),n=this.getROIEstimates()[a]?.returnRate||"0%";let l=parseInt(n.replace(/[^0-9]/g,""),10);return isNaN(l)&&(l=0),{value:`$${(r*l/100).toLocaleString()}`,percentage:n,description:`Return on investment for ${t} security level implementation`}}getROIEstimates(){return this.dataProvider.roiEstimates}getSecurityMetrics(t,r=t,a=t){const s=this.getComponentDetails("availability",t),n=this.getComponentDetails("integrity",r),l=this.getComponentDetails("confidentiality",a),o=this.calculateSecurityScore(t,r,a),m=s?.capex||0,x=n?.capex||0,p=l?.capex||0,h=s?.opex||0,b=n?.opex||0,g=l?.opex||0,y=m+x+p,N=h+b+g,f=y+N,k=this.calculateRiskReduction(t,r,a),H=this.calculateMonitoringScore(t,r,a),w=this.calculateResilienceScore(t),c=this.calculateComplianceScore(t,r,a),d=this.calculateSecurityMaturity(t,r,a),C=this.calculateImpactMetrics(t,r,a),M=this.getComponentMetrics("availability",t),E=this.getComponentMetrics("integrity",r),R=this.getComponentMetrics("confidentiality",a);return{overallScore:o,score:o,maxScore:100,percentage:`${o}%`,totalCapex:y,totalOpex:N,totalCost:f,riskReduction:`${k}%`,availability:M,integrity:E,confidentiality:R,impactMetrics:C,monitoring:H,resilience:w,compliance:c,benchmarkScore:75,securityMaturity:d}}getComponentMetrics(t,r){const a=this.getComponentDetails(t,r),s=this.getSecurityLevelValue(r);return{component:t,level:r,value:s,percentage:`${s/4*100}%`,description:a?.description||this.getSecurityLevelDescription(r),capex:a?.capex||0,opex:a?.opex||0,score:s*25,recommendations:a?.recommendations||[]}}getComponentTechnicalMetrics(t,r){const a=this.getComponentMetrics(t,r),s={};return Object.entries(a).forEach(([n,l])=>{l==null?s[n]="":typeof l=="object"?s[n]=JSON.stringify(l):s[n]=typeof l=="number"?l.toString():l}),s}getImpactMetrics(t,r){const a=this.getComponentDetails(t,r),s=this.calculateSingleComponentRiskReduction(r);return{securityLevel:r,riskReduction:`${s}%`,description:a?.description||this.getSecurityLevelDescription(r),technical:a?.technical||"",businessImpact:a?.businessImpact||"",financialImpact:"Impact not calculated",operationalImpact:"Impact not calculated",reputationalImpact:"Impact not calculated",complianceImpact:"Impact not calculated"}}calculateImpactMetrics(t,r,a){const s=this.calculateFinancialImpactLevel(t,a),n=this.calculateOperationalImpactLevel(t,r),l=this.calculateReputationalImpactLevel(a,r),o=this.calculateComplianceImpactLevel(t,r,a);return{financialImpact:s,operationalImpact:n,reputationalImpact:l,complianceImpact:o,securityLevel:this.calculateAverageSecurityLevel([t,r,a]),riskReduction:`${this.calculateRiskReduction(t,r,a)}%`}}calculateFinancialImpactLevel(t,r){const a=this.getSecurityLevelValue(t),s=this.getSecurityLevelValue(r),n=(a+s)/2;return n<1?"Severe financial impact risk":n<2?"High financial impact risk":n<3?"Moderate financial impact risk":n<4?"Low financial impact risk":"Minimal financial impact risk"}calculateOperationalImpactLevel(t,r){const a=this.getSecurityLevelValue(t),s=this.getSecurityLevelValue(r),n=(a+s)/2;return n<1?"Severe operational disruption risk":n<2?"High operational disruption risk":n<3?"Moderate operational disruption risk":n<4?"Low operational disruption risk":"Minimal operational disruption risk"}calculateReputationalImpactLevel(t,r){const a=this.getSecurityLevelValue(t),s=this.getSecurityLevelValue(r),n=a*.7+s*.3;return n<1?"Severe reputational damage risk":n<2?"High reputational damage risk":n<3?"Moderate reputational damage risk":n<4?"Low reputational damage risk":"Minimal reputational damage risk"}calculateComplianceImpactLevel(t,r,a){const s=this.getSecurityLevelValue(t),n=this.getSecurityLevelValue(r),l=this.getSecurityLevelValue(a),o=(s+n+l)/3;return o<1?"Severe compliance violation risk":o<2?"High compliance violation risk":o<3?"Moderate compliance violation risk":o<4?"Low compliance violation risk":"Minimal compliance violation risk"}calculateRiskReduction(t,r=t,a=t){const s=this.calculateSingleComponentRiskReduction(t),n=this.calculateSingleComponentRiskReduction(r),l=this.calculateSingleComponentRiskReduction(a),o=s*.3+n*.3+l*.4;return`${Math.round(o)}%`}calculateSingleComponentRiskReduction(t){try{return{None:0,Low:25,Moderate:50,High:75,"Very High":90}[t]||0}catch{return Z.warn(`Failed to calculate risk reduction for level: ${t}`),0}}getSecurityLevelDescription(t){switch(t){case"None":return"No security controls implemented";case"Low":return"Basic security controls with minimal protection";case"Moderate":return"Standard security controls with adequate protection";case"High":return"Advanced security controls with strong protection";case"Very High":return"Maximum security controls with comprehensive protection";default:return"Unknown security level"}}getProtectionLevel(t){if(typeof this.dataProvider.getProtectionLevel=="function")try{return this.dataProvider.getProtectionLevel(t)}catch{}switch(t){case"None":return"No Protection";case"Low":return"Basic Protection";case"Moderate":return"Standard Protection";case"High":return"Advanced Protection";case"Very High":return"Maximum Protection";default:return"Unknown Protection Level"}}getRiskBadgeVariant(t){const r=t.toLowerCase();return r.includes("critical")||r.includes("high")?"error":r.includes("medium")||r.includes("moderate")?"warning":r.includes("low")?"info":r.includes("minimal")||r.includes("none")?"success":"neutral"}getSecurityIcon(t){return this.getDefaultSecurityIcon(t)}getRiskLevel(t){return t<=30?"Critical Risk":t<=40?"High Risk":t<=60?"Medium Risk":t<=80?"Low Risk":"Minimal Risk"}getSecurityLevelFromValue(t){switch(t){case 0:return"None";case 1:return"Low";case 2:return"Moderate";case 3:return"High";case 4:return"Very High";default:return"None"}}calculateSecurityScore(t,r=t,a=t){const s=this.getSecurityLevelValue(t),n=this.getSecurityLevelValue(r),l=this.getSecurityLevelValue(a),o=(s+n+l)/3;return Math.round(o/4*100)}calculateMonitoringScore(t,r,a){const s=(this.securityLevelToPercentage(t)+this.securityLevelToPercentage(r)+this.securityLevelToPercentage(a))/3;return this.getSecurityLevelValue(a)>2?Math.min(95,s+10):s}calculateResilienceScore(t){return Math.min(95,this.securityLevelToPercentage(t)+5)}calculateComplianceScore(t,r,a){const s=this.securityLevelToPercentage(t)*.3+this.securityLevelToPercentage(r)*.3+this.securityLevelToPercentage(a)*.4;return this.getSecurityLevelValue(a)<2?Math.max(10,s-15):s}calculateSecurityMaturity(t,r,a){const s=this.calculateOverallScore(t,r,a);return s<20?"Initial":s<40?"Developing":s<60?"Defined":s<80?"Managed":"Optimized"}calculateOverallScore(t,r,a){const s=[this.securityLevelToPercentage(t),this.securityLevelToPercentage(r),this.securityLevelToPercentage(a),this.calculateMonitoringScore(t,r,a),this.calculateResilienceScore(t),this.calculateComplianceScore(t,r,a)];return Math.round(s.reduce((n,l)=>n+l,0)/s.length)}calculateAverageSecurityLevel(t){const a=t.reduce((s,n)=>s+this.getSecurityLevelValue(n),0)/t.length;return a<.5?"None":a<1.5?"Low":a<2.5?"Moderate":a<3.5?"High":"Very High"}securityLevelToPercentage(t){switch(t){case"None":return 10;case"Low":return 30;case"Moderate":return 50;case"High":return 75;case"Very High":return 95;default:return 0}}getSecurityLevelValue(t){return Ct(t)}getDefaultSecurityIcon(t){if(typeof this.dataProvider.getDefaultSecurityIcon=="function")try{return this.dataProvider.getDefaultSecurityIcon(t)}catch{}switch(t){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}}function Oe(i){if(!i){const t={availabilityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},integrityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},confidentialityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"250%",description:"High ROI"},VERY_HIGH:{returnRate:"400%",description:"Very High ROI"}}};return new He(t)}return new He(i)}function Ct(i){switch(i){case"None":return 0;case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4;default:return 0}}const Mt=[{id:"resource-1",title:"NIST Cybersecurity Framework",description:"A set of guidelines for mitigating organizational cybersecurity risks",url:"https://www.nist.gov/cyberframework",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["framework","best_practices","standards"],source:"NIST"},{id:"resource-2",title:"OWASP Top 10",description:"Standard awareness document for developers about the most critical security risks to web applications",url:"https://owasp.org/www-project-top-ten/",type:"integrity",securityLevels:["Low","Moderate","High"],components:["integrity"],tags:["web","vulnerabilities","security_testing"],source:"OWASP"},{id:"resource-3",title:"AWS Well-Architected Framework",description:"Helps cloud architects build secure, high-performing, resilient, and efficient infrastructure",url:"https://aws.amazon.com/architecture/well-architected/",type:"availability",securityLevels:["Moderate","High","Very High"],components:["availability"],tags:["cloud","architecture","resilience"],source:"AWS"},{id:"resource-4",title:"Data Encryption Standard",description:"Standards and guidelines for implementing encryption to protect sensitive data",url:"https://csrc.nist.gov/publications/detail/fips/140/3/final",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["encryption","data_protection","standards"],source:"NIST"},{id:"resource-5",title:"CIS Benchmarks",description:"Best practices for secure configuration of technology systems",url:"https://www.cisecurity.org/cis-benchmarks/",type:"general",securityLevels:["Low","Moderate","High","Very High"],components:["integrity","confidentiality"],tags:["configuration","benchmarks","hardening"],source:"CIS"},{id:"resource-6",title:"AWS Security Hub",description:"Centralized security tool to manage security alerts and automate compliance checks across AWS accounts",url:"https://aws.amazon.com/security-hub/",type:"general",securityLevels:["High","Very High"],components:["availability","integrity","confidentiality"],tags:["cloud","monitoring","automation"],source:"AWS",priority:3},{id:"resource-7",title:"Zero Trust Architecture Guide",description:"NIST guide for implementing a zero trust architecture in enterprise environments",url:"https://www.nist.gov/publications/zero-trust-architecture",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["zero_trust","architecture","access_control"],source:"NIST",priority:2},{id:"resource-8",title:"SANS CIS Controls Implementation Guide",description:"Practical guide to implementing the top 20 Critical Security Controls",url:"https://www.sans.org/blog/cis-controls-v8/",type:"general",securityLevels:["Low","Moderate","High"],components:["availability","integrity","confidentiality"],tags:["implementation","baseline","best_practices"],source:"SANS Institute",priority:4},{id:"resource-9",title:"HashiCorp Vault",description:"Secrets management and data protection with identity-based access",url:"https://www.vaultproject.io/",type:"confidentiality",securityLevels:["Moderate","High","Very High"],components:["confidentiality","integrity"],tags:["secrets_management","encryption","access_control"],source:"HashiCorp",priority:3},{id:"resource-10",title:"DDoS Protection Best Practices",description:"Guidelines for protecting systems against distributed denial-of-service attacks",url:"https://www.cisa.gov/sites/default/files/publications/DDoS%20Quick%20Guide.pdf",type:"availability",securityLevels:["Moderate","High"],components:["availability"],tags:["ddos","resilience","mitigation"],source:"CISA",priority:2},{id:"resource-11",title:"OWASP API Security Top 10",description:"Top 10 API security vulnerabilities and how to mitigate them",url:"https://owasp.org/www-project-api-security/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity","confidentiality"],tags:["api","web_security","vulnerabilities"],source:"OWASP",priority:3},{id:"resource-12",title:"Microsoft Security Development Lifecycle",description:"Industry-leading software security assurance process",url:"https://www.microsoft.com/en-us/securityengineering/sdl/",type:"integrity",securityLevels:["Moderate","High","Very High"],components:["integrity"],tags:["sdlc","secure_coding","development"],source:"Microsoft",priority:2},{id:"resource-13",title:"Google SRE Book",description:"Site Reliability Engineering: How Google Runs Production Systems",url:"https://sre.google/sre-book/table-of-contents/",type:"availability",securityLevels:["High","Very High"],components:["availability"],tags:["sre","reliability","operations"],source:"Google",priority:3},{id:"resource-14",title:"ENISA Threat Landscape",description:"European Union Agency for Cybersecurity's comprehensive threat landscape report",url:"https://www.enisa.europa.eu/topics/threat-risk-management/threats-and-trends",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["threat_intelligence","risk_assessment","planning"],source:"ENISA",priority:2},{id:"resource-15",title:"Snyk",description:"Developer security platform to find and fix vulnerabilities in code, dependencies, containers, and IaC",url:"https://snyk.io/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity"],tags:["dependency_scanning","vulnerability_management","devops"],source:"Snyk",priority:4}];class Rt extends ee{resources;constructor(t){super(t),this.resources=this.processResources(Mt)}processResources(t){return t.map(r=>({...r,relevance:r.priority||50,score:r.priority||50}))}getSecurityResources(t,r){const a={id:`fallback-${t}`,title:`Basic security guidance for ${t}`,description:`Start with these resources to implement ${t} security controls`,url:"https://www.nist.gov/cyberframework",type:t==="all"?"general":t,relevance:100,score:100,tags:["beginner","basics"],category:"documentation",source:"NIST"},s={availability:{id:"avail-resource",title:"Availability Best Practices",description:"Guidance for implementing availability controls",url:"https://example.com/availability",type:"availability",relevance:90,score:90,tags:["availability","uptime"],category:"best_practices",source:"NIST"},integrity:{id:"integrity-resource",title:"Integrity Guidelines",description:"Guidance for implementing integrity controls",url:"https://example.com/integrity",type:"integrity",relevance:90,score:90,tags:["integrity","validation"],category:"best_practices",source:"NIST"},confidentiality:{id:"confidentiality-resource",title:"Confidentiality Controls",description:"Guidance for implementing confidentiality controls",url:"https://example.com/confidentiality",type:"confidentiality",relevance:90,score:90,tags:["confidentiality","encryption"],category:"best_practices",source:"NIST"}};return[...this.resources,a,...Object.values(s)].filter(l=>t==="all"||l.type===t||l.components&&l.components.includes(t)?!0:l.type==="general").filter(l=>!l.relevantLevels||l.relevantLevels.length===0?!0:l.relevantLevels.includes(r)).map(l=>({...l,relevance:this.calculateRelevance(l,t,r)})).sort((l,o)=>o.relevance-l.relevance)}calculateRelevance(t,r,a){let s=t.priority||50;return t.type===r&&(s+=20),t.relevantLevels&&t.relevantLevels.includes(a)&&(s+=20),s}getValuePoints(t){if(!t)return["No value points available for undefined security level"];if(this.dataProvider.getDefaultValuePoints)try{const r=this.dataProvider.getDefaultValuePoints(t);if(r&&r.length>0)return r}catch(r){console.warn("Error fetching custom value points:",r)}return t==="None"?["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"]:[`Provides ${t.toLowerCase()} level of protection`,`Meets ${t==="High"||t==="Very High"?"advanced":"basic"} security requirements`]}}class Et extends ee{constructor(t){super(t)}getTechnicalImplementation(t,r){const s=this.getCIAOptions(t)[r];return s&&!s.technical?this.createDefaultImplementationDetails(t,r):s?.technicalImplementation&&s.technicalImplementation.description&&s.technicalImplementation.implementationSteps&&s.technicalImplementation.effort?s.technicalImplementation:s?.recommendations&&s.recommendations.length>0?{description:"No implementation details available",implementationSteps:s.recommendations,effort:{development:this.getDefaultDevelopmentEffort(r),maintenance:this.getDefaultMaintenanceEffort(r),expertise:this.getDefaultExpertiseLevel(r)}}:this.createDefaultImplementationDetails(t,r)}getComponentImplementationDetails(t,r){return this.getTechnicalImplementation(t,r)}getTechnicalDescription(t,r){const a=this.getComponentDetails(t,r);return a?.technical?a.technical:"No technical details available"}getRecommendations(t,r){const a=this.getComponentDetails(t,r);return a?.technical?t==="availability"&&r==="None"?[]:a?.recommendations?a.recommendations:[]:[]}getImplementationTime(t){switch(t){case"None":return"No implementation time";case"Low":return"1-2 weeks";case"Moderate":return"4-8 weeks";case"High":return"3-6 months";case"Very High":return"6-12 months";default:return"Unknown implementation time"}}getImplementationConsiderations(t){switch(t){case"None":return"No implementation considerations as no controls are implemented.";case"Low":return"Basic implementation with minimal resource requirements. This level focuses on establishing foundational security controls with straightforward implementation steps.";case"Moderate":return"Moderate implementation complexity requiring dedicated technical expertise. This level requires a more structured approach with comprehensive planning and periodic maintenance.";case"High":return"Complex implementation requiring specialized expertise and significant resource allocation. This level involves sophisticated technical controls with regular maintenance and monitoring requirements.";case"Very High":return"Highly complex implementation requiring expert-level technical skills and substantial resource investment. This level involves enterprise-grade security architecture with continuous monitoring, updates, and specialized maintenance procedures.";default:return"Unknown security level - implementation considerations cannot be determined."}}getImplementationEffort(t,r){return this.getComponentImplementationDetails(t,r).effort}getImplementationSteps(t,r){return this.getComponentImplementationDetails(t,r).implementationSteps}createDefaultImplementationDetails(t,r){return{description:"No implementation details available",implementationSteps:[],effort:{development:this.getDefaultDevelopmentEffort(r),maintenance:this.getDefaultMaintenanceEffort(r),expertise:this.getDefaultExpertiseLevel(r)}}}getDefaultDevelopmentEffort(t){switch(t){case"None":return"None required";case"Low":return"Days (3-5)";case"Moderate":return"Weeks (2-4)";case"High":return"Months (1-3)";case"Very High":return"Months (3-6+)";default:return"Unknown effort"}}getDefaultMaintenanceEffort(t){switch(t){case"None":return"None required";case"Low":return"Minimal (quarterly review)";case"Moderate":return"Regular (monthly review)";case"High":return"Significant (weekly review)";case"Very High":return"Continuous (daily monitoring)";default:return"Unknown effort"}}getDefaultExpertiseLevel(t){if(typeof this.dataProvider.getDefaultExpertiseLevel=="function")try{return this.dataProvider.getDefaultExpertiseLevel(t)}catch{}switch(t){case"None":return"No special expertise required";case"Low":return"Basic IT knowledge";case"Moderate":return"Security professional";case"High":return"Security specialist";case"Very High":return"Security expert team";default:return"Unknown expertise level"}}}function A(i){const t={None:{bg:"#f5f5f5",text:"#a0a0a0"},Low:{bg:"#e3f2fd",text:"#1976d2"},Moderate:{bg:"#e8f5e9",text:"#2e7d32"},High:{bg:"#fff8e1",text:"#ff8f00"},"Very High":{bg:"#fbe9e7",text:"#d84315"}};return t[i]||t.None}function Ve(i){switch(typeof i=="string"?i.toLowerCase().trim():String(i).toLowerCase().trim()){case"none":return"bg-red-100 dark:bg-red-900 dark:bg-opacity-20";case"low":return"bg-yellow-100 dark:bg-yellow-900 dark:bg-opacity-20";case"moderate":return"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20";case"high":return"bg-green-100 dark:bg-green-900 dark:bg-opacity-20";case"very high":return"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20";default:return"bg-gray-100 dark:bg-gray-800 dark:bg-opacity-20"}}function At(i){const t={Critical:"#d32f2f",High:"#f57c00",Medium:"#fbc02d",Low:"#4caf50",Minimal:"#2196f3",Unknown:"#9e9e9e"};return t[i]||t.Unknown}function Ht(i){return i<=30?"bg-red-600":i<=50?"bg-yellow-400":i<=60?"bg-orange-500":i<=80?"bg-green-500":"bg-blue-500"}const Dt={None:{description:"No availability measures are in place. The system is prone to frequent, unpredictable outages.",technical:"No redundancy, backup systems, monitoring, or disaster recovery procedures are implemented.",businessImpact:"Severe disruptions occur during outages, potentially resulting in revenue losses estimated at 5-10% annually under prolonged conditions.",capex:0,opex:0,bg:A("None").bg,text:A("None").text,recommendations:["Implement basic monitoring to detect outages early","Establish a rudimentary backup process with periodic testing","Document manual recovery procedures with clear roles","Establish baseline uptime metrics to gauge current performance","Identify and prioritize critical systems for improvement"],uptime:"<90%",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Prolonged outages can lead to significant revenue loss, estimated at 5-10% of annual revenue.",riskLevel:"Critical",annualRevenueLoss:"5-10% of annual revenue"},operational:{description:"Operations are severely disrupted with recovery timelines that are highly unpredictable.",riskLevel:"Critical",meanTimeToRecover:"Unpredictable (hours to days)"},regulatory:{description:"Likely violates basic service agreements and regulatory requirements.",riskLevel:"High",complianceViolations:["SLAs","Basic industry standards"]}},securityIcon:"âš ï¸",valuePoints:["No availability value","Systems may be unavailable for extended periods","Unpredictable outages disrupt business operations","No disaster recovery procedures in place","Not suitable for business-critical applications"],technicalImplementation:{description:"No availability measures or redundancy implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current system architecture as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic availability measures are present but have significant limitations, leading to extended downtime during disruptions.",technical:"Reliance on manual backup processes and limited monitoring, with basic recovery documentation.",businessImpact:"Moderate disruptions can lead to revenue losses estimated at 3-5% annually, heavily dependent on recovery speed.",capex:5,opex:3,bg:A("Low").bg,text:A("Low").text,recommendations:["Implement scheduled backups and test recovery procedures regularly","Set up basic monitoring alerts for early detection","Document recovery processes and establish a communication protocol for outages"],uptime:"95%",rto:"24-48 hours",rpo:"24 hours",mttr:"12-24 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is estimated at around 3-5% annually due to extended downtimes.",riskLevel:"High",annualRevenueLoss:"3-5% of annual revenue"},operational:{description:"Business disruptions are significant and require manual intervention, leading to slower recovery.",riskLevel:"High",meanTimeToRecover:"12-24 hours"}},securityIcon:"ðŸ”‘",valuePoints:["Basic availability with minimal protection against outages","Manual recovery processes that require significant time","Scheduled backups but with large recovery point objectives","Suitable for non-critical internal systems","Provides a foundational availability posture"],technicalImplementation:{description:"Basic manual backup and recovery processes",implementationSteps:["Set up scheduled system backups","Document basic recovery procedures","Implement simple monitoring with email alerts"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior IT staff"}}},Moderate:{description:"Standard availability measures that yield acceptable uptime with planned disaster recovery processes.",technical:"Scheduled backups, automated monitoring with alerts, documented recovery procedures, and partial redundancy for key components.",businessImpact:"Occasional disruptions are generally contained, with revenue losses estimated at 1-3% annually.",capex:15,opex:10,bg:A("Moderate").bg,text:A("Moderate").text,recommendations:["Enhance redundancy for mission-critical systems","Automate backup and disaster recovery testing","Integrate comprehensive monitoring with defined SLAs"],uptime:"99%",rto:"4-8 hours",rpo:"4 hours",mttr:"2-4 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is modest, estimated at approximately 1-3% annually, assuming typical outage scenarios.",riskLevel:"Medium",annualRevenueLoss:"1-3% of annual revenue"},operational:{description:"Disruptions occur infrequently and recovery is relatively quick.",riskLevel:"Medium",meanTimeToRecover:"2-4 hours"}},securityIcon:"ðŸ”“",valuePoints:["Balanced availability with standard protection measures","Semi-automated recovery procedures","Regular backups with moderate recovery point objectives","Suitable for standard business applications","Meets basic availability requirements for most operations"],technicalImplementation:{description:"Standard availability controls with some automation",implementationSteps:["Implement automated backup systems","Set up monitoring and alerting infrastructure","Deploy basic redundancy for key components","Create and test disaster recovery procedures"],effort:{development:"Weeks (2-4)",maintenance:"Scheduled weekly maintenance",expertise:"Mid-level IT staff"}}},High:{description:"Robust availability measures with high redundancy and automated recovery systems ensure near-continuous operations.",technical:"N+1 redundancy, multi-region standby systems, automated failover, comprehensive monitoring, and regular disaster recovery testing.",businessImpact:"Business continuity is well-maintained with negligible revenue impact (generally under 1%).",capex:30,opex:20,bg:A("High").bg,text:A("High").text,recommendations:["Deploy N+1 redundancy for all critical systems","Implement automated failover and real-time monitoring","Conduct regular disaster recovery drills and define escalation procedures"],uptime:"99.9%",rto:"15-60 minutes",rpo:"15 minutes",mttr:"10-30 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is minimal, generally estimated at less than 1% of annual revenue.",riskLevel:"Low",annualRevenueLoss:"<1% of annual revenue"},operational:{description:"Disruptions are rare and recovery is almost instantaneous due to automation.",riskLevel:"Low",meanTimeToRecover:"10-30 minutes"},strategic:{description:"High reliability can support market expansion and reinforces customer trust.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong availability with robust protection against outages","Automated failover and rapid recovery capabilities","Near real-time replication with minimal data loss risk","Suitable for business-critical applications","Supports high-value customer-facing services"],technicalImplementation:{description:"Advanced availability architecture with automated recovery",implementationSteps:["Deploy N+1 redundancy across all critical infrastructure","Implement automated failover mechanisms","Set up comprehensive monitoring and alerting","Establish regular disaster recovery testing"],effort:{development:"Months (1-3)",maintenance:"Continuous monitoring, weekly testing",expertise:"Senior IT specialists"}}},"Very High":{description:"Maximum availability with continuous operations enabled by multi-region redundancy, real-time replication, and fully automated recovery.",technical:"N+2 redundancy, active-active multi-region architecture, real-time replication, and automated remediation ensure near-zero downtime.",businessImpact:"Operational continuity is nearly uninterrupted under normal conditions, with revenue impact considered negligibleâ€”though extreme events remain a risk.",capex:60,opex:40,bg:A("Very High").bg,text:A("Very High").text,recommendations:["Implement N+2 redundancy across all critical components","Deploy an active-active multi-region architecture with real-time replication","Establish fully automated remediation systems and 24/7 operations support","Conduct regular chaos engineering exercises to stress-test resilience"],uptime:"99.99%",rto:"<5 minutes",rpo:"<1 minute",mttr:"<5 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue losses due to availability issues are negligible under normal conditions.",riskLevel:"Minimal"},operational:{description:"Business operations are maintained nearly continuously with rapid, automated recovery.",riskLevel:"Minimal",meanTimeToRecover:"<5 minutes"},strategic:{description:"Superior reliability offers a competitive advantage in high-demand markets.",riskLevel:"Minimal"},regulatory:{description:"Exceeds stringent regulatory and SLA requirements for availability.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum availability with comprehensive protection","Active-active multi-region deployment with instant failover","Real-time replication with virtually no data loss","Suitable for mission-critical systems with zero downtime requirements","Supports high-frequency financial transactions and life-critical systems"],technicalImplementation:{description:"Enterprise-grade high availability infrastructure",implementationSteps:["Implement N+2 redundancy across all system components","Deploy active-active architecture across multiple regions","Set up real-time data replication and synchronization","Implement automated self-healing mechanisms","Establish continuous chaos engineering testing"],effort:{development:"Months (4-6+)",maintenance:"24/7 operations team, continuous monitoring",expertise:"Senior availability specialists and architects"}}}},Tt={None:{description:"No confidentiality controls are implemented, leaving sensitive information fully exposed to any user with system access.",technical:"There are no access controls, no encryption measures, and no data classification processes.",businessImpact:"This exposes the organization to severe reputational damage and regulatory non-compliance, with potential legal penalties if sensitive data is compromised.",capex:0,opex:0,bg:A("None").bg,text:A("None").text,recommendations:["Implement basic authentication mechanisms","Introduce simple authorization controls","Establish a rudimentary data classification scheme"],protectionMethod:"None",businessImpactDetails:{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}},securityIcon:"âš ï¸",valuePoints:["No confidentiality safeguards","All data accessible to anyone with system access","High risk of data exposure and theft","No protection for sensitive information","Not suitable for handling personal or proprietary data"],technicalImplementation:{description:"No confidentiality controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data access as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic confidentiality measures are in place but provide only minimal protection against unauthorized access.",technical:"Relies on password protection, basic role-based access controls, and minimal encryption.",businessImpact:"Sensitive data is somewhat protected, but the risk of exposure remains high, potentially leading to moderate reputational harm and regulatory challenges.",capex:5,opex:3,bg:A("Low").bg,text:A("Low").text,recommendations:["Upgrade to a robust authentication system","Implement comprehensive role-based access controls","Enforce TLS/SSL for all data in transit"],protectionMethod:"Basic access control",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Exposure of sensitive data is possible, which could lead to moderate damage to the organization's reputation if an incident occurs.",riskLevel:"High"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Existing measures may not fully satisfy privacy regulations, leading to potential fines or legal scrutiny.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic confidentiality with password protection","Simple access controls for data access","Limited protection for sensitive information","Suitable for internal, less sensitive data","Provides foundation for data protection initiatives"],technicalImplementation:{description:"Basic authentication and access control",implementationSteps:["Implement password-based authentication","Set up basic role-based access controls","Configure transport layer security (TLS)"],effort:{development:"Days (1-5)",maintenance:"Monthly password resets and access reviews",expertise:"Junior IT security staff"}}},Moderate:{description:"Standard confidentiality measures provide a reasonable level of protection for sensitive information under typical threat scenarios.",technical:"Utilizes strong authentication, role-based access control, and encryption both at rest and in transit.",businessImpact:"Most unauthorized access attempts are thwarted, reducing the risk of data breaches. However, sophisticated threats might still pose a risk, leading to moderate operational and reputational impacts.",capex:15,opex:10,bg:A("Moderate").bg,text:A("Moderate").text,recommendations:["Implement robust encryption for data both at rest and in transit","Regularly review and update access controls","Establish continuous monitoring and auditing of data access"],protectionMethod:"Standard encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Sensitive data is largely protected, mitigating the risk of reputational damage in the event of an incident.",riskLevel:"Medium"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Generally meets standard data protection requirements, though vulnerabilities may remain against highly sophisticated attacks.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard confidentiality with encryption protections","Role-based access controls for data protection","Encryption for data at rest and in transit","Suitable for most business applications with sensitive data","Meets requirements for standard regulatory compliance"],technicalImplementation:{description:"Encryption and role-based access control",implementationSteps:["Implement strong authentication mechanisms","Configure comprehensive role-based access control","Deploy encryption for sensitive data at rest and in transit","Set up access logging and monitoring"],effort:{development:"Weeks (2-3)",maintenance:"Quarterly access reviews, monthly updates",expertise:"Mid-level security professionals"}}},High:{description:"Advanced confidentiality measures provide strong protection against unauthorized access to sensitive information.",technical:"Employs multi-factor authentication, robust encryption, fine-grained access controls, and continuous security monitoring.",businessImpact:"Significantly reduces the risk of data breaches, thereby minimizing reputational damage and ensuring compliance with stringent regulatory standards.",capex:30,opex:20,bg:A("High").bg,text:A("High").text,recommendations:["Deploy multi-factor authentication across all user access points","Implement end-to-end encryption and conduct regular security audits","Establish comprehensive monitoring of data access and activity"],protectionMethod:"E2E encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"High-level measures substantially reduce the risk of sensitive data exposure, protecting the organization's reputation.",riskLevel:"Low"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Measures meet or exceed many regulatory requirements, thereby reducing legal risks.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong confidentiality with advanced encryption","Multi-factor authentication for secure access","Fine-grained access controls with least privilege","Suitable for sensitive financial and personal data","Meets requirements for most regulatory frameworks"],technicalImplementation:{description:"Advanced encryption and multi-factor authentication",implementationSteps:["Deploy multi-factor authentication system","Implement end-to-end encryption for sensitive data","Configure fine-grained access controls","Set up comprehensive security monitoring","Establish regular security audit procedures"],effort:{development:"Months (2-3)",maintenance:"Bi-weekly security reviews, continuous monitoring",expertise:"Senior security engineers"}}},"Very High":{description:"Maximum confidentiality measures provide comprehensive protection for highly sensitive information requiring the utmost security.",technical:"Utilizes military-grade encryption, hardware security modules, zero-trust architecture, and continuous threat monitoring and response.",businessImpact:"Provides the highest level of data protection required for regulated industries, government contractors, or organizations handling extremely sensitive data.",capex:60,opex:40,bg:A("Very High").bg,text:A("Very High").text,recommendations:["Implement zero-trust security architecture","Deploy advanced encryption with quantum-resistant algorithms","Establish comprehensive data security governance program","Conduct regular penetration testing and security assessments"],protectionMethod:"Military-grade encryption with zero-trust",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Maximum-level measures virtually eliminate the risk of reputational damage from data breaches.",riskLevel:"Minimal"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Exceeds regulatory requirements for data protection in all major frameworks.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum confidentiality with military-grade protection","Zero-trust architecture for comprehensive security","Advanced threat detection and prevention","Suitable for classified, top-secret, or highly regulated data","Exceeds requirements for all regulatory frameworks"],technicalImplementation:{description:"Military-grade encryption with zero-trust architecture",implementationSteps:["Implement zero-trust security architecture","Deploy military-grade encryption with quantum resistance","Set up hardware security modules for cryptographic keys","Implement continuous security monitoring and threat hunting","Establish comprehensive data security governance"],effort:{development:"Months (6+)",maintenance:"Continuous monitoring, monthly assessments",expertise:"Elite security specialists and architects"}}}},Vt={None:{description:"No integrity controls are implemented, leaving the system vulnerable to undetected data corruption.",technical:"There is no input validation, no checksums, no audit logging, and no data verification mechanisms.",businessImpact:"This lack of controls poses a critical risk to decision-making and financial reporting, potentially leading to significant operational disruptions.",capex:0,opex:0,bg:A("None").bg,text:A("None").text,recommendations:["Implement fundamental input validation measures","Introduce basic application-level data checks","Set up rudimentary audit logs for critical transactions"],businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial reporting reliability is severely compromised, risking misallocation of resources.",riskLevel:"Critical"},operational:{description:"Decisions based on inaccurate data can lead to cascading failures and prolonged recovery times.",riskLevel:"Critical"}},validationMethod:"None",securityIcon:"âš ï¸",valuePoints:["No data integrity safeguards","Vulnerable to undetected data corruption","High risk of making decisions based on inaccurate data","No protection against unauthorized modifications","Not suitable for any data requiring accuracy"],technicalImplementation:{description:"No data integrity controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data flows as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic integrity controls are present, relying mainly on manual verification processes that are error-prone and hard to scale.",technical:"Relies on simple input validation, rudimentary access controls, and manual checksum verification without automated oversight.",businessImpact:"Data inaccuracies may occur intermittently, potentially leading to errors in financial calculations and operational inefficiencies.",capex:5,opex:3,bg:A("Low").bg,text:A("Low").text,recommendations:["Adopt server-side validation to minimize human error","Introduce automated data verification where possible","Schedule regular manual reviews to detect anomalies"],validationMethod:"Manual checks",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial calculations might be affected by occasional errors, though the overall impact is moderate.",riskLevel:"High"},operational:{description:"Manual processes may catch corruption inconsistently, leading to sporadic operational delays.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic data integrity with minimal protection","Simple input validation to catch obvious errors","Periodic manual verification processes","Suitable for low-importance internal data","Provides foundation for data quality initiatives"],technicalImplementation:{description:"Basic manual validation processes",implementationSteps:["Implement basic input validation in applications","Create procedures for manual data reviews","Document data validation requirements"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior developers"}}},Moderate:{description:"Standard integrity controls combine automated verification with periodic manual oversight, providing a reasonable level of assurance.",technical:"Utilizes comprehensive input validation, checksums, version control, and audit logging with a blend of automated and manual checks.",businessImpact:"Most data corruption is detected and corrected, though sophisticated attacks or subtle errors may still occur.",capex:15,opex:10,bg:A("Moderate").bg,text:A("Moderate").text,recommendations:["Implement end-to-end automated data validation","Utilize database constraints and triggers to enforce integrity rules","Establish robust audit trails and periodic integrity reviews"],validationMethod:"Automated validation",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial data is generally reliable; however, occasional discrepancies may still impact reporting accuracy.",riskLevel:"Medium"},operational:{description:"Operational disruptions are infrequent and usually resolved quickly via established audit trails.",riskLevel:"Medium"},regulatory:{description:"Controls meet basic regulatory standards, though they might fall short of stricter compliance requirements.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard integrity with automated validation","Comprehensive input validation and data checks","Database constraints to enforce data rules","Suitable for standard business applications","Meets requirements for most business operations"],technicalImplementation:{description:"Automated validation with database constraints",implementationSteps:["Implement comprehensive server-side validation","Configure database constraints and triggers","Set up automated data quality checks","Establish audit logging for data changes"],effort:{development:"Weeks (2-3)",maintenance:"Monthly reviews and updates",expertise:"Mid-level developers"}}},High:{description:"Advanced integrity controls employing cryptographic techniques provide strong data assurance, albeit with increased complexity and cost.",technical:"Incorporates digital signatures, hash verifications, and tamper-resistant audit logs to secure data integrity.",businessImpact:"Data integrity is strongly maintained, reducing risks in financial and operational decision-making, but the high investment may limit broader scalability.",capex:30,opex:20,bg:A("High").bg,text:A("High").text,recommendations:["Deploy digital signatures for high-risk data entries","Implement cryptographic hash validations for data immutability","Establish immutable audit logging mechanisms"],validationMethod:"Cryptographic verification",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"High confidence in financial data minimizes the risk of significant misreporting.",riskLevel:"Low"},operational:{description:"Robust change tracking enables timely detection and correction of data errors.",riskLevel:"Low"},regulatory:{description:"These controls typically exceed many regulatory requirements, providing a strong compliance posture.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong integrity with cryptographic protection","Digital signatures to verify data origin","Cryptographic hash validation for detecting tampering","Suitable for financial and regulated applications","Provides strong audit and compliance capabilities"],technicalImplementation:{description:"Cryptographic integrity verification systems",implementationSteps:["Implement digital signature infrastructure","Deploy hash verification for critical data","Set up immutable audit logging","Establish key management processes"],effort:{development:"Months (1-2)",maintenance:"Bi-weekly checks and key rotation",expertise:"Senior security engineers"}}},"Very High":{description:"State-of-the-art integrity controls leveraging distributed ledger technologies provide near-absolute data assurance, though they introduce significant complexity and cost.",technical:"Employs multi-party verification, blockchain-based ledgers, and zero-knowledge proofs to ensure immutable audit trails.",businessImpact:"Data integrity is virtually guaranteed, which is critical for high-stakes regulatory and financial environments, but the substantial investment and complexity may not be justifiable for all organizations.",capex:60,opex:40,bg:A("Very High").bg,text:A("Very High").text,recommendations:["Explore blockchain or distributed ledger solutions for critical data","Deploy multi-party verification systems to enhance auditability","Investigate zero-knowledge proofs to verify data integrity without compromising confidentiality"],validationMethod:"Blockchain/distributed ledger",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Ensures exceptional reliability of financial data, enabling precise reporting in regulated sectors.",riskLevel:"Minimal"},operational:{description:"Data integrity is nearly absolute, reducing operational risk to an absolute minimum, despite high system complexity.",riskLevel:"Minimal"},strategic:{description:"Supports organizations in highly regulated or high-stakes markets; however, the cost and complexity may outweigh benefits for most.",riskLevel:"Minimal"}},securityIcon:"ðŸ”",valuePoints:["Maximum integrity with blockchain/distributed ledger technology","Immutable audit trail of all data changes","Multi-party consensus verification","Suitable for high-value financial transactions and legal evidence","Virtually tamper-proof data storage and verification"],technicalImplementation:{description:"Distributed ledger or blockchain-based integrity systems",implementationSteps:["Implement blockchain or distributed ledger infrastructure","Set up consensus mechanisms for data validation","Deploy smart contracts for automated verification","Establish multi-party validation processes","Implement zero-knowledge proofs where applicable"],effort:{development:"Months (3-6+)",maintenance:"Continuous monitoring, regular protocol updates",expertise:"Specialized blockchain/cryptography experts"}}}},De={NONE:{returnRate:"0%",value:"0%",description:"No ROI without security investment",potentialSavings:"$0",breakEvenPeriod:"N/A"},LOW:{returnRate:"50-100%",value:"50-100%",description:"Basic security measures provide minimal protection with moderate return",potentialSavings:"$5K-$10K annually",breakEvenPeriod:"12-18 months"},MODERATE:{returnRate:"100-200%",value:"100-200%",description:"Balanced security approach delivers positive returns for most organizations",potentialSavings:"$10K-$25K annually",breakEvenPeriod:"6-12 months"},HIGH:{returnRate:"200-300%",value:"200-300%",description:"Strong security posture provides excellent returns for organizations with sensitive data or operations",potentialSavings:"$20K-$50K annually",breakEvenPeriod:"3-6 months"},VERY_HIGH:{returnRate:"300-500%",value:"300-500%",description:"Maximum security investment delivers highest potential returns for organizations in regulated industries or handling critical data",potentialSavings:"$30K-$70K annually",breakEvenPeriod:"2-4 months"}},Ze=Dt,Je=Tt,Qe=Vt,et=De;function Pt(i){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(i)}function Se(i){return{None:"No return on investment for none level security controls",Low:"Basic return on security investment at low level",Moderate:"Moderate return on security investment at moderate level",High:"Strong return on security investment at high level","Very High":"Maximum return on security investment at very high level"}[i]||"Unknown ROI"}const _e={warn:i=>{console.warn(i)},error:i=>{console.error(i)},info:i=>{console.info(i)}};function $t(i){return i?i.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):""}function Lt(i){return i>=90?"Exceptional security posture meeting highest standards":i>=80?"Very strong security posture exceeding most requirements":i>=70?"Strong security posture meeting most requirements":i>=60?"Adequate security posture with some improvements needed":i>=50?"Moderate security posture with significant improvements needed":i>=40?"Weak security posture with many vulnerabilities":i>=30?"Poor security posture requiring immediate attention":i>=20?"Very poor security posture with critical vulnerabilities":"Critical security posture requiring complete overhaul"}class ne extends ee{dataProvider;businessImpactService;complianceService;securityMetricsService;technicalImplementationService;securityResourceService;constructor(t){const r=t||{availabilityOptions:Ze,integrityOptions:Qe,confidentialityOptions:Je,roiEstimates:et};super(r),this.dataProvider=r,this.businessImpactService=new St(this.dataProvider),this.complianceService=new Xe(this.dataProvider),this.securityMetricsService=new He(this.dataProvider),this.technicalImplementationService=new Et(this.dataProvider),this.securityResourceService=new Rt(this.dataProvider)}async initialize(){return Promise.resolve()}getCIAOptions(t){return t==="availability"?this.dataProvider.availabilityOptions:t==="integrity"?this.dataProvider.integrityOptions:t==="confidentiality"?this.dataProvider.confidentialityOptions:{None:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Low:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Moderate:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},High:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},"Very High":{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]}}}getComponentDetails(t,r){if(!ft(t))return;const a=this.getCIAOptions(t);if(!(!a||!a[r]))return a[r]}static normalizeLevel(t){return(t??"None").toString().trim().toLowerCase()}getROIEstimate(t){if(!t||t==="None"||ne.normalizeLevel(t)==="none")return{value:"0%",returnRate:"0%",description:"No return on investment for security controls"};const r=t.toUpperCase().replace(" ","_"),a=this.dataProvider.roiEstimates[r];return a||{value:"Negative",returnRate:"0%",description:"No return on investment for security controls"}}getROIEstimates(t){if(!t||t==="None"||ne.normalizeLevel(t)==="none")return{value:"0%",returnRate:"0%",description:"No return on investment for security controls"};const r={returnRate:"0%",description:"No return on investment for security controls",value:"0%"},a=this.securityLevelToROIKey(t),n=(this.dataProvider.roiEstimates||{})[a];return n?{...n,returnRate:n.returnRate||"0%"}:r}securityLevelToROIKey(t){switch(t){case"None":return"NONE";case"Low":return"LOW";case"Moderate":return"MODERATE";case"High":return"HIGH";case"Very High":return"VERY_HIGH";default:return"MODERATE"}}getAllROIEstimates(){return this.dataProvider.roiEstimates}getBusinessImpact(t,r){return this.businessImpactService.getBusinessImpact(t,r)}getTechnicalImplementation(t,r){return this.technicalImplementationService.getTechnicalImplementation(t,r)}getComponentImplementationDetails(t,r){return this.technicalImplementationService.getComponentImplementationDetails(t,r)}getBusinessImpactDescription(t,r){return this.businessImpactService.getBusinessImpactDescription(t,r)}getTechnicalDescription(t,r){return this.technicalImplementationService.getTechnicalDescription(t,r)}getDetailedDescription(t,r){return this.businessImpactService?this.businessImpactService.getBusinessImpact(t,r):{summary:"",financial:{description:"",riskLevel:""},operational:{description:"",riskLevel:""},reputational:{description:"",riskLevel:""}}}getRecommendations(t,r){return this.technicalImplementationService.getRecommendations(t,r)}calculateRoi(t,r){if(!t||t==="None"||ne.normalizeLevel(t)==="none")return{value:"$0",percentage:"0%",description:Se("None")};if(r<=0)return{value:"$0",percentage:this.getROIEstimates(t).returnRate,description:Se(t)};const a=this.getROIEstimates(t),s=parseInt(a.returnRate.replace("%",""),10)||0,n=r*(s/100);return{value:Pt(n),percentage:a.returnRate,description:Se(t)}}getSecurityMetrics(t,r=t,a=t){return this.securityMetricsService.getSecurityMetrics(t,r,a)}getComplianceStatus(t,r,a){return this.complianceService.getComplianceStatus(t,r,a)}getComponentMetrics(t,r){return this.securityMetricsService.getComponentMetrics(t,r)}getImpactMetrics(t,r){return this.securityMetricsService.getImpactMetrics(t,r)}getSecurityResources(t,r){return this.securityResourceService.getSecurityResources(t,r)}getSecurityLevelDescription(t){return this.securityMetricsService.getSecurityLevelDescription(t)}getProtectionLevel(t){return this.securityMetricsService.getProtectionLevel(t)}calculateBusinessImpactLevel(t,r=t,a=t){return this.businessImpactService.calculateBusinessImpactLevel(t,r,a)}getRiskBadgeVariant(t){return this.securityMetricsService.getRiskBadgeVariant(t)}getCategoryIcon(t){return this.businessImpactService.getCategoryIcon(t)}getValuePoints(t){return this.securityResourceService.getValuePoints(t)}getImplementationConsiderations(t){return!t||!Array.isArray(t)||t.length!==3?"Invalid security levels provided. Please provide an array with exactly three security levels.":this.technicalImplementationService.getImplementationConsiderations(t[0])}getSecurityIcon(t){return this.securityMetricsService.getSecurityIcon(t)}getCompliantFrameworks(t){return this.complianceService.getCompliantFrameworks(t,t,t)}getFrameworkDescription(t){return this.complianceService.getFrameworkDescription(t)}getFrameworkRequiredLevel(t,r){const a=r,s=r,n=r,l=this.complianceService.getComplianceStatus(a,s,n);return _e.info(`Assessing framework requirements for ${t} at ${r} level`),l.compliantFrameworks.length>0&&l.nonCompliantFrameworks.length===0?`Current ${r} level for ${t} meets requirements for most frameworks`:l.partiallyCompliantFrameworks.length>0?`Current ${r} level for ${t} partially meets requirements; consider upgrading to ${r==="Low"?"Moderate":"High"} for full compliance`:`Current ${r} level for ${t} is insufficient; upgrade to at least ${r==="None"?"Low":r==="Low"?"Moderate":"High"} for basic compliance`}getImplementationTime(t){return this.technicalImplementationService.getImplementationTime(t)}getTotalImplementationTime(t,r,a){const s={None:0,Low:2,Moderate:6,High:12,"Very High":24},n=s[t]+s[r]+s[a],l=Math.round(n*.6);return l<=0?"No implementation required":l<=4?`${l} weeks`:l<=12?`${l} weeks`:`${Math.round(l/4)} to ${Math.round(l/4)+2} months`}getRequiredExpertise(t,r,a){switch([t,r,a].sort((l,o)=>{const m={None:0,Low:1,Moderate:2,High:3,"Very High":4};return m[o]-m[l]})[0]){case"None":return"No special expertise required";case"Low":return"IT staff with basic security knowledge";case"Moderate":return"Security professional";case"High":return"Senior security engineer or architect";case"Very High":return"Expert security team with specialized skills";default:return"Unknown expertise level"}}getRecommendedImplementationPlan(t,r,a){const s=this.getSecurityLevelValue(t),n=this.getSecurityLevelValue(r),l=this.getSecurityLevelValue(a),o=s+n+l;return o<=3?`Step 1: Define basic security requirements
Step 2: Implement fundamental controls
Step 3: Document basic procedures`:o<=6?`Step 1: Conduct risk assessment
Step 2: Develop standard security controls
Step 3: Implement monitoring procedures
Step 4: Create maintenance plan`:o<=9?`Step 1: Perform comprehensive security assessment
Step 2: Design advanced security architecture
Step 3: Implement defense-in-depth strategy
Step 4: Establish continuous monitoring
Step 5: Create incident response plan`:`Step 1: Engage security experts
Step 2: Implement rigorous security architecture
Step 3: Deploy advanced security controls
Step 4: Establish security operations center
Step 5: Implement automated response capabilities
Step 6: Conduct regular penetration testing`}getInformationSensitivity(t){switch(t){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Sensitive Data";case"High":return"Confidential Data";case"Very High":return"Restricted Data";default:return"Unknown Classification"}}getComponentContent(t,r){const a=this.getComponentDetails(t,r);return a?{description:a.description||`${t} ${r} description`,technical:a.technical||`${t} ${r} technical details`,businessImpact:a.businessImpact||`${t} ${r} business impact`,recommendations:a.recommendations||[`${t} ${r} recommendation`]}:(_e.warn(`Component details not found for ${t} at level ${r}`),{description:`${t} ${r} description not available`,technical:`${t} ${r} technical details not available`,businessImpact:`${t} ${r} business impact not available`,recommendations:[`Implement basic ${t} controls for ${r} level`]})}getBusinessImpactContent(t,r){const a=this.businessImpactService.getBusinessImpact(t,r);return a?`
      ## Business Impact Summary for ${$t(t)} (${r})
      
      ${a.summary}
      
      ### Financial Impact
      ${a.financial?.description||"Financial impact information not available."} 
      Risk level: ${a.financial?.riskLevel||"Unknown"}
      
      ### Operational Impact
      ${a.operational?.description||"Operational impact information not available."}
      Risk level: ${a.operational?.riskLevel||"Unknown"}
      
      ### Reputational Impact
      ${a.reputational?.description||"Reputational impact information not available."}
      Risk level: ${a.reputational?.riskLevel||"Unknown"}
    `:`Business impact information for ${t} at ${r} level is not available.`}getSummaryContent(t,r,a){const s=this.getComponentDetails("availability",t)?.description||`${t} availability`,n=this.getComponentDetails("integrity",r)?.description||`${r} integrity`,l=this.getComponentDetails("confidentiality",a)?.description||`${a} confidentiality`,o=this.complianceService.getComplianceStatus(t,r,a),m=this.securityMetricsService.calculateSecurityScore(t,r,a),x=this.businessImpactService.getBusinessImpactDescription("availability",t),p=this.businessImpactService.getBusinessImpactDescription("integrity",r),h=this.businessImpactService.getBusinessImpactDescription("confidentiality",a);return`
      # Security Profile Summary
      
      ## Current Security Configuration
      - **Availability**: ${s}
      - **Integrity**: ${n}
      - **Confidentiality**: ${l}
      
      ## Security Score: ${m}%
      ${Lt(m)}
      
      ## Business Impact
      - **Availability Impact**: ${x}
      - **Integrity Impact**: ${p}
      - **Confidentiality Impact**: ${h}
      
      ## Compliance Status
      ${o.status||""}
      - Compliant with ${o.compliantFrameworks.length} frameworks
      - Partially compliant with ${o.partiallyCompliantFrameworks.length} frameworks
      - Non-compliant with ${o.nonCompliantFrameworks.length} frameworks
      
      ${o.remediationSteps&&o.remediationSteps.length>0?`## Remediation Steps
`+o.remediationSteps.map(b=>`- ${b}`).join(`
`):""}
    `}getComplianceDescription(t){switch(t){case"None":return"Non-compliant with most regulatory frameworks. Fails to meet minimum security requirements for data protection and system integrity. Significant remediation needed to meet basic compliance standards.";case"Low":return"Meets only minimal compliance requirements. May satisfy basic requirements for non-sensitive data, but insufficient for regulated industries or sensitive information. Additional controls needed for most compliance frameworks.";case"Moderate":return"Satisfies common baseline requirements across major frameworks. Adequate for most general business applications but may need enhancement for highly regulated industries or sensitive data processing.";case"High":return"Compliant with major regulatory frameworks including GDPR, HIPAA, and PCI DSS. Implements controls exceeding standard requirements, suitable for organizations handling sensitive personal and financial information.";case"Very High":return"Meets the most stringent regulatory requirements across all major frameworks. Fully compliant with industry best practices and specialized regulations. Suitable for critical infrastructure, financial services, and healthcare.";default:return`Compliance information for ${t} security level is not available.`}}getKeyValuePoints(t,r){return this.getValuePoints(r)}getDefaultPrivacyImpact(t){switch(t){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}getDefaultSLAMetrics(t){switch(t){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}getDefaultValidationLevel(t){switch(t){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}getDefaultErrorRate(t){switch(t){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 1%";case"High":return"< 0.1%";case"Very High":return"< 0.01%";default:return"Unknown"}}}new ne;function Ot(i){return{None:"âš ï¸",Low:"ðŸ”‘",Moderate:"ðŸ”“",High:"ðŸ”’","Very High":"ðŸ”"}[i]||"â“"}function _t(i){const t=[`Provides ${i.toLowerCase()} level of protection`,`Meets ${i==="High"||i==="Very High"?"advanced":"basic"} security requirements`],r={None:[],Low:["Cost-effective basic security measures"],Moderate:["Balanced security and cost","Suitable for standard business operations"],High:["Strong protection for sensitive data","Complies with most regulatory frameworks"],"Very High":["Maximum protection for critical assets","Exceeds regulatory requirements","Enterprise-grade security"]};return[...t,...r[i]||[]]}function Ft(i){const t={availabilityOptions:Ze,integrityOptions:Qe,confidentialityOptions:Je,roiEstimates:et,getDefaultSecurityIcon:Ot,getDefaultValuePoints:_t};return new ne(t)}const qt={None:{capex:0,opex:0},Low:{capex:5e3,opex:2e3},Moderate:{capex:15e3,opex:5e3},High:{capex:5e4,opex:15e3},"Very High":{capex:2e5,opex:5e4}},Fe={small:.5,medium:1,large:2.5,enterprise:5},qe={general:1,financial:1.5,healthcare:1.7,government:1.3,retail:1.2,technology:1.4,manufacturing:1.1};function Bt(i){if(!i)return"None";const t=typeof i=="string"?i.trim():"";return/^none$/i.test(t)?"None":/^low$/i.test(t)?"Low":/^(moderate|medium)$/i.test(t)?"Moderate":/^high$/i.test(t)?"High":/^very\s*high$/i.test(t)?"Very High":"None"}function Ie(i,t="medium",r="general"){const a=Bt(i),s=qt[a]||{capex:0,opex:0},n=Ut(t),l=zt(r);return{capex:Math.round(s.capex*n*l),opex:Math.round(s.opex*n*l)}}function Te(i,t,r,a="medium",s="general"){const n=Ie(i,a,s),l=Ie(t,a,s),o=Ie(r,a,s),m=n.capex+l.capex+o.capex,x=n.opex+l.opex+o.opex;return{availabilityCost:n,integrityCost:l,confidentialityCost:o,totalCapex:m,totalOpex:x,totalCost:m+x}}function Ut(i){return Fe[i]||Fe.medium}function zt(i){return qe[i]||qe.general}function Be(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function tt(i){return typeof i=="string"}function xe(i){return Array.isArray(i)}function S(i){return i==null}function Gt(i){return i instanceof Error}function rt(i){return Gt(i)?i:i instanceof Object&&"message"in i&&typeof i.message=="string"?new Error(i.message):new Error(String(i))}function Yt(i,t){const r=rt(i);return t?`${t}: ${r.message}`:r.message}const it=i=>typeof i=="object"&&i!==null&&"message"in i&&typeof i.message=="string",Pe=i=>it(i)?i.message:i==null||typeof i=="object"&&!("message"in i)?"An unknown error occurred":String(i),Wt=i=>{const t=Pe(i);console.error("Error:",t)},Kt=(i,t)=>{const r=Pe(i);return console.error(`API Error (${t}):`,r),r},Xt=Object.freeze(Object.defineProperty({__proto__:null,displayErrorMessage:Wt,formatError:Yt,formatErrorMessage:Pe,handleApiError:Kt,isErrorWithMessage:it,toErrorObject:rt},Symbol.toStringTag,{value:"Module"}));function P(i,t,r){let a="USD",s="en-US",n=0,l=0;return typeof t=="string"?(a=t,r&&(s=r)):t&&typeof t=="object"&&(t.currency&&(a=t.currency),t.locale&&(s=t.locale),t.minimumFractionDigits!==void 0&&(n=t.minimumFractionDigits),t.maximumFractionDigits!==void 0&&(l=t.maximumFractionDigits)),new Intl.NumberFormat(s,{style:"currency",currency:a,minimumFractionDigits:n,maximumFractionDigits:l}).format(i)}function Zt(i){switch(i){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}function Jt(i){switch(i){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}function Qt(i){switch(i){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}const er=i=>{switch(i){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 3%";case"High":return"< 1%";case"Very High":return"< 0.01%";default:return"Unknown"}};function tr(i){switch(i){case"Minimal":return"Low Risk";case"Low":return"Low Risk";case"Moderate":return"Low Risk";case"High":return"High Risk";case"Very High":return"High Risk";default:return"Unknown Risk"}}function rr(i){if(!i)return"neutral";const t=ir(i);return t.includes("critical")?"error":t.includes("high risk")?"warning":t.includes("medium")||t.includes("moderate")?"info":t.includes("low risk")||t.includes("minimal")||t.includes("none")?"success":"neutral"}function ir(i){return i==null?"":i.toLowerCase()}function at(i,t,r){const a={None:0,Low:1,Moderate:2,High:3,"Very High":4},s=a[i]||0,n=a[t]||0,l=a[r]||0,o=(s+n+l)/3;return o<=.5?"Minimal":o<=1.5?"Low":o<=2.5?"Moderate":o<=3.5?"High":"Very High"}function ye(i,t,r){const a=T(i)+T(t)+T(r);return a<=2?"Low":a<=6?"Moderate":a<=9?"High":"Very High"}function K(i,t){const r=t==="None"||t==="Low";return i==="availability"?{summary:`${t} availability impact on business operations`,operational:{description:`${r?"Significant operational disruptions possible due to limited availability controls":"Operations protected by appropriate availability controls"}`,riskLevel:r?"High Risk":"Low Risk"},financial:{description:`${r?"Potential financial losses due to service disruptions and downtime":"Financial impact minimized through robust availability controls"}`,riskLevel:r?"Medium Risk":"Low Risk"}}:i==="integrity"?{summary:`${t} integrity impact on business operations`,operational:{description:`${r?"Business decisions may be based on inaccurate or corrupted data":"Data accuracy protected by appropriate integrity controls"}`,riskLevel:r?"High Risk":"Low Risk"},financial:{description:`${r?"Financial losses possible due to data errors affecting decision making":"Financial impact minimized through data validation and integrity mechanisms"}`,riskLevel:r?"Medium Risk":"Low Risk"}}:{summary:`${t} confidentiality impact on business operations`,reputational:{description:`${r?"High risk of reputational damage from data exposures or breaches":"Reputation protected by appropriate confidentiality controls"}`,riskLevel:r?"High Risk":"Low Risk"},regulatory:{description:`${r?"Increased risk of non-compliance with data protection regulations":"Regulatory compliance supported by appropriate data protection measures"}`,riskLevel:r?"Medium Risk":"Low Risk"}}}const{toErrorObject:ar}=Xt,G=()=>{const[i,t]=u.useState(null),[r,a]=u.useState(!0),[s,n]=u.useState(null),l=async()=>{try{a(!0);const m=Ft();await m.initialize(),t(m),n(null)}catch(m){t(null),n(ar(m))}finally{a(!1)}},o=()=>{a(!0),l()};return u.useEffect(()=>{l()},[]),{ciaContentService:i,isLoading:r,error:s,refresh:o}};function Ce({label:i,value:t,className:r="",keyClassName:a="",valueClassName:s="",labelClassName:n="",testId:l,iconPrefix:o}){return e.jsxs("div",{className:`p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 ${r}`,"data-testid":l||je.KEY_VALUE_PAIR,children:[e.jsxs("div",{className:`text-xs font-medium mb-1 text-gray-600 dark:text-gray-400 ${a} ${n}`,"data-testid":je.KEY_VALUE_KEY,children:[o&&e.jsx("span",{className:"mr-1",children:o}),i]}),e.jsx("div",{className:`text-sm font-medium ${s}`,"data-testid":je.KEY_VALUE_VALUE,children:t||"N/A"})]})}const z=({status:i,children:t,className:r="",testId:a,size:s="md",variant:n="neutral"})=>{const l=()=>{switch(i){case"success":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300";case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300";case"neutral":return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300";case"purple":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-30 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},o=()=>{switch(s){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}},m=sr(i);return e.jsx("span",{className:`font-medium rounded-md ${l()} ${o()} ${m} ${r}`,"data-testid":a,children:t})};function sr(i){switch(i){case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-20 dark:text-red-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-20 dark:text-yellow-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-20 dark:text-blue-300";case"success":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-20 dark:text-green-300";case"neutral":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}}const nr=({risk:i,className:t="",testId:r="risk-level-badge",showIcon:a=!1})=>{if(!i)return e.jsx(z,{status:"neutral",className:t,testId:r,children:"Unknown"});const s=i.includes("Risk")?i:`${i} Risk`,n=rr(i);return e.jsxs(z,{status:n,className:t,testId:r,children:[a&&or(i)," ",s]})};function or(i){const t=i.toLowerCase();return t.includes("critical")||t.includes("high")?"âš ï¸":t.includes("medium")||t.includes("moderate")?"âš ":t.includes("low")?"â„¹ï¸":t.includes("minimal")||t.includes("none")?"âœ“":"â“"}const $=({category:i,level:t,colorClass:r,textClass:a,className:s="",testId:n})=>{const l=()=>{switch(t){case"None":return"bg-red-100 dark:bg-red-900 dark:bg-opacity-20";case"Low":return"bg-yellow-100 dark:bg-yellow-900 dark:bg-opacity-20";case"Moderate":return"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20";case"High":return"bg-green-100 dark:bg-green-900 dark:bg-opacity-20";case"Very High":return"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20";default:return"bg-gray-100 dark:bg-gray-800"}},o=()=>{switch(t){case"None":return"text-red-800 dark:text-red-300";case"Low":return"text-yellow-800 dark:text-yellow-300";case"Moderate":return"text-blue-800 dark:text-blue-300";case"High":return"text-green-800 dark:text-green-300";case"Very High":return"text-purple-800 dark:text-purple-300";default:return"text-gray-800 dark:text-gray-300"}},m=r||l(),x=a||o();return e.jsxs("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${m} ${x} ${s}`,"data-testid":n,children:[i&&`${i}: `,t]})},q=({title:i,children:t,isLoading:r=!1,loading:a=!1,error:s=null,className:n="",testId:l,errorContent:o,icon:m,actions:x})=>{const p=r||a,h=s?`widget-container-error${l?`-${l}`:""}`:p?`widget-container-loading-container${l?`-${l}`:""}`:`widget-container${l?`-${l}`:""}`,b=`widget-spinner${l?`-${l}`:""}`,g=`test-widget-error${l?`-${l}`:""}`;let y=null;return s!==null&&(y=s instanceof Error?s.message:String(s)),y?e.jsxs("div",{className:`widget-container widget-error border border-red-300 rounded-lg shadow-sm ${n}`,"data-testid":h,children:[e.jsx("div",{className:"widget-header bg-red-50 dark:bg-red-900 dark:bg-opacity-20 px-4 py-3 border-b border-red-200 dark:border-red-800 rounded-t-lg",children:e.jsxs("h3",{className:"text-lg font-medium text-red-800 dark:text-red-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âš ï¸"}),i]})}),e.jsxs("div",{className:"widget-body p-4 bg-white dark:bg-gray-900",children:[e.jsx("div",{className:"text-red-600 dark:text-red-400","data-testid":g,children:y}),o&&e.jsx("div",{children:o})]})]}):e.jsxs("div",{className:`widget-container border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm ${n}`,"data-testid":h,children:[e.jsxs("div",{className:"widget-header bg-gray-50 dark:bg-gray-800 px-4 py-3 border-b border-gray-200 dark:border-gray-700 rounded-t-lg flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-800 dark:text-gray-200 flex items-center",children:[m&&e.jsx("span",{className:"mr-2",children:m}),i]}),x&&e.jsx("div",{className:"widget-actions",children:x})]}),e.jsx("div",{className:`widget-body p-4 bg-white dark:bg-gray-900 rounded-b-lg ${p?"flex items-center justify-center min-h-[100px]":""}`,children:p?e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500","data-testid":b}):t})]})},cr=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,className:a="",testId:s=ht.BUSINESS_IMPACT_WIDGET})=>{const{ciaContentService:n,error:l,isLoading:o}=G(),[m,x]=u.useState("considerations"),p=u.useMemo(()=>{try{if(S(n))return pe(i,t,r);if(typeof n.calculateBusinessImpactLevel=="function"){const c=n.calculateBusinessImpactLevel(i,t,r);return S(c)?pe(i,t,r):c}return pe(i,t,r)}catch(c){return console.error("Error calculating impact level:",c),pe(i,t,r)}},[n,i,t,r]),h=u.useMemo(()=>{try{if(S(n))return O("availability",i);if(typeof n.getBusinessImpact=="function"){const c=n.getBusinessImpact("availability",i);return S(c)?O("availability",i):c}return O("availability",i)}catch(c){return console.error("Error getting availability impact:",c),O("availability",i)}},[n,i]),b=u.useMemo(()=>{try{if(S(n))return O("integrity",t);if(typeof n.getBusinessImpact=="function"){const c=n.getBusinessImpact("integrity",t);return S(c)?O("integrity",t):c}return O("integrity",t)}catch(c){return console.error("Error getting integrity impact:",c),O("integrity",t)}},[n,t]),g=u.useMemo(()=>{try{if(S(n))return O("confidentiality",r);if(typeof n.getBusinessImpact=="function"){const c=n.getBusinessImpact("confidentiality",r);return S(c)?O("confidentiality",r):c}return O("confidentiality",r)}catch(c){return console.error("Error getting confidentiality impact:",c),O("confidentiality",r)}},[n,r]),y=(c,d,C)=>{const M={None:0,Low:1,Moderate:2,High:3,"Very High":4},E=M[c]||0,R=M[d]||0,D=M[C]||0,v=E+R+D;return v<=2?"Low":v<=6?"Moderate":v<=9?"High":"Very High"},N=(c,d)=>{const C={Availability:"â±ï¸",Integrity:"âœ…",Confidentiality:"ðŸ”’",Financial:"ðŸ’°",Operational:"âš™ï¸",Reputational:"ðŸ‘¥",Regulatory:"ðŸ“œ"};return e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg mb-3","data-testid":`${s}-impact-${c.toLowerCase()}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h3",{className:"text-md font-medium flex items-center",children:[e.jsx("span",{className:"mr-2",children:C[c]||"ðŸ“Š"}),c," Impact"]}),d.riskLevel&&e.jsx(nr,{risk:d.riskLevel,testId:`${s}-risk-level`})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:d.description||"No description available"})]},`impact-${c}`)},f=u.useMemo(()=>{const c=ae(i)+ae(t)+ae(r);return[{title:"Implementation Effort",description:`${y(i,t,r)} complexity implementation requiring appropriate planning and resources.`,icon:"âš™ï¸"},{title:"Resource Requirements",description:`Security levels of this tier typically require ${c<3?"minimal resources and can be implemented with existing staff.":c<6?"moderate resources including some specialized expertise.":c<9?"significant resources and dedicated security personnel.":"extensive resources and specialized security expertise."}`,icon:"ðŸ‘¥"},{title:"Maintenance Overhead",description:`Ongoing maintenance will require ${c<3?"minimal effort with basic monitoring.":c<6?"regular attention and periodic reviews.":c<9?"dedicated staff time and routine assessments.":"continuous monitoring and regular reassessment."}`,icon:"ðŸ”§"},{title:"Organizational Impact",description:`These security controls will have ${c<3?"minimal impact on business processes.":c<6?"some impact on business processes requiring minor adjustments.":c<9?"moderate impact on business processes requiring training and adaptation.":"significant impact requiring process redesign and extensive training."}`,icon:"ðŸ¢"}]},[i,t,r]),k=u.useMemo(()=>{const c=ae(i)+ae(t)+ae(r);return[{title:"Risk Reduction",description:`${c<3?"Basic protection against common threats.":c<6?"Moderate risk reduction for most business scenarios.":c<9?"Significant protection against advanced threats.":"Comprehensive protection against sophisticated attacks."}`,icon:"ðŸ›¡ï¸"},{title:"Compliance Coverage",description:`These security controls provide ${c<3?"minimal compliance coverage for basic requirements.":c<6?"moderate compliance coverage for common regulations.":c<9?"substantial compliance coverage for most frameworks.":"comprehensive compliance with stringent regulatory requirements."}`,icon:"âœ…"},{title:"Business Enablement",description:`Security at this level ${c<3?"enables basic business operations with minimal protection.":c<6?"supports standard business functions with adequate protection.":c<9?"enables business growth with strong security assurances.":"provides competitive advantage through superior security posture."}`,icon:"ðŸ“ˆ"},{title:"Customer Trust",description:`This security profile ${c<3?"meets minimal customer expectations.":c<6?"satisfies standard customer security requirements.":c<9?"exceeds typical customer security expectations.":"establishes your organization as a security leader in the industry."}`,icon:"ðŸ¤"}]},[i,t,r]),H=()=>e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-4 mb-4",children:[e.jsxs("div",{className:`p-2 rounded text-center ${Me(r)}`,"data-testid":`${s}-heatmap-confidentiality`,children:[e.jsx("div",{className:"text-xs font-medium",children:"Confidentiality"}),e.jsx("div",{className:"font-bold",children:r})]}),e.jsxs("div",{className:`p-2 rounded text-center ${Me(t)}`,"data-testid":`${s}-heatmap-integrity`,children:[e.jsx("div",{className:"text-xs font-medium",children:"Integrity"}),e.jsx("div",{className:"font-bold",children:t})]}),e.jsxs("div",{className:`p-2 rounded text-center ${Me(i)}`,"data-testid":`${s}-heatmap-availability`,children:[e.jsx("div",{className:"text-xs font-medium",children:"Availability"}),e.jsx("div",{className:"font-bold",children:i})]})]}),w=()=>e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4","data-testid":`${s}-executive-summary`,children:[e.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“Š"}),"Executive Summary"]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Current security posture provides"," ",e.jsx("span",{className:"font-medium",children:p})," protection for business operations. Business impacts are most significant in"," ",lr(h,b,g)," ","areas."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx(Ce,{label:"Overall Impact",value:p,testId:`${s}-overall-impact`,valueClassName:`font-medium ${dr(p)}`}),e.jsx(Ce,{label:"Implementation Complexity",value:y(i,t,r),testId:`${s}-implementation-complexity`}),e.jsx(Ce,{label:"Security Profile",value:i===t&&t===r?i:"Mixed",testId:`${s}-security-profile`})]})]});return e.jsx(q,{title:F.BUSINESS_IMPACT_ANALYSIS,icon:_.BUSINESS_IMPACT_ANALYSIS,className:a,testId:s,isLoading:o,error:l,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Business Impacts by Component"}),g&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Confidentiality Impact"]}),g.reputational&&N("Reputational",g.reputational),g.regulatory&&N("Regulatory",g.regulatory)]}),b&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âœ…"}),"Integrity Impact"]}),b.financial&&N("Financial",b.financial),b.operational&&N("Operational",b.operational)]}),h&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Availability Impact"]}),h.financial&&N("Financial",h.financial),h.operational&&N("Operational",h.operational)]})]}),e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:e.jsx("p",{className:"text-sm",children:w()})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Current Security Levels"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx($,{category:"Confidentiality",level:r,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:`${s}-confidentiality-badge`}),e.jsx($,{category:"Integrity",level:t,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:`${s}-integrity-badge`}),e.jsx($,{category:"Availability",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:`${s}-availability-badge`})]}),H()]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("button",{className:`py-2 px-4 font-medium ${m==="considerations"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>x("considerations"),"data-testid":`${s}-tab-considerations`,children:"Implementation Considerations"}),e.jsx("button",{className:`py-2 px-4 font-medium ${m==="benefits"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,onClick:()=>x("benefits"),"data-testid":`${s}-tab-benefits`,children:"Business Benefits"})]})}),m==="considerations"?e.jsx("div",{className:"grid grid-cols-1 gap-4","data-testid":`${s}-considerations`,children:f.map((c,d)=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":`${s}-consideration-${d}`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:c.icon}),e.jsx("h4",{className:"text-md font-medium",children:c.title})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.description})]},`consideration-${d}`))}):e.jsx("div",{className:"grid grid-cols-1 gap-4","data-testid":`${s}-benefits`,children:k.map((c,d)=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":`${s}-benefit-${d}`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2 text-green-500",children:c.icon}),e.jsx("h4",{className:"text-md font-medium",children:c.title})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:c.description})]},`benefit-${d}`))})]})]})})};function lr(i,t,r){const a=[];return i?.operational?.riskLevel?.includes("High")&&a.push("operational"),i?.financial?.riskLevel?.includes("High")&&a.push("financial"),t?.operational?.riskLevel?.includes("High")&&a.push("operational"),t?.financial?.riskLevel?.includes("High")&&a.push("financial"),r?.reputational?.riskLevel?.includes("High")&&a.push("reputational"),r?.regulatory?.riskLevel?.includes("High")&&a.push("regulatory"),a.length===0?"minimal":a.length===1?a[0]:a.length===2?`${a[0]} and ${a[1]}`:"multiple"}function ae(i){return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[i]||0}function Me(i){switch(i){case"None":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";case"Low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300";case"Moderate":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300";case"High":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:bg-opacity-30 dark:text-orange-300";case"Very High":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}}function dr(i){return i.includes("Low")?"text-green-600 dark:text-green-400":i.includes("Moderate")?"text-yellow-600 dark:text-yellow-400":i.includes("High")?"text-orange-600 dark:text-orange-400":i.includes("Very High")||i.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}function pe(i,t,r){const a={None:0,Low:1,Moderate:2,High:3,"Very High":4},s=a[i]||0,n=a[t]||0,l=a[r]||0,o=(s+n+l)/3;return o<=.5?"Minimal":o<=1.5?"Low":o<=2.5?"Moderate":o<=3.5?"High":"Very High"}function O(i,t){const r=t==="None"||t==="Low";return i==="availability"?{summary:`${t} availability impact on business operations`,operational:{description:`${r?"Significant operational disruptions possible due to limited availability controls":"Operations protected by appropriate availability controls"}`,riskLevel:r?"High Risk":"Low Risk"},financial:{description:`${r?"Potential financial losses due to service disruptions and downtime":"Financial impact minimized through robust availability controls"}`,riskLevel:r?"Medium Risk":"Low Risk"}}:i==="integrity"?{summary:`${t} integrity impact on business operations`,operational:{description:`${r?"Business decisions may be based on inaccurate or corrupted data":"Data accuracy protected by appropriate integrity controls"}`,riskLevel:r?"High Risk":"Low Risk"},financial:{description:`${r?"Financial losses possible due to data errors affecting decision making":"Financial impact minimized through data validation and integrity mechanisms"}`,riskLevel:r?"Medium Risk":"Low Risk"}}:{summary:`${t} confidentiality impact on business operations`,reputational:{description:`${r?"High risk of reputational damage from data exposures or breaches":"Reputation protected by appropriate confidentiality controls"}`,riskLevel:r?"High Risk":"Low Risk"},regulatory:{description:`${r?"Increased risk of non-compliance with data protection regulations":"Regulatory compliance supported by appropriate data protection measures"}`,riskLevel:r?"Medium Risk":"Low Risk"}}}const ur=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,onAvailabilityChange:a,onIntegrityChange:s,onConfidentialityChange:n,className:l="",testId:o="security-level-widget"})=>{const{ciaContentService:m}=G(),[x,p]=u.useState(null),[h,b]=u.useState(!1),[g,y]=u.useState("availability"),[N,f]=u.useState(null),[k,H]=u.useState(null),[w,c]=u.useState(null);u.useEffect(()=>{b(!0);try{if(!m)throw new Error("Content service unavailable");const v=g==="availability"?i:g==="integrity"?t:r,I=m.getComponentDetails(g,v)||{description:"No details available",technical:"No technical information available",businessImpact:"No business impact information available",recommendations:[]};H(I),f(null),p(null)}catch(v){console.error("Error loading component details:",v),f(v instanceof Error?v:new Error("Failed to load component details")),p(v instanceof Error?v:new Error("Service error"))}finally{b(!1)}},[m,g,i,t,r]);const d=u.useCallback(v=>{const I=v.target.value;a&&a(I),c("availability")},[a]),C=u.useCallback(v=>{const I=v.target.value;s&&s(I),c("integrity")},[s]),M=u.useCallback(v=>{const I=v.target.value;n&&n(I),c("confidentiality")},[n]),E=[oe.NONE,oe.LOW,oe.MODERATE,oe.HIGH,oe.VERY_HIGH],R=(v,I)=>{switch(v){case"availability":return I==="None"?"No uptime guarantees":I==="Low"?"~95% uptime, 24-48h recovery":I==="Moderate"?"~99% uptime, 4-8h recovery":I==="High"?"~99.9% uptime, 15-60min recovery":I==="Very High"?"~99.99% uptime, <5min recovery":"";case"integrity":return I==="None"?"No validation controls":I==="Low"?"Manual validation with basic checks":I==="Moderate"?"Automated validation with checks":I==="High"?"Cryptographic verification":I==="Very High"?"Blockchain validation":"";case"confidentiality":return I==="None"?"No access controls":I==="Low"?"Basic access control":I==="Moderate"?"RBAC with encryption":I==="High"?"E2E encryption with MFA":I==="Very High"?"Zero-trust architecture":"";default:return"No details available"}},D=v=>{switch(v){case"availability":return"text-blue-600 dark:text-blue-400";case"integrity":return"text-green-600 dark:text-green-400";case"confidentiality":return"text-purple-600 dark:text-purple-400";default:return"text-gray-600 dark:text-gray-400"}};return e.jsx(q,{title:F.SECURITY_LEVEL,icon:_.SECURITY_LEVEL,className:l,testId:o,children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:e.jsx("p",{className:"text-sm",children:"Configure security levels for each CIA component to set your organization's security posture. Higher levels provide stronger protection but may require more resources to implement."})}),(N||x)&&e.jsxs("div",{className:"p-3 mb-4 bg-red-100 dark:bg-red-900 dark:bg-opacity-20 text-red-800 dark:text-red-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium",children:"Error"}),e.jsx("p",{className:"text-sm",children:"Unable to load component details. Please try again later."})]}),h&&e.jsx("div",{className:"p-3 mb-4 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 text-blue-800 dark:text-blue-200 rounded-lg",children:e.jsx("p",{className:"text-sm",children:"Loading security level details..."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Configure Security Levels"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"security-level-confidentiality",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{htmlFor:"confidentiality-select",className:"text-sm font-medium flex items-center",children:[e.jsx("span",{className:"text-purple-500 dark:text-purple-400 mr-2",children:he.confidentiality}),"Confidentiality"]}),e.jsx($,{category:"",level:r,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:"security-level-widget-confidentiality-badge"})]}),e.jsx("select",{id:"confidentiality-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-purple-400 focus:border-purple-500 focus:ring-2 focus:ring-purple-200",value:r,onChange:M,"data-testid":"confidentiality-select",children:E.map(v=>e.jsx("option",{value:v,children:v},`confidentiality-${v}`))}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":"security-level-widget-confidentiality-summary",children:[r,":"," ",R("confidentiality",r)]}),e.jsx("button",{className:"mt-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors",onClick:()=>y("confidentiality"),"data-testid":"confidentiality-details-button",children:"View details"}),w==="confidentiality"&&e.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":"confidentiality-changed-indicator",children:"âœ“ Security level updated"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"security-level-integrity",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{htmlFor:"integrity-select",className:"text-sm font-medium flex items-center",children:[e.jsx("span",{className:"text-green-500 dark:text-green-400 mr-2",children:he.integrity}),"Integrity"]}),e.jsx($,{category:"",level:t,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:"security-level-widget-integrity-badge"})]}),e.jsx("select",{id:"integrity-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-green-400 focus:border-green-500 focus:ring-2 focus:ring-green-200",value:t,onChange:C,"data-testid":"integrity-select",children:E.map(v=>e.jsx("option",{value:v,children:v},`integrity-${v}`))}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":"security-level-widget-integrity-summary",children:[t,":"," ",R("integrity",t)]}),e.jsx("button",{className:"mt-2 px-2 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600 transition-colors",onClick:()=>y("integrity"),"data-testid":"integrity-details-button",children:"View details"}),w==="integrity"&&e.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":"integrity-changed-indicator",children:"âœ“ Security level updated"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"security-level-availability",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("label",{htmlFor:"availability-select",className:"text-sm font-medium flex items-center",children:[e.jsx("span",{className:"text-blue-500 dark:text-blue-400 mr-2",children:he.availability}),"Availability"]}),e.jsx($,{category:"",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:"security-level-widget-availability-badge"})]}),e.jsx("select",{id:"availability-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-blue-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",value:i,onChange:d,"data-testid":"availability-select",children:E.map(v=>e.jsx("option",{value:v,children:v},`availability-${v}`))}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":"security-level-widget-availability-summary",children:[i,":"," ",R("availability",i)]}),e.jsx("button",{className:"mt-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors",onClick:()=>y("availability"),"data-testid":"availability-details-button",children:"View details"}),w==="availability"&&e.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":"availability-changed-indicator",children:"âœ“ Security level updated"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium mb-4",children:[g.charAt(0).toUpperCase()+g.slice(1)," ","Details"]}),e.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 h-full","data-testid":`${g}-details-content`,children:k?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:`font-medium ${D(g)}`,children:[g==="availability"?i:g==="integrity"?t:r," ","Level"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:k.description||"No description available"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Technical Implementation"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:k.technical||"No technical details available"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Business Impact"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:k.businessImpact||"No business impact details available"})]}),g==="availability"&&e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Uptime"}),e.jsx("div",{className:"text-sm",children:k.uptime||"N/A"})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Time"}),e.jsx("div",{className:"text-sm",children:k.rto||"N/A"})]})]}),g==="integrity"&&k.validationMethod&&e.jsxs("div",{className:"mt-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-green-700 dark:text-green-300",children:"Validation Method"}),e.jsx("div",{className:"text-sm",children:k.validationMethod})]}),g==="confidentiality"&&k.protectionMethod&&e.jsxs("div",{className:"mt-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 p-2 rounded",children:[e.jsx("div",{className:"text-xs font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Protection Method"}),e.jsx("div",{className:"text-sm",children:k.protectionMethod})]})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:e.jsx("p",{children:"No details available for this security level."})})})]})]}),e.jsxs("div",{className:"mt-6 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-md font-medium mb-2",children:"Security Level Overview"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Higher security levels provide stronger protection but typically require more resources to implement and maintain. Consider your organization's needs and constraints when selecting security levels."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-xs",children:[e.jsxs("div",{className:"p-2 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-red-700 dark:text-red-300",children:"None"}),e.jsx("div",{className:"text-red-600 dark:text-red-400",children:"Minimal to no security controls"})]}),e.jsxs("div",{className:"p-2 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Low"}),e.jsx("div",{className:"text-yellow-600 dark:text-yellow-400",children:"Basic security controls"})]}),e.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Moderate"}),e.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:"Standard security controls"})]}),e.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-green-700 dark:text-green-300",children:"High"}),e.jsx("div",{className:"text-green-600 dark:text-green-400",children:"Advanced security controls"})]}),e.jsxs("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[e.jsx("div",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Very High"}),e.jsx("div",{className:"text-purple-600 dark:text-purple-400",children:"Maximum security controls"})]})]})]})]})})};function ce(){return{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"}}function st(){const[i,t]=u.useState(!0),[r,a]=u.useState(null),s=u.useMemo(()=>{const n={None:ce(),Low:ce(),Moderate:ce(),High:ce(),"Very High":ce()};return new Xe({availabilityOptions:n,integrityOptions:n,confidentialityOptions:n,roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"300%",description:"High ROI"},VERY_HIGH:{returnRate:"500%",description:"Very high ROI"}}})},[]);return u.useEffect(()=>{let n=!0;return(async()=>{try{s&&n&&t(!1)}catch(o){console.error("Failed to initialize compliance service:",o),n&&(a(o instanceof Error?o:new Error("An error occurred")),t(!1))}})(),()=>{n=!1}},[s]),{isLoading:i,complianceService:s,error:r}}const mr="modulepreload",gr=function(i,t){return new URL(i,t).href},Ue={},pr=function(t,r,a){let s=Promise.resolve();if(r&&r.length>0){let x=function(p){return Promise.all(p.map(h=>Promise.resolve(h).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};const l=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),m=o?.nonce||o?.getAttribute("nonce");s=x(r.map(p=>{if(p=gr(p,a),p in Ue)return;Ue[p]=!0;const h=p.endsWith(".css"),b=h?'[rel="stylesheet"]':"";if(a)for(let y=l.length-1;y>=0;y--){const N=l[y];if(N.href===p&&(!h||N.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${p}"]${b}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":mr,h||(g.as="script"),g.crossOrigin="",g.href=p,m&&g.setAttribute("nonce",m),document.head.appendChild(g),h)return new Promise((y,N)=>{g.addEventListener("load",y),g.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${p}`)))})}))}function n(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&n(o.reason);return t().catch(n)})},hr=()=>{const[i,t]=u.useState(null),[r,a]=u.useState(null),[s,n]=u.useState(!0),l=u.useCallback(async()=>{try{n(!0),a(null);const{createDefaultDataProvider:o}=await pr(async()=>{const{createDefaultDataProvider:x}=await import("./dataProviders-CFFatKfO.js");return{createDefaultDataProvider:x}},[],import.meta.url),m=o();t(m)}catch(o){console.error("Error initializing CIA data provider:",o),a(o instanceof Error?o:new Error("Failed to initialize data provider")),t(null)}finally{n(!1)}},[]);return u.useEffect(()=>{l()},[l]),{dataProvider:i,error:r,isLoading:s,refreshDataProvider:l}},nt=()=>{const[i,t]=u.useState(null),[r,a]=u.useState(null),[s,n]=u.useState(!0),{dataProvider:l}=hr(),o=u.useCallback(async()=>{try{n(!0),a(null);const m=l?Oe(l):Oe();t(m)}catch(m){console.error("Error initializing security metrics service:",m),a(m instanceof Error?m:new Error("Failed to initialize security metrics service")),t(null)}finally{n(!1)}},[l]);return u.useEffect(()=>{o()},[o]),{securityMetricsService:i,error:r,isLoading:s,refreshService:o}};function ot(i,t,r){const s=Ke(i,t,r).toUpperCase().replace(" ","_");return De[s]||De.MODERATE}const ct=({availabilityLevel:i="None",integrityLevel:t="None",confidentialityLevel:r="None",className:a="",testId:s=me.RADAR_CHART})=>{const n=u.useRef(null),l=u.useRef(null),[o,m]=u.useState(null),[x,p]=u.useState(document.documentElement.classList.contains("dark")),[h]=u.useState({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r}),b=y=>{switch(y){case"None":return 0;case"Basic":case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4;default:return 0}};u.useEffect(()=>{const y=new MutationObserver(N=>{N.forEach(f=>{if(f.attributeName==="class"&&f.target===document.documentElement){const k=document.documentElement.classList.contains("dark");k!==x&&p(k)}})});return y.observe(document.documentElement,{attributes:!0}),()=>y.disconnect()},[x]),u.useEffect(()=>{if(n.current)try{l.current&&l.current.destroy();const y=n.current?.getContext("2d");if(!y){m("Could not get canvas context");return}const N=b(i),f=b(t),k=b(r),H=x?"rgba(0, 204, 102, 0.2)":"rgba(0, 102, 51, 0.2)",w=x?"#00cc66":"#006633",c=x?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",d=x?"#f0f0f0":"#222222";l.current=new ut(y,{type:"radar",data:{labels:["Availability","Integrity","Confidentiality"],datasets:[{label:"Security Profile",data:[N,f,k],backgroundColor:H,borderColor:w,borderWidth:2,pointBackgroundColor:w,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:w}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{r:{angleLines:{color:c},grid:{color:c},pointLabels:{color:d,font:{size:12}},min:0,max:4,ticks:{backdropColor:"transparent",color:d,z:100,stepSize:1,font:{size:10},callback:function(M){return["None","Basic","Moderate","High","Very High"][M]||""}},beginAtZero:!0}},plugins:{legend:{display:!1,labels:{color:x?"#00cc66":"#006633",font:{family:"'Share Tech Mono', monospace",size:12},boxWidth:15,boxHeight:2}},tooltip:{callbacks:{label:function(M){const E=["None","Basic","Moderate","High","Very High"],R=M.raw;return`${M.label}: ${E[R]||""}`}}}}}});const C=()=>{l.current&&l.current.resize()};return window.addEventListener("resize",C),()=>{window.removeEventListener("resize",C),l.current&&l.current.destroy()}}catch(y){m(y instanceof Error?y.message:String(y))}},[i,t,r,x]);const g=a?`radar-chart-container ${a}`.trim():"radar-chart-container";return e.jsxs("div",{className:g,"data-testid":`${s}-container`,children:[o?e.jsxs("div",{"data-testid":`${s}-error`,className:"error-message",children:["Error loading chart: ",o]}):e.jsxs("div",{className:"radar-values flex justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Availability:"})," ",e.jsx("span",{"data-testid":me.RADAR_AVAILABILITY_VALUE,children:i||"None"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Integrity:"})," ",e.jsx("span",{"data-testid":me.RADAR_INTEGRITY_VALUE,children:t||"None"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Confidentiality:"})," ",e.jsx("span",{"data-testid":me.RADAR_CONFIDENTIALITY_VALUE,children:r||"None"})]})]}),e.jsx("canvas",{ref:n,"data-testid":s})]})},Q=({level:i,size:t="md",className:r="",testId:a})=>{const s=()=>{switch(i){case"None":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-20 dark:text-red-300";case"Low":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-20 dark:text-yellow-300";case"Moderate":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-20 dark:text-blue-300";case"High":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-20 dark:text-green-300";case"Very High":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},n=()=>{switch(t){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}};return e.jsx("span",{className:`font-medium rounded-md ${s()} ${n()} ${r}`,"data-testid":a,children:i})},xr=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,className:a="",testId:s=ge.WIDGET})=>{const[n,l]=u.useState("overview"),{ciaContentService:o,error:m,isLoading:x}=G(),{error:p,isLoading:h}=nt(),{complianceService:b,error:g,isLoading:y}=st(),N=x||h||y,f=m||p||g,k=u.useMemo(()=>Ke(i,t,r),[i,t,r]),H=u.useMemo(()=>kt(k),[k]),w=u.useMemo(()=>{const j=T(i),V=T(t),ve=T(r),ke=j+V+ve;return Math.round(ke/12*100)},[i,t,r]),c=u.useMemo(()=>w>=80?"Low Risk":w>=60?"Medium Risk":w>=40?"High Risk":"Critical Risk",[w]),d=u.useMemo(()=>{if(!S(o))try{if(typeof o.getSecurityClassification=="function"){const j=o.getSecurityClassification(k);if(!S(j))return j}}catch(j){console.error("Error fetching security classification:",j)}switch(k){case"None":return"Minimal Security";case"Low":return"Basic Security";case"Moderate":return"Standard Security";case"High":return"Enhanced Security";case"Very High":return"Maximum Security";default:return"Unknown Security Level"}},[o,k]),C=u.useMemo(()=>{if(!S(o)&&typeof o.getInformationSensitivity=="function")try{const j=o.getInformationSensitivity(r);if(!S(j))return j}catch(j){console.error("Error fetching information sensitivity:",j)}switch(r){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Confidential Data";case"High":return"Restricted Data";case"Very High":return"Classified Data";default:return"Unclassified Data"}},[o,r]),M=u.useMemo(()=>{if(!S(o)&&typeof o.getImplementationComplexity=="function")try{const ue=o.getImplementationComplexity(i,t,r);if(!S(ue))return ue}catch(ue){console.error("Error fetching implementation complexity:",ue)}const j={None:0,Low:1,Moderate:2,High:3,"Very High":4},V=j[i]||0,ve=j[t]||0,ke=j[r]||0,de=V+ve+ke;return de<=3?"Low":de<=6?"Moderate":de<=9?"High":"Very High"},[o,i,t,r]),E=j=>{const V=j.toLowerCase();return V==="none"?"error":V==="low"?"warning":V==="moderate"?"info":V==="high"?"success":V==="very high"?"purple":"neutral"},R=u.useMemo(()=>{try{if(S(b))return null;const j=b.getComplianceStatus?.(i,t,r);return j?{...j,compliantFrameworks:j.compliantFrameworks||[],partiallyCompliantFrameworks:j.partiallyCompliantFrameworks||[],nonCompliantFrameworks:j.nonCompliantFrameworks||[]}:null}catch(j){return console.error("Error fetching compliance status:",j),null}},[b,i,t,r]),D=j=>j.includes("Low")?"text-green-600 dark:text-green-400":j.includes("Medium")?"text-yellow-600 dark:text-yellow-400":j.includes("High")?"text-orange-600 dark:text-orange-400":j.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400",v=()=>{try{if(!S(o)&&typeof o.getImplementationTime=="function"){const j=o.getImplementationTime(i,t,r);if(!S(j))return j}}catch(j){console.error("Error fetching implementation time:",j)}return w>=80?"3-6 months":w>=60?"2-4 months":w>=40?"1-2 months":"2-4 weeks"},I=()=>{try{if(!S(o)&&typeof o.getRequiredResources=="function"){const j=o.getRequiredResources(i,t,r);if(!S(j))return j}}catch(j){console.error("Error fetching resource requirements:",j)}return w>=80?"Specialized Team":w>=60?"Dedicated Team":w>=40?"Small Team":"Individual Effort"},B=u.useMemo(()=>w>=80?"Strategic":w>=60?"Advanced":w>=40?"Standard":"Basic",[w]),te=u.useMemo(()=>{switch(B){case"Strategic":return"Enables competitive advantage and innovation";case"Advanced":return"Supports business growth and trusted partnerships";case"Standard":return"Maintains core business operations securely";case"Basic":return"Enables fundamental business activities";default:return"Unknown business maturity level"}},[B]),le=()=>{try{return ot(i,t,r).value??"N/A"}catch(j){return console.error("Error calculating ROI estimate:",j),"N/A"}},re=u.useMemo(()=>Te(i,t,r,"medium","general"),[i,t,r]),{totalCapex:U,totalOpex:X}=Te(i,t,r,"medium","general");return e.jsx(q,{title:F.SECURITY_SUMMARY,icon:_.SECURITY_SUMMARY,className:a,testId:s,isLoading:N,error:f,children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border-l-4 border-blue-500 dark:border-blue-400 shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-full bg-blue-500 dark:bg-blue-400 pulse-dot"}),d]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:H})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Security Score"}),e.jsxs("div",{className:"font-bold text-xl text-blue-600 dark:text-blue-400",children:[w,"%"]}),e.jsx("div",{className:`text-sm font-medium ${D(c)}`,"data-testid":`${s}-risk-level`,children:c})]})]})}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:e.jsx("nav",{className:"flex flex-wrap -mb-px gap-2","aria-label":"Security Summary Tabs",children:[{id:"overview",label:"Overview"},{id:"business",label:"Business Value"},{id:"implementation",label:"Implementation"},{id:"compliance",label:"Compliance"}].map(j=>e.jsx("button",{className:`py-2 px-4 text-sm font-medium border-b-2 transition-colors duration-200 ${n===j.id?"border-blue-500 text-blue-600 dark:text-blue-400 dark:border-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 hover:border-gray-300"}`,onClick:()=>l(j.id),"data-testid":`${s}-tab-${j.id}`,"aria-selected":n===j.id,role:"tab",children:j.label},j.id))})}),e.jsxs("div",{className:"tab-content",children:[n==="overview"&&e.jsxs("div",{"data-testid":`${s}-content-overview`,className:"space-y-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Security Profile"}),e.jsx("div",{className:"h-[300px]",children:e.jsx(ct,{availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,testId:`${s}-radar-chart`})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Security Components"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800","data-testid":ge.CONFIDENTIALITY_CARD,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-2 text-purple-500 dark:text-purple-400",children:"ðŸ”’"}),e.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Confidentiality"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(Q,{level:r}),e.jsx(z,{status:E(ie(r)),size:"sm",children:ie(r)})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Classification:"," ",e.jsx("span",{className:"font-medium",children:C})]})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800","data-testid":ge.INTEGRITY_CARD,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-2 text-green-500 dark:text-green-400",children:"âœ“"}),e.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Integrity"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(Q,{level:t}),e.jsx(z,{status:E(ie(t)),size:"sm",children:ie(t)})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Validation Level:"," ",e.jsx("span",{className:"font-medium",children:t==="None"?"Unverified":t==="Low"?"Basic Validation":t==="Moderate"?"Validated":t==="High"?"Strongly Validated":"Formally Verified"})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800","data-testid":ge.AVAILABILITY_CARD,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-2 text-blue-500 dark:text-blue-400",children:"â±ï¸"}),e.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Availability"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx(Q,{level:i}),e.jsx(z,{status:E(ie(i)),size:"sm",children:ie(i)})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Uptime Target:"," ",e.jsx("span",{className:"font-medium",children:i==="None"?"No guarantee":i==="Low"?"95%":i==="Moderate"?"99%":i==="High"?"99.9%":"99.999%"})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Key Security Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Implementation Complexity"}),e.jsx("div",{className:"text-lg font-bold",children:M}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Based on combined security levels"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Business Maturity"}),e.jsx("div",{className:"text-lg font-bold",children:B}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:te})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Compliance Status"}),e.jsxs("div",{className:"text-lg font-bold",children:[R?.complianceScore||w,"%"]}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Overall compliance alignment"})]})]})]})]}),n==="business"&&e.jsxs("div",{"data-testid":`${s}-content-business`,className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:e.jsx("p",{className:"text-sm",children:"This section summarizes the business value and financial impact of your selected security levels, helping justify security investments to stakeholders."})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Business Value Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Business Maturity Level"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:B}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1",children:te})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Estimated ROI"}),e.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400 mt-2",children:le()}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:w>=80?"Strong return from security investments":w>=60?"Good return from security investments":w>=40?"Basic return, primarily risk avoidance":"Minimal return on investment"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Cost Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Implementation Cost"}),e.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:re.totalCapex}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"One-time investment"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Operational Cost"}),e.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:re.totalOpex}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Annual expense"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Total First-Year Cost"}),e.jsx("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:re.totalCost}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Combined implementation and operational costs"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Business Enablement"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Business Capabilities"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1 text-sm",children:w>=80?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Enables digital transformation initiatives"}),e.jsx("li",{children:"Supports secure cloud adoption"}),e.jsx("li",{children:"Facilitates secure partner integrations"}),e.jsx("li",{children:"Provides competitive advantage through security as a value"})]}):w>=60?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Supports most digital business initiatives"}),e.jsx("li",{children:"Enables secure customer data handling"}),e.jsx("li",{children:"Allows controlled partner access"}),e.jsx("li",{children:"Meets most customer security requirements"})]}):w>=40?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Supports basic business operations"}),e.jsx("li",{children:"Enables limited partner interactions"}),e.jsx("li",{children:"Meets minimum customer expectations"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Limited security capabilities"}),e.jsx("li",{children:"May restrict business opportunities"}),e.jsx("li",{children:"Potential compliance limitations"})]})})]})})]})]}),n==="implementation"&&e.jsxs("div",{"data-testid":`${s}-content-implementation`,className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:e.jsx("p",{className:"text-sm",children:"This section summarizes implementation requirements for your selected security levels, helping plan resources, timelines, and technical approaches."})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Implementation Overview"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium",children:"Implementation Complexity:"}),e.jsx("div",{className:"font-medium",children:M})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${M==="Low"?"w-1/4 bg-green-500":M==="Moderate"?"w-2/4 bg-yellow-500":M==="High"?"w-3/4 bg-orange-500":"w-full bg-red-500"}`})}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:M==="Low"?"Basic security controls with straightforward implementation":M==="Moderate"?"Standard security measures with moderate implementation effort":M==="High"?"Advanced security controls requiring significant implementation effort":"Comprehensive security framework requiring extensive resources"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Estimated Implementation Time"}),e.jsx("div",{className:"text-lg font-bold",children:v()}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Typical project timeline"})]}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Required Resources"}),e.jsx("div",{className:"text-lg font-bold",children:I()}),e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Resource allocation recommendation"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Component Implementation Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[e.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Confidentiality Implementation"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r==="None"?"No data protection controls needed":r==="Low"?"Basic access controls and authentication":r==="Moderate"?"Role-based access and encryption for sensitive data":r==="High"?"Comprehensive encryption and access controls":"Maximum protection with advanced encryption and zero-trust"}),e.jsxs("div",{className:"mt-2 text-xs font-medium text-purple-700 dark:text-purple-300",children:["Level: ",r]})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800",children:[e.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300 mb-2",children:"Integrity Implementation"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t==="None"?"No data validation controls needed":t==="Low"?"Basic input validation and error checking":t==="Moderate"?"Data validation and cryptographic checksums":t==="High"?"Digital signatures and strong validation":"Formal verification and immutable audit trails"}),e.jsxs("div",{className:"mt-2 text-xs font-medium text-green-700 dark:text-green-300",children:["Level: ",t]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Availability Implementation"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:i==="None"?"No uptime guarantees or redundancy":i==="Low"?"Basic backup and recovery procedures":i==="Moderate"?"Redundant components and standard backups":i==="High"?"High availability clustering and failover":"Multi-site redundancy and continuous availability"}),e.jsxs("div",{className:"mt-2 text-xs font-medium text-blue-700 dark:text-blue-300",children:["Level: ",i]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Implementation Considerations"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Success Factors"}),e.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm",children:[e.jsx("li",{children:"Executive sponsorship and support"}),e.jsx("li",{children:"Clear security requirements definition"}),e.jsx("li",{children:"Adequate resource allocation"}),e.jsx("li",{children:"Proper testing and validation"}),e.jsx("li",{children:"Staff training and awareness"})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Key Challenges"}),e.jsxs("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm",children:[e.jsx("li",{children:"Balancing security with usability"}),e.jsx("li",{children:"Integration with existing systems"}),e.jsx("li",{children:"Managing scope and expectations"}),e.jsx("li",{children:"Maintaining consistent controls"}),e.jsx("li",{children:"Securing necessary expertise"})]})]})]})]})]}),n==="compliance"&&e.jsxs("div",{"data-testid":`${s}-content-compliance`,className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:e.jsx("p",{className:"text-sm",children:"This section summarizes your compliance status based on selected security levels, highlighting alignment with regulatory frameworks and standards."})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Compliance Status Overview"}),R?e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:"Compliance Score"}),e.jsxs("span",{className:"text-xl font-bold",children:[R.complianceScore,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5 mb-2",children:e.jsx("div",{className:`h-2.5 rounded-full ${(R.complianceScore||0)>=80?"bg-green-500":(R.complianceScore||0)>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${R.complianceScore||0}%`}})}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:R.status||((R.complianceScore||0)>=80?"Strong compliance position":(R.complianceScore||0)>=50?"Moderate compliance position":"Compliance gaps detected")})]}):e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:"Compliance Score"}),e.jsxs("span",{className:"text-xl font-bold",children:[w,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2.5 mb-2",children:e.jsx("div",{className:`h-2.5 rounded-full ${w>=80?"bg-green-500":w>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${w}%`}})}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:w>=80?"Strong compliance position":w>=50?"Moderate compliance position":"Compliance gaps detected"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Framework Compliance Status"}),R?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-green-700 dark:text-green-300 flex items-center justify-between",children:[e.jsx("span",{children:"Compliant"}),e.jsx("span",{className:"text-sm bg-green-100 dark:bg-green-800 px-2 py-0.5 rounded-full",children:R.compliantFrameworks.length})]}),R.compliantFrameworks.length>0?e.jsx("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:R.compliantFrameworks.map((j,V)=>e.jsx("li",{children:j},`compliant-${V}`))}):e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 italic",children:"No fully compliant frameworks"})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300 flex items-center justify-between",children:[e.jsx("span",{children:"Partially Compliant"}),e.jsx("span",{className:"text-sm bg-yellow-100 dark:bg-yellow-800 px-2 py-0.5 rounded-full",children:R.partiallyCompliantFrameworks.length})]}),R.partiallyCompliantFrameworks.length>0?e.jsx("ul",{className:"mt-2 space-y-1 list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:R.partiallyCompliantFrameworks.map((j,V)=>e.jsx("li",{children:j},`partial-${V}`))}):e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 italic",children:"No partially compliant frameworks"})]})]}):e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"Detailed compliance information is not available."})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Component Compliance Requirements"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[e.jsx("h5",{className:"text-sm font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Confidentiality"}),e.jsxs("p",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Level:"})," ",r]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:r==="None"?"Not sufficient for most compliance frameworks":r==="Low"?"Meets basic compliance requirements":r==="Moderate"?"Satisfies most regulatory requirements":r==="High"?"Meets stringent compliance standards":"Exceeds most compliance requirements"})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[e.jsx("h5",{className:"text-sm font-medium mb-1 text-green-700 dark:text-green-300",children:"Integrity"}),e.jsxs("p",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Level:"})," ",t]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:t==="None"?"Not sufficient for most compliance frameworks":t==="Low"?"Meets basic compliance requirements":t==="Moderate"?"Satisfies most regulatory requirements":t==="High"?"Meets stringent compliance standards":"Exceeds most compliance requirements"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[e.jsx("h5",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Availability"}),e.jsxs("p",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Level:"})," ",i]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:i==="None"?"Not sufficient for most compliance frameworks":i==="Low"?"Meets basic compliance requirements":i==="Moderate"?"Satisfies most regulatory requirements":i==="High"?"Meets stringent compliance standards":"Exceeds most compliance requirements"})]})]})]})]})]})]})})},yr=i=>i>=80?"success":i>=50?"warning":"error",br=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,industry:a,region:s,className:n="",testId:l=L.WIDGET})=>{const{complianceService:o,error:m,isLoading:x}=st(),[p,h]=u.useState(null),b=u.useMemo(()=>{const c={None:0,Low:1,Moderate:2,High:3,"Very High":4},d=Math.min(c[i],c[t],c[r]);return["None","Low","Moderate","High","Very High"].find((M,E)=>E===d)||"Moderate"},[i,t,r]),g=u.useMemo(()=>{if(x||m||!o)return null;try{return o.getComplianceStatus(i,t,r)}catch(c){return console.error("Error getting compliance status:",c),null}},[o,i,t,r,a,s,x,m]),y=u.useCallback(()=>{if(x)return"Loading compliance status...";if(m)return"Error loading compliance status";if(!g)return"Unable to determine compliance status";try{if(o?.getComplianceStatusText){const c=o.getComplianceStatusText(i,t,r);if(!S(c))return c}return g.status?g.status:`Based on ${b} security level`}catch(c){return console.error("Error getting compliance status text:",c),"Unable to determine compliance status"}},[o,g,i,t,r,b,x,m]),N=u.useCallback(c=>g?g.compliantFrameworks.includes(c)?"success":g.partiallyCompliantFrameworks.includes(c)?"warning":"error":"neutral",[g]),f=u.useMemo(()=>y(),[y]),k=u.useMemo(()=>{if(x||m||!o||!p)return null;try{return o.getComplianceGapAnalysis(i,t,r,p)}catch(c){return console.error("Error getting gap analysis:",c),null}},[o,p,i,t,r,x,m]),H=u.useCallback((c,d)=>{if(o?.getFrameworkRequiredLevel)try{return o.getFrameworkRequiredLevel(c,d)}catch(M){console.error(`Error getting required level for ${c}:`,M)}return{"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},GDPR:{availability:"Moderate",integrity:"High",confidentiality:"High"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"SOC 2":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"}}[c]?.[d]||"Moderate"},[o]),w=u.useCallback(c=>{if(!o)return`${c} requirements`;try{return typeof o.getFrameworkDescription=="function"?o.getFrameworkDescription(c)||`${c} requirements`:`${c} requirements`}catch(d){return console.error(`Error getting description for ${c}:`,d),`${c} requirements`}},[o]);return e.jsx(q,{title:F.COMPLIANCE_STATUS,icon:_.COMPLIANCE_STATUS,className:n,testId:l,isLoading:x,error:m,children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:e.jsx("p",{className:"text-sm",children:"This widget shows your compliance status with various regulatory frameworks and industry standards based on your selected security levels."})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Overall Compliance Status"}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":L.COMPLIANCE_STATUS_SUMMARY,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-2xl mr-2 text-blue-500",children:mt.compliance}),e.jsx("span",{className:"font-medium",children:"Compliance Status"})]}),e.jsx(z,{status:yr(g?.complianceScore??0),testId:L.COMPLIANCE_STATUS_BADGE,children:f})]}),g&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Compliance Score"}),e.jsxs("span",{className:"font-bold","data-testid":L.COMPLIANCE_SCORE,children:[g.complianceScore??0,"%"]})]}),e.jsx("div",{className:"relative pt-1",children:e.jsx("div",{className:"overflow-hidden h-2 mb-2 text-xs flex rounded bg-blue-200 dark:bg-blue-900",children:e.jsx("div",{style:{width:`${g.complianceScore??0}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500 dark:bg-blue-600","data-testid":L.COMPLIANCE_SCORE_BAR})})})]})]})]}),g&&g.compliantFrameworks.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Compliant Frameworks"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3","data-testid":L.COMPLIANT_FRAMEWORKS_LIST,children:g.compliantFrameworks.map((c,d)=>e.jsxs("div",{className:`p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-200 dark:border-green-800 cursor-pointer ${p===c?"ring-2 ring-green-500 dark:ring-green-400":""}`,onClick:()=>h(c),"data-testid":`${L.FRAMEWORK_ITEM_PREFIX}-${d}`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:c}),e.jsx(z,{status:N(c),testId:`framework-status-badge-${d}`,children:"Compliant"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:w(c)})]},c))})]}),g&&g.partiallyCompliantFrameworks.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Partially Compliant Frameworks"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3","data-testid":L.PARTIALLY_COMPLIANT_FRAMEWORKS_LIST,children:g.partiallyCompliantFrameworks.map((c,d)=>e.jsxs("div",{className:`p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg border border-yellow-200 dark:border-yellow-800 cursor-pointer ${p===c?"ring-2 ring-yellow-500 dark:ring-yellow-400":""}`,onClick:()=>h(c),"data-testid":`${L.FRAMEWORK_ITEM_PREFIX}-partial-${d}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"font-medium",children:c}),e.jsx(z,{status:N(c),testId:`framework-partial-status-badge-${d}`,children:"Partially Compliant"})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:w(c)})]},c))})]}),g&&g.nonCompliantFrameworks.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Non-Compliant Frameworks"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3","data-testid":L.NON_COMPLIANT_FRAMEWORKS_LIST,children:g.nonCompliantFrameworks.map((c,d)=>e.jsxs("div",{className:`p-3 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded-lg border border-red-200 dark:border-red-800 cursor-pointer ${p===c?"ring-2 ring-red-500 dark:ring-red-400":""}`,onClick:()=>h(c),"data-testid":`${L.FRAMEWORK_ITEM_PREFIX}-non-${d}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"font-medium",children:c}),e.jsx(z,{status:N(c),testId:`framework-non-status-badge-${d}`,children:"Non-Compliant"})]}),e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:w(c)})]},c))})]}),p&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h3",{className:"text-lg font-medium mb-2",children:[p," Gap Analysis"]}),e.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":L.FRAMEWORK_GAP_ANALYSIS,children:k?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"font-medium mb-1",children:"Status"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:k.isCompliant?`Your security controls meet the requirements for ${p}.`:`Your security controls do not fully meet the requirements for ${p}.`})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"font-medium mb-1",children:"Component Requirements"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mt-2",children:["availability","integrity","confidentiality"].map(c=>{const d=c,C=d==="availability"?i:d==="integrity"?t:r,M=H(p,d),E=ze(C)>=ze(M);return e.jsxs("div",{className:`p-2 rounded-lg ${E?"bg-green-50 dark:bg-green-900 dark:bg-opacity-20":"bg-red-50 dark:bg-red-900 dark:bg-opacity-20"}`,children:[e.jsx("div",{className:"text-xs font-medium mb-1",children:d.charAt(0).toUpperCase()+d.slice(1)}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["Current:"," ",e.jsx("span",{className:"font-medium",children:C})]}),e.jsxs("span",{children:["Required:"," ",e.jsx("span",{className:"font-medium",children:M})]})]}),e.jsx("div",{className:"mt-1 text-xs text-right",children:e.jsx(z,{status:E?"success":"error",testId:`${c}-requirement-status`,children:E?"Meeting":"Not Meeting"})})]},c)})})]}),k.gaps&&k.gaps.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h4",{className:"font-medium mb-1",children:"Compliance Gaps"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:k.gaps.map((c,d)=>e.jsx("li",{children:typeof c=="string"?c:c.framework||c.frameworkDescription||"Undefined compliance gap"},d))})]}),k.recommendations&&k.recommendations.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-1",children:"Recommendations"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:k.recommendations.map((c,d)=>e.jsx("li",{children:c},d))})]})]}):e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-6","data-testid":L.NO_GAP_ANALYSIS,children:"No gap analysis available for this framework."})})]}),e.jsxs("div",{className:"mt-6 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-blue-500 dark:text-blue-400 mr-2",children:"ðŸ’¡"}),e.jsx("h3",{className:"font-medium",children:"Compliance Tips"})]}),e.jsx("ul",{className:"text-sm space-y-1 list-disc list-inside text-gray-600 dark:text-gray-400","data-testid":L.COMPLIANCE_TIPS_LIST,children:g&&g.complianceScore?g.complianceScore<50?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Focus on implementing foundational security controls"}),e.jsx("li",{children:"Prioritize controls that address multiple compliance frameworks"}),e.jsx("li",{children:"Consider engaging a compliance specialist to create a roadmap"})]}):g.complianceScore<80?e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Address specific gaps in partially compliant frameworks"}),e.jsx("li",{children:"Implement regular compliance monitoring and validation"}),e.jsx("li",{children:"Document your compliance controls and processes"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Maintain your strong compliance posture with regular reviews"}),e.jsx("li",{children:"Prepare for upcoming regulatory changes and new frameworks"}),e.jsx("li",{children:"Consider compliance certification to showcase your capabilities"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"Implement controls across all CIA components for balanced compliance"}),e.jsx("li",{children:"Start with the frameworks most relevant to your industry"}),e.jsx("li",{children:"Document your security controls to demonstrate compliance"})]})})]})]})})};function ze(i){return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[i]||0}const fr=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,className:a="",testId:s="cost-estimation-widget"})=>{const{ciaContentService:n,error:l,isLoading:o}=G(),{totalCapex:m,totalOpex:x,totalCost:p,availabilityCost:h,integrityCost:b,confidentialityCost:g}=u.useMemo(()=>Te(i,t,r),[i,t,r]),y=u.useMemo(()=>ye(i,t,r),[i,t,r]),N=u.useMemo(()=>{const d={None:.1,Low:.25,Moderate:.5,High:1,"Very High":2},C=d[i]||.5,M=d[t]||.5,E=d[r]||.5,D=Math.max(C,M,E),v=Number((D*.6).toFixed(1));return{implementation:D,maintenance:v,total:Number((D+v).toFixed(1))}},[i,t,r]),f=(d,C)=>{try{if(S(n))return Re(d,C);const M=n.getComponentDetails(d,C);if(!S(M)){const E=M;if(xe(E.expertiseRequired))return E.expertiseRequired;if(tt(E.expertiseRequired))return[E.expertiseRequired]}return Re(d,C)}catch(M){return console.error(`Error getting expertise for ${d}:`,M),Re(d,C)}},k=u.useMemo(()=>{const d=[{type:"availability",level:i},{type:"integrity",level:t},{type:"confidentiality",level:r}].sort((C,M)=>T(M.level)-T(C.level))[0];return f(d.type,d.level)},[i,t,r]),H=u.useMemo(()=>({Low:25,Moderate:50,High:75,"Very High":100})[y]||0,[y]),w=u.useMemo(()=>{const d=h.capex+h.opex+b.capex+b.opex+g.capex+g.opex;return{availability:d>0?((h.capex+h.opex)/d*100).toFixed(0):"0",integrity:d>0?((b.capex+b.opex)/d*100).toFixed(0):"0",confidentiality:d>0?((g.capex+g.opex)/d*100).toFixed(0):"0"}},[h,b,g]),c=u.useMemo(()=>{const d=m+x;return{capex:d>0?(m/d*100).toFixed(0):"0",opex:d>0?(x/d*100).toFixed(0):"0"}},[m,x]);return e.jsx(q,{title:F.COST_ESTIMATION,icon:_.COST_ESTIMATION,className:a,testId:s,isLoading:o,error:l,children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:e.jsx("p",{className:"text-sm",children:"This widget provides cost estimates for implementing and maintaining security controls based on your selected security levels across the CIA triad."})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"ðŸ’¼"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Implementation Cost"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:P(m)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:"One-time capital expenditure"})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2 text-green-500",children:"ðŸ”„"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Annual Operations"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:P(x)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Yearly operational expenses"})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2 text-purple-500",children:"ðŸ’²"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total First Year Cost"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:P(p)}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Implementation + first year operations"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Cost Breakdown"}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("div",{className:"text-sm font-medium",children:"CAPEX"}),e.jsx("div",{className:"text-sm font-medium",children:"OPEX"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2",children:e.jsx("div",{className:"h-3 bg-blue-500 rounded-l-full",style:{width:`${c.capex}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{children:[c.capex,"% (",P(m),")"]}),e.jsxs("div",{children:[c.opex,"% (",P(x),")"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Implementation Complexity"}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:y}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mt-2",children:e.jsx("div",{className:"h-2.5 bg-purple-500 dark:bg-purple-600 rounded-full",style:{width:`${H}%`}})})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:"Based on combined complexity across CIA components"})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-md font-medium mb-3",children:"Personnel Requirements"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Implementation Team"}),e.jsxs("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:[N.implementation," FTE"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ongoing Maintenance"}),e.jsxs("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:[N.maintenance," FTE"]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Annual Personnel Cost"}),e.jsx("div",{className:"text-lg font-bold",children:P(N.total*12e4)})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Cost by Security Component"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"font-medium text-purple-800 dark:text-purple-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Confidentiality"]}),e.jsx($,{category:"",level:r,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:`${s}-conf-level`})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-md font-bold text-purple-600 dark:text-purple-400",children:P(g.capex+g.opex)}),e.jsxs("div",{className:"text-sm bg-purple-100 dark:bg-purple-900 dark:bg-opacity-30 px-2 py-1 rounded",children:[w.confidentiality,"% of total"]})]}),e.jsxs("div",{className:"text-xs mt-2 text-gray-600 dark:text-gray-400 flex justify-between",children:[e.jsxs("span",{children:["CAPEX: ",P(g.capex)]}),e.jsxs("span",{children:["OPEX: ",P(g.opex)]})]})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"font-medium text-green-800 dark:text-green-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âœ“"}),"Integrity"]}),e.jsx($,{category:"",level:t,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:`${s}-int-level`})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-md font-bold text-green-600 dark:text-green-400",children:P(b.capex+b.opex)}),e.jsxs("div",{className:"text-sm bg-green-100 dark:bg-green-900 dark:bg-opacity-30 px-2 py-1 rounded",children:[w.integrity,"% of total"]})]}),e.jsxs("div",{className:"text-xs mt-2 text-gray-600 dark:text-gray-400 flex justify-between",children:[e.jsxs("span",{children:["CAPEX: ",P(b.capex)]}),e.jsxs("span",{children:["OPEX: ",P(b.opex)]})]})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"font-medium text-blue-800 dark:text-blue-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Availability"]}),e.jsx($,{category:"",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:`${s}-avail-level`})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-md font-bold text-blue-600 dark:text-blue-400",children:P(h.capex+h.opex)}),e.jsxs("div",{className:"text-sm bg-blue-100 dark:bg-blue-900 dark:bg-opacity-30 px-2 py-1 rounded",children:[w.availability,"% of total"]})]}),e.jsxs("div",{className:"text-xs mt-2 text-gray-600 dark:text-gray-400 flex justify-between",children:[e.jsxs("span",{children:["CAPEX: ",P(h.capex)]}),e.jsxs("span",{children:["OPEX: ",P(h.opex)]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Expertise Required"}),e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:k.map((d,C)=>e.jsxs("li",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),e.jsx("span",{children:d})]},`expertise-${C}`))})})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Cost Notes"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400 pl-2",children:[e.jsx("li",{children:"Estimates are based on industry averages for the selected security levels"}),e.jsx("li",{children:"Actual costs may vary based on your organization's size and industry"}),e.jsx("li",{children:"FTE calculations assume an average annual cost of $120,000 per full-time employee"}),e.jsx("li",{children:"Consider consulting with security professionals for more accurate cost projections"})]})]})]})})};function Re(i,t){if(i==="confidentiality")switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic security knowledge","Access control fundamentals"];case"Moderate":return["Identity management","Encryption technologies","Authentication systems"];case"High":return["Advanced cryptography","Identity and access management","Security architecture","Data protection"];case"Very High":return["Security architecture","Advanced cryptography","Zero-trust implementation","Data protection specialization","Hardware security"];default:return["General security knowledge"]}if(i==="integrity")switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic data validation","Error handling"];case"Moderate":return["Data validation techniques","Database integrity","Error handling"];case"High":return["Cryptographic verification","Digital signatures","Secure logging","Change management"];case"Very High":return["Advanced cryptography","Formal verification","Distributed ledger technologies","Immutable logging systems"];default:return["Data integrity fundamentals"]}switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic system monitoring","Manual recovery procedures"];case"Moderate":return["System redundancy","Backup management","Basic load balancing"];case"High":return["High availability architecture","Disaster recovery","Advanced monitoring","Automated failover"];case"Very High":return["Distributed systems","Site reliability engineering","Global load balancing","Chaos engineering","Real-time recovery systems"];default:return["System reliability fundamentals"]}}const vr=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,className:a="",testId:s="value-creation-widget"})=>{const{ciaContentService:n,error:l,isLoading:o}=G(),m=u.useMemo(()=>at(i,t,r),[i,t,r]),x=u.useMemo(()=>{switch(m){case"Minimal":return"None";case"Low":return"Low";case"Moderate":return"Moderate";case"High":return"High";case"Very High":return"Very High";default:return"Moderate"}},[m]),p=u.useMemo(()=>{switch(m){case"Minimal":return 1;case"Low":return 2;case"Moderate":return 3;case"High":return 4;case"Very High":return 5;default:return 3}},[m]),h=u.useMemo(()=>{try{if(!S(n)&&typeof n.getBusinessValueMetrics=="function"){const f=n.getBusinessValueMetrics(i,t,r);if(Array.isArray(f)&&f.length>0)return f}return Ge(i,t,r,p)}catch(f){return console.error("Error retrieving business value metrics:",f),Ge(i,t,r,p)}},[n,i,t,r,p]),b=(f,k)=>{try{if(!S(n)&&typeof n.getComponentValueStatements=="function"){const H=n.getComponentValueStatements(f,k);if(Array.isArray(H)&&H.length>0)return H}switch(f){case"availability":return k==="None"||k==="Low"?["Basic operational continuity","Minimal protection against service disruptions"]:k==="Moderate"?["Predictable system access and reliable operations","Improved user satisfaction through consistent service delivery","Enhanced operational efficiency with reduced downtime"]:["Near-continuous operations even during adverse events","Competitive advantage through superior service reliability","Protected revenue streams with minimal service interruptions","Maintained customer trust through consistent service delivery"];case"integrity":return k==="None"||k==="Low"?["Basic data consistency","Minimal protection against data errors"]:k==="Moderate"?["Trustworthy data for operational and strategic decisions","Reduced costs from data errors and reconciliation efforts","Improved compliance posture with accurate record-keeping"]:["Data you can stake your business reputation on","Enhanced business intelligence through high-quality data","Reduced fraud risk with validated transactions","Defensible audit trail for regulatory scrutiny"];case"confidentiality":return k==="None"||k==="Low"?["Basic information protection","Minimal safeguards for sensitive data"]:k==="Moderate"?["Protected intellectual property and business secrets","Reduced risk of data breaches and associated costs","Enhanced customer and partner trust in data handling"]:["Secured competitive advantage through protected innovations","Strengthened customer trust with demonstrable privacy controls","Reputation as a secure business partner","Reduced breach-related costs and regulatory penalties"];default:return["No value statements available"]}}catch(H){return console.error(`Error retrieving ${f} value statements:`,H),[`Unable to retrieve ${f} value statements`]}},g=()=>{try{if(!S(n)&&typeof n.getROIEstimate=="function"){const k=n.getROIEstimate(i,t,r);if(!S(k))return{value:k.value??"Unable to calculate",description:k.description||"ROI estimation"}}const f=ot(i,t,r);return{value:f.value??"Unable to calculate",description:f.description}}catch(f){return console.error("Error calculating ROI estimate:",f),{value:"Unable to calculate",description:"ROI estimation error"}}},y=()=>{try{if(!S(n)&&typeof n.getBusinessValueSummary=="function"){const f=n.getBusinessValueSummary(i,t,r);if(typeof f=="string"&&f)return f}switch(m){case"None":return"Minimal security investments provide basic operational capabilities but limited business value.";case"Low":return"Basic security controls enable fundamental business operations with modest protection against common threats.";case"Moderate":return"Balanced security investments deliver operational stability, data reliability, and reasonable protection that enable business growth.";case"High":return"Strategic security investments create significant business value through enhanced reliability, data integrity, and protected information assets.";case"Very High":return"Premium security investments establish market-leading capabilities and competitive advantages through exceptional reliability, data quality, and information protection.";default:return"Security investments can deliver business value through improved operations, enhanced decision-making, and protected information assets."}}catch(f){return console.error("Error generating business value summary:",f),"Security investments can deliver business value beyond just risk reduction."}},N=u.useMemo(()=>g(),[n,i,t,r,m]);return e.jsx(q,{title:F.VALUE_CREATION,icon:_.VALUE_CREATION,className:a,testId:s,isLoading:o,error:l,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:e.jsx("p",{className:"text-sm","data-testid":"value-creation-summary",children:y()})}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Overall Value Profile"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"mr-2 text-sm text-gray-600 dark:text-gray-400",children:"Security Level:"}),e.jsx(Q,{level:x,size:"md"})]})]}),e.jsx("div",{className:"p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Estimated Return on Investment"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:N.description})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400","data-testid":"roi-value",children:N.value})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"value-metrics-grid",children:h.map((f,k)=>e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":`value-metric-${k}`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-2 text-blue-500",children:f.icon||"ðŸ“ˆ"}),e.jsx("h4",{className:"font-medium",children:f.category})]}),e.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400 mb-1",children:f.value}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:f.description})]},k))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Component Business Value"}),e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg","data-testid":"confidentiality-value-section",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-2",children:"ðŸ”’"}),e.jsxs("h4",{className:"font-medium",children:["Confidentiality Value (",r,")"]})]}),e.jsx("ul",{className:"list-disc list-inside pl-2 text-sm text-gray-600 dark:text-gray-400",children:b("confidentiality",r).map((f,k)=>e.jsx("li",{className:"mb-1","data-testid":`confidentiality-value-item-${k}`,children:f},k))})]}),e.jsxs("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":"integrity-value-section",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-2",children:"âœ“"}),e.jsxs("h4",{className:"font-medium",children:["Integrity Value (",t,")"]})]}),e.jsx("ul",{className:"list-disc list-inside pl-2 text-sm text-gray-600 dark:text-gray-400",children:b("integrity",t).map((f,k)=>e.jsx("li",{className:"mb-1","data-testid":`integrity-value-item-${k}`,children:f},k))})]}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","data-testid":"availability-value-section",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-xl mr-2",children:"â±ï¸"}),e.jsxs("h4",{className:"font-medium",children:["Availability Value (",i,")"]})]}),e.jsx("ul",{className:"list-disc list-inside pl-2 text-sm text-gray-600 dark:text-gray-400",children:b("availability",i).map((f,k)=>e.jsx("li",{className:"mb-1","data-testid":`availability-value-item-${k}`,children:f},k))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Investment Business Case"}),e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Use these value statements to build your business case for security investments:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Executive Summary"}),e.jsxs("p",{className:"text-sm",children:["Our ",m.toLowerCase()," security investment strategy delivers business value through improved operational reliability, data integrity, and information protection."]})]}),e.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Financial Value"}),e.jsxs("p",{className:"text-sm",children:["With an estimated ROI of ",N.value,", our security investments provide strong financial returns through risk reduction, operational improvements, and business enablement."]})]}),e.jsxs("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[e.jsx("h5",{className:"text-sm font-medium mb-1",children:"Strategic Value"}),e.jsx("p",{className:"text-sm",children:"Beyond direct financial returns, our security program creates strategic value by enabling digital initiatives, protecting our brand, and building customer trust."})]})]})]})]})]})})};function Ge(i,t,r,a){return[{category:"Trust Enhancement",value:se(a,95),description:"Increased customer and partner trust in your business",icon:"ðŸ¤"},{category:"Operational Efficiency",value:se(a,40),description:"Improved operational efficiency through reliable systems",icon:"âš™ï¸"},{category:"Innovation Enablement",value:se(a,70),description:"Enhanced ability to launch new digital initiatives",icon:"ðŸ’¡"},{category:"Decision Quality",value:se(a,60),description:"Better business decisions through reliable data",icon:"ðŸ“Š"},{category:"Competitive Advantage",value:se(a,50),description:"Market differentiation through security capabilities",icon:"ðŸ†"},{category:"Risk Reduction",value:se(a,80),description:"Reduced likelihood of business disruptions",icon:"ðŸ›¡ï¸"}]}function se(i,t){return`${Math.min(95,Math.max(5,Math.round(t*(.3+i*.2))))}%`}const $e=({impact:i,color:t,testId:r="business-impact-section"})=>{const a=i.financial?.riskLevel||i.operational?.riskLevel||"Unknown";return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card","data-testid":r,children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact",e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Risk: ",a]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${r}-summary`,children:i.summary||"No business impact data available"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.financial&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’°"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Financial Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:i.financial.description||"No financial impact information available"}),i.financial.annualRevenueLoss&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Annual Revenue Loss: "}),i.financial.annualRevenueLoss]})]}),i.operational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"âš™ï¸"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Operational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:i.operational.description||"No operational impact information available"}),i.operational.meanTimeToRecover&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Mean Time to Recover: "}),i.operational.meanTimeToRecover]})]}),i.reputational&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ†"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Reputational Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:i.reputational.description||"No reputational impact information available"}),i.reputational.reputationalImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:i.reputational.reputationalImpact})]}),i.strategic&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Strategic Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:i.strategic.description||"No strategic impact information available"}),i.strategic.competitiveAdvantage&&e.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[e.jsx("span",{className:"font-medium",children:"Competitive Advantage: "}),i.strategic.competitiveAdvantage]})]}),i.regulatory&&e.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${t}-100 dark:bg-${t}-900 dark:bg-opacity-20 border border-${t}-200 dark:border-${t}-800`,children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),e.jsx("span",{className:`font-medium text-${t}-700 dark:text-${t}-300`,children:"Regulatory Impact"})]}),e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:i.regulatory.description||"No regulatory impact information available"}),i.regulatory.complianceImpact&&e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:i.regulatory.complianceImpact}),i.regulatory.complianceViolations&&i.regulatory.complianceViolations.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Potential Violations:"," "]}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.regulatory.complianceViolations.map((s,n)=>e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full bg-${t}-50 text-${t}-700 dark:bg-${t}-900 dark:bg-opacity-50 dark:text-${t}-300`,children:s},n))})]})]})]})]})},kr=({level:i,availabilityLevel:t,integrityLevel:r,confidentialityLevel:a,showExtendedDetails:s=!1,className:n="",testId:l=xt.AVAILABILITY_IMPACT_PREFIX})=>{const o=J(t||i||"Moderate"),{ciaContentService:m,error:x,isLoading:p}=G(),h=u.useMemo(()=>{if(S(m))return null;try{const y=m.getComponentDetails("availability",o);return S(y)?null:y}catch(y){return console.error("Error getting availability details:",y),null}},[m,o]),b=u.useMemo(()=>{if(S(m))return K("availability",o);try{return m.getBusinessImpact("availability",o)||K("availability",o)}catch(y){return console.error("Error getting availability business impact:",y),K("availability",o)}},[m,o]),g=u.useMemo(()=>{const y=Zt(o);return S(h)?y:{uptime:h.uptime||y.uptime,rto:h.rto||y.rto,rpo:h.rpo||y.rpo,mttr:h.mttr||y.mttr,sla:h.sla||y.sla}},[h,o]);return e.jsx(q,{title:F.AVAILABILITY_IMPACT,icon:_.AVAILABILITY_IMPACT||"â±ï¸",className:`${n} cia-availability`,testId:l,isLoading:p,error:x,children:e.jsxs("div",{className:"p-4 cia-widget",children:[e.jsx("div",{className:"mb-4",children:e.jsx($,{category:"Availability",level:o,colorClass:Ve("blue"),textClass:"text-blue-800 dark:text-blue-300",testId:`${l}-level`})}),b&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Business Impact"}),e.jsx($e,{impact:b,color:"blue",testId:`${l}-business-impact`})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"â±ï¸"}),"SLA Metrics"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Uptime Target"}),e.jsx("div",{className:"text-lg font-bold",children:g.uptime}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Expected system availability"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Time Objective"}),e.jsx("div",{className:"text-lg font-bold",children:g.rto}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Time to restore service"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Point Objective"}),e.jsx("div",{className:"text-lg font-bold",children:g.rpo}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Maximum data loss allowed"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Service Level Agreement"}),e.jsx("div",{className:"text-lg font-bold",children:g.sla}),e.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Support coverage period"})]})})]})]})})},Nr=({level:i,availabilityLevel:t,integrityLevel:r,confidentialityLevel:a,className:s="",testId:n="widget-confidentiality-impact",onLevelChange:l})=>{const{ciaContentService:o,error:m,isLoading:x}=G(),p=a||i||"Moderate",h=u.useMemo(()=>{try{if(S(o))return null;const N=o.getComponentDetails("confidentiality",p);return S(N)?null:N}catch(N){return console.error("Error fetching confidentiality details:",N),null}},[o,p]),b=u.useMemo(()=>{try{return S(o)?K("confidentiality",p):o.getBusinessImpact("confidentiality",p)||K("confidentiality",p)}catch(N){return console.error("Error fetching business impact details:",N),K("confidentiality",p)}},[o,p]),g=u.useMemo(()=>{if(S(o))return`${p} Classification`;try{return o.getInformationSensitivity(p)}catch(N){return console.error("Error getting data classification:",N),`${p} Classification`}},[o,p]),y=u.useMemo(()=>!S(h)&&h.privacyImpact?h.privacyImpact:Jt(p),[h,p]);return e.jsx(q,{title:F.CONFIDENTIALITY_IMPACT,icon:_.CONFIDENTIALITY_IMPACT||"ðŸ”’",className:`${s} overflow-visible`,testId:n,isLoading:x,error:m,children:e.jsx("div",{className:"max-h-[550px] overflow-y-auto pr-1",children:e.jsxs("div",{className:"p-4",role:"region","aria-labelledby":"confidentiality-impact-heading",children:[e.jsx("div",{className:"mb-4",children:e.jsx($,{category:"Confidentiality",level:p,colorClass:Ve("purple"),textClass:"text-purple-800 dark:text-purple-300",testId:`${n}-confidentiality-badge`})}),b&&e.jsx($e,{impact:b,color:"purple",testId:`${n}-business-impact`}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“Š"}),"Data Protection"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Data Classification"}),e.jsx("div",{className:"text-lg font-bold",children:g}),e.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Level of data sensitivity"})]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Privacy Impact"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Privacy Impact:"}),e.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:y})]})})]})]})})})},jr=({level:i,availabilityLevel:t,integrityLevel:r,confidentialityLevel:a,className:s="",testId:n=yt.INTEGRITY_IMPACT_PREFIX,showExtendedDetails:l=!1})=>{const o=J(r||i||"Moderate"),{ciaContentService:m,error:x,isLoading:p}=G(),h=u.useMemo(()=>{try{if(S(m)||S(o))return null;const f=m.getComponentDetails("integrity",o);return S(f)?null:f}catch(f){return console.error("Error getting integrity details:",f),null}},[m,o]),b=u.useMemo(()=>{try{return S(m)||S(o)?K("integrity",o):m.getBusinessImpact("integrity",o)||K("integrity",o)}catch(f){return console.error("Error getting integrity business impact:",f),K("integrity",o)}},[m,o]),g=u.useMemo(()=>{try{return S(m)||S(o)?[]:m.getRecommendations("integrity",o)||[]}catch(f){return console.error("Error getting recommendations:",f),[]}},[m,o]),y=u.useMemo(()=>!S(h)&&h.validationLevel?h.validationLevel:Qt(o),[h,o]),N=u.useMemo(()=>!S(h)&&h.errorRate?h.errorRate:er(o),[h,o]);return e.jsx(q,{title:F.INTEGRITY_IMPACT,icon:_.INTEGRITY_IMPACT||"âœ“",className:s,testId:n,isLoading:p,error:x,children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx($,{category:"Integrity",level:o,colorClass:Ve("green"),textClass:"text-green-800 dark:text-green-300",testId:`${n}-integrity-badge`})}),b&&e.jsx("div",{className:"mt-4","data-testid":`${n}-business-impact-container`,children:e.jsx($e,{impact:b,color:"green",testId:`${n}-business-impact`})}),e.jsxs("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":`${n}-metrics`,children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-green-800 dark:text-green-300",children:"Data Integrity Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Data Validation Controls:"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:y})]}),e.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Acceptable Error Rate:"}),e.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:N})]})]})]}),l&&g.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Recommendations"}),e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:g.map((f,k)=>e.jsx("li",{className:"text-sm text-gray-600 dark:text-gray-400",children:f},k))})]})]})})},wr=(i,t)=>i?i.length>t?`${i.substring(0,t)}...`:i:"",Sr=({resource:i,onClick:t,className:r="",testId:a})=>{const s=()=>{t?t(i):window.open(i.url,"_blank","noopener,noreferrer")};return e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-4 hover:shadow-lg transition-shadow ${r}`,onClick:s,role:"button",tabIndex:0,onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&s()},"data-testid":a||"resource-item",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:i.title}),e.jsx("div",{className:"text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-100 px-2 py-1 rounded",children:i.type||"General"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:wr(i.description||"",100)}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[i.component&&e.jsxs("span",{className:"mr-2",children:["Component: ",i.component]}),i.source&&e.jsxs("span",{className:"mr-2",children:["Source: ",i.source]}),i.level&&e.jsxs("span",{children:["Level: ",i.level]})]}),e.jsx("div",{className:"mt-2 flex flex-wrap",children:i.tags?.map((n,l)=>e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded mr-1 mb-1",children:n},l))})]})},Ir=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,className:a="",testId:s=bt.WIDGET,limit:n=8,showTopResourcesOnly:l=!1})=>{const{ciaContentService:o,error:m,isLoading:x}=G(),[p,h]=u.useState(null),[b,g]=u.useState(""),[y,N]=u.useState(1),[f,k]=u.useState(n),H=u.useMemo(()=>{try{if(S(o))return[];const v=xe(o.getSecurityResources?.("availability",i))?o.getSecurityResources?.("availability",i):[],I=xe(o.getSecurityResources?.("integrity",t))?o.getSecurityResources?.("integrity",t):[],B=xe(o.getSecurityResources?.("confidentiality",r))?o.getSecurityResources?.("confidentiality",r):[],te=[...v||[],...I||[],...B||[]],le=[],re=new Set;return te.forEach(U=>{const X=tt(U.url)?U.url:U.title;re.has(X)||(re.add(X),le.push(U))}),le.sort((U,X)=>{const j=Be(U)&&"relevanceScore"in U?U.relevanceScore:0,V=Be(X)&&"relevanceScore"in X?X.relevanceScore:0;return j!==void 0&&V!==void 0?V-j:U.title.localeCompare(X.title)})}catch(v){return console.error("Error getting security resources:",v),[]}},[o,i,t,r]),w=u.useMemo(()=>{const v=new Set;return H.forEach(I=>{I.category&&v.add(I.category)}),Array.from(v).sort()},[H]),c=u.useMemo(()=>{let v=H;if(p&&(v=v.filter(I=>I.category===p)),b.trim()){const I=b.toLowerCase().trim();v=v.filter(B=>B.title.toLowerCase().includes(I)||B.description?.toLowerCase().includes(I)||B.tags&&B.tags.some(te=>te.toLowerCase().includes(I)))}return v},[H,p,b]),d=u.useMemo(()=>{const v=y*f,I=v-f;return c.slice(I,v)},[c,y,f]),C=u.useCallback(v=>{h(v),N(1)},[]),M=u.useCallback(v=>{g(v.target.value),N(1)},[]),E=u.useCallback(v=>{N(v)},[]),R=Math.ceil(c.length/f),D=u.useMemo(()=>{try{return S(o)?[]:[o.getTechnicalImplementation?.("availability",i),o.getTechnicalImplementation?.("integrity",t),o.getTechnicalImplementation?.("confidentiality",r)].filter(v=>v!==void 0)}catch(v){return console.error("Error getting implementation guides:",v),[]}},[o,i,t,r]);return e.jsx(q,{title:F.SECURITY_RESOURCES,icon:_.SECURITY_RESOURCES,className:a,testId:s,isLoading:x,error:m,children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:e.jsx("p",{className:"text-sm",children:"This widget provides curated security resources to help implement controls that align with your selected security levels across the CIA triad."})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"md:w-1/4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"resource-search",className:"block text-sm font-medium mb-1",children:"Search Resources"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"resource-search",type:"text",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md dark:bg-gray-800 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Search by title, description...",value:b,onChange:M,"data-testid":`${s}-search`}),e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 dark:text-gray-400",children:"ðŸ”"})]})]}),w.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Categories"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:`px-3 py-2 rounded-md cursor-pointer text-sm ${p===null?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,onClick:()=>C(null),"data-testid":`${s}-category-all`,children:"All Resources"}),w.map((v,I)=>e.jsx("div",{className:`px-3 py-2 rounded-md cursor-pointer text-sm ${p===v?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,onClick:()=>C(v),"data-testid":`${s}-category-${I}`,children:v},v))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Implementation Guidelines"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg text-sm",children:[e.jsx("p",{className:"mb-2 font-medium",children:"Selected Security Levels:"}),e.jsxs("div",{className:"mb-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Confidentiality:"}),e.jsx("span",{className:"font-medium",children:r})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Integrity:"}),e.jsx("span",{className:"font-medium",children:t})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Availability:"}),e.jsx("span",{className:"font-medium",children:i})]})]}),e.jsx("p",{className:"mb-2 text-xs text-gray-600 dark:text-gray-400",children:"Focus on implementing controls that satisfy all three components for a balanced security posture."})]})]})]}),e.jsxs("div",{className:"md:w-3/4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Security Resources"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[c.length," ",c.length===1?"resource":"resources"," ","found"]})]}),c.length===0&&e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center text-gray-500 dark:text-gray-400","data-testid":`${s}-no-resources`,children:[e.jsx("p",{className:"mb-2",children:"No resources found."}),e.jsx("p",{className:"text-sm",children:b?"Try adjusting your search terms or clearing filters.":"Resources will appear here when available."})]}),c.length>0&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map((v,I)=>e.jsx(Sr,{resource:v,testId:`${s}-resource-${I}`},`${v.url||""}-${I}`))}),R>1&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>E(y-1),disabled:y===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border ${y===1?"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600 cursor-not-allowed":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"} text-sm font-medium`,children:"Previous"}),Array.from({length:R}).map((v,I)=>e.jsx("button",{onClick:()=>E(I+1),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${y===I+1?"z-10 bg-blue-50 border-blue-500 text-blue-600 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,children:I+1},I)),e.jsx("button",{onClick:()=>E(y+1),disabled:y===R,className:`relative inline-flex items-center px-2 py-2 rounded-r-md border ${y===R?"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600 cursor-not-allowed":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"} text-sm font-medium`,children:"Next"})]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Implementation Tips"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("h4",{className:"text-md font-medium mb-2",children:"Getting Started with Implementation"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400 pl-2",children:[e.jsx("li",{children:"Begin with a thorough assessment of your current security controls"}),e.jsx("li",{children:"Prioritize implementations based on risk exposure and business impact"}),e.jsx("li",{children:"Implement controls gradually, starting with foundational elements"}),e.jsx("li",{children:"Document your implementation process and security configurations"}),e.jsx("li",{children:"Test and validate controls after implementation"})]})]}),D.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[D[2]&&e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-purple-700 dark:text-purple-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Confidentiality (",r,")"]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("p",{className:"mb-2",children:D[2].description||"Focus on data protection and access controls."}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Expertise:"})," ",D[2].expertiseLevel||"Standard"]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Effort:"})," ",D[2].developmentEffort||"Medium"]})]})]}),D[1]&&e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-green-700 dark:text-green-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âœ“"}),"Integrity (",t,")"]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("p",{className:"mb-2",children:D[1].description||"Focus on data accuracy and validation mechanisms."}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Expertise:"})," ",D[1].expertiseLevel||"Standard"]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Effort:"})," ",D[1].developmentEffort||"Medium"]})]})]}),D[0]&&e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-blue-700 dark:text-blue-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Availability (",i,")"]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("p",{className:"mb-2",children:D[0].description||"Focus on systems uptime and recovery capabilities."}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Expertise:"})," ",D[0].expertiseLevel||"Standard"]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Effort:"})," ",D[0].developmentEffort||"Medium"]})]})]})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg border border-yellow-100 dark:border-yellow-800",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-yellow-700 dark:text-yellow-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âš ï¸"}),"Common Implementation Challenges"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400 pl-2",children:[e.jsx("li",{children:"Balancing security with usability and performance"}),e.jsx("li",{children:"Maintaining consistent controls across different environments"}),e.jsx("li",{children:"Integration with legacy systems and applications"}),e.jsx("li",{children:"Building security expertise and awareness across teams"}),e.jsx("li",{children:"Allocating sufficient resources for ongoing maintenance"})]})]})]})]})]})]})]})})},Cr=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,className:a="",testId:s="security-visualization-widget"})=>{const{error:n,isLoading:l}=nt(),o=u.useMemo(()=>{const p=J(i),h=J(t),b=J(r),g=T(p),y=T(h),N=T(b),f=g+y+N;return Math.round(f/12*100)},[i,t,r]),m=u.useMemo(()=>{const p=at(i,t,r);return tr(p)},[i,t,r]),x=()=>{const p=T(i),h=T(t),b=T(r);return i===t&&t===r&&(i==="High"||i==="Very High")?e.jsx("div",{"data-testid":"balanced-recommendation",className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg mt-4",children:e.jsx("p",{className:"text-sm",children:"Your security posture is well-balanced with strong controls across all CIA components."})}):e.jsxs("div",{className:"space-y-2 mt-4","data-testid":"security-recommendations",children:[p<2&&e.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:e.jsx("p",{className:"text-sm",children:"Consider improving availability controls to ensure business continuity."})}),h<3&&e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:e.jsx("p",{className:"text-sm",children:"Enhance data validation mechanisms and change management to improve integrity."})}),b<2&&e.jsx("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:e.jsx("p",{className:"text-sm",children:"Strengthen access controls and data protection to improve confidentiality."})})]})};return e.jsx(q,{title:F.SECURITY_VISUALIZATION,icon:_.SECURITY_VISUALIZATION,className:a,testId:s,isLoading:l,error:n,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Posture"}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Security Score"}),e.jsx("div",{className:"text-3xl font-bold","data-testid":"security-score-value",children:o})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Risk Level"}),e.jsx("div",{className:`text-xl font-bold ${At(m)}`,"data-testid":"risk-level",children:m})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Security Level"}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${Ht(o)}`,style:{width:`${o}%`},"data-testid":"security-score-bar"})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mt-1",children:[e.jsx("div",{children:"Critical"}),e.jsx("div",{children:"High"}),e.jsx("div",{children:"Medium"}),e.jsx("div",{children:"Low"}),e.jsx("div",{children:"Minimal"})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Components"}),e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsx(ct,{availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,testId:`${s}-radar-chart`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Component Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg","data-testid":"confidentiality-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-purple-800 dark:text-purple-300",children:"Confidentiality"}),e.jsx(Q,{level:r,testId:"confidentiality-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-purple-500 h-1.5 rounded-full",style:{width:`${T(r)/4*100}%`},"data-testid":"confidentiality-gauge"})})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":"integrity-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-green-800 dark:text-green-300",children:"Integrity"}),e.jsx(Q,{level:t,testId:"integrity-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${T(t)/4*100}%`},"data-testid":"integrity-gauge"})})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","data-testid":"availability-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-blue-800 dark:text-blue-300",children:"Availability"}),e.jsx(Q,{level:i,testId:"availability-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full",style:{width:`${T(i)/4*100}%`},"data-testid":"availability-gauge"})})]})]})]}),x(),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mt-4",children:[e.jsx("h3",{className:"text-md font-medium mb-2",children:"Security Visualization Key"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"The security score represents your overall security posture based on your CIA triad levels. The risk level indicates the potential business risk associated with your current security posture."}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs",children:[e.jsx("div",{className:"p-1 bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300 rounded text-center",children:"Critical Risk"}),e.jsx("div",{className:"p-1 bg-orange-100 text-orange-800 dark:bg-orange-900 dark:bg-opacity-30 dark:text-orange-300 rounded text-center",children:"High Risk"}),e.jsx("div",{className:"p-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300 rounded text-center",children:"Medium Risk"}),e.jsx("div",{className:"p-1 bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300 rounded text-center",children:"Low Risk"}),e.jsx("div",{className:"p-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300 rounded text-center",children:"Minimal Risk"})]})]})]})})},Mr=({availabilityLevel:i,integrityLevel:t,confidentialityLevel:r,className:a="",testId:s="technical-details-widget"})=>{const[n,l]=u.useState("confidentiality"),{ciaContentService:o,error:m,isLoading:x}=G(),p=c=>T(c)*25,h=u.useMemo(()=>{try{if(S(o))return W("confidentiality",r);const c=o.getComponentDetails?.("confidentiality",r);return S(c)?W("confidentiality",r):c}catch(c){return console.error("Error getting confidentiality details:",c),W("confidentiality",r)}},[o,r]),b=u.useMemo(()=>{try{if(S(o))return W("integrity",t);const c=o.getComponentDetails?.("integrity",t);return S(c)?W("integrity",t):c}catch(c){return console.error("Error getting integrity details:",c),W("integrity",t)}},[o,t]),g=u.useMemo(()=>{try{if(S(o))return W("availability",i);const c=o.getComponentDetails?.("availability",i);return S(c)?W("availability",i):c}catch(c){return console.error("Error getting availability details:",c),W("availability",i)}},[o,i]),y=(c,d)=>{try{if(S(o))return fe(c,d);const C=o.getTechnicalRequirements?.(c,d);return Array.isArray(C)&&C.length>0?C:fe(c,d)}catch(C){return console.error(`Error getting ${c} requirements:`,C),fe(c,d)}},N=(c,d)=>{try{if(!S(o)&&typeof o.getExpertiseRequired=="function"){const C=o.getExpertiseRequired(c,d);if(Array.isArray(C)&&C.length>0)return C}return Ye(c,d)}catch(C){return console.error(`Error getting ${c} expertise requirements:`,C),Ye(c,d)}},f=c=>`${{None:.1,Low:.25,Moderate:.5,High:1,"Very High":2}[c]||.5} FTE`,k=u.useMemo(()=>{const c=ye(r,r,r);return{value:p(c),label:c}},[r]),H=u.useMemo(()=>{const c=ye(t,t,t);return{value:p(c),label:c}},[t]),w=u.useMemo(()=>{const c=ye(i,i,i);return{value:p(c),label:c}},[i]);return e.jsx(q,{title:F.TECHNICAL_DETAILS,icon:_.TECHNICAL_DETAILS,className:a,testId:s,isLoading:x,error:m,children:e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:e.jsx("p",{className:"text-sm",children:"This widget provides technical implementation details for achieving your selected security levels. Use these guidelines when designing and implementing your security controls."})}),e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-4",children:[e.jsxs("button",{onClick:()=>l("confidentiality"),className:`py-2 px-4 font-medium text-sm focus:outline-none ${n==="confidentiality"?"border-b-2 border-purple-500 text-purple-600 dark:text-purple-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,"data-testid":"confidentiality-tab",children:[e.jsx("span",{className:"mr-1",children:"ðŸ”’"})," Confidentiality"]}),e.jsxs("button",{onClick:()=>l("integrity"),className:`py-2 px-4 font-medium text-sm focus:outline-none ${n==="integrity"?"border-b-2 border-green-500 text-green-600 dark:text-green-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,"data-testid":"integrity-tab",children:[e.jsx("span",{className:"mr-1",children:"âœ“"})," Integrity"]}),e.jsxs("button",{onClick:()=>l("availability"),className:`py-2 px-4 font-medium text-sm focus:outline-none ${n==="availability"?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,"data-testid":"availability-tab",children:[e.jsx("span",{className:"mr-1",children:"â±ï¸"})," Availability"]})]}),n==="confidentiality"&&e.jsxs("div",{className:"mb-6","data-testid":"confidentiality-section",children:[e.jsxs("div",{className:"flex items-center mb-4","data-testid":"technical-header",children:[e.jsx("span",{className:"text-xl mr-2 text-purple-500",children:"ðŸ”’"}),e.jsx("h3",{className:"text-lg font-medium",children:"Confidentiality Controls"}),e.jsx("div",{className:"ml-auto",children:e.jsx($,{category:"",level:r,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:`${s}-confidentiality-badge`})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg shadow-sm border border-purple-100 dark:border-purple-800",children:[e.jsx("h4",{className:"text-md font-medium text-purple-700 dark:text-purple-300 mb-3",children:"Technical Description"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"technical-description",children:h?.technical||be("confidentiality",r)}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Implementation Complexity"}),e.jsxs("div",{className:"flex items-center","data-testid":"development-effort",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:e.jsx("div",{className:"h-2 bg-purple-500 dark:bg-purple-600 rounded-full",style:{width:`${k.value}%`}})}),e.jsx("span",{className:"text-xs font-medium",children:k.label})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Personnel Requirements"}),e.jsxs("div",{className:"flex items-center","data-testid":"maintenance-level",children:[e.jsx("span",{className:"text-sm",children:"Estimated staffing: "}),e.jsx("span",{className:"ml-2 text-sm font-medium text-purple-600 dark:text-purple-400",children:f(r)})]})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-md font-medium mb-3","data-testid":"implementation-header",children:"Implementation Requirements"}),e.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400","data-testid":"implementation-steps",children:y("confidentiality",r).map((c,d)=>e.jsx("li",{"data-testid":`conf-req-${d}`,children:c},`conf-req-${d}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-purple-500",children:"ðŸ’»"}),"Technologies"]}),e.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:h?.technologies||Ee("confidentiality",r)})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-purple-500",children:"âš™ï¸"}),"Configurations"]}),e.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:h?.configurations||Ae("confidentiality",r)})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-purple-500",children:"ðŸ‘¨â€ðŸ’»"}),"Expertise Required"]}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2","data-testid":"required-expertise",children:N("confidentiality",r).map((c,d)=>e.jsxs("li",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"mr-2 text-purple-500",children:"â€¢"}),e.jsx("span",{children:c})]},`conf-exp-${d}`))})]})]}),n==="integrity"&&e.jsxs("div",{className:"mb-6","data-testid":"integrity-section",children:[e.jsxs("div",{className:"flex items-center mb-4","data-testid":"technical-header",children:[e.jsx("span",{className:"text-xl mr-2 text-green-500",children:"âœ“"}),e.jsx("h3",{className:"text-lg font-medium",children:"Integrity Controls"}),e.jsx("div",{className:"ml-auto",children:e.jsx($,{category:"",level:t,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:`${s}-integrity-badge`})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg shadow-sm border border-green-100 dark:border-green-800",children:[e.jsx("h4",{className:"text-md font-medium text-green-700 dark:text-green-300 mb-3",children:"Technical Description"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"technical-description",children:b?.technical||be("integrity",t)}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-green-700 dark:text-green-300 mb-2",children:"Implementation Complexity"}),e.jsxs("div",{className:"flex items-center","data-testid":"development-effort",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:e.jsx("div",{className:"h-2 bg-green-500 dark:bg-green-600 rounded-full",style:{width:`${H.value}%`}})}),e.jsx("span",{className:"text-xs font-medium",children:H.label})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-green-700 dark:text-green-300 mb-2",children:"Personnel Requirements"}),e.jsxs("div",{className:"flex items-center","data-testid":"maintenance-level",children:[e.jsx("span",{className:"text-sm",children:"Estimated staffing: "}),e.jsx("span",{className:"ml-2 text-sm font-medium text-green-600 dark:text-green-400",children:f(t)})]})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-md font-medium mb-3","data-testid":"implementation-header",children:"Implementation Requirements"}),e.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400","data-testid":"implementation-steps",children:y("integrity",t).map((c,d)=>e.jsx("li",{"data-testid":`int-req-${d}`,children:c},`int-req-${d}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-green-500",children:"ðŸ’»"}),"Technologies"]}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:b?.technologies||Ee("integrity",t)})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-green-500",children:"âš™ï¸"}),"Configurations"]}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:b?.configurations||Ae("integrity",t)})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-green-500",children:"ðŸ‘¨â€ðŸ’»"}),"Expertise Required"]}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2","data-testid":"required-expertise",children:N("integrity",t).map((c,d)=>e.jsxs("li",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"mr-2 text-green-500",children:"â€¢"}),e.jsx("span",{children:c})]},`int-exp-${d}`))})]})]}),n==="availability"&&e.jsxs("div",{className:"mb-6","data-testid":"availability-section",children:[e.jsxs("div",{className:"flex items-center mb-4","data-testid":"technical-header",children:[e.jsx("span",{className:"text-xl mr-2 text-blue-500",children:"â±ï¸"}),e.jsx("h3",{className:"text-lg font-medium",children:"Availability Controls"}),e.jsx("div",{className:"ml-auto",children:e.jsx($,{category:"",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:`${s}-availability-badge`})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg shadow-sm border border-blue-100 dark:border-blue-800",children:[e.jsx("h4",{className:"text-md font-medium text-blue-700 dark:text-blue-300 mb-3",children:"Technical Description"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"technical-description",children:g?.technical||be("availability",i)}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Implementation Complexity"}),e.jsxs("div",{className:"flex items-center","data-testid":"development-effort",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:e.jsx("div",{className:"h-2 bg-blue-500 dark:bg-blue-600 rounded-full",style:{width:`${w.value}%`}})}),e.jsx("span",{className:"text-xs font-medium",children:w.label})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Personnel Requirements"}),e.jsxs("div",{className:"flex items-center","data-testid":"maintenance-level",children:[e.jsx("span",{className:"text-sm",children:"Estimated staffing: "}),e.jsx("span",{className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:f(i)})]})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("h4",{className:"text-md font-medium mb-3","data-testid":"implementation-header",children:"Implementation Requirements"}),e.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400","data-testid":"implementation-steps",children:y("availability",i).map((c,d)=>e.jsx("li",{"data-testid":`avail-req-${d}`,children:c},`avail-req-${d}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"ðŸ’»"}),"Technologies"]}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:g?.technologies||Ee("availability",i)})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"âš™ï¸"}),"Configurations"]}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:g?.configurations||Ae("availability",i)})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"ðŸ‘¨â€ðŸ’»"}),"Expertise Required"]}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2","data-testid":"required-expertise",children:N("availability",i).map((c,d)=>e.jsxs("li",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),e.jsx("span",{children:c})]},`avail-exp-${d}`))})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Implementation Notes"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),e.jsx("span",{children:"Implement these technical controls in a layered approach, starting with foundational controls."})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),e.jsx("span",{children:"Regular testing and validation are required to ensure controls are functioning as intended."})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),e.jsx("span",{children:"Consider integrating with existing security infrastructure to maximize effectiveness."})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),e.jsx("span",{children:"Document all implementation details and maintain up-to-date configuration records."})]})]})]})]})})};function W(i,t){return{description:Rr(i,t),technical:be(i,t),recommendations:fe(i,t)}}function Rr(i,t){if(i==="confidentiality")switch(t){case"None":return"No confidentiality controls implemented, allowing unrestricted access to data.";case"Low":return"Basic confidentiality controls to prevent casual unauthorized access to data.";case"Moderate":return"Standard confidentiality controls with defined access privileges and protections.";case"High":return"Advanced confidentiality controls with strong encryption and strict access management.";case"Very High":return"Comprehensive confidentiality controls with the highest level of protection.";default:return"Standard confidentiality controls."}if(i==="integrity")switch(t){case"None":return"No integrity controls implemented, data can be modified without detection.";case"Low":return"Basic integrity controls that provide minimal protection against unauthorized changes.";case"Moderate":return"Standard integrity controls that detect unauthorized modifications to data.";case"High":return"Advanced integrity controls with cryptographic verification of data.";case"Very High":return"Comprehensive integrity controls with immutable audit trails.";default:return"Standard integrity controls."}switch(t){case"None":return"No availability controls implemented, no guarantees for system uptime.";case"Low":return"Basic availability controls providing minimal resilience to disruptions.";case"Moderate":return"Standard availability controls ensuring reasonable system uptime.";case"High":return"Advanced availability controls with redundancy and quick recovery capabilities.";case"Very High":return"Comprehensive availability controls with maximum fault tolerance.";default:return"Standard availability controls."}}function be(i,t){if(i==="confidentiality")switch(t){case"None":return"No specific technical controls for protecting data confidentiality.";case"Low":return"Basic access controls and password protection for sensitive resources.";case"Moderate":return"Role-based access control (RBAC), data encryption at rest and in transit, and proper authentication mechanisms.";case"High":return"Granular access control, strong encryption with proper key management, DLP controls, and multi-factor authentication.";case"Very High":return"Zero-trust architecture, advanced encryption with hardware security modules, comprehensive DLP, and context-aware access controls.";default:return"Standard confidentiality technical controls."}if(i==="integrity")switch(t){case"None":return"No specific technical controls for ensuring data integrity.";case"Low":return"Basic input validation and error detection mechanisms.";case"Moderate":return"Comprehensive input validation, checksums, access controls, and error detection.";case"High":return"Digital signatures, cryptographic hashing, strong change control, and comprehensive logging.";case"Very High":return"Blockchain or similar technologies for critical data, immutable audit logs, and formal verification methods.";default:return"Standard integrity technical controls."}switch(t){case"None":return"No specific technical controls for ensuring system availability.";case"Low":return"Basic monitoring and manual recovery procedures.";case"Moderate":return"Redundant components, scheduled backups, load balancing, and defined recovery procedures.";case"High":return"Automatic failover, real-time monitoring, comprehensive disaster recovery, and advanced load balancing.";case"Very High":return"Multi-site active-active configurations, continuous data protection, and fully automated recovery with zero data loss.";default:return"Standard availability technical controls."}}function fe(i,t){if(i==="confidentiality")switch(t){case"None":return["No specific requirements."];case"Low":return["Implement user authentication","Use basic password policies","Apply simple access controls","Secure sensitive data storage"];case"Moderate":return["Implement role-based access control","Use standard TLS for data in transit","Encrypt sensitive data at rest","Enforce strong password policies","Implement session management"];case"High":return["Implement multi-factor authentication","Deploy data loss prevention solutions","Use strong encryption for all data","Implement privileged access management","Conduct regular access reviews"];case"Very High":return["Implement zero-trust network architecture","Use hardware security modules for encryption","Deploy advanced data loss prevention","Implement just-in-time access","Use behavioral analytics for access monitoring"];default:return["Standard confidentiality requirements."]}if(i==="integrity")switch(t){case"None":return["No specific requirements."];case"Low":return["Implement basic input validation","Use simple error detection","Apply basic data quality checks"];case"Moderate":return["Implement comprehensive input validation","Use checksums for data verification","Implement change detection mechanisms","Maintain data validation logs","Use database constraints"];case"High":return["Implement digital signatures","Use cryptographic hash verification","Deploy comprehensive audit logging","Implement strict change controls","Use data integrity monitoring"];case"Very High":return["Implement blockchain for critical data","Use immutable audit trails","Deploy formal verification methods","Implement hardware-based integrity controls","Use zero-knowledge proofs where applicable"];default:return["Standard integrity requirements."]}switch(t){case"None":return["No specific requirements."];case"Low":return["Set up basic system monitoring","Implement manual backup procedures","Create simple incident response plan"];case"Moderate":return["Implement redundant components","Set up scheduled backup routines","Deploy basic load balancing","Create disaster recovery procedures","Implement health checks and alerts"];case"High":return["Implement automatic failover mechanisms","Deploy real-time monitoring and alerting","Set up geographically distributed backups","Implement advanced load balancing","Create comprehensive disaster recovery plan"];case"Very High":return["Implement multi-site active-active configuration","Deploy continuous data protection","Use fully automated recovery mechanisms","Implement zero-downtime deployment processes","Deploy dedicated site reliability engineering"];default:return["Standard availability requirements."]}}function Ee(i,t){if(i==="confidentiality")switch(t){case"None":return"No specific technologies";case"Low":return"Password managers, basic access control lists";case"Moderate":return"LDAP, Active Directory, TLS 1.2+, AES-128";case"High":return"MFA solutions, DLP tools, AES-256, Key Management Systems";case"Very High":return"Zero-trust platforms, HSMs, Advanced SIEM/SOAR, PAM solutions";default:return"Standard security technologies"}if(i==="integrity")switch(t){case"None":return"No specific technologies";case"Low":return"Form validation libraries, database constraints";case"Moderate":return"Checksum tools, hash functions (SHA-256), validation frameworks";case"High":return"Digital signature tools, cryptographic libraries, audit platforms";case"Very High":return"Blockchain frameworks, zero-knowledge proof systems, formal verification tools";default:return"Standard integrity technologies"}switch(t){case"None":return"No specific technologies";case"Low":return"Basic monitoring tools, manual backup solutions";case"Moderate":return"Load balancers, backup solutions, monitoring systems";case"High":return"Clustering solutions, automated failover systems, advanced monitoring";case"Very High":return"Global load balancing, containerization, automated recovery systems";default:return"Standard availability technologies"}}function Ae(i,t){if(i==="confidentiality")switch(t){case"None":return"No specific configurations";case"Low":return"Basic password policies, minimal HTTPS";case"Moderate":return"RBAC configurations, TLS 1.2+, standard encryption setup";case"High":return"MFA policies, DLP rules, key management procedures";case"Very High":return"Zero-trust policies, HSM integration, advanced access controls";default:return"Standard security configurations"}if(i==="integrity")switch(t){case"None":return"No specific configurations";case"Low":return"Basic validation rules, simple error handling";case"Moderate":return"Comprehensive validation rules, hash verification setup";case"High":return"Digital signature verification, advanced audit logging, strong change control";case"Very High":return"Blockchain node configuration, immutable storage settings";default:return"Standard integrity configurations"}switch(t){case"None":return"No specific configurations";case"Low":return"Basic monitoring alerts, manual backup procedures";case"Moderate":return"Redundant configurations, backup schedules, load balancer settings";case"High":return"Cluster configurations, automated failover settings, monitoring rules";case"Very High":return"Multi-region deployments, automated scaling, zero-downtime configurations";default:return"Standard availability configurations"}}function Ye(i,t){if(i==="confidentiality")switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic security knowledge","Access control fundamentals"];case"Moderate":return["Identity management","Encryption technologies","Authentication systems"];case"High":return["Advanced cryptography","Identity and access management","Security architecture","Data protection"];case"Very High":return["Security architecture","Advanced cryptography","Zero-trust implementation","Data protection specialization","Hardware security"];default:return["General security knowledge"]}if(i==="integrity")switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic data validation","Error handling"];case"Moderate":return["Data validation techniques","Database integrity","Error handling"];case"High":return["Cryptographic verification","Digital signatures","Secure logging","Change management"];case"Very High":return["Advanced cryptography","Formal verification","Distributed ledger technologies","Immutable logging systems"];default:return["Data integrity fundamentals"]}switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic system monitoring","Manual recovery procedures"];case"Moderate":return["System redundancy","Backup management","Basic load balancing"];case"High":return["High availability architecture","Disaster recovery","Advanced monitoring","Automated failover"];case"Very High":return["Distributed systems","Site reliability engineering","Global load balancing","Chaos engineering","Real-time recovery systems"];default:return["System reliability fundamentals"]}}const Er=()=>{const i="0.8.31",t=localStorage.getItem("availabilityLevel")||"Moderate",r=localStorage.getItem("integrityLevel")||"Moderate",a=localStorage.getItem("confidentialityLevel")||"Moderate",s=localStorage.getItem("darkMode")==="true"||window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,[n,l]=u.useState(t),[o,m]=u.useState(r),[x,p]=u.useState(a),[h,b]=u.useState(s),g=d=>{localStorage.setItem("availabilityLevel",d),l(d)},y=d=>{localStorage.setItem("integrityLevel",d),m(d)},N=d=>{localStorage.setItem("confidentialityLevel",d),p(d)},f=d=>{const C=typeof d=="function"?d(h):d;localStorage.setItem("darkMode",String(C)),b(C)};u.useEffect(()=>{console.log("CIA App Security Levels:",{availability:n,integrity:o,confidentiality:x})},[n,o,x]);const k=u.useCallback(d=>{console.log("CIAClassificationApp: Setting availability level to:",d),g(d)},[]),H=u.useCallback(d=>{console.log("CIAClassificationApp: Setting integrity level to:",d),y(d)},[]),w=u.useCallback(d=>{console.log("CIAClassificationApp: Setting confidentiality level to:",d),N(d)},[]),c=()=>{f(d=>!d)};return u.useEffect(()=>{h?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))},[h]),e.jsx("div",{className:"app-container",children:e.jsxs("div",{className:`min-h-screen ${h?"dark bg-gray-900":"bg-gray-100"} p-4 transition-colors duration-300`,children:[e.jsxs("div",{className:"mb-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded-lg shadow-md flex justify-between items-center app-header",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center overflow-hidden mr-1.5",children:e.jsx("img",{src:"./icon-192.png",alt:"CIA Compliance Manager Logo",style:{transform:"scale(0.2)"},"data-testid":"app-logo"})}),e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("h1",{"data-testid":We.APP_TITLE,className:"text-sm font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300 mr-2",children:pt.APP_TITLE}),e.jsxs("div",{className:"cyber-nav flex items-center flex-wrap",children:[e.jsx("span",{className:"inline-block pulse-dot mr-1","data-testid":"app-indicator",children:"â– "}),e.jsxs("span",{className:"mr-1 version-tag","data-testid":"app-version",children:["v",i]}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://github.com/Hack23/cia-compliance-manager",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":"source-link",children:"Source"}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://hack23.github.io/cia-compliance-manager/documentation.html",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":"docs-link",children:"Doc"}),e.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),e.jsx("a",{href:"https://hack23.com/",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":"author-link",children:"Hack23"})]})]})]}),e.jsx("button",{onClick:c,className:"theme-toggle-btn","data-testid":"theme-toggle",children:h?"â˜€ï¸ Light":"ðŸŒ™ Dark"})]}),e.jsx("div",{className:"w-full max-w-[1600px] mx-auto",children:e.jsxs("div",{"data-testid":"dashboard-grid",className:"dashboard-grid-container",children:[e.jsx("div",{className:"grid-widget-container",children:e.jsx(ur,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,onAvailabilityChange:k,onIntegrityChange:H,onConfidentialityChange:w,testId:"widget-security-level"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(cr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-business-impact"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(xr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-security-summary"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(vr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-value-creation"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(fr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-cost-estimation"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(br,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-compliance-status"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(Nr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-confidentiality-impact"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(jr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"integrity-impact-widget"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(kr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-availability-impact"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(Mr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-technical-details"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(Cr,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"widget-security-visualization"})}),e.jsx("div",{className:"grid-widget-container",children:e.jsx(Ir,{availabilityLevel:n,integrityLevel:o,confidentialityLevel:x,testId:"security-resources-widget"})})]})})]})})};function Ar(){return e.jsx("div",{className:"app-container","data-testid":We.APP_CONTAINER,children:e.jsx(Er,{})})}const Hr=lt.createRoot(document.getElementById("root"));Hr.render(e.jsx(dt.StrictMode,{children:e.jsx(Ar,{})}));
//# sourceMappingURL=index-BF2wwWuj.js.map
