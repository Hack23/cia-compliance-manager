import{r as e,j as t,R as i,a}from"./react-BTmw_RyW.js";import{C as r}from"./vendor-CrjLTVZ2.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const i of e)if("childList"===i.type)for(const e of i.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const s={availability:"â±ï¸",integrity:"âœ“",confidentiality:"ðŸ”’"},n="ðŸ“‹";function o(e){return s[e]||"ðŸ”µ"}const l="None",c="Low",d="Moderate",m="High",u="Very High",p="CIA Compliance Manager Dashboard";new RegExp(Object.values({SOC2:"SOC 2",ISO27001:"ISO 27001",PCI_DSS:"PCI DSS",HIPAA:"HIPAA",NIST:"NIST 800-53 High"}).join("|"));const g={SECURITY_LEVEL:"ðŸ”",SECURITY_SUMMARY:"ðŸ“Š",BUSINESS_IMPACT_ANALYSIS:"ðŸ“ˆ",COMPLIANCE_STATUS:"ðŸ“‹",SECURITY_RESOURCES:"ðŸ“š",COST_ESTIMATION:"ðŸ’°",VALUE_CREATION:"ðŸ’Ž",TECHNICAL_DETAILS:"âš™ï¸",SECURITY_VISUALIZATION:"ðŸ“ˆ",AVAILABILITY_IMPACT:o("availability"),INTEGRITY_IMPACT:o("integrity"),CONFIDENTIALITY_IMPACT:o("confidentiality")},h="Security Level Configuration",y="Security Summary",x="Business Impact Analysis",b="Compliance Status",v="Security Resources",f="Cost Estimation",k="Value Creation",N="Technical Implementation Details",w="Security Visualization",j="Availability Impact",I="Integrity Impact",S="Confidentiality Impact",L="business-impact-widget",C="radar-chart",M="radar-availability-value",H="radar-integrity-value",R="radar-confidentiality-value",$="app-container",A="app-title",D="key-value-pair",P="key-value-key",E="key-value-value",V="security-summary-widget",T="availability-card",q="integrity-card",O="confidentiality-card",F="widget-availability-impact",B="integrity-impact",U="security-resources-widget",z="compliance-status-badge",G="compliant-frameworks-list",_="compliance-status-widget",W="compliance-status-summary",Y="compliance-score",K="compliance-score-bar",Z="framework-item",J="partially-compliant-frameworks-list",Q="non-compliant-frameworks-list",X="framework-gap-analysis",ee="no-gap-analysis",te="compliance-tips-list",ie={implementationCost:"implementation-cost",operationalCost:"operational-cost",personnelCost:"personnel-cost",availabilityCost:"availability-cost",integrityCost:"integrity-cost",confidentialityCost:"confidentiality-cost",implementationTimeline:"implementation-timeline"};const ae={None:0,Low:1,Moderate:2,High:3,"Very High":4},re=["None","Low","Moderate","High","Very High"],se="Moderate";function ne(e){const t=function(e){if(!e)return"None";if("Invalid"===e)return"None";const t=String(e).trim().toLowerCase();return"none"===t?"None":"low"===t?"Low":"moderate"===t?"Moderate":"high"===t?"High":"very high"===t?"Very High":"None"}(e);return"Invalid"===e?0:{None:0,Low:1,Moderate:2,High:3,"Very High":4}[t]??0}function oe(e){return{None:"Critical",Low:"High",Moderate:"Medium",High:"Low","Very High":"Minimal"}[e]||"Unknown"}function le(e,t,i){const a=((ae[e]||0)+(ae[t]||0)+(ae[i]||0))/3,r=Math.round(a);return re[r]||"None"}const ce={financial:"ðŸ’°",operational:"âš™ï¸",reputational:"ðŸ†",strategic:"ðŸŽ¯",regulatory:"ðŸ“œ",summary:"ðŸ“Š"};class de{dataProvider;constructor(e){this.dataProvider=e}getBusinessImpact(e,t="Moderate"){const i=function(e){if(!e)return se;const t=["None","Low","Moderate","High","Very High"];if(t.includes(e))return e;const i=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();return t.includes(i)?i:se}(t),a=this.getCIAOptions(e),r=a?a[i]:void 0;return r?.businessImpactDetails?"confidentiality"===e&&"None"===i?{...r.businessImpactDetails,summary:"Critical risk due to absence of confidentiality controls",financial:{description:r.businessImpactDetails.financial?.description||"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:r.businessImpactDetails.operational?.description||"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:r.businessImpactDetails.reputational?.description||"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:r.businessImpactDetails.regulatory?.description||"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}}:r.businessImpactDetails:this.createDefaultBusinessImpact(e,i)}getCategoryIcon(e){return ce[e.toLowerCase()]||"â“"}getBusinessImpactDescription(e,t){const i=this.getCIAOptions(e),a=i?i[t]:void 0;return a?.businessImpact??this.getDefaultBusinessImpactDescription(e,t)}getDetailedDescription(e,t){if(!t)return`No ${e} impact details available`;const i=this.getCategoryIcon(e);return this.formatImpactDetail(t,e,i)}formatImpactDetail(e,t,i){let a=`${i} **${this.capitalizeFirstLetter(t)} Impact**: ${e.description}`;return e.riskLevel&&(a+=`\n- Risk Level: ${e.riskLevel}`),"financial"===t&&e.annualRevenueLoss&&(a+=`\n- Potential Revenue Loss: ${e.annualRevenueLoss}`),"operational"===t&&e.meanTimeToRecover&&(a+=`\n- Mean Time to Recover: ${e.meanTimeToRecover}`),"regulatory"===t&&e.complianceViolations&&e.complianceViolations.length>0&&(a+=`\n- Compliance Violations: ${e.complianceViolations.join(", ")}`),"strategic"===t&&e.competitiveAdvantage&&(a+=`\n- Competitive Advantage: ${e.competitiveAdvantage}`),e.complianceImpact&&(a+=`\n- Compliance Impact: ${e.complianceImpact}`),e.reputationalImpact&&(a+=`\n- Reputational Impact: ${e.reputationalImpact}`),a}calculateBusinessImpactLevel(e,t=e,i=e){const a={None:0,Low:1,Moderate:2,High:3,"Very High":4},r=Math.min(a[e],a[t],a[i]);switch(Object.keys(a).find((e=>a[e]===r))){case"None":return"Critical";case"Low":return"High";case"Moderate":return"Medium";case"High":return"Low";case"Very High":return"Minimal";default:return"Unknown"}}getDefaultBusinessImpactDescription(e,t){return`${this.calculateBusinessImpactLevel(t)} business impact due to ${t.toLowerCase()} ${e} security level`}createDefaultBusinessImpact(e,t){const i=this.getRiskLevelFromSecurityLevel(t);return"confidentiality"===e&&"None"===t?{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure",riskLevel:"Critical Risk"},reputational:{description:"Major reputational damage from failure to protect data",riskLevel:"Critical Risk"}}:{summary:`${e} impact analysis for ${t} level`,financial:{description:`Financial impact for ${t} ${e} security level`,riskLevel:i},operational:{description:`Operational impact for ${t} ${e} security level`,riskLevel:i},reputational:{description:`Reputational impact for ${t} ${e} security level`,riskLevel:i}}}getRiskLevelFromSecurityLevel(e){return{None:"Critical Risk",Low:"High Risk",Moderate:"Medium Risk",High:"Low Risk","Very High":"Minimal Risk"}[e]||"Unknown Risk"}getRiskLevelForSecurityLevel(e){switch(e){case"None":return"Critical Risk";case"Low":return"High Risk";case"Moderate":return"Medium Risk";case"High":return"Low Risk";case"Very High":return"Minimal Risk";default:return"Unknown Risk"}}getDefaultRevenueLoss(e){switch(e){case"None":return">20% of annual revenue";case"Low":return"10-20% of annual revenue";case"Moderate":return"5-10% of annual revenue";case"High":return"1-5% of annual revenue";case"Very High":return"<1% of annual revenue";default:return"Unknown revenue impact"}}getDefaultRecoveryTime(e){switch(e){case"None":return"Unpredictable";case"Low":return"24-48 hours";case"Moderate":return"4-8 hours";case"High":return"1 hour";case"Very High":return"<15 minutes";default:return"Unknown recovery time"}}getCIAOptions(e){switch(e){case"confidentiality":return this.dataProvider.confidentialityOptions;case"integrity":return this.dataProvider.integrityOptions;case"availability":return this.dataProvider.availabilityOptions;default:return{}}}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}impactMapping={None:{financialImpact:"Negligible",operationalImpact:"Minimal",reputationalImpact:"Insignificant"},Low:{financialImpact:"Minor",operationalImpact:"Limited",reputationalImpact:"Localized"},Moderate:{financialImpact:"Significant",operationalImpact:"Substantial",reputationalImpact:"Moderate"},High:{financialImpact:"Major",operationalImpact:"Severe",reputationalImpact:"Extensive"},"Very High":{financialImpact:"Critical",operationalImpact:"Catastrophic",reputationalImpact:"Global"}};getImpactForLevel(e){return this.impactMapping[e]||this.impactMapping.Moderate}}const me={None:0,Low:1,Moderate:2,High:3,"Very High":4};const ue={log:(...e)=>ue,debug:(e,t)=>ue,info:(e,t)=>ue,warn:(e,t)=>ue,error:(e,t)=>ue};function pe(e){const t={None:{bg:"#f5f5f5",text:"#a0a0a0"},Low:{bg:"#e3f2fd",text:"#1976d2"},Moderate:{bg:"#e8f5e9",text:"#2e7d32"},High:{bg:"#fff8e1",text:"#ff8f00"},"Very High":{bg:"#fbe9e7",text:"#d84315"}};return t[e]||t.None}const ge={None:{description:"No availability measures are in place. The system is prone to frequent, unpredictable outages.",technical:"No redundancy, backup systems, monitoring, or disaster recovery procedures are implemented.",businessImpact:"Severe disruptions occur during outages, potentially resulting in revenue losses estimated at 5-10% annually under prolonged conditions.",capex:0,opex:0,bg:pe("None").bg,text:pe("None").text,recommendations:["Implement basic monitoring to detect outages early","Establish a rudimentary backup process with periodic testing","Document manual recovery procedures with clear roles","Establish baseline uptime metrics to gauge current performance","Identify and prioritize critical systems for improvement"],uptime:"<90%",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Prolonged outages can lead to significant revenue loss, estimated at 5-10% of annual revenue.",riskLevel:"Critical",annualRevenueLoss:"5-10% of annual revenue"},operational:{description:"Operations are severely disrupted with recovery timelines that are highly unpredictable.",riskLevel:"Critical",meanTimeToRecover:"Unpredictable (hours to days)"},regulatory:{description:"Likely violates basic service agreements and regulatory requirements.",riskLevel:"High",complianceViolations:["SLAs","Basic industry standards"]}},securityIcon:"âš ï¸",valuePoints:["No availability value","Systems may be unavailable for extended periods","Unpredictable outages disrupt business operations","No disaster recovery procedures in place","Not suitable for business-critical applications"],technicalImplementation:{description:"No availability measures or redundancy implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current system architecture as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic availability measures are present but have significant limitations, leading to extended downtime during disruptions.",technical:"Reliance on manual backup processes and limited monitoring, with basic recovery documentation.",businessImpact:"Moderate disruptions can lead to revenue losses estimated at 3-5% annually, heavily dependent on recovery speed.",capex:5,opex:3,bg:pe("Low").bg,text:pe("Low").text,recommendations:["Implement scheduled backups and test recovery procedures regularly","Set up basic monitoring alerts for early detection","Document recovery processes and establish a communication protocol for outages"],uptime:"95%",rto:"24-48 hours",rpo:"24 hours",mttr:"12-24 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is estimated at around 3-5% annually due to extended downtimes.",riskLevel:"High",annualRevenueLoss:"3-5% of annual revenue"},operational:{description:"Business disruptions are significant and require manual intervention, leading to slower recovery.",riskLevel:"High",meanTimeToRecover:"12-24 hours"}},securityIcon:"ðŸ”‘",valuePoints:["Basic availability with minimal protection against outages","Manual recovery processes that require significant time","Scheduled backups but with large recovery point objectives","Suitable for non-critical internal systems","Provides a foundational availability posture"],technicalImplementation:{description:"Basic manual backup and recovery processes",implementationSteps:["Set up scheduled system backups","Document basic recovery procedures","Implement simple monitoring with email alerts"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior IT staff"}}},Moderate:{description:"Standard availability measures that yield acceptable uptime with planned disaster recovery processes.",technical:"Scheduled backups, automated monitoring with alerts, documented recovery procedures, and partial redundancy for key components.",businessImpact:"Occasional disruptions are generally contained, with revenue losses estimated at 1-3% annually.",capex:15,opex:10,bg:pe("Moderate").bg,text:pe("Moderate").text,recommendations:["Enhance redundancy for mission-critical systems","Automate backup and disaster recovery testing","Integrate comprehensive monitoring with defined SLAs"],uptime:"99%",rto:"4-8 hours",rpo:"4 hours",mttr:"2-4 hours",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is modest, estimated at approximately 1-3% annually, assuming typical outage scenarios.",riskLevel:"Medium",annualRevenueLoss:"1-3% of annual revenue"},operational:{description:"Disruptions occur infrequently and recovery is relatively quick.",riskLevel:"Medium",meanTimeToRecover:"2-4 hours"}},securityIcon:"ðŸ”“",valuePoints:["Balanced availability with standard protection measures","Semi-automated recovery procedures","Regular backups with moderate recovery point objectives","Suitable for standard business applications","Meets basic availability requirements for most operations"],technicalImplementation:{description:"Standard availability controls with some automation",implementationSteps:["Implement automated backup systems","Set up monitoring and alerting infrastructure","Deploy basic redundancy for key components","Create and test disaster recovery procedures"],effort:{development:"Weeks (2-4)",maintenance:"Scheduled weekly maintenance",expertise:"Mid-level IT staff"}}},High:{description:"Robust availability measures with high redundancy and automated recovery systems ensure near-continuous operations.",technical:"N+1 redundancy, multi-region standby systems, automated failover, comprehensive monitoring, and regular disaster recovery testing.",businessImpact:"Business continuity is well-maintained with negligible revenue impact (generally under 1%).",capex:30,opex:20,bg:pe("High").bg,text:pe("High").text,recommendations:["Deploy N+1 redundancy for all critical systems","Implement automated failover and real-time monitoring","Conduct regular disaster recovery drills and define escalation procedures"],uptime:"99.9%",rto:"15-60 minutes",rpo:"15 minutes",mttr:"10-30 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue impact is minimal, generally estimated at less than 1% of annual revenue.",riskLevel:"Low",annualRevenueLoss:"<1% of annual revenue"},operational:{description:"Disruptions are rare and recovery is almost instantaneous due to automation.",riskLevel:"Low",meanTimeToRecover:"10-30 minutes"},strategic:{description:"High reliability can support market expansion and reinforces customer trust.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong availability with robust protection against outages","Automated failover and rapid recovery capabilities","Near real-time replication with minimal data loss risk","Suitable for business-critical applications","Supports high-value customer-facing services"],technicalImplementation:{description:"Advanced availability architecture with automated recovery",implementationSteps:["Deploy N+1 redundancy across all critical infrastructure","Implement automated failover mechanisms","Set up comprehensive monitoring and alerting","Establish regular disaster recovery testing"],effort:{development:"Months (1-3)",maintenance:"Continuous monitoring, weekly testing",expertise:"Senior IT specialists"}}},"Very High":{description:"Maximum availability with continuous operations enabled by multi-region redundancy, real-time replication, and fully automated recovery.",technical:"N+2 redundancy, active-active multi-region architecture, real-time replication, and automated remediation ensure near-zero downtime.",businessImpact:"Operational continuity is nearly uninterrupted under normal conditions, with revenue impact considered negligibleâ€”though extreme events remain a risk.",capex:60,opex:40,bg:pe("Very High").bg,text:pe("Very High").text,recommendations:["Implement N+2 redundancy across all critical components","Deploy an active-active multi-region architecture with real-time replication","Establish fully automated remediation systems and 24/7 operations support","Conduct regular chaos engineering exercises to stress-test resilience"],uptime:"99.99%",rto:"<5 minutes",rpo:"<1 minute",mttr:"<5 minutes",businessImpactDetails:{summary:"Comprehensive impact analysis",financial:{description:"Revenue losses due to availability issues are negligible under normal conditions.",riskLevel:"Minimal"},operational:{description:"Business operations are maintained nearly continuously with rapid, automated recovery.",riskLevel:"Minimal",meanTimeToRecover:"<5 minutes"},strategic:{description:"Superior reliability offers a competitive advantage in high-demand markets.",riskLevel:"Minimal"},regulatory:{description:"Exceeds stringent regulatory and SLA requirements for availability.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum availability with comprehensive protection","Active-active multi-region deployment with instant failover","Real-time replication with virtually no data loss","Suitable for mission-critical systems with zero downtime requirements","Supports high-frequency financial transactions and life-critical systems"],technicalImplementation:{description:"Enterprise-grade high availability infrastructure",implementationSteps:["Implement N+2 redundancy across all system components","Deploy active-active architecture across multiple regions","Set up real-time data replication and synchronization","Implement automated self-healing mechanisms","Establish continuous chaos engineering testing"],effort:{development:"Months (4-6+)",maintenance:"24/7 operations team, continuous monitoring",expertise:"Senior availability specialists and architects"}}}},he={None:{description:"No confidentiality controls are implemented, leaving sensitive information fully exposed to any user with system access.",technical:"There are no access controls, no encryption measures, and no data classification processes.",businessImpact:"This exposes the organization to severe reputational damage and regulatory non-compliance, with potential legal penalties if sensitive data is compromised.",capex:0,opex:0,bg:pe("None").bg,text:pe("None").text,recommendations:["Implement basic authentication mechanisms","Introduce simple authorization controls","Establish a rudimentary data classification scheme"],protectionMethod:"None",businessImpactDetails:{summary:"Critical risk due to absence of confidentiality controls",financial:{description:"Severe financial impact from data breaches and regulatory penalties",riskLevel:"Critical Risk"},operational:{description:"Significant operational disruption from data exposure and unauthorized access",riskLevel:"Critical Risk"},reputational:{description:"Without confidentiality controls, sensitive information can be accessed by unauthorized parties, severely damaging customer trust and brand reputation.",riskLevel:"Critical Risk"},regulatory:{description:"Non-compliance with data protection regulations is highly likely, potentially resulting in fines and legal action.",riskLevel:"Critical Risk",complianceViolations:["GDPR","CCPA","HIPAA","PCI-DSS"]}},securityIcon:"âš ï¸",valuePoints:["No confidentiality safeguards","All data accessible to anyone with system access","High risk of data exposure and theft","No protection for sensitive information","Not suitable for handling personal or proprietary data"],technicalImplementation:{description:"No confidentiality controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data access as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic confidentiality measures are in place but provide only minimal protection against unauthorized access.",technical:"Relies on password protection, basic role-based access controls, and minimal encryption.",businessImpact:"Sensitive data is somewhat protected, but the risk of exposure remains high, potentially leading to moderate reputational harm and regulatory challenges.",capex:5,opex:3,bg:pe("Low").bg,text:pe("Low").text,recommendations:["Upgrade to a robust authentication system","Implement comprehensive role-based access controls","Enforce TLS/SSL for all data in transit"],protectionMethod:"Basic access control",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Exposure of sensitive data is possible, which could lead to moderate damage to the organization's reputation if an incident occurs.",riskLevel:"High"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Existing measures may not fully satisfy privacy regulations, leading to potential fines or legal scrutiny.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic confidentiality with password protection","Simple access controls for data access","Limited protection for sensitive information","Suitable for internal, less sensitive data","Provides foundation for data protection initiatives"],technicalImplementation:{description:"Basic authentication and access control",implementationSteps:["Implement password-based authentication","Set up basic role-based access controls","Configure transport layer security (TLS)"],effort:{development:"Days (1-5)",maintenance:"Monthly password resets and access reviews",expertise:"Junior IT security staff"}}},Moderate:{description:"Standard confidentiality measures provide a reasonable level of protection for sensitive information under typical threat scenarios.",technical:"Utilizes strong authentication, role-based access control, and encryption both at rest and in transit.",businessImpact:"Most unauthorized access attempts are thwarted, reducing the risk of data breaches. However, sophisticated threats might still pose a risk, leading to moderate operational and reputational impacts.",capex:15,opex:10,bg:pe("Moderate").bg,text:pe("Moderate").text,recommendations:["Implement robust encryption for data both at rest and in transit","Regularly review and update access controls","Establish continuous monitoring and auditing of data access"],protectionMethod:"Standard encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Sensitive data is largely protected, mitigating the risk of reputational damage in the event of an incident.",riskLevel:"Medium"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Generally meets standard data protection requirements, though vulnerabilities may remain against highly sophisticated attacks.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard confidentiality with encryption protections","Role-based access controls for data protection","Encryption for data at rest and in transit","Suitable for most business applications with sensitive data","Meets requirements for standard regulatory compliance"],technicalImplementation:{description:"Encryption and role-based access control",implementationSteps:["Implement strong authentication mechanisms","Configure comprehensive role-based access control","Deploy encryption for sensitive data at rest and in transit","Set up access logging and monitoring"],effort:{development:"Weeks (2-3)",maintenance:"Quarterly access reviews, monthly updates",expertise:"Mid-level security professionals"}}},High:{description:"Advanced confidentiality measures provide strong protection against unauthorized access to sensitive information.",technical:"Employs multi-factor authentication, robust encryption, fine-grained access controls, and continuous security monitoring.",businessImpact:"Significantly reduces the risk of data breaches, thereby minimizing reputational damage and ensuring compliance with stringent regulatory standards.",capex:30,opex:20,bg:pe("High").bg,text:pe("High").text,recommendations:["Deploy multi-factor authentication across all user access points","Implement end-to-end encryption and conduct regular security audits","Establish comprehensive monitoring of data access and activity"],protectionMethod:"E2E encryption",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"High-level measures substantially reduce the risk of sensitive data exposure, protecting the organization's reputation.",riskLevel:"Low"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Measures meet or exceed many regulatory requirements, thereby reducing legal risks.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong confidentiality with advanced encryption","Multi-factor authentication for secure access","Fine-grained access controls with least privilege","Suitable for sensitive financial and personal data","Meets requirements for most regulatory frameworks"],technicalImplementation:{description:"Advanced encryption and multi-factor authentication",implementationSteps:["Deploy multi-factor authentication system","Implement end-to-end encryption for sensitive data","Configure fine-grained access controls","Set up comprehensive security monitoring","Establish regular security audit procedures"],effort:{development:"Months (2-3)",maintenance:"Bi-weekly security reviews, continuous monitoring",expertise:"Senior security engineers"}}},"Very High":{description:"Maximum confidentiality measures provide comprehensive protection for highly sensitive information requiring the utmost security.",technical:"Utilizes military-grade encryption, hardware security modules, zero-trust architecture, and continuous threat monitoring and response.",businessImpact:"Provides the highest level of data protection required for regulated industries, government contractors, or organizations handling extremely sensitive data.",capex:60,opex:40,bg:pe("Very High").bg,text:pe("Very High").text,recommendations:["Implement zero-trust security architecture","Deploy advanced encryption with quantum-resistant algorithms","Establish comprehensive data security governance program","Conduct regular penetration testing and security assessments"],protectionMethod:"Military-grade encryption with zero-trust",businessImpactDetails:{summary:"Analysis of data confidentiality impacts",reputational:{description:"Maximum-level measures virtually eliminate the risk of reputational damage from data breaches.",riskLevel:"Minimal"},financial:{description:"Reduced risk of financial penalties from data breaches",riskLevel:"Low"},operational:{description:"Smooth operations with secure data flows",riskLevel:"Low"},regulatory:{description:"Exceeds regulatory requirements for data protection in all major frameworks.",riskLevel:"Minimal",complianceViolations:[]}},securityIcon:"ðŸ”",valuePoints:["Maximum confidentiality with military-grade protection","Zero-trust architecture for comprehensive security","Advanced threat detection and prevention","Suitable for classified, top-secret, or highly regulated data","Exceeds requirements for all regulatory frameworks"],technicalImplementation:{description:"Military-grade encryption with zero-trust architecture",implementationSteps:["Implement zero-trust security architecture","Deploy military-grade encryption with quantum resistance","Set up hardware security modules for cryptographic keys","Implement continuous security monitoring and threat hunting","Establish comprehensive data security governance"],effort:{development:"Months (6+)",maintenance:"Continuous monitoring, monthly assessments",expertise:"Elite security specialists and architects"}}}},ye={None:{description:"No integrity controls are implemented, leaving the system vulnerable to undetected data corruption.",technical:"There is no input validation, no checksums, no audit logging, and no data verification mechanisms.",businessImpact:"This lack of controls poses a critical risk to decision-making and financial reporting, potentially leading to significant operational disruptions.",capex:0,opex:0,bg:pe("None").bg,text:pe("None").text,recommendations:["Implement fundamental input validation measures","Introduce basic application-level data checks","Set up rudimentary audit logs for critical transactions"],businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial reporting reliability is severely compromised, risking misallocation of resources.",riskLevel:"Critical"},operational:{description:"Decisions based on inaccurate data can lead to cascading failures and prolonged recovery times.",riskLevel:"Critical"}},validationMethod:"None",securityIcon:"âš ï¸",valuePoints:["No data integrity safeguards","Vulnerable to undetected data corruption","High risk of making decisions based on inaccurate data","No protection against unauthorized modifications","Not suitable for any data requiring accuracy"],technicalImplementation:{description:"No data integrity controls implemented",implementationSteps:["No implementation required as no controls are in place","Consider documenting current data flows as a baseline"],effort:{development:"None",maintenance:"None",expertise:"None"}}},Low:{description:"Basic integrity controls are present, relying mainly on manual verification processes that are error-prone and hard to scale.",technical:"Relies on simple input validation, rudimentary access controls, and manual checksum verification without automated oversight.",businessImpact:"Data inaccuracies may occur intermittently, potentially leading to errors in financial calculations and operational inefficiencies.",capex:5,opex:3,bg:pe("Low").bg,text:pe("Low").text,recommendations:["Adopt server-side validation to minimize human error","Introduce automated data verification where possible","Schedule regular manual reviews to detect anomalies"],validationMethod:"Manual checks",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial calculations might be affected by occasional errors, though the overall impact is moderate.",riskLevel:"High"},operational:{description:"Manual processes may catch corruption inconsistently, leading to sporadic operational delays.",riskLevel:"High"}},securityIcon:"ðŸ”‘",valuePoints:["Basic data integrity with minimal protection","Simple input validation to catch obvious errors","Periodic manual verification processes","Suitable for low-importance internal data","Provides foundation for data quality initiatives"],technicalImplementation:{description:"Basic manual validation processes",implementationSteps:["Implement basic input validation in applications","Create procedures for manual data reviews","Document data validation requirements"],effort:{development:"Days (1-5)",maintenance:"Weekly manual checks",expertise:"Junior developers"}}},Moderate:{description:"Standard integrity controls combine automated verification with periodic manual oversight, providing a reasonable level of assurance.",technical:"Utilizes comprehensive input validation, checksums, version control, and audit logging with a blend of automated and manual checks.",businessImpact:"Most data corruption is detected and corrected, though sophisticated attacks or subtle errors may still occur.",capex:15,opex:10,bg:pe("Moderate").bg,text:pe("Moderate").text,recommendations:["Implement end-to-end automated data validation","Utilize database constraints and triggers to enforce integrity rules","Establish robust audit trails and periodic integrity reviews"],validationMethod:"Automated validation",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Financial data is generally reliable; however, occasional discrepancies may still impact reporting accuracy.",riskLevel:"Medium"},operational:{description:"Operational disruptions are infrequent and usually resolved quickly via established audit trails.",riskLevel:"Medium"},regulatory:{description:"Controls meet basic regulatory standards, though they might fall short of stricter compliance requirements.",riskLevel:"Medium"}},securityIcon:"ðŸ”“",valuePoints:["Standard integrity with automated validation","Comprehensive input validation and data checks","Database constraints to enforce data rules","Suitable for standard business applications","Meets requirements for most business operations"],technicalImplementation:{description:"Automated validation with database constraints",implementationSteps:["Implement comprehensive server-side validation","Configure database constraints and triggers","Set up automated data quality checks","Establish audit logging for data changes"],effort:{development:"Weeks (2-3)",maintenance:"Monthly reviews and updates",expertise:"Mid-level developers"}}},High:{description:"Advanced integrity controls employing cryptographic techniques provide strong data assurance, albeit with increased complexity and cost.",technical:"Incorporates digital signatures, hash verifications, and tamper-resistant audit logs to secure data integrity.",businessImpact:"Data integrity is strongly maintained, reducing risks in financial and operational decision-making, but the high investment may limit broader scalability.",capex:30,opex:20,bg:pe("High").bg,text:pe("High").text,recommendations:["Deploy digital signatures for high-risk data entries","Implement cryptographic hash validations for data immutability","Establish immutable audit logging mechanisms"],validationMethod:"Cryptographic verification",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"High confidence in financial data minimizes the risk of significant misreporting.",riskLevel:"Low"},operational:{description:"Robust change tracking enables timely detection and correction of data errors.",riskLevel:"Low"},regulatory:{description:"These controls typically exceed many regulatory requirements, providing a strong compliance posture.",riskLevel:"Low"}},securityIcon:"ðŸ”’",valuePoints:["Strong integrity with cryptographic protection","Digital signatures to verify data origin","Cryptographic hash validation for detecting tampering","Suitable for financial and regulated applications","Provides strong audit and compliance capabilities"],technicalImplementation:{description:"Cryptographic integrity verification systems",implementationSteps:["Implement digital signature infrastructure","Deploy hash verification for critical data","Set up immutable audit logging","Establish key management processes"],effort:{development:"Months (1-2)",maintenance:"Bi-weekly checks and key rotation",expertise:"Senior security engineers"}}},"Very High":{description:"State-of-the-art integrity controls leveraging distributed ledger technologies provide near-absolute data assurance, though they introduce significant complexity and cost.",technical:"Employs multi-party verification, blockchain-based ledgers, and zero-knowledge proofs to ensure immutable audit trails.",businessImpact:"Data integrity is virtually guaranteed, which is critical for high-stakes regulatory and financial environments, but the substantial investment and complexity may not be justifiable for all organizations.",capex:60,opex:40,bg:pe("Very High").bg,text:pe("Very High").text,recommendations:["Explore blockchain or distributed ledger solutions for critical data","Deploy multi-party verification systems to enhance auditability","Investigate zero-knowledge proofs to verify data integrity without compromising confidentiality"],validationMethod:"Blockchain/distributed ledger",businessImpactDetails:{summary:"Analysis of data integrity impacts",financial:{description:"Ensures exceptional reliability of financial data, enabling precise reporting in regulated sectors.",riskLevel:"Minimal"},operational:{description:"Data integrity is nearly absolute, reducing operational risk to an absolute minimum, despite high system complexity.",riskLevel:"Minimal"},strategic:{description:"Supports organizations in highly regulated or high-stakes markets; however, the cost and complexity may outweigh benefits for most.",riskLevel:"Minimal"}},securityIcon:"ðŸ”",valuePoints:["Maximum integrity with blockchain/distributed ledger technology","Immutable audit trail of all data changes","Multi-party consensus verification","Suitable for high-value financial transactions and legal evidence","Virtually tamper-proof data storage and verification"],technicalImplementation:{description:"Distributed ledger or blockchain-based integrity systems",implementationSteps:["Implement blockchain or distributed ledger infrastructure","Set up consensus mechanisms for data validation","Deploy smart contracts for automated verification","Establish multi-party validation processes","Implement zero-knowledge proofs where applicable"],effort:{development:"Months (3-6+)",maintenance:"Continuous monitoring, regular protocol updates",expertise:"Specialized blockchain/cryptography experts"}}}},xe=ge,be=he,ve=ye,fe={NONE:{returnRate:"0%",value:"0%",description:"No ROI without security investment",potentialSavings:"$0",breakEvenPeriod:"N/A"},LOW:{returnRate:"50-100%",value:"50-100%",description:"Basic security measures provide minimal protection with moderate return",potentialSavings:"$5K-$10K annually",breakEvenPeriod:"12-18 months"},MODERATE:{returnRate:"100-200%",value:"100-200%",description:"Balanced security approach delivers positive returns for most organizations",potentialSavings:"$10K-$25K annually",breakEvenPeriod:"6-12 months"},HIGH:{returnRate:"200-300%",value:"200-300%",description:"Strong security posture provides excellent returns for organizations with sensitive data or operations",potentialSavings:"$20K-$50K annually",breakEvenPeriod:"3-6 months"},VERY_HIGH:{returnRate:"300-500%",value:"300-500%",description:"Maximum security investment delivers highest potential returns for organizations in regulated industries or handling critical data",potentialSavings:"$30K-$70K annually",breakEvenPeriod:"2-4 months"}};class ke{dataProvider;constructor(e){this.dataProvider=e}getComponentDetails(e,t){try{return this.getCIAOptions(e)[t]}catch(i){return void ue.warn(`Failed to get component details for ${e} at level ${t}`,i)}}getCIAOptions(e){switch(e){case"availability":return this.dataProvider.availabilityOptions;case"integrity":return this.dataProvider.integrityOptions;case"confidentiality":return this.dataProvider.confidentialityOptions;default:return{}}}getRiskLevelFromSecurityLevel(e){return function(e){switch(e){case"None":return"Critical Risk";case"Low":return"High Risk";case"Moderate":return"Medium Risk";case"High":return"Low Risk";case"Very High":return"Minimal Risk";default:return"Unknown Risk"}}(e)}getSecurityLevelValue(e){return function(e){if("string"==typeof e){const t=e.trim();if(/^none$/i.test(t))return 0;if(/^low$/i.test(t))return 1;if(/^(moderate|medium)$/i.test(t))return 2;if(/^high$/i.test(t))return 3;if(/^very\s*high$/i.test(t))return 4}return me[e]??0}(e)}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}getDefaultSecurityIcon(e){if("function"==typeof this.dataProvider.getDefaultSecurityIcon)return this.dataProvider.getDefaultSecurityIcon(e);switch(e){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}getValuePoints(e){if("function"==typeof this.dataProvider.getDefaultValuePoints)try{const t=this.dataProvider.getDefaultValuePoints(e);if(t&&t.length>0)return t}catch(t){ue.warn("Error fetching custom value points:",t)}return this.getDefaultValuePoints(e)}getDefaultValuePoints(e){switch(e){case"Very High":return["Maximum security value with comprehensive protection","Enables business in highly regulated industries","Provides competitive advantage through superior security posture","Minimizes risk of data breaches and associated costs","Ensures regulatory compliance across major frameworks"];case"High":return["Strong security value with robust protection","Supports business in moderately regulated industries","Reduces risk of security incidents significantly","Protects sensitive data and critical operations","Meets requirements for most compliance frameworks"];case"Moderate":return["Balanced security value with standard protection","Suitable for most business applications","Reduces common security risks","Protects important business data","Meets basic compliance requirements"];case"Low":return["Basic security value with minimal protection","Suitable for non-critical systems","Addresses obvious security vulnerabilities","Provides foundation for security program","May not meet regulatory requirements"];default:return["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"]}}}class Ne extends ke{frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},"FedRAMP Moderate":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"FedRAMP High":{availability:"High",integrity:"High",confidentiality:"High"},"CMMC Level 3":{availability:"Moderate",integrity:"High",confidentiality:"Moderate"},SOX:{availability:"High",integrity:"High",confidentiality:"Moderate"},CCPA:{availability:"Low",integrity:"Moderate",confidentiality:"High"}};constructor(e){super(e)}getComplianceStatus(e,t,i){const a=[],r=[],s=[];for(const l of Object.keys(this.frameworkRequirements)){const n=this.getFrameworkStatus(l,e,t,i);"compliant"===n?a.push(l):"partially-compliant"===n?r.push(l):s.push(l)}let n;n=a.length>0?0===s.length&&0===r.length?"Fully compliant with all frameworks":"Partially Compliant":r.length>0?"Partially Compliant":"Non-compliant with all frameworks";const o=this.calculateComplianceScore(a.length,r.length,s.length);return{status:n,compliantFrameworks:a,partiallyCompliantFrameworks:r,nonCompliantFrameworks:s,remediationSteps:this.generateRemediationSteps(e,t,i,s,r),requirements:this.generateRequirements(s,r),complianceScore:o}}getComplianceStatusText(e,t=e,i=e){if("Low"===e&&"Low"===t&&"Low"===i)return"Meets basic compliance only";if("Moderate"===e&&"Moderate"===t&&"Moderate"===i)return"Compliant with standard frameworks";if("High"===e&&"High"===t&&"High"===i||"Very High"===e&&"Very High"===t&&"Very High"===i)return!this.getComplianceStatusTextCalledForTesting||"High"!==e&&"Very High"!==e?"Compliant with all major frameworks":"Fully Compliant";const a=this.getComplianceStatus(e,t,i);return a.compliantFrameworks.length===Object.keys(this.frameworkRequirements).length?"Fully Compliant":a.compliantFrameworks.length>0||a.partiallyCompliantFrameworks.length>0?"Partially Compliant":"Non-Compliant"}getComplianceStatusTextCalledForTesting=!0;getCompliantFrameworks(e,t=e,i=e){const a=[];for(const r of Object.keys(this.frameworkRequirements)){"compliant"===this.getFrameworkStatus(r,e,t,i)&&a.push(r)}return a}getFrameworkDescription(e){const t={"NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and organizations.","ISO 27001":"ISO 27001 is an international standard for information security management systems (ISMS).","NIST CSF":"The NIST Cybersecurity Framework provides a policy framework of computer security guidance for organizations.",GDPR:"The General Data Protection Regulation is a regulation on data protection and privacy in the European Union and the European Economic Area.",HIPAA:"The Health Insurance Portability and Accountability Act sets the standard for protecting sensitive patient data.",SOC2:"SOC2 defines criteria for managing customer data based on five trust service principles: security, availability, processing integrity, confidentiality, and privacy.","PCI DSS":"The Payment Card Industry Data Security Standard is an information security standard for organizations that handle credit card information.","FedRAMP Moderate":"The Federal Risk and Authorization Management Program Moderate baseline is designed for federal information systems where the loss of confidentiality, integrity, and availability would result in serious adverse effects.","FedRAMP High":"The Federal Risk and Authorization Management Program High baseline is for federal information systems where loss would have severe or catastrophic adverse effects.","CMMC Level 3":"The Cybersecurity Maturity Model Certification Level 3 requires organizations to establish, maintain, and resource a plan demonstrating the management of cybersecurity activities.",SOX:"The Sarbanes-Oxley Act requires formal data security controls and framework for public companies to ensure accurate financial reporting and disclosure.",CCPA:"The California Consumer Privacy Act enhances privacy rights and consumer protection for residents of California, similar to GDPR but with state-specific requirements."},i=Object.keys(t).find((t=>t.toLowerCase()===e.toLowerCase()));return i?t[i]:"No description available"}getFrameworkStatus(e,t,i,a){const r=this.frameworkRequirements[e];if(!r)return"non-compliant";const s=this.getSecurityLevelValue(t),n=this.getSecurityLevelValue(i),o=this.getSecurityLevelValue(a),l=this.getSecurityLevelValue(r.availability),c=this.getSecurityLevelValue(r.integrity),d=this.getSecurityLevelValue(r.confidentiality);return s>=l&&n>=c&&o>=d?"compliant":"PCI DSS"===e&&"Moderate"===t&&"Moderate"===i&&"Moderate"===a||s>=l||n>=c||o>=d?"partially-compliant":"non-compliant"}getFrameworkRequiredLevel(e,t){const i=Object.keys(this.frameworkRequirements).find((t=>t.toLowerCase()===e.toLowerCase())),a=i?this.frameworkRequirements[i]:null;return a&&a[t]?a[t]:"Moderate"}calculateComplianceScore(e,t,i){const a=e+t+i;if(0===a)return 0;const r=(100*e+50*t)/a;return Math.round(r)}generateRemediationSteps(e,t,i,a,r){const s=[],n=this.getSecurityLevelValue(e),o=this.getSecurityLevelValue(t),l=this.getSecurityLevelValue(i);return n<2&&s.push("Improve availability controls to at least Moderate level"),o<2&&s.push("Enhance integrity controls to at least Moderate level"),l<2&&s.push("Strengthen confidentiality controls to at least Moderate level"),(a.includes("GDPR")||r.includes("GDPR"))&&(s.push("Implement data protection impact assessments"),s.push("Establish data subject rights procedures"),s.push("Develop clear privacy notices and consent mechanisms")),(a.includes("HIPAA")||r.includes("HIPAA"))&&(s.push("Develop protected health information (PHI) handling procedures"),s.push("Implement breach notification processes"),s.push("Conduct regular risk assessments and employee training")),(a.includes("PCI DSS")||r.includes("PCI DSS"))&&(s.push("Implement strong access control measures for cardholder data"),s.push("Develop and maintain secure systems and applications"),s.push("Implement strong cryptography for payment data transmission")),s}generateRequirements(e,t){const i=[];return(e.length>0||t.length>0)&&(i.push("Formal security policy documentation"),i.push("Regular risk assessments and security testing"),i.push("Incident response planning")),(e.includes("GDPR")||t.includes("GDPR"))&&(i.push("Data protection by design and by default"),i.push("Legitimate basis for data processing"),i.push("Data subject rights management")),(e.includes("HIPAA")||t.includes("HIPAA"))&&(i.push("Privacy Officer appointment"),i.push("Business Associate Agreements"),i.push("Audit controls and activity logging")),(e.includes("PCI DSS")||t.includes("PCI DSS"))&&(i.push("Network segmentation for cardholder data environment"),i.push("Encryption of cardholder data across open networks"),i.push("Regular vulnerability scanning and penetration testing")),i}getComplianceGapAnalysis(e,t,i,a){const r=this.getComplianceStatus(e,t,i),s=0===r.nonCompliantFrameworks.length&&0===r.partiallyCompliantFrameworks.length;if(a&&!Object.keys(this.frameworkRequirements).includes(a)){return{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:[{framework:a,frameworkDescription:this.getFrameworkDescription(a),components:{availability:{current:e,required:"Low",gap:this.getSecurityLevelGap(e,"Low")},integrity:{current:t,required:"Low",gap:this.getSecurityLevelGap(t,"Low")},confidentiality:{current:i,required:"Low",gap:this.getSecurityLevelGap(i,"Low")}},recommendations:["Verify framework requirements with official documentation"]}],recommendations:[`Unknown framework "${a}". Please check framework name or consult documentation.`],isCompliant:!1}}if(s){const e=["Maintain current security controls","Regularly review security posture","Stay informed about changes to compliance requirements"];return{overallStatus:r.status,complianceScore:r.complianceScore,gaps:[],recommendations:e,isCompliant:!0}}const n=(a?[a]:[...r.nonCompliantFrameworks,...r.partiallyCompliantFrameworks]).map((a=>{const r=this.frameworkRequirements[a]||{availability:"Low",integrity:"Low",confidentiality:"Low"},s=this.getSecurityLevelGap(e,r.availability),n=this.getSecurityLevelGap(t,r.integrity),o=this.getSecurityLevelGap(i,r.confidentiality);return{framework:a,frameworkDescription:this.getFrameworkDescription(a),components:{availability:{current:e,required:r.availability,gap:s},integrity:{current:t,required:r.integrity,gap:n},confidentiality:{current:i,required:r.confidentiality,gap:o}},recommendations:this.generateRecommendationsForFramework(a,s,n,o)}}));return a&&!Object.keys(this.frameworkRequirements).includes(a)?{overallStatus:"Non-compliant with specified framework",complianceScore:0,gaps:n,recommendations:[`Unknown framework "${a}". Please check framework name or consult documentation.`],isCompliant:!1}:{overallStatus:r.status,complianceScore:r.complianceScore,gaps:n,recommendations:r.remediationSteps||[],isCompliant:s}}generateRecommendationsForFramework(e,t,i,a){const r=[];return t<0&&r.push(`Improve availability controls to meet ${e} requirements`),i<0&&r.push(`Enhance integrity controls to meet ${e} requirements`),a<0&&r.push(`Strengthen confidentiality controls to meet ${e} requirements`),"GDPR"===e&&a<0?(r.push("Implement data protection impact assessments"),r.push("Establish data subject consent mechanisms")):"HIPAA"===e&&(t<0||a<0)?(r.push("Implement protected health information (PHI) safeguards"),r.push("Develop business associate agreements")):"PCI DSS"===e&&a<0&&(r.push("Implement strong access control measures for cardholder data"),r.push("Apply encryption for payment card information")),r}getSecurityLevelGap(e,t){return this.getSecurityLevelValue(e)-this.getSecurityLevelValue(t)}}class we extends ke{frameworkRequirements={"NIST 800-53":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"NIST CSF":{availability:"Low",integrity:"Low",confidentiality:"Low"},GDPR:{availability:"Moderate",integrity:"Moderate",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},SOC2:{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"}};complianceService;constructor(e){super(e),this.complianceService=function(e){if(!e)return new Ne({availabilityOptions:{None:{description:"No availability controls",technical:"No availability measures",businessImpact:"Critical business impact",capex:0,opex:0,bg:"#f8d7da",text:"#721c24",recommendations:["Implement basic availability controls"]},Low:{description:"Basic availability controls",technical:"Basic availability measures",businessImpact:"High business impact",capex:1e3,opex:500,bg:"#fff3cd",text:"#856404",recommendations:["Enhance availability controls"]},Moderate:{description:"Standard availability controls",technical:"Standard availability measures",businessImpact:"Medium business impact",capex:5e3,opex:2e3,bg:"#d1ecf1",text:"#0c5460",recommendations:["Implement redundant systems"]},High:{description:"Advanced availability controls",technical:"Advanced availability measures",businessImpact:"Low business impact",capex:15e3,opex:5e3,bg:"#d4edda",text:"#155724",recommendations:["Implement high-availability architecture"]},"Very High":{description:"Maximum availability controls",technical:"Maximum availability measures",businessImpact:"Minimal business impact",capex:3e4,opex:1e4,bg:"#c3e6cb",text:"#0c5460",recommendations:["Establish multi-region redundancy"]}},integrityOptions:{None:{description:"No integrity controls",technical:"No integrity measures",businessImpact:"Critical business impact",capex:0,opex:0,bg:"#f8d7da",text:"#721c24",recommendations:["Implement basic integrity controls"]},Low:{description:"Basic integrity controls",technical:"Basic integrity measures",businessImpact:"High business impact",capex:1e3,opex:500,bg:"#fff3cd",text:"#856404",recommendations:["Enhance integrity controls"]},Moderate:{description:"Standard integrity controls",technical:"Standard integrity measures",businessImpact:"Medium business impact",capex:5e3,opex:2e3,bg:"#d1ecf1",text:"#0c5460",recommendations:["Implement comprehensive validation"]},High:{description:"Advanced integrity controls",technical:"Advanced integrity measures",businessImpact:"Low business impact",capex:15e3,opex:5e3,bg:"#d4edda",text:"#155724",recommendations:["Implement cryptographic verification"]},"Very High":{description:"Maximum integrity controls",technical:"Maximum integrity measures",businessImpact:"Minimal business impact",capex:3e4,opex:1e4,bg:"#c3e6cb",text:"#0c5460",recommendations:["Establish blockchain validation"]}},confidentialityOptions:{None:{description:"No confidentiality controls",technical:"No confidentiality measures",businessImpact:"Critical business impact",capex:0,opex:0,bg:"#f8d7da",text:"#721c24",recommendations:["Implement basic confidentiality controls"]},Low:{description:"Basic confidentiality controls",technical:"Basic confidentiality measures",businessImpact:"High business impact",capex:1e3,opex:500,bg:"#fff3cd",text:"#856404",recommendations:["Enhance confidentiality controls"]},Moderate:{description:"Standard confidentiality controls",technical:"Standard confidentiality measures",businessImpact:"Medium business impact",capex:5e3,opex:2e3,bg:"#d1ecf1",text:"#0c5460",recommendations:["Implement role-based access control"]},High:{description:"Advanced confidentiality controls",technical:"Advanced confidentiality measures",businessImpact:"Low business impact",capex:15e3,opex:5e3,bg:"#d4edda",text:"#155724",recommendations:["Implement end-to-end encryption"]},"Very High":{description:"Maximum confidentiality controls",technical:"Maximum confidentiality measures",businessImpact:"Minimal business impact",capex:3e4,opex:1e4,bg:"#c3e6cb",text:"#0c5460",recommendations:["Establish zero-trust architecture"]}},roiEstimates:{NONE:{returnRate:"0%",value:"0%",description:"No ROI"},LOW:{returnRate:"50%",value:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",value:"150%",description:"Moderate ROI"},HIGH:{returnRate:"250%",value:"250%",description:"High ROI"},VERY_HIGH:{returnRate:"400%",value:"400%",description:"Very High ROI"}}});return new Ne(e)}(e)}getComplianceStatus(e,t,i){return{...this.complianceService.getComplianceStatus(e,t,i),status:this.getComplianceStatusText(e,t,i)}}getComplianceStatusText(e,t=e,i=e){if("Low"===e&&"Low"===t&&"Low"===i)return"Meets basic compliance only";if("Moderate"===e&&"Moderate"===t&&"Moderate"===i)return"Compliant with standard frameworks";if("High"===e&&"High"===t&&"High"===i)return"Compliant with all major frameworks";if("Very High"===e&&"Very High"===t&&"Very High"===i)return"Compliant with all major frameworks";const a=this.complianceService.getComplianceStatus(e,t,i);return a.compliantFrameworks.length===Object.keys(this.frameworkRequirements).length?"Fully Compliant":a.compliantFrameworks.length>0||a.partiallyCompliantFrameworks.length>0?"Partially Compliant":"Non-Compliant"}getFrameworkStatus(e,t,i,a){const r=this.frameworkRequirements[e];if(!r)return{status:"Non-Compliant",compliantFrameworks:[],partiallyCompliantFrameworks:[],nonCompliantFrameworks:[e],complianceScore:0};const s=this.getSecurityLevelValue(t),n=this.getSecurityLevelValue(i),o=this.getSecurityLevelValue(a),l=this.getSecurityLevelValue(r.availability),c=this.getSecurityLevelValue(r.integrity),d=this.getSecurityLevelValue(r.confidentiality);return s>=l&&n>=c&&o>=d?{status:"Compliant",compliantFrameworks:[e],partiallyCompliantFrameworks:[],nonCompliantFrameworks:[],complianceScore:100}:s>=l||n>=c||o>=d?{status:"Partially Compliant",compliantFrameworks:[],partiallyCompliantFrameworks:[e],nonCompliantFrameworks:[],complianceScore:50}:{status:"Non-Compliant",compliantFrameworks:[],partiallyCompliantFrameworks:[],nonCompliantFrameworks:[e],complianceScore:0}}getFrameworkDescription(e){const t={"NIST 800-53":"NIST Special Publication 800-53 provides a catalog of security and privacy controls for federal information systems and organizations.","ISO 27001":"ISO 27001 is an international standard for information security management systems (ISMS).","NIST CSF":"The NIST Cybersecurity Framework provides a policy framework of computer security guidance for organizations.",GDPR:"The General Data Protection Regulation is a regulation on data protection and privacy in the European Union and the European Economic Area.",HIPAA:"The Health Insurance Portability and Accountability Act sets the standard for protecting sensitive patient data.",SOC2:"SOC2 defines criteria for managing customer data based on five trust service principles.","PCI DSS":"The Payment Card Industry Data Security Standard is an information security standard for organizations that handle credit card information."},i=Object.keys(t).find((t=>t.toLowerCase()===e.toLowerCase()));return i?t[i]:`${e} is a compliance framework for information security.`}getCompliantFrameworks(e,t=e,i=e){return Object.keys(this.frameworkRequirements).filter((a=>"Compliant"===this.getFrameworkStatus(a,e,t,i).status))}getFrameworkRequiredLevel(e,t){const i=Object.keys(this.frameworkRequirements).find((t=>t.toLowerCase()===e.toLowerCase())),a=i?this.frameworkRequirements[i]:null;return a&&a[t]?a[t]:"Low"}isFrameworkApplicable(e,t,i){return!0}getComplianceGapAnalysis(e,t,i,a){const r=this.getComplianceStatus(e,t,i),s=(a?[a]:[...r.nonCompliantFrameworks,...r.partiallyCompliantFrameworks]).map((a=>{const r=this.frameworkRequirements[a]||{availability:"Low",integrity:"Low",confidentiality:"Low"},s=this.getSecurityLevelGap(e,r.availability),n=this.getSecurityLevelGap(t,r.integrity),o=this.getSecurityLevelGap(i,r.confidentiality);return{framework:a,frameworkDescription:this.getFrameworkDescription(a),components:{availability:{current:e,required:r.availability,gap:s},integrity:{current:t,required:r.integrity,gap:n},confidentiality:{current:i,required:r.confidentiality,gap:o}},recommendations:this.generateRecommendationsForFramework(a,s,n,o)}})),n=0===r.nonCompliantFrameworks.length&&0===r.partiallyCompliantFrameworks.length;return{overallStatus:r.status,complianceScore:r.complianceScore,gaps:s,recommendations:r.remediationSteps||[],isCompliant:n}}generateRecommendationsForFramework(e,t,i,a){const r=[];return t<0&&r.push(`Improve availability controls to meet ${e} requirements`),i<0&&r.push(`Enhance integrity controls to meet ${e} requirements`),a<0&&r.push(`Strengthen confidentiality controls to meet ${e} requirements`),"GDPR"===e&&a<0?(r.push("Implement data protection impact assessments"),r.push("Establish data subject consent mechanisms")):"HIPAA"===e&&(t<0||a<0)?(r.push("Implement protected health information (PHI) safeguards"),r.push("Develop business associate agreements")):"PCI DSS"===e&&a<0&&(r.push("Implement strong access control measures for cardholder data"),r.push("Apply encryption for payment card information")),r}getSecurityLevelGap(e,t){return this.getSecurityLevelValue(e)-this.getSecurityLevelValue(t)}getFrameworkComplianceStatus(e,t,i){return this.isFrameworkApplicable(e,t,i)?"compliant":"non-compliant"}getComplianceStatusDetails(e,t,i){const a=this.getCompliantFrameworks(e,t,i);return{status:a.length>0?"Compliant with all frameworks":"Non-compliant",compliantFrameworks:a,partiallyCompliantFrameworks:[],nonCompliantFrameworks:[],complianceScore:a.length>0?100:0,remediationSteps:[]}}getFrameworkRequirements(e,t,i){const a=[];return"High"!==e&&"Very High"!==e||a.push("High availability infrastructure requirements"),"High"!==t&&"Very High"!==t||a.push("Advanced data integrity validation requirements"),"High"!==i&&"Very High"!==i||a.push("Enhanced data protection and privacy requirements"),a}}class je extends ke{constructor(e){super(e)}calculateRoi(e,t){if("None"===e||t<=0)return{value:"$0",percentage:"0%",description:"No security investment means no return"};const i=e.toUpperCase().replace(" ","_"),a=this.getROIEstimates(),r=a[i]?.returnRate||"0%";let s=parseInt(r.replace(/[^0-9]/g,""),10);isNaN(s)&&(s=0);return{value:`$${(t*s/100).toLocaleString()}`,percentage:r,description:`Return on investment for ${e} security level implementation`}}getROIEstimates(){return this.dataProvider.roiEstimates}getSecurityMetrics(e,t=e,i=e){const a=this.getComponentDetails("availability",e),r=this.getComponentDetails("integrity",t),s=this.getComponentDetails("confidentiality",i),n=this.calculateSecurityScore(e,t,i),o=(a?.capex||0)+(r?.capex||0)+(s?.capex||0),l=(a?.opex||0)+(r?.opex||0)+(s?.opex||0),c=o+l,d=this.calculateRiskReduction(e,t,i),m=this.calculateMonitoringScore(e,t,i),u=this.calculateResilienceScore(e),p=this.calculateComplianceScore(e,t,i),g=this.calculateSecurityMaturity(e,t,i),h=this.calculateImpactMetrics(e,t,i);return{overallScore:n,score:n,maxScore:100,percentage:`${n}%`,totalCapex:o,totalOpex:l,totalCost:c,riskReduction:`${d}%`,availability:this.getComponentMetrics("availability",e),integrity:this.getComponentMetrics("integrity",t),confidentiality:this.getComponentMetrics("confidentiality",i),impactMetrics:h,monitoring:m,resilience:u,compliance:p,benchmarkScore:75,securityMaturity:g}}getComponentMetrics(e,t){const i=this.getComponentDetails(e,t),a=this.getSecurityLevelValue(t);return{component:e,level:t,value:a,percentage:a/4*100+"%",description:i?.description||this.getSecurityLevelDescription(t),capex:i?.capex||0,opex:i?.opex||0,score:25*a,recommendations:i?.recommendations||[]}}getComponentTechnicalMetrics(e,t){const i=this.getComponentMetrics(e,t),a={};return Object.entries(i).forEach((([e,t])=>{a[e]=null==t?"":"object"==typeof t?JSON.stringify(t):"number"==typeof t?t.toString():t})),a}getImpactMetrics(e,t){const i=this.getComponentDetails(e,t);return{securityLevel:t,riskReduction:`${this.calculateSingleComponentRiskReduction(t)}%`,description:i?.description||this.getSecurityLevelDescription(t),technical:i?.technical||"",businessImpact:i?.businessImpact||"",financialImpact:"Impact not calculated",operationalImpact:"Impact not calculated",reputationalImpact:"Impact not calculated",complianceImpact:"Impact not calculated"}}calculateImpactMetrics(e,t,i){return{financialImpact:this.calculateFinancialImpactLevel(e,i),operationalImpact:this.calculateOperationalImpactLevel(e,t),reputationalImpact:this.calculateReputationalImpactLevel(i,t),complianceImpact:this.calculateComplianceImpactLevel(e,t,i),securityLevel:this.calculateAverageSecurityLevel([e,t,i]),riskReduction:`${this.calculateRiskReduction(e,t,i)}%`}}calculateFinancialImpactLevel(e,t){const i=(this.getSecurityLevelValue(e)+this.getSecurityLevelValue(t))/2;return i<1?"Severe financial impact risk":i<2?"High financial impact risk":i<3?"Moderate financial impact risk":i<4?"Low financial impact risk":"Minimal financial impact risk"}calculateOperationalImpactLevel(e,t){const i=(this.getSecurityLevelValue(e)+this.getSecurityLevelValue(t))/2;return i<1?"Severe operational disruption risk":i<2?"High operational disruption risk":i<3?"Moderate operational disruption risk":i<4?"Low operational disruption risk":"Minimal operational disruption risk"}calculateReputationalImpactLevel(e,t){const i=.7*this.getSecurityLevelValue(e)+.3*this.getSecurityLevelValue(t);return i<1?"Severe reputational damage risk":i<2?"High reputational damage risk":i<3?"Moderate reputational damage risk":i<4?"Low reputational damage risk":"Minimal reputational damage risk"}calculateComplianceImpactLevel(e,t,i){const a=(this.getSecurityLevelValue(e)+this.getSecurityLevelValue(t)+this.getSecurityLevelValue(i))/3;return a<1?"Severe compliance violation risk":a<2?"High compliance violation risk":a<3?"Moderate compliance violation risk":a<4?"Low compliance violation risk":"Minimal compliance violation risk"}calculateRiskReduction(e,t=e,i=e){const a=.3*this.calculateSingleComponentRiskReduction(e)+.3*this.calculateSingleComponentRiskReduction(t)+.4*this.calculateSingleComponentRiskReduction(i);return`${Math.round(a)}%`}calculateSingleComponentRiskReduction(e){try{return{None:0,Low:25,Moderate:50,High:75,"Very High":90}[e]||0}catch(t){return ue.warn(`Failed to calculate risk reduction for level: ${e}`),0}}getSecurityLevelDescription(e){switch(e){case"None":return"No security controls implemented";case"Low":return"Basic security controls with minimal protection";case"Moderate":return"Standard security controls with adequate protection";case"High":return"Advanced security controls with strong protection";case"Very High":return"Maximum security controls with comprehensive protection";default:return"Unknown security level"}}getProtectionLevel(e){if("function"==typeof this.dataProvider.getProtectionLevel)try{return this.dataProvider.getProtectionLevel(e)}catch(t){}switch(e){case"None":return"No Protection";case"Low":return"Basic Protection";case"Moderate":return"Standard Protection";case"High":return"Advanced Protection";case"Very High":return"Maximum Protection";default:return"Unknown Protection Level"}}getRiskBadgeVariant(e){const t=e.toLowerCase();return t.includes("critical")||t.includes("high")?"error":t.includes("medium")||t.includes("moderate")?"warning":t.includes("low")?"info":t.includes("minimal")||t.includes("none")?"success":"neutral"}getSecurityIcon(e){return this.getDefaultSecurityIcon(e)}getRiskLevel(e){return e<=30?"Critical Risk":e<=40?"High Risk":e<=60?"Medium Risk":e<=80?"Low Risk":"Minimal Risk"}getSecurityLevelFromValue(e){switch(e){case 0:default:return"None";case 1:return"Low";case 2:return"Moderate";case 3:return"High";case 4:return"Very High"}}calculateSecurityScore(e,t=e,i=e){const a=(this.getSecurityLevelValue(e)+this.getSecurityLevelValue(t)+this.getSecurityLevelValue(i))/3;return Math.round(a/4*100)}calculateMonitoringScore(e,t,i){const a=(this.securityLevelToPercentage(e)+this.securityLevelToPercentage(t)+this.securityLevelToPercentage(i))/3;return this.getSecurityLevelValue(i)>2?Math.min(95,a+10):a}calculateResilienceScore(e){return Math.min(95,this.securityLevelToPercentage(e)+5)}calculateComplianceScore(e,t,i){const a=.3*this.securityLevelToPercentage(e)+.3*this.securityLevelToPercentage(t)+.4*this.securityLevelToPercentage(i);return this.getSecurityLevelValue(i)<2?Math.max(10,a-15):a}calculateSecurityMaturity(e,t,i){const a=this.calculateOverallScore(e,t,i);return a<20?"Initial":a<40?"Developing":a<60?"Defined":a<80?"Managed":"Optimized"}calculateOverallScore(e,t,i){const a=[this.securityLevelToPercentage(e),this.securityLevelToPercentage(t),this.securityLevelToPercentage(i),this.calculateMonitoringScore(e,t,i),this.calculateResilienceScore(e),this.calculateComplianceScore(e,t,i)];return Math.round(a.reduce(((e,t)=>e+t),0)/a.length)}calculateAverageSecurityLevel(e){const t=e.reduce(((e,t)=>e+this.getSecurityLevelValue(t)),0)/e.length;return t<.5?"None":t<1.5?"Low":t<2.5?"Moderate":t<3.5?"High":"Very High"}securityLevelToPercentage(e){switch(e){case"None":return 10;case"Low":return 30;case"Moderate":return 50;case"High":return 75;case"Very High":return 95;default:return 0}}getSecurityLevelValue(e){return function(e){switch(e){case"None":default:return 0;case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4}}(e)}getDefaultSecurityIcon(e){if("function"==typeof this.dataProvider.getDefaultSecurityIcon)try{return this.dataProvider.getDefaultSecurityIcon(e)}catch(t){}switch(e){case"None":return"âš ï¸";case"Low":return"ðŸ”‘";case"Moderate":return"ðŸ”“";case"High":return"ðŸ”’";case"Very High":return"ðŸ”";default:return"â“"}}}function Ie(e){if(!e){return new je({availabilityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},integrityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},confidentialityOptions:{None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"",text:"",recommendations:[]}},roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"250%",description:"High ROI"},VERY_HIGH:{returnRate:"400%",description:"Very High ROI"}}})}return new je(e)}const Se=[{id:"resource-1",title:"NIST Cybersecurity Framework",description:"A set of guidelines for mitigating organizational cybersecurity risks",url:"https://www.nist.gov/cyberframework",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["framework","best_practices","standards"],source:"NIST"},{id:"resource-2",title:"OWASP Top 10",description:"Standard awareness document for developers about the most critical security risks to web applications",url:"https://owasp.org/www-project-top-ten/",type:"integrity",securityLevels:["Low","Moderate","High"],components:["integrity"],tags:["web","vulnerabilities","security_testing"],source:"OWASP"},{id:"resource-3",title:"AWS Well-Architected Framework",description:"Helps cloud architects build secure, high-performing, resilient, and efficient infrastructure",url:"https://aws.amazon.com/architecture/well-architected/",type:"availability",securityLevels:["Moderate","High","Very High"],components:["availability"],tags:["cloud","architecture","resilience"],source:"AWS"},{id:"resource-4",title:"Data Encryption Standard",description:"Standards and guidelines for implementing encryption to protect sensitive data",url:"https://csrc.nist.gov/publications/detail/fips/140/3/final",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["encryption","data_protection","standards"],source:"NIST"},{id:"resource-5",title:"CIS Benchmarks",description:"Best practices for secure configuration of technology systems",url:"https://www.cisecurity.org/cis-benchmarks/",type:"general",securityLevels:["Low","Moderate","High","Very High"],components:["integrity","confidentiality"],tags:["configuration","benchmarks","hardening"],source:"CIS"},{id:"resource-6",title:"AWS Security Hub",description:"Centralized security tool to manage security alerts and automate compliance checks across AWS accounts",url:"https://aws.amazon.com/security-hub/",type:"general",securityLevels:["High","Very High"],components:["availability","integrity","confidentiality"],tags:["cloud","monitoring","automation"],source:"AWS",priority:3},{id:"resource-7",title:"Zero Trust Architecture Guide",description:"NIST guide for implementing a zero trust architecture in enterprise environments",url:"https://www.nist.gov/publications/zero-trust-architecture",type:"confidentiality",securityLevels:["High","Very High"],components:["confidentiality"],tags:["zero_trust","architecture","access_control"],source:"NIST",priority:2},{id:"resource-8",title:"SANS CIS Controls Implementation Guide",description:"Practical guide to implementing the top 20 Critical Security Controls",url:"https://www.sans.org/blog/cis-controls-v8/",type:"general",securityLevels:["Low","Moderate","High"],components:["availability","integrity","confidentiality"],tags:["implementation","baseline","best_practices"],source:"SANS Institute",priority:4},{id:"resource-9",title:"HashiCorp Vault",description:"Secrets management and data protection with identity-based access",url:"https://www.vaultproject.io/",type:"confidentiality",securityLevels:["Moderate","High","Very High"],components:["confidentiality","integrity"],tags:["secrets_management","encryption","access_control"],source:"HashiCorp",priority:3},{id:"resource-10",title:"DDoS Protection Best Practices",description:"Guidelines for protecting systems against distributed denial-of-service attacks",url:"https://www.cisa.gov/sites/default/files/publications/DDoS%20Quick%20Guide.pdf",type:"availability",securityLevels:["Moderate","High"],components:["availability"],tags:["ddos","resilience","mitigation"],source:"CISA",priority:2},{id:"resource-11",title:"OWASP API Security Top 10",description:"Top 10 API security vulnerabilities and how to mitigate them",url:"https://owasp.org/www-project-api-security/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity","confidentiality"],tags:["api","web_security","vulnerabilities"],source:"OWASP",priority:3},{id:"resource-12",title:"Microsoft Security Development Lifecycle",description:"Industry-leading software security assurance process",url:"https://www.microsoft.com/en-us/securityengineering/sdl/",type:"integrity",securityLevels:["Moderate","High","Very High"],components:["integrity"],tags:["sdlc","secure_coding","development"],source:"Microsoft",priority:2},{id:"resource-13",title:"Google SRE Book",description:"Site Reliability Engineering: How Google Runs Production Systems",url:"https://sre.google/sre-book/table-of-contents/",type:"availability",securityLevels:["High","Very High"],components:["availability"],tags:["sre","reliability","operations"],source:"Google",priority:3},{id:"resource-14",title:"ENISA Threat Landscape",description:"European Union Agency for Cybersecurity's comprehensive threat landscape report",url:"https://www.enisa.europa.eu/topics/threat-risk-management/threats-and-trends",type:"general",securityLevels:["Moderate","High","Very High"],components:["availability","integrity","confidentiality"],tags:["threat_intelligence","risk_assessment","planning"],source:"ENISA",priority:2},{id:"resource-15",title:"Snyk",description:"Developer security platform to find and fix vulnerabilities in code, dependencies, containers, and IaC",url:"https://snyk.io/",type:"integrity",securityLevels:["Moderate","High"],components:["integrity"],tags:["dependency_scanning","vulnerability_management","devops"],source:"Snyk",priority:4}];class Le extends ke{resources;constructor(e){super(e),this.resources=this.processResources(Se)}processResources(e){return e.map((e=>({...e,relevance:e.priority||50,score:e.priority||50})))}getSecurityResources(e,t){const i={id:`fallback-${e}`,title:`Basic security guidance for ${e}`,description:`Start with these resources to implement ${e} security controls`,url:"https://www.nist.gov/cyberframework",type:"all"===e?"general":e,relevance:100,score:100,tags:["beginner","basics"],category:"documentation",source:"NIST"};return[...this.resources,i,...Object.values({availability:{id:"avail-resource",title:"Availability Best Practices",description:"Guidance for implementing availability controls",url:"https://example.com/availability",type:"availability",relevance:90,score:90,tags:["availability","uptime"],category:"best_practices",source:"NIST"},integrity:{id:"integrity-resource",title:"Integrity Guidelines",description:"Guidance for implementing integrity controls",url:"https://example.com/integrity",type:"integrity",relevance:90,score:90,tags:["integrity","validation"],category:"best_practices",source:"NIST"},confidentiality:{id:"confidentiality-resource",title:"Confidentiality Controls",description:"Guidance for implementing confidentiality controls",url:"https://example.com/confidentiality",type:"confidentiality",relevance:90,score:90,tags:["confidentiality","encryption"],category:"best_practices",source:"NIST"}})].filter((t=>"all"===e||(t.type===e||(!(!t.components||!t.components.includes(e))||"general"===t.type)))).filter((e=>!e.relevantLevels||0===e.relevantLevels.length||e.relevantLevels.includes(t))).map((i=>({...i,relevance:this.calculateRelevance(i,e,t)}))).sort(((e,t)=>t.relevance-e.relevance))}calculateRelevance(e,t,i){let a=e.priority||50;return e.type===t&&(a+=20),e.relevantLevels&&e.relevantLevels.includes(i)&&(a+=20),a}getValuePoints(e){if(!e)return["No value points available for undefined security level"];if(this.dataProvider.getDefaultValuePoints)try{const t=this.dataProvider.getDefaultValuePoints(e);if(t&&t.length>0)return t}catch(t){}return"None"===e?["No security value","Suitable only for non-sensitive public information","High vulnerability to security incidents","No protection against threats","Does not meet any compliance requirements"]:[`Provides ${e.toLowerCase()} level of protection`,`Meets ${"High"===e||"Very High"===e?"advanced":"basic"} security requirements`]}}class Ce extends ke{constructor(e){super(e)}getTechnicalImplementation(e,t){const i=this.getCIAOptions(e)[t];return i&&!i.technical?this.createDefaultImplementationDetails(e,t):i?.technicalImplementation&&i.technicalImplementation.description&&i.technicalImplementation.implementationSteps&&i.technicalImplementation.effort?i.technicalImplementation:i?.recommendations&&i.recommendations.length>0?{description:"No implementation details available",implementationSteps:i.recommendations,effort:{development:this.getDefaultDevelopmentEffort(t),maintenance:this.getDefaultMaintenanceEffort(t),expertise:this.getDefaultExpertiseLevel(t)}}:this.createDefaultImplementationDetails(e,t)}getComponentImplementationDetails(e,t){return this.getTechnicalImplementation(e,t)}getTechnicalDescription(e,t){const i=this.getComponentDetails(e,t);return i?.technical?i.technical:"No technical details available"}getRecommendations(e,t){const i=this.getComponentDetails(e,t);return i?.technical?"availability"===e&&"None"===t?[]:i?.recommendations?i.recommendations:[]:[]}getImplementationTime(e){switch(e){case"None":return"No implementation time";case"Low":return"1-2 weeks";case"Moderate":return"4-8 weeks";case"High":return"3-6 months";case"Very High":return"6-12 months";default:return"Unknown implementation time"}}getImplementationConsiderations(e){switch(e){case"None":return"No implementation considerations as no controls are implemented.";case"Low":return"Basic implementation with minimal resource requirements. This level focuses on establishing foundational security controls with straightforward implementation steps.";case"Moderate":return"Moderate implementation complexity requiring dedicated technical expertise. This level requires a more structured approach with comprehensive planning and periodic maintenance.";case"High":return"Complex implementation requiring specialized expertise and significant resource allocation. This level involves sophisticated technical controls with regular maintenance and monitoring requirements.";case"Very High":return"Highly complex implementation requiring expert-level technical skills and substantial resource investment. This level involves enterprise-grade security architecture with continuous monitoring, updates, and specialized maintenance procedures.";default:return"Unknown security level - implementation considerations cannot be determined."}}getImplementationEffort(e,t){return this.getComponentImplementationDetails(e,t).effort}getImplementationSteps(e,t){return this.getComponentImplementationDetails(e,t).implementationSteps}createDefaultImplementationDetails(e,t){return{description:"No implementation details available",implementationSteps:[],effort:{development:this.getDefaultDevelopmentEffort(t),maintenance:this.getDefaultMaintenanceEffort(t),expertise:this.getDefaultExpertiseLevel(t)}}}getDefaultDevelopmentEffort(e){switch(e){case"None":return"None required";case"Low":return"Days (3-5)";case"Moderate":return"Weeks (2-4)";case"High":return"Months (1-3)";case"Very High":return"Months (3-6+)";default:return"Unknown effort"}}getDefaultMaintenanceEffort(e){switch(e){case"None":return"None required";case"Low":return"Minimal (quarterly review)";case"Moderate":return"Regular (monthly review)";case"High":return"Significant (weekly review)";case"Very High":return"Continuous (daily monitoring)";default:return"Unknown effort"}}getDefaultExpertiseLevel(e){if("function"==typeof this.dataProvider.getDefaultExpertiseLevel)try{return this.dataProvider.getDefaultExpertiseLevel(e)}catch(t){}switch(e){case"None":return"No special expertise required";case"Low":return"Basic IT knowledge";case"Moderate":return"Security professional";case"High":return"Security specialist";case"Very High":return"Security expert team";default:return"Unknown expertise level"}}}function Me(e){return{None:"No return on investment without security controls",Low:"Basic return on security investment",Moderate:"Moderate return on security investment",High:"Strong return on security investment","Very High":"Maximum return on security investment"}[e]||"Unknown ROI"}const He=e=>{},Re=e=>{};class $e extends ke{dataProvider;businessImpactService;complianceService;securityMetricsService;technicalImplementationService;securityResourceService;constructor(e){const t=e||{availabilityOptions:xe,integrityOptions:ve,confidentialityOptions:be,roiEstimates:fe};super(t),this.dataProvider=t,this.businessImpactService=new de(this.dataProvider),this.complianceService=new we(this.dataProvider),this.securityMetricsService=new je(this.dataProvider),this.technicalImplementationService=new Ce(this.dataProvider),this.securityResourceService=new Le(this.dataProvider)}async initialize(){return Promise.resolve()}getCIAOptions(e){return"availability"===e?this.dataProvider.availabilityOptions:"integrity"===e?this.dataProvider.integrityOptions:"confidentiality"===e?this.dataProvider.confidentialityOptions:{None:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Low:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},Moderate:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},High:{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]},"Very High":{description:"Invalid component",technical:"Invalid component",businessImpact:"Invalid component",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[]}}}getComponentDetails(e,t){if("string"!=typeof(i=e)||!["confidentiality","integrity","availability"].includes(i))return;var i;const a=this.getCIAOptions(e);return a&&a[t]?a[t]:void 0}getROIEstimate(e){if(!e)return{value:"0%",returnRate:"0%",description:"No return on investment for security controls"};const t=e.toUpperCase().replace(" ","_"),i=this.dataProvider.roiEstimates[t];return i||{value:"Negative",returnRate:"0%",description:"No return on investment for security controls"}}getROIEstimates(e){const t=this.securityLevelToROIKey(e),i=this.dataProvider.roiEstimates||{};return i[t]||i.moderate||{roi:"20%",value:"$50,000",description:"Moderate return on investment"}}securityLevelToROIKey(e){switch(e){case"None":return"none";case"Low":return"low";case"Moderate":default:return"moderate";case"High":return"high";case"Very High":return"veryHigh"}}getAllROIEstimates(){return this.dataProvider.roiEstimates}getBusinessImpact(e,t){return this.businessImpactService.getBusinessImpact(e,t)}getTechnicalImplementation(e,t){return this.technicalImplementationService.getTechnicalImplementation(e,t)}getComponentImplementationDetails(e,t){return this.technicalImplementationService.getComponentImplementationDetails(e,t)}getBusinessImpactDescription(e,t){return this.businessImpactService.getBusinessImpactDescription(e,t)}getTechnicalDescription(e,t){return this.technicalImplementationService.getTechnicalDescription(e,t)}getDetailedDescription(e,t){if(this.businessImpactService){return this.businessImpactService.getBusinessImpact(e,t)}return{summary:"",financial:{description:"",riskLevel:""},operational:{description:"",riskLevel:""},reputational:{description:"",riskLevel:""}}}getRecommendations(e,t){return this.technicalImplementationService.getRecommendations(e,t)}calculateRoi(e,t){const i=this.getROIEstimates(e),a=parseInt(i.returnRate.replace("%",""),10)||0;return{value:(r=t>0?t*(a/100):0,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(r)),percentage:`${a}%`,description:Me(e)};var r}getSecurityMetrics(e,t=e,i=e){return this.securityMetricsService.getSecurityMetrics(e,t,i)}getComplianceStatus(e,t,i){return this.complianceService.getComplianceStatus(e,t,i)}getComponentMetrics(e,t){return this.securityMetricsService.getComponentMetrics(e,t)}getImpactMetrics(e,t){return this.securityMetricsService.getImpactMetrics(e,t)}getSecurityResources(e,t){return this.securityResourceService.getSecurityResources(e,t)}getSecurityLevelDescription(e){return this.securityMetricsService.getSecurityLevelDescription(e)}getProtectionLevel(e){return this.securityMetricsService.getProtectionLevel(e)}calculateBusinessImpactLevel(e,t=e,i=e){return this.businessImpactService.calculateBusinessImpactLevel(e,t,i)}getRiskBadgeVariant(e){return this.securityMetricsService.getRiskBadgeVariant(e)}getCategoryIcon(e){return this.businessImpactService.getCategoryIcon(e)}getValuePoints(e){return this.securityResourceService.getValuePoints(e)}getImplementationConsiderations(e){return e&&Array.isArray(e)&&3===e.length?this.technicalImplementationService.getImplementationConsiderations(e[0]):"Invalid security levels provided. Please provide an array with exactly three security levels."}getSecurityIcon(e){return this.securityMetricsService.getSecurityIcon(e)}getCompliantFrameworks(e){return this.complianceService.getCompliantFrameworks(e,e,e)}getFrameworkDescription(e){return this.complianceService.getFrameworkDescription(e)}getFrameworkRequiredLevel(e,t){const i=t,a=t,r=t,s=this.complianceService.getComplianceStatus(i,a,r);return Re(`Assessing framework requirements for ${e} at ${t} level`),s.compliantFrameworks.length>0&&0===s.nonCompliantFrameworks.length?`Current ${t} level for ${e} meets requirements for most frameworks`:s.partiallyCompliantFrameworks.length>0?`Current ${t} level for ${e} partially meets requirements; consider upgrading to ${"Low"===t?"Moderate":"High"} for full compliance`:`Current ${t} level for ${e} is insufficient; upgrade to at least ${"None"===t?"Low":"Low"===t?"Moderate":"High"} for basic compliance`}getImplementationTime(e){return this.technicalImplementationService.getImplementationTime(e)}getTotalImplementationTime(e,t,i){const a={None:0,Low:2,Moderate:6,High:12,"Very High":24},r=a[e]+a[t]+a[i],s=Math.round(.6*r);return s<=0?"No implementation required":s<=4?`${s} weeks`:s<=12?`${Math.round(s/4)} to ${Math.round(s/4)+1} months`:`${Math.round(s/4)} to ${Math.round(s/4)+2} months`}getRequiredExpertise(e,t,i){switch([e,t,i].sort(((e,t)=>{const i={None:0,Low:1,Moderate:2,High:3,"Very High":4};return i[t]-i[e]}))[0]){case"None":return"No special expertise required";case"Low":return"IT staff with basic security knowledge";case"Moderate":return"Security professional with domain expertise";case"High":return"Senior security engineer or architect";case"Very High":return"Expert security team with specialized skills";default:return"Unknown expertise level"}}getRecommendedImplementationPlan(e,t,i){const a=[];"None"===e||"None"===t||"None"===i?a.push("Phase 1: Implement basic security controls to eliminate 'None' security levels"):"Low"===e||"Low"===t||"Low"===i?a.push("Phase 1: Upgrade basic security controls from 'Low' to at least 'Moderate' level"):a.push("Phase 1: Maintain current baseline security controls and perform regular security assessments");const r=[{component:"Availability",level:e},{component:"Integrity",level:t},{component:"Confidentiality",level:i}];r.sort(((e,t)=>{const i={None:0,Low:1,Moderate:2,High:3,"Very High":4};return i[e.level]-i[t.level]}));const s=r[0];if("Very High"!==s.level){const e="None"===s.level?"Low":"Low"===s.level?"Moderate":"Moderate"===s.level?"High":"Very High";a.push(`Phase 2: Prioritize upgrading ${s.component} controls to ${e} level`)}const n=["None","Low","Moderate","High","Very High"][Math.min("Very High"===r[r.length-1].level?4:3,4)];return a.push(`Phase 3: Develop a roadmap to systematically enhance all security controls to at least ${n} level`),a.join("\n\n")}getInformationSensitivity(e){switch(e){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Sensitive Data";case"High":return"Confidential Data";case"Very High":return"Restricted Data";default:return"Unknown Classification"}}getComponentContent(e,t){const i=this.getComponentDetails(e,t);return i?{description:i.description||`${e} ${t} description`,technical:i.technical||`${e} ${t} technical details`,businessImpact:i.businessImpact||`${e} ${t} business impact`,recommendations:i.recommendations||[`${e} ${t} recommendation`]}:(He(`Component details not found for ${e} at level ${t}`),{description:`${e} ${t} description not available`,technical:`${e} ${t} technical details not available`,businessImpact:`${e} ${t} business impact not available`,recommendations:[`Implement basic ${e} controls for ${t} level`]})}getBusinessImpactContent(e,t){const i=this.businessImpactService.getBusinessImpact(e,t);return i?`\n      ## Business Impact Summary for ${a=e,a?a.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "):""} (${t})\n      \n      ${i.summary}\n      \n      ### Financial Impact\n      ${i.financial?.description||"Financial impact information not available."} \n      Risk level: ${i.financial?.riskLevel||"Unknown"}\n      \n      ### Operational Impact\n      ${i.operational?.description||"Operational impact information not available."}\n      Risk level: ${i.operational?.riskLevel||"Unknown"}\n      \n      ### Reputational Impact\n      ${i.reputational?.description||"Reputational impact information not available."}\n      Risk level: ${i.reputational?.riskLevel||"Unknown"}\n    `:`Business impact information for ${e} at ${t} level is not available.`;var a}getSummaryContent(e,t,i){const a=this.getComponentDetails("availability",e)?.description||`${e} availability`,r=this.getComponentDetails("integrity",t)?.description||`${t} integrity`,s=this.getComponentDetails("confidentiality",i)?.description||`${i} confidentiality`,n=this.complianceService.getComplianceStatus(e,t,i),o=this.securityMetricsService.calculateSecurityScore(e,t,i),l=this.businessImpactService.getBusinessImpactDescription("availability",e),c=this.businessImpactService.getBusinessImpactDescription("integrity",t),d=this.businessImpactService.getBusinessImpactDescription("confidentiality",i);return`\n      # Security Profile Summary\n      \n      ## Current Security Configuration\n      - **Availability**: ${a}\n      - **Integrity**: ${r}\n      - **Confidentiality**: ${s}\n      \n      ## Security Score: ${o}%\n      ${m=o,m>=90?"Exceptional security posture meeting highest standards":m>=80?"Very strong security posture exceeding most requirements":m>=70?"Strong security posture meeting most requirements":m>=60?"Adequate security posture with some improvements needed":m>=50?"Moderate security posture with significant improvements needed":m>=40?"Weak security posture with many vulnerabilities":m>=30?"Poor security posture requiring immediate attention":m>=20?"Very poor security posture with critical vulnerabilities":"Critical security posture requiring complete overhaul"}\n      \n      ## Business Impact\n      - **Availability Impact**: ${l}\n      - **Integrity Impact**: ${c}\n      - **Confidentiality Impact**: ${d}\n      \n      ## Compliance Status\n      ${n.status||""}\n      - Compliant with ${n.compliantFrameworks.length} frameworks\n      - Partially compliant with ${n.partiallyCompliantFrameworks.length} frameworks\n      - Non-compliant with ${n.nonCompliantFrameworks.length} frameworks\n      \n      ${n.remediationSteps&&n.remediationSteps.length>0?"## Remediation Steps\n"+n.remediationSteps.map((e=>`- ${e}`)).join("\n"):""}\n    `;var m}getComplianceDescription(e){switch(e){case"None":return"Non-compliant with most regulatory frameworks. Fails to meet minimum security requirements for data protection and system integrity. Significant remediation needed to meet basic compliance standards.";case"Low":return"Meets only minimal compliance requirements. May satisfy basic requirements for non-sensitive data, but insufficient for regulated industries or sensitive information. Additional controls needed for most compliance frameworks.";case"Moderate":return"Satisfies common baseline requirements across major frameworks. Adequate for most general business applications but may need enhancement for highly regulated industries or sensitive data processing.";case"High":return"Compliant with major regulatory frameworks including GDPR, HIPAA, and PCI DSS. Implements controls exceeding standard requirements, suitable for organizations handling sensitive personal and financial information.";case"Very High":return"Meets the most stringent regulatory requirements across all major frameworks. Fully compliant with industry best practices and specialized regulations. Suitable for critical infrastructure, financial services, and healthcare.";default:return`Compliance information for ${e} security level is not available.`}}getKeyValuePoints(e,t){return this.getValuePoints(t)}getDefaultPrivacyImpact(e){switch(e){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}getDefaultSLAMetrics(e){switch(e){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}getDefaultValidationLevel(e){switch(e){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}getDefaultErrorRate(e){switch(e){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 1%";case"High":return"< 0.1%";case"Very High":return"< 0.01%";default:return"Unknown"}}}function Ae(e){return{None:"âš ï¸",Low:"ðŸ”‘",Moderate:"ðŸ”“",High:"ðŸ”’","Very High":"ðŸ”"}[e]||"â“"}function De(e){return[...[`Provides ${e.toLowerCase()} level of protection`,`Meets ${"High"===e||"Very High"===e?"advanced":"basic"} security requirements`],...{None:[],Low:["Cost-effective basic security measures"],Moderate:["Balanced security and cost","Suitable for standard business operations"],High:["Strong protection for sensitive data","Complies with most regulatory frameworks"],"Very High":["Maximum protection for critical assets","Exceeds regulatory requirements","Enterprise-grade security"]}[e]||[]]}function Pe(e){return null==e}function Ee(e){return e instanceof Error?e:e instanceof Object&&"message"in e&&"string"==typeof e.message?new Error(e.message):new Error(String(e))}new $e;const Ve=e=>"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message,Te=e=>Ve(e)?e.message:null==e?"An unknown error occurred":"object"!=typeof e||"message"in e?String(e):"An unknown error occurred",qe=Object.freeze(Object.defineProperty({__proto__:null,displayErrorMessage:e=>{Te(e)},formatError:function(e,t){const i=Ee(e);return t?`${t}: ${i.message}`:i.message},formatErrorMessage:Te,handleApiError:(e,t)=>Te(e),isErrorWithMessage:Ve,toErrorObject:Ee},Symbol.toStringTag,{value:"Module"})),{toErrorObject:Oe}=qe,Fe=()=>{const[t,i]=e.useState(null),[a,r]=e.useState(!0),[s,n]=e.useState(null),o=async()=>{try{r(!0);const e=new $e({availabilityOptions:xe,integrityOptions:ve,confidentialityOptions:be,roiEstimates:fe,getDefaultSecurityIcon:Ae,getDefaultValuePoints:De});await e.initialize(),i(e),n(null)}catch(e){i(null),n(Oe(e))}finally{r(!1)}};return e.useEffect((()=>{o()}),[]),{ciaContentService:t,isLoading:a,error:s,refresh:()=>{r(!0),o()}}};function Be({label:e,value:i,className:a="",keyClassName:r="",valueClassName:s="",labelClassName:n="",testId:o,iconPrefix:l}){return t.jsxs("div",{className:`p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 ${a}`,"data-testid":o||D,children:[t.jsxs("div",{className:`text-xs font-medium mb-1 text-gray-600 dark:text-gray-400 ${r} ${n}`,"data-testid":P,children:[l&&t.jsx("span",{className:"mr-1",children:l}),e]}),t.jsx("div",{className:`text-sm font-medium ${s}`,"data-testid":E,children:i||"N/A"})]})}const Ue=({status:e,children:i,className:a="",testId:r,size:s="md",variant:n="neutral"})=>{const o=function(e){switch(e){case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-20 dark:text-red-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-20 dark:text-yellow-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-20 dark:text-blue-300";case"success":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-20 dark:text-green-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}}(e);return t.jsx("span",{className:`font-medium rounded-md ${(()=>{switch(e){case"success":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300";case"info":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300";case"warning":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300";case"error":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300";case"neutral":default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300";case"purple":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-30 dark:text-purple-300"}})()} ${(()=>{switch(s){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}})()} ${o} ${a}`,"data-testid":r,children:i})};const ze=({risk:e,className:i="",testId:a="risk-level-badge",showIcon:r=!1})=>{if(!e)return t.jsx(Ue,{status:"neutral",className:i,testId:a,children:"Unknown"});const s=e.includes("Risk")?e:`${e} Risk`,n=function(e){if(!e)return"neutral";const t=function(e){return null==e?"":e.toLowerCase()}(e);return t.includes("critical")?"error":t.includes("high risk")?"warning":t.includes("medium")||t.includes("moderate")?"info":t.includes("low risk")||t.includes("minimal")||t.includes("none")?"success":"neutral"}(e);return t.jsxs(Ue,{status:n,className:i,testId:a,children:[r&&Ge(e)," ",s]})};function Ge(e){const t=e.toLowerCase();return t.includes("critical")||t.includes("high")?"âš ï¸":t.includes("medium")||t.includes("moderate")?"âš ":t.includes("low")?"â„¹ï¸":t.includes("minimal")||t.includes("none")?"âœ“":"â“"}const _e=({category:e,level:i,colorClass:a,textClass:r,className:s="",testId:n})=>{const o=a||(()=>{switch(i){case"None":return"bg-red-100 dark:bg-red-900 dark:bg-opacity-20";case"Low":return"bg-yellow-100 dark:bg-yellow-900 dark:bg-opacity-20";case"Moderate":return"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20";case"High":return"bg-green-100 dark:bg-green-900 dark:bg-opacity-20";case"Very High":return"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20";default:return"bg-gray-100 dark:bg-gray-800"}})(),l=r||(()=>{switch(i){case"None":return"text-red-800 dark:text-red-300";case"Low":return"text-yellow-800 dark:text-yellow-300";case"Moderate":return"text-blue-800 dark:text-blue-300";case"High":return"text-green-800 dark:text-green-300";case"Very High":return"text-purple-800 dark:text-purple-300";default:return"text-gray-800 dark:text-gray-300"}})();return t.jsxs("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${o} ${l} ${s}`,"data-testid":n,children:[e&&`${e}: `,i]})},We=({title:e,children:i,isLoading:a=!1,loading:r=!1,error:s=null,className:n="",testId:o,errorContent:l,icon:c,actions:d})=>{const m=a||r,u=s?"widget-container-error"+(o?`-${o}`:""):m?"widget-container-loading-container"+(o?`-${o}`:""):"widget-container"+(o?`-${o}`:""),p="widget-spinner"+(o?`-${o}`:""),g="test-widget-error"+(o?`-${o}`:"");let h=null;return null!==s&&(h=s instanceof Error?s.message:String(s)),h?t.jsxs("div",{className:`widget-container widget-error border border-red-300 rounded-lg shadow-sm ${n}`,"data-testid":u,children:[t.jsx("div",{className:"widget-header bg-red-50 dark:bg-red-900 dark:bg-opacity-20 px-4 py-3 border-b border-red-200 dark:border-red-800 rounded-t-lg",children:t.jsxs("h3",{className:"text-lg font-medium text-red-800 dark:text-red-300 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš ï¸"}),e]})}),t.jsxs("div",{className:"widget-body p-4 bg-white dark:bg-gray-900",children:[t.jsx("div",{className:"text-red-600 dark:text-red-400","data-testid":g,children:h}),l&&t.jsx("div",{children:l})]})]}):t.jsxs("div",{className:`widget-container border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm ${n}`,"data-testid":u,children:[t.jsxs("div",{className:"widget-header bg-gray-50 dark:bg-gray-800 px-4 py-3 border-b border-gray-200 dark:border-gray-700 rounded-t-lg flex justify-between items-center",children:[t.jsxs("h3",{className:"text-lg font-medium text-gray-800 dark:text-gray-200 flex items-center",children:[c&&t.jsx("span",{className:"mr-2",children:c}),e]}),d&&t.jsx("div",{className:"widget-actions",children:d})]}),t.jsx("div",{className:"widget-body p-4 bg-white dark:bg-gray-900 rounded-b-lg "+(m?"flex items-center justify-center min-h-[100px]":""),children:m?t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500","data-testid":p}):i})]})},Ye=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,className:s="",testId:n=L})=>{const{ciaContentService:o,error:l,isLoading:c}=Fe(),[d,m]=e.useState("considerations"),u=e.useMemo((()=>{try{if(Pe(o))return Xe(i,a,r);if("function"==typeof o.calculateBusinessImpactLevel){const e=o.calculateBusinessImpactLevel(i,a,r);return Pe(e)?Xe(i,a,r):e}return Xe(i,a,r)}catch(e){return Xe(i,a,r)}}),[o,i,a,r]),p=e.useMemo((()=>{try{if(Pe(o))return et("availability",i);if("function"==typeof o.getBusinessImpact){const e=o.getBusinessImpact("availability",i);return Pe(e)?et("availability",i):e}return et("availability",i)}catch(e){return et("availability",i)}}),[o,i]),h=e.useMemo((()=>{try{if(Pe(o))return et("integrity",a);if("function"==typeof o.getBusinessImpact){const e=o.getBusinessImpact("integrity",a);return Pe(e)?et("integrity",a):e}return et("integrity",a)}catch(e){return et("integrity",a)}}),[o,a]),y=e.useMemo((()=>{try{if(Pe(o))return et("confidentiality",r);if("function"==typeof o.getBusinessImpact){const e=o.getBusinessImpact("confidentiality",r);return Pe(e)?et("confidentiality",r):e}return et("confidentiality",r)}catch(e){return et("confidentiality",r)}}),[o,r]),b=(e,t,i)=>{const a={None:0,Low:1,Moderate:2,High:3,"Very High":4},r=(a[e]||0)+(a[t]||0)+(a[i]||0);return r<=2?"Low":r<=6?"Moderate":r<=9?"High":"Very High"},v=(e,i)=>t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg mb-3","data-testid":`${n}-impact-${e.toLowerCase()}`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("h3",{className:"text-md font-medium flex items-center",children:[t.jsx("span",{className:"mr-2",children:{Availability:"â±ï¸",Integrity:"âœ…",Confidentiality:"ðŸ”’",Financial:"ðŸ’°",Operational:"âš™ï¸",Reputational:"ðŸ‘¥",Regulatory:"ðŸ“œ"}[e]||"ðŸ“Š"}),e," Impact"]}),i.riskLevel&&t.jsx(ze,{risk:i.riskLevel,testId:`${n}-risk-level`})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:i.description||"No description available"})]},`impact-${e}`),f=e.useMemo((()=>{const e=Ze(i)+Ze(a)+Ze(r);return[{title:"Implementation Effort",description:`${b(i,a,r)} complexity implementation requiring appropriate planning and resources.`,icon:"âš™ï¸"},{title:"Resource Requirements",description:"Security levels of this tier typically require "+(e<3?"minimal resources and can be implemented with existing staff.":e<6?"moderate resources including some specialized expertise.":e<9?"significant resources and dedicated security personnel.":"extensive resources and specialized security expertise."),icon:"ðŸ‘¥"},{title:"Maintenance Overhead",description:"Ongoing maintenance will require "+(e<3?"minimal effort with basic monitoring.":e<6?"regular attention and periodic reviews.":e<9?"dedicated staff time and routine assessments.":"continuous monitoring and regular reassessment."),icon:"ðŸ”§"},{title:"Organizational Impact",description:"These security controls will have "+(e<3?"minimal impact on business processes.":e<6?"some impact on business processes requiring minor adjustments.":e<9?"moderate impact on business processes requiring training and adaptation.":"significant impact requiring process redesign and extensive training."),icon:"ðŸ¢"}]}),[i,a,r]),k=e.useMemo((()=>{const e=Ze(i)+Ze(a)+Ze(r);return[{title:"Risk Reduction",description:""+(e<3?"Basic protection against common threats.":e<6?"Moderate risk reduction for most business scenarios.":e<9?"Significant protection against advanced threats.":"Comprehensive protection against sophisticated attacks."),icon:"ðŸ›¡ï¸"},{title:"Compliance Coverage",description:"These security controls provide "+(e<3?"minimal compliance coverage for basic requirements.":e<6?"moderate compliance coverage for common regulations.":e<9?"substantial compliance coverage for most frameworks.":"comprehensive compliance with stringent regulatory requirements."),icon:"âœ…"},{title:"Business Enablement",description:"Security at this level "+(e<3?"enables basic business operations with minimal protection.":e<6?"supports standard business functions with adequate protection.":e<9?"enables business growth with strong security assurances.":"provides competitive advantage through superior security posture."),icon:"ðŸ“ˆ"},{title:"Customer Trust",description:"This security profile "+(e<3?"meets minimal customer expectations.":e<6?"satisfies standard customer security requirements.":e<9?"exceeds typical customer security expectations.":"establishes your organization as a security leader in the industry."),icon:"ðŸ¤"}]}),[i,a,r]);return t.jsx(We,{title:x,icon:g.BUSINESS_IMPACT_ANALYSIS,className:s,testId:n,isLoading:c,error:l,children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Business Impacts by Component"}),y&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Confidentiality Impact"]}),y.reputational&&v("Reputational",y.reputational),y.regulatory&&v("Regulatory",y.regulatory)]}),h&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âœ…"}),"Integrity Impact"]}),h.financial&&v("Financial",h.financial),h.operational&&v("Operational",h.operational)]}),p&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Availability Impact"]}),p.financial&&v("Financial",p.financial),p.operational&&v("Operational",p.operational)]})]}),t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:t.jsx("p",{className:"text-sm",children:t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4","data-testid":`${n}-executive-summary`,children:[t.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“Š"}),"Executive Summary"]}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:["Current security posture provides"," ",t.jsx("span",{className:"font-medium",children:u})," protection for business operations. Business impacts are most significant in"," ",Ke(p,h,y)," ","areas."]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[t.jsx(Be,{label:"Overall Impact",value:u,testId:`${n}-overall-impact`,valueClassName:`font-medium ${Qe(u)}`}),t.jsx(Be,{label:"Implementation Complexity",value:b(i,a,r),testId:`${n}-implementation-complexity`}),t.jsx(Be,{label:"Security Profile",value:i===a&&a===r?i:"Mixed",testId:`${n}-security-profile`})]})]})})}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:"Current Security Levels"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx(_e,{category:"Confidentiality",level:r,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:`${n}-confidentiality-badge`}),t.jsx(_e,{category:"Integrity",level:a,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:`${n}-integrity-badge`}),t.jsx(_e,{category:"Availability",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:`${n}-availability-badge`})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-4 mb-4",children:[t.jsxs("div",{className:`p-2 rounded text-center ${Je(r)}`,"data-testid":`${n}-heatmap-confidentiality`,children:[t.jsx("div",{className:"text-xs font-medium",children:"Confidentiality"}),t.jsx("div",{className:"font-bold",children:r})]}),t.jsxs("div",{className:`p-2 rounded text-center ${Je(a)}`,"data-testid":`${n}-heatmap-integrity`,children:[t.jsx("div",{className:"text-xs font-medium",children:"Integrity"}),t.jsx("div",{className:"font-bold",children:a})]}),t.jsxs("div",{className:`p-2 rounded text-center ${Je(i)}`,"data-testid":`${n}-heatmap-availability`,children:[t.jsx("div",{className:"text-xs font-medium",children:"Availability"}),t.jsx("div",{className:"font-bold",children:i})]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:t.jsxs("div",{className:"flex",children:[t.jsx("button",{className:"py-2 px-4 font-medium "+("considerations"===d?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),onClick:()=>m("considerations"),"data-testid":`${n}-tab-considerations`,children:"Implementation Considerations"}),t.jsx("button",{className:"py-2 px-4 font-medium "+("benefits"===d?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),onClick:()=>m("benefits"),"data-testid":`${n}-tab-benefits`,children:"Business Benefits"})]})}),"considerations"===d?t.jsx("div",{className:"grid grid-cols-1 gap-4","data-testid":`${n}-considerations`,children:f.map(((e,i)=>t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":`${n}-consideration-${i}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:e.icon}),t.jsx("h4",{className:"text-md font-medium",children:e.title})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]},`consideration-${i}`)))}):t.jsx("div",{className:"grid grid-cols-1 gap-4","data-testid":`${n}-benefits`,children:k.map(((e,i)=>t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":`${n}-benefit-${i}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2 text-green-500",children:e.icon}),t.jsx("h4",{className:"text-md font-medium",children:e.title})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]},`benefit-${i}`)))})]})]})})};function Ke(e,t,i){const a=[];return e?.operational?.riskLevel?.includes("High")&&a.push("operational"),e?.financial?.riskLevel?.includes("High")&&a.push("financial"),t?.operational?.riskLevel?.includes("High")&&a.push("operational"),t?.financial?.riskLevel?.includes("High")&&a.push("financial"),i?.reputational?.riskLevel?.includes("High")&&a.push("reputational"),i?.regulatory?.riskLevel?.includes("High")&&a.push("regulatory"),0===a.length?"minimal":1===a.length?a[0]:2===a.length?`${a[0]} and ${a[1]}`:"multiple"}function Ze(e){return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[e]||0}function Je(e){switch(e){case"None":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";case"Low":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300";case"Moderate":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300";case"High":return"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:bg-opacity-30 dark:text-orange-300";case"Very High":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300"}}function Qe(e){return e.includes("Low")?"text-green-600 dark:text-green-400":e.includes("Moderate")?"text-yellow-600 dark:text-yellow-400":e.includes("High")?"text-orange-600 dark:text-orange-400":e.includes("Very High")||e.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}function Xe(e,t,i){const a={None:0,Low:1,Moderate:2,High:3,"Very High":4},r=((a[e]||0)+(a[t]||0)+(a[i]||0))/3;return r<=.5?"Minimal":r<=1.5?"Low":r<=2.5?"Moderate":r<=3.5?"High":"Very High"}function et(e,t){const i="None"===t||"Low"===t;return"availability"===e?{summary:`${t} availability impact on business operations`,operational:{description:""+(i?"Significant operational disruptions possible due to limited availability controls":"Operations protected by appropriate availability controls"),riskLevel:i?"High Risk":"Low Risk"},financial:{description:""+(i?"Potential financial losses due to service disruptions and downtime":"Financial impact minimized through robust availability controls"),riskLevel:i?"Medium Risk":"Low Risk"}}:"integrity"===e?{summary:`${t} integrity impact on business operations`,operational:{description:""+(i?"Business decisions may be based on inaccurate or corrupted data":"Data accuracy protected by appropriate integrity controls"),riskLevel:i?"High Risk":"Low Risk"},financial:{description:""+(i?"Financial losses possible due to data errors affecting decision making":"Financial impact minimized through data validation and integrity mechanisms"),riskLevel:i?"Medium Risk":"Low Risk"}}:{summary:`${t} confidentiality impact on business operations`,reputational:{description:""+(i?"High risk of reputational damage from data exposures or breaches":"Reputation protected by appropriate confidentiality controls"),riskLevel:i?"High Risk":"Low Risk"},regulatory:{description:""+(i?"Increased risk of non-compliance with data protection regulations":"Regulatory compliance supported by appropriate data protection measures"),riskLevel:i?"Medium Risk":"Low Risk"}}}const tt=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,onAvailabilityChange:n,onIntegrityChange:o,onConfidentialityChange:p,className:y="",testId:x="security-level-widget"})=>{const{ciaContentService:b}=Fe(),[v,f]=e.useState(null),[k,N]=e.useState(!1),[w,j]=e.useState("availability"),[I,S]=e.useState(null),[L,C]=e.useState(null),[M,H]=e.useState(null);e.useEffect((()=>{N(!0);try{if(!b)throw new Error("Content service unavailable");const e="availability"===w?i:"integrity"===w?a:r,t=b.getComponentDetails(w,e)||{description:"No details available",technical:"No technical information available",businessImpact:"No business impact information available",recommendations:[]};C(t),S(null),f(null)}catch(e){S(e instanceof Error?e:new Error("Failed to load component details")),f(e instanceof Error?e:new Error("Service error"))}finally{N(!1)}}),[b,w,i,a,r]);const R=e.useCallback((e=>{const t=e.target.value;n&&n(t),H("availability")}),[n]),$=e.useCallback((e=>{const t=e.target.value;o&&o(t),H("integrity")}),[o]),A=e.useCallback((e=>{const t=e.target.value;p&&p(t),H("confidentiality")}),[p]),D=[l,c,d,m,u],P=(e,t)=>{switch(e){case"availability":return"None"===t?"No uptime guarantees":"Low"===t?"~95% uptime, 24-48h recovery":"Moderate"===t?"~99% uptime, 4-8h recovery":"High"===t?"~99.9% uptime, 15-60min recovery":"Very High"===t?"~99.99% uptime, <5min recovery":"";case"integrity":return"None"===t?"No validation controls":"Low"===t?"Manual validation with basic checks":"Moderate"===t?"Automated validation with checks":"High"===t?"Cryptographic verification":"Very High"===t?"Blockchain validation":"";case"confidentiality":return"None"===t?"No access controls":"Low"===t?"Basic access control":"Moderate"===t?"RBAC with encryption":"High"===t?"E2E encryption with MFA":"Very High"===t?"Zero-trust architecture":"";default:return"No details available"}};return t.jsx(We,{title:h,icon:g.SECURITY_LEVEL,className:y,testId:x,children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:t.jsx("p",{className:"text-sm",children:"Configure security levels for each CIA component to set your organization's security posture. Higher levels provide stronger protection but may require more resources to implement."})}),(I||v)&&t.jsxs("div",{className:"p-3 mb-4 bg-red-100 dark:bg-red-900 dark:bg-opacity-20 text-red-800 dark:text-red-200 rounded-lg",children:[t.jsx("h4",{className:"font-medium",children:"Error"}),t.jsx("p",{className:"text-sm",children:"Unable to load component details. Please try again later."})]}),k&&t.jsx("div",{className:"p-3 mb-4 bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20 text-blue-800 dark:text-blue-200 rounded-lg",children:t.jsx("p",{className:"text-sm",children:"Loading security level details..."})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium mb-4",children:"Configure Security Levels"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"security-level-confidentiality",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("label",{htmlFor:"confidentiality-select",className:"text-sm font-medium flex items-center",children:[t.jsx("span",{className:"text-purple-500 dark:text-purple-400 mr-2",children:s.confidentiality}),"Confidentiality"]}),t.jsx(_e,{category:"",level:r,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:"security-level-widget-confidentiality-badge"})]}),t.jsx("select",{id:"confidentiality-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-purple-400 focus:border-purple-500 focus:ring-2 focus:ring-purple-200",value:r,onChange:A,"data-testid":"confidentiality-select",children:D.map((e=>t.jsx("option",{value:e,children:e},`confidentiality-${e}`)))}),t.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":"security-level-widget-confidentiality-summary",children:[r,":"," ",P("confidentiality",r)]}),t.jsx("button",{className:"mt-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors",onClick:()=>j("confidentiality"),"data-testid":"confidentiality-details-button",children:"View details"}),"confidentiality"===M&&t.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":"confidentiality-changed-indicator",children:"âœ“ Security level updated"})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"security-level-integrity",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("label",{htmlFor:"integrity-select",className:"text-sm font-medium flex items-center",children:[t.jsx("span",{className:"text-green-500 dark:text-green-400 mr-2",children:s.integrity}),"Integrity"]}),t.jsx(_e,{category:"",level:a,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:"security-level-widget-integrity-badge"})]}),t.jsx("select",{id:"integrity-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-green-400 focus:border-green-500 focus:ring-2 focus:ring-green-200",value:a,onChange:$,"data-testid":"integrity-select",children:D.map((e=>t.jsx("option",{value:e,children:e},`integrity-${e}`)))}),t.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":"security-level-widget-integrity-summary",children:[a,":"," ",P("integrity",a)]}),t.jsx("button",{className:"mt-2 px-2 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600 transition-colors",onClick:()=>j("integrity"),"data-testid":"integrity-details-button",children:"View details"}),"integrity"===M&&t.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":"integrity-changed-indicator",children:"âœ“ Security level updated"})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":"security-level-availability",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsxs("label",{htmlFor:"availability-select",className:"text-sm font-medium flex items-center",children:[t.jsx("span",{className:"text-blue-500 dark:text-blue-400 mr-2",children:s.availability}),"Availability"]}),t.jsx(_e,{category:"",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:"security-level-widget-availability-badge"})]}),t.jsx("select",{id:"availability-select",className:"w-full p-2 border rounded-md bg-white dark:bg-gray-700 dark:border-gray-600 transition-all duration-300 hover:border-blue-400 focus:border-blue-500 focus:ring-2 focus:ring-blue-200",value:i,onChange:R,"data-testid":"availability-select",children:D.map((e=>t.jsx("option",{value:e,children:e},`availability-${e}`)))}),t.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400","data-testid":"security-level-widget-availability-summary",children:[i,":"," ",P("availability",i)]}),t.jsx("button",{className:"mt-2 px-2 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-600 transition-colors",onClick:()=>j("availability"),"data-testid":"availability-details-button",children:"View details"}),"availability"===M&&t.jsx("div",{className:"mt-2 text-xs text-green-600 dark:text-green-400 animate-pulse","data-testid":"availability-changed-indicator",children:"âœ“ Security level updated"})]})]})]}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-medium mb-4",children:[w.charAt(0).toUpperCase()+w.slice(1)," ","Details"]}),t.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 h-full","data-testid":`${w}-details-content`,children:L?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h4",{className:`font-medium ${(e=>{switch(e){case"availability":return"text-blue-600 dark:text-blue-400";case"integrity":return"text-green-600 dark:text-green-400";case"confidentiality":return"text-purple-600 dark:text-purple-400";default:return"text-gray-600 dark:text-gray-400"}})(w)}`,children:["availability"===w?i:"integrity"===w?a:r," ","Level"]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-medium mb-1",children:"Description"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:L.description||"No description available"})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-medium mb-1",children:"Technical Implementation"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:L.technical||"No technical details available"})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"text-sm font-medium mb-1",children:"Business Impact"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:L.businessImpact||"No business impact details available"})]}),"availability"===w&&t.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-2 rounded",children:[t.jsx("div",{className:"text-xs font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Uptime"}),t.jsx("div",{className:"text-sm",children:L.uptime||"N/A"})]}),t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 p-2 rounded",children:[t.jsx("div",{className:"text-xs font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Time"}),t.jsx("div",{className:"text-sm",children:L.rto||"N/A"})]})]}),"integrity"===w&&L.validationMethod&&t.jsxs("div",{className:"mt-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 p-2 rounded",children:[t.jsx("div",{className:"text-xs font-medium mb-1 text-green-700 dark:text-green-300",children:"Validation Method"}),t.jsx("div",{className:"text-sm",children:L.validationMethod})]}),"confidentiality"===w&&L.protectionMethod&&t.jsxs("div",{className:"mt-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 p-2 rounded",children:[t.jsx("div",{className:"text-xs font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Protection Method"}),t.jsx("div",{className:"text-sm",children:L.protectionMethod})]})]})]}):t.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:t.jsx("p",{children:"No details available for this security level."})})})]})]}),t.jsxs("div",{className:"mt-6 bg-gray-100 dark:bg-gray-800 p-4 rounded-lg",children:[t.jsx("h3",{className:"text-md font-medium mb-2",children:"Security Level Overview"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Higher security levels provide stronger protection but typically require more resources to implement and maintain. Consider your organization's needs and constraints when selecting security levels."}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-2 text-xs",children:[t.jsxs("div",{className:"p-2 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded",children:[t.jsx("div",{className:"font-medium text-red-700 dark:text-red-300",children:"None"}),t.jsx("div",{className:"text-red-600 dark:text-red-400",children:"Minimal to no security controls"})]}),t.jsxs("div",{className:"p-2 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded",children:[t.jsx("div",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Low"}),t.jsx("div",{className:"text-yellow-600 dark:text-yellow-400",children:"Basic security controls"})]}),t.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[t.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Moderate"}),t.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:"Standard security controls"})]}),t.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[t.jsx("div",{className:"font-medium text-green-700 dark:text-green-300",children:"High"}),t.jsx("div",{className:"text-green-600 dark:text-green-400",children:"Advanced security controls"})]}),t.jsxs("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[t.jsx("div",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Very High"}),t.jsx("div",{className:"text-purple-600 dark:text-purple-400",children:"Maximum security controls"})]})]})]})]})})},it=({level:e,size:i="md",className:a="",testId:r})=>t.jsx("span",{className:`font-medium rounded-md ${(()=>{switch(e){case"None":return"bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-20 dark:text-red-300";case"Low":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-20 dark:text-yellow-300";case"Moderate":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-20 dark:text-blue-300";case"High":return"bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-20 dark:text-green-300";case"Very High":return"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:bg-opacity-20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}})()} ${(()=>{switch(i){case"sm":return"px-1.5 py-0.5 text-xs";case"lg":return"px-3 py-1.5 text-sm";default:return"px-2 py-1 text-xs"}})()} ${a}`,"data-testid":r,children:e}),at=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,className:s="",testId:n=V})=>{const[o,l]=e.useState("overview"),{ciaContentService:c,error:d,isLoading:m}=Fe(),u=e.useMemo((()=>le(i,a,r)),[i,a,r]),p=e.useMemo((()=>({None:"No security controls implemented",Low:"Basic security controls with minimal protection",Moderate:"Standard security controls with adequate protection",High:"Advanced security controls with strong protection","Very High":"Maximum security controls with comprehensive protection"}[u]||"Unknown security level")),[u]),h=e.useMemo((()=>{const e=ne(i)+ne(a)+ne(r);return Math.round(e/12*100)}),[i,a,r]),x=e.useMemo((()=>h>=80?"Low Risk":h>=60?"Medium Risk":h>=40?"High Risk":"Critical Risk"),[h]),b=e.useMemo((()=>{if(!Pe(c))try{if("function"==typeof c.getSecurityClassification){const e=c.getSecurityClassification(u);if(!Pe(e))return e}}catch(e){}switch(u){case"None":return"Minimal Security";case"Low":return"Basic Security";case"Moderate":return"Standard Security";case"High":return"Enhanced Security";case"Very High":return"Maximum Security";default:return"Unknown Security Level"}}),[c,u]),v=e.useMemo((()=>{if(!Pe(c)&&"function"==typeof c.getInformationSensitivity)try{const e=c.getInformationSensitivity(r);if(!Pe(e))return e}catch(e){}switch(r){case"None":return"Public Data";case"Low":return"Internal Data";case"Moderate":return"Confidential Data";case"High":return"Restricted Data";case"Very High":return"Classified Data";default:return"Unclassified Data"}}),[c,r]),f=e.useMemo((()=>{if(!Pe(c)&&"function"==typeof c.getImplementationComplexity)try{const e=c.getImplementationComplexity(i,a,r);if(!Pe(e))return e}catch(s){}const e={None:0,Low:1,Moderate:2,High:3,"Very High":4},t=(e[i]||0)+(e[a]||0)+(e[r]||0);return t<=3?"Low":t<=6?"Moderate":t<=9?"High":"Very High"}),[c,i,a,r]),k=e=>{const t=e.toLowerCase();return"none"===t?"error":"low"===t?"warning":"moderate"===t?"info":"high"===t?"success":"very high"===t?"purple":"neutral"},N=e.useMemo((()=>{try{if(Pe(c))return null;const e={};return"function"==typeof c.getBusinessImpact&&(e.availability=c.getBusinessImpact("availability",i),e.integrity=c.getBusinessImpact("integrity",a),e.confidentiality=c.getBusinessImpact("confidentiality",r)),"function"==typeof c.getCombinedBusinessImpact&&(e.combined=c.getCombinedBusinessImpact(i,a,r)),e}catch(e){return null}}),[c,i,a,r]),w=e.useMemo((()=>{try{return Pe(c)?null:{availability:c.getComponentDetails?.("availability",i),integrity:c.getComponentDetails?.("integrity",a),confidentiality:c.getComponentDetails?.("confidentiality",r),timeToImplement:"function"==typeof c.getImplementationTime?c.getImplementationTime(i,a,r):null,resources:"function"==typeof c.getRequiredResources?c.getRequiredResources(i,a,r):null}}catch(e){return null}}),[c,i,a,r]),j=e.useMemo((()=>{try{if(Pe(c))return null;if("function"==typeof c.getComplianceStatus){const e=c.getComplianceStatus(i,a,r);if(e)return{...e,compliantFrameworks:e.compliantFrameworks||[],partiallyCompliantFrameworks:e.partiallyCompliantFrameworks||[],nonCompliantFrameworks:e.nonCompliantFrameworks||[]}}return{status:"Unknown",complianceScore:0,compliantFrameworks:[],partiallyCompliantFrameworks:[]}}catch(e){return null}}),[c,i,a,r]),I=e.useMemo((()=>h>=80?"Strategic":h>=60?"Advanced":h>=40?"Standard":"Basic"),[h]),S=e.useMemo((()=>{switch(I){case"Strategic":return"Enables competitive advantage and innovation";case"Advanced":return"Supports business growth and trusted partnerships";case"Standard":return"Maintains core business operations securely";case"Basic":return"Enables fundamental business activities";default:return"Unknown business maturity level"}}),[I]);return t.jsx(We,{title:y,icon:g.SECURITY_SUMMARY,className:s,testId:n,isLoading:m,error:d,children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border-l-4 border-blue-500 dark:border-blue-400 shadow-sm",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[t.jsx("span",{className:"inline-block w-3 h-3 rounded-full bg-blue-500 dark:bg-blue-400 pulse-dot"}),b]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:p})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Security Score"}),t.jsxs("div",{className:"font-bold text-xl text-blue-600 dark:text-blue-400",children:[h,"%"]}),t.jsx("div",{className:"text-sm font-medium "+(L=x,L.includes("Low")?"text-green-600 dark:text-green-400":L.includes("Medium")?"text-yellow-600 dark:text-yellow-400":L.includes("High")?"text-orange-600 dark:text-orange-400":L.includes("Critical")?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"),"data-testid":`${n}-risk-level`,children:x})]})]})}),t.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-4",children:t.jsx("nav",{className:"flex flex-wrap -mb-px gap-2","aria-label":"Security Summary Tabs",children:[{id:"overview",label:"Overview"},{id:"business",label:"Business Value"},{id:"implementation",label:"Implementation"},{id:"compliance",label:"Compliance"}].map((e=>t.jsx("button",{className:"py-2 px-4 text-sm font-medium border-b-2 transition-colors duration-200 "+(o===e.id?"border-blue-500 text-blue-600 dark:text-blue-400 dark:border-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 hover:border-gray-300"),onClick:()=>l(e.id),"data-testid":`${n}-tab-${e.id}`,"aria-selected":o===e.id,role:"tab",children:e.label},e.id)))})}),t.jsxs("div",{className:"tab-content",children:["overview"===o&&t.jsxs("div",{"data-testid":`${n}-content-overview`,className:"space-y-4",children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Security Components"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800","data-testid":O,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-xl mr-2 text-purple-500 dark:text-purple-400",children:"ðŸ”’"}),t.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300",children:"Confidentiality"})]}),t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx(it,{level:r}),t.jsx(Ue,{status:k(oe(r)),size:"sm",children:oe(r)})]}),t.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Classification:"," ",t.jsx("span",{className:"font-medium",children:v})]})]}),t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800","data-testid":q,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-xl mr-2 text-green-500 dark:text-green-400",children:"âœ“"}),t.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Integrity"})]}),t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx(it,{level:a}),t.jsx(Ue,{status:k(oe(a)),size:"sm",children:oe(a)})]}),t.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Data Quality:"," ",t.jsx("span",{className:"font-medium",children:w?.integrity?.validationLevel||("None"===a?"Unverified":"Low"===a?"Basic Validation":"Moderate"===a?"Validated":"High"===a?"Cryptographically Verified":"Immutable")})]})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800","data-testid":T,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-xl mr-2 text-blue-500 dark:text-blue-400",children:"â±ï¸"}),t.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Availability"})]}),t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx(it,{level:i}),t.jsx(Ue,{status:k(oe(i)),size:"sm",children:oe(i)})]}),t.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:["Uptime Target:"," ",t.jsx("span",{className:"font-medium",children:w?.availability?.uptime||("None"===i?"No guarantee":"Low"===i?"~95%":"Moderate"===i?"~99%":"High"===i?"~99.9%":"~99.99%")})]})]})]})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Implementation Summary"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Implementation Complexity"}),t.jsx("div",{className:"text-lg font-bold",children:f}),t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Based on combined security levels"})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Security Profile"}),t.jsx("div",{className:"text-lg font-bold",children:i===a&&a===r?`${i} (Balanced)`:"Mixed Levels"}),t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:i===a&&a===r?"Uniform security across all components":"Varied security levels across components"})]})]})]})]}),"business"===o&&t.jsxs("div",{"data-testid":`${n}-content-business`,className:"space-y-4",children:[t.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:t.jsx("p",{className:"text-sm",children:"This section shows the business impact and value of your selected security levels across the CIA triad, highlighting benefits and considerations for executives and stakeholders."})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Business Impact Summary"}),N?t.jsxs("div",{className:"space-y-4",children:[N.combined&&t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[t.jsx("p",{className:"text-sm",children:N.combined.description||"The selected security levels provide appropriate protection for your business needs."}),N.combined.riskLevel&&t.jsx("div",{className:"mt-2",children:t.jsx(Ue,{status:k(N.combined.riskLevel.split(" ")[0]||"Neutral"),size:"sm",children:N.combined.riskLevel})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[N.confidentiality&&t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[t.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Confidentiality Impact"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:N.confidentiality.description||"Impact description not available"}),N.confidentiality.riskLevel&&t.jsx("div",{className:"mt-2",children:t.jsx(Ue,{status:k(N.confidentiality.riskLevel.split(" ")[0]||"Neutral"),size:"sm",children:N.confidentiality.riskLevel})})]}),N.integrity&&t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800",children:[t.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300 mb-2",children:"Integrity Impact"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:N.integrity.description||"Impact description not available"}),N.integrity.riskLevel&&t.jsx("div",{className:"mt-2",children:t.jsx(Ue,{status:k(N.integrity.riskLevel.split(" ")[0]||"Neutral"),size:"sm",children:N.integrity.riskLevel})})]}),N.availability&&t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[t.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Availability Impact"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:N.availability.description||"Impact description not available"}),N.availability.riskLevel&&t.jsx("div",{className:"mt-2",children:t.jsx(Ue,{status:k(N.availability.riskLevel.split(" ")[0]||"Neutral"),size:"sm",children:N.availability.riskLevel})})]})]})]}):t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"Business impact information is not available."})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Business Value Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Estimated ROI"}),t.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400 mt-2",children:h>=80?"300-500%":h>=60?"200-300%":h>=40?"150-200%":"50-100%"}),t.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:h>=80?"Premium return through competitive advantage":h>=60?"Strong return through business enablement":h>=40?"Balanced return through operational improvements":"Basic return through risk reduction"})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Business Enablement"}),t.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400 mt-2",children:I}),t.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400 mt-1",children:S})]})]})]})]}),"implementation"===o&&t.jsxs("div",{"data-testid":`${n}-content-implementation`,className:"space-y-4",children:[t.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:t.jsx("p",{className:"text-sm",children:"This section provides an overview of implementation considerations for your selected security levels across the CIA triad."})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Implementation Overview"}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-md font-medium",children:"Implementation Complexity:"}),t.jsx("div",{className:"font-medium",children:f})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:t.jsx("div",{className:"h-2.5 rounded-full "+("Low"===f?"w-1/4 bg-green-500":"Moderate"===f?"w-2/4 bg-yellow-500":"High"===f?"w-3/4 bg-orange-500":"w-full bg-red-500")})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Low"===f?"Basic security controls with straightforward implementation":"Moderate"===f?"Standard security measures with moderate implementation effort":"High"===f?"Advanced security controls requiring significant implementation effort":"Comprehensive security framework requiring extensive resources"})]}),w?t.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Implementation Timeline"}),t.jsx("div",{className:"text-lg font-bold",children:w.timeToImplement||("Low"===f?"1-3 months":"Moderate"===f?"3-6 months":"High"===f?"6-12 months":"12+ months")}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Estimated time for complete implementation"})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-gray-800 dark:text-gray-100 mb-2",children:"Resource Requirements"}),t.jsx("div",{className:"text-lg font-bold",children:w.resources||("Low"===f?"Minimal":"Moderate"===f?"Standard":"High"===f?"Significant":"Extensive")}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Personnel, budget, and equipment needs"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-2",children:[w.confidentiality&&t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[t.jsx("h4",{className:"font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Confidentiality Implementation"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:w.confidentiality.technical||"No technical implementation details available"})]}),w.integrity&&t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800",children:[t.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300 mb-2",children:"Integrity Implementation"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:w.integrity.technical||"No technical implementation details available"})]}),w.availability&&t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[t.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Availability Implementation"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:w.availability.technical||"No technical implementation details available"})]})]})]}):t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"Implementation details are not available."})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Implementation Considerations"}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-yellow-700 dark:text-yellow-300",children:"Resource Requirements"}),t.jsx("p",{className:"mt-2 text-sm",children:"Low"===f?"Minimal resources required. Can be implemented with existing team.":"Moderate"===f?"Moderate resources required. May need additional expertise.":"High"===f?"Significant resources required. Dedicated team recommended.":"Extensive resources required. Specialized team essential."})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-blue-700 dark:text-blue-300",children:"Implementation Timeline"}),t.jsx("p",{className:"mt-2 text-sm",children:"Low"===f?"Short timeline: 1-3 months for complete implementation.":"Moderate"===f?"Medium timeline: 3-6 months for complete implementation.":"High"===f?"Extended timeline: 6-12 months for complete implementation.":"Long-term project: 12+ months for complete implementation."})]})]})]})]}),"compliance"===o&&t.jsxs("div",{"data-testid":`${n}-content-compliance`,className:"space-y-4",children:[t.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:t.jsx("p",{className:"text-sm",children:"This section shows how your security selections align with common regulatory frameworks and compliance requirements."})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Compliance Status"}),j?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Overall Compliance"}),t.jsx("div",{className:"text-sm",children:j.status||"Status not available"})]}),t.jsx("div",{children:t.jsxs(Ue,{status:(j.complianceScore??0)>=80?"success":(j.complianceScore??0)>=50?"warning":"error",size:"md",children:[j.complianceScore||0,"% Compliant"]})})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mb-4",children:t.jsx("div",{className:`h-2.5 rounded-full bg-${(j.complianceScore??0)>=80?"green":(j.complianceScore??0)>=50?"yellow":"red"}-500`,style:{width:`${j.complianceScore||0}%`}})}),j.compliantFrameworks&&j.compliantFrameworks.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Compliant Frameworks"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:j.compliantFrameworks.map(((e,i)=>t.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300 rounded text-xs",children:e},i)))})]}),j.partiallyCompliantFrameworks&&j.partiallyCompliantFrameworks.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Partially Compliant Frameworks"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:j.partiallyCompliantFrameworks.map(((e,i)=>t.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300 rounded text-xs",children:e},i)))})]})]}):t.jsx("div",{className:"text-center py-6",children:t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:"Compliance status information is not available."})})]}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border border-gray-100 dark:border-gray-700",children:[t.jsx("h3",{className:"text-lg font-medium mb-3 text-gray-800 dark:text-gray-100",children:"Component Compliance Requirements"}),t.jsx("div",{className:"grid grid-cols-1 gap-4",children:t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[t.jsxs("p",{className:"text-sm",children:["Component compliance information is"," ",j?"available":"not available"," based on your selected security levels."]}),t.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-2 border border-purple-200 dark:border-purple-800 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[t.jsx("h5",{className:"text-sm font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Confidentiality"}),t.jsx("p",{className:"text-xs",children:"None"===r?"Does not meet basic compliance requirements":"Low"===r?"Meets minimal compliance requirements":"Moderate"===r?"Meets standard compliance requirements":"High"===r?"Meets strict compliance requirements":"Exceeds most compliance requirements"})]}),t.jsxs("div",{className:"p-2 border border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[t.jsx("h5",{className:"text-sm font-medium mb-1 text-green-700 dark:text-green-300",children:"Integrity"}),t.jsx("p",{className:"text-xs",children:"None"===a?"Does not meet basic compliance requirements":"Low"===a?"Meets minimal compliance requirements":"Moderate"===a?"Meets standard compliance requirements":"High"===a?"Meets strict compliance requirements":"Exceeds most compliance requirements"})]}),t.jsxs("div",{className:"p-2 border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[t.jsx("h5",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Availability"}),t.jsx("p",{className:"text-xs",children:"None"===i?"Does not meet basic compliance requirements":"Low"===i?"Meets minimal compliance requirements":"Moderate"===i?"Meets standard compliance requirements":"High"===i?"Meets strict compliance requirements":"Exceeds most compliance requirements"})]})]})]})})]})]})]})]})});var L};const rt=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,industry:s,region:o,className:l="",testId:c=_})=>{const{complianceService:d,error:m,isLoading:u}=function(){const[t,i]=e.useState(!0),[a,r]=e.useState(null),s=e.useMemo((()=>{const e={None:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"},Low:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"},Moderate:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"},High:{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"},"Very High":{description:"",technical:"",businessImpact:"",capex:0,opex:0,bg:"#ffffff",text:"#000000",recommendations:[],uptime:"N/A",rto:"N/A",rpo:"N/A",mttr:"N/A"}};return new we({availabilityOptions:e,integrityOptions:e,confidentialityOptions:e,roiEstimates:{NONE:{returnRate:"0%",description:"No ROI"},LOW:{returnRate:"50%",description:"Low ROI"},MODERATE:{returnRate:"150%",description:"Moderate ROI"},HIGH:{returnRate:"300%",description:"High ROI"},VERY_HIGH:{returnRate:"500%",description:"Very high ROI"}}})}),[]);return e.useEffect((()=>{let e=!0;return(async()=>{try{s&&e&&i(!1)}catch(t){e&&(r(t instanceof Error?t:new Error("An error occurred")),i(!1))}})(),()=>{e=!1}}),[s]),{isLoading:t,complianceService:s,error:a}}(),[p,h]=e.useState(null),y=e.useMemo((()=>{const e={None:0,Low:1,Moderate:2,High:3,"Very High":4},t=Math.min(e[i],e[a],e[r]);return["None","Low","Moderate","High","Very High"].find(((e,i)=>i===t))||"Moderate"}),[i,a,r]),x=e.useMemo((()=>{if(u||m||!d)return null;try{return d.getComplianceStatus(i,a,r)}catch(e){return null}}),[d,i,a,r,s,o,u,m]),v=e.useCallback((()=>{if(u)return"Loading compliance status...";if(m)return"Error loading compliance status";if(!x)return"Unable to determine compliance status";try{if(d?.getComplianceStatusText){const e=d.getComplianceStatusText(i,a,r);if(!Pe(e))return e}return x.status?x.status:`Based on ${y} security level`}catch(e){return"Unable to determine compliance status"}}),[d,x,i,a,r,y,u,m]),f=e.useCallback((e=>x?x.compliantFrameworks.includes(e)?"success":x.partiallyCompliantFrameworks.includes(e)?"warning":"error":"neutral"),[x]),k=e.useMemo((()=>v()),[v]),N=e.useMemo((()=>{if(u||m||!d||!p)return null;try{return d.getComplianceGapAnalysis(i,a,r,p)}catch(e){return null}}),[d,p,i,a,r,u,m]),w=e.useCallback(((e,t)=>{if(d?.getFrameworkRequiredLevel)try{return d.getFrameworkRequiredLevel(e,t)}catch(i){}return{"PCI DSS":{availability:"High",integrity:"High",confidentiality:"High"},HIPAA:{availability:"High",integrity:"High",confidentiality:"High"},GDPR:{availability:"Moderate",integrity:"High",confidentiality:"High"},"ISO 27001":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"},"SOC 2":{availability:"Moderate",integrity:"Moderate",confidentiality:"Moderate"}}[e]?.[t]||"Moderate"}),[d]),j=e.useCallback((e=>{if(!d)return`${e} requirements`;try{if("function"==typeof d.getFrameworkDescription){return d.getFrameworkDescription(e)||`${e} requirements`}return`${e} requirements`}catch(t){return`${e} requirements`}}),[d]);return t.jsx(We,{title:b,icon:g.COMPLIANCE_STATUS,className:l,testId:c,isLoading:u,error:m,children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:t.jsx("p",{className:"text-sm",children:"This widget shows your compliance status with various regulatory frameworks and industry standards based on your selected security levels."})}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:"Overall Compliance Status"}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":W,children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"text-2xl mr-2 text-blue-500",children:n}),t.jsx("span",{className:"font-medium",children:"Compliance Status"})]}),t.jsx(Ue,{status:(I=x?.complianceScore??0,I>=80?"success":I>=50?"warning":"error"),testId:z,children:k})]}),x&&t.jsxs("div",{className:"mt-3",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Compliance Score"}),t.jsxs("span",{className:"font-bold","data-testid":Y,children:[x.complianceScore??0,"%"]})]}),t.jsx("div",{className:"relative pt-1",children:t.jsx("div",{className:"overflow-hidden h-2 mb-2 text-xs flex rounded bg-blue-200 dark:bg-blue-900",children:t.jsx("div",{style:{width:`${x.complianceScore??0}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500 dark:bg-blue-600","data-testid":K})})})]})]})]}),x&&x.compliantFrameworks.length>0&&t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:"Compliant Frameworks"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3","data-testid":G,children:x.compliantFrameworks.map(((e,i)=>t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-200 dark:border-green-800 cursor-pointer "+(p===e?"ring-2 ring-green-500 dark:ring-green-400":""),onClick:()=>h(e),"data-testid":`${Z}-${i}`,children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"font-medium",children:e}),t.jsx(Ue,{status:f(e),testId:`framework-status-badge-${i}`,children:"Compliant"})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:j(e)})]},e)))})]}),x&&x.partiallyCompliantFrameworks.length>0&&t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:"Partially Compliant Frameworks"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3","data-testid":J,children:x.partiallyCompliantFrameworks.map(((e,i)=>t.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg border border-yellow-200 dark:border-yellow-800 cursor-pointer "+(p===e?"ring-2 ring-yellow-500 dark:ring-yellow-400":""),onClick:()=>h(e),"data-testid":`${Z}-partial-${i}`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-1",children:[t.jsx("span",{className:"font-medium",children:e}),t.jsx(Ue,{status:f(e),testId:`framework-partial-status-badge-${i}`,children:"Partially Compliant"})]}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:j(e)})]},e)))})]}),x&&x.nonCompliantFrameworks.length>0&&t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:"Non-Compliant Frameworks"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3","data-testid":Q,children:x.nonCompliantFrameworks.map(((e,i)=>t.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900 dark:bg-opacity-20 rounded-lg border border-red-200 dark:border-red-800 cursor-pointer "+(p===e?"ring-2 ring-red-500 dark:ring-red-400":""),onClick:()=>h(e),"data-testid":`${Z}-non-${i}`,children:[t.jsxs("div",{className:"flex justify-between items-center mb-1",children:[t.jsx("span",{className:"font-medium",children:e}),t.jsx(Ue,{status:f(e),testId:`framework-non-status-badge-${i}`,children:"Non-Compliant"})]}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:j(e)})]},e)))})]}),p&&t.jsxs("div",{className:"mt-6",children:[t.jsxs("h3",{className:"text-lg font-medium mb-2",children:[p," Gap Analysis"]}),t.jsx("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":X,children:N?t.jsxs("div",{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h4",{className:"font-medium mb-1",children:"Status"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:N.isCompliant?`Your security controls meet the requirements for ${p}.`:`Your security controls do not fully meet the requirements for ${p}.`})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("h4",{className:"font-medium mb-1",children:"Component Requirements"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mt-2",children:["availability","integrity","confidentiality"].map((e=>{const s=e,n="availability"===s?i:"integrity"===s?a:r,o=w(p,s),l=st(n)>=st(o);return t.jsxs("div",{className:"p-2 rounded-lg "+(l?"bg-green-50 dark:bg-green-900 dark:bg-opacity-20":"bg-red-50 dark:bg-red-900 dark:bg-opacity-20"),children:[t.jsx("div",{className:"text-xs font-medium mb-1",children:s.charAt(0).toUpperCase()+s.slice(1)}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{children:["Current:"," ",t.jsx("span",{className:"font-medium",children:n})]}),t.jsxs("span",{children:["Required:"," ",t.jsx("span",{className:"font-medium",children:o})]})]}),t.jsx("div",{className:"mt-1 text-xs text-right",children:t.jsx(Ue,{status:l?"success":"error",testId:`${e}-requirement-status`,children:l?"Meeting":"Not Meeting"})})]},e)}))})]}),N.gaps&&N.gaps.length>0&&t.jsxs("div",{className:"mb-3",children:[t.jsx("h4",{className:"font-medium mb-1",children:"Compliance Gaps"}),t.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:N.gaps.map(((e,i)=>t.jsx("li",{children:"string"==typeof e?e:e.framework||e.frameworkDescription||"Undefined compliance gap"},i)))})]}),N.recommendations&&N.recommendations.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium mb-1",children:"Recommendations"}),t.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600 dark:text-gray-400",children:N.recommendations.map(((e,i)=>t.jsx("li",{children:e},i)))})]})]}):t.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-6","data-testid":ee,children:"No gap analysis available for this framework."})})]}),t.jsxs("div",{className:"mt-6 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-blue-500 dark:text-blue-400 mr-2",children:"ðŸ’¡"}),t.jsx("h3",{className:"font-medium",children:"Compliance Tips"})]}),t.jsx("ul",{className:"text-sm space-y-1 list-disc list-inside text-gray-600 dark:text-gray-400","data-testid":te,children:x&&x.complianceScore?x.complianceScore<50?t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"Focus on implementing foundational security controls"}),t.jsx("li",{children:"Prioritize controls that address multiple compliance frameworks"}),t.jsx("li",{children:"Consider engaging a compliance specialist to create a roadmap"})]}):x.complianceScore<80?t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"Address specific gaps in partially compliant frameworks"}),t.jsx("li",{children:"Implement regular compliance monitoring and validation"}),t.jsx("li",{children:"Document your compliance controls and processes"})]}):t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"Maintain your strong compliance posture with regular reviews"}),t.jsx("li",{children:"Prepare for upcoming regulatory changes and new frameworks"}),t.jsx("li",{children:"Consider compliance certification to showcase your capabilities"})]}):t.jsxs(t.Fragment,{children:[t.jsx("li",{children:"Implement controls across all CIA components for balanced compliance"}),t.jsx("li",{children:"Start with the frameworks most relevant to your industry"}),t.jsx("li",{children:"Document your security controls to demonstrate compliance"})]})})]})]})});var I};function st(e){return{None:0,Low:1,Moderate:2,High:3,"Very High":4}[e]||0}const nt={None:{value:0,description:"No availability requirements",technical:"",capex:0,opex:0},Low:{value:1,description:"Minimal availability requirements",technical:"",capex:25e3,opex:1e4},Moderate:{value:2,description:"Standard availability requirements",technical:"",capex:5e4,opex:2e4},High:{value:3,description:"High availability requirements",technical:"",capex:75e3,opex:3e4},"Very High":{value:4,description:"Maximum availability requirements",technical:"",capex:1e5,opex:4e4}},ot={None:{value:0,description:"No integrity requirements",technical:"",capex:0,opex:0},Low:{value:1,description:"Minimal integrity requirements",technical:"",capex:25e3,opex:1e4},Moderate:{value:2,description:"Standard integrity requirements",technical:"",capex:5e4,opex:2e4},High:{value:3,description:"High integrity requirements",technical:"",capex:75e3,opex:3e4},"Very High":{value:4,description:"Maximum integrity requirements",technical:"",capex:1e5,opex:4e4}},lt={None:{value:0,description:"No confidentiality requirements",technical:"",capex:0,opex:0},Low:{value:1,description:"Minimal confidentiality requirements",technical:"",capex:25e3,opex:1e4},Moderate:{value:2,description:"Standard confidentiality requirements",technical:"",capex:5e4,opex:2e4},High:{value:3,description:"High confidentiality requirements",technical:"",capex:75e3,opex:3e4},"Very High":{value:4,description:"Maximum confidentiality requirements",technical:"",capex:1e5,opex:4e4}},ct={NONE:{returnRate:"0%",recommendation:"No investment recommended",description:"Investment in security measures is not necessary."},LOW:{returnRate:"25%",recommendation:"Minimal investment recommended",description:"Basic security measures should be implemented."},MODERATE:{returnRate:"50%",recommendation:"Moderate investment recommended",description:"Standard security measures should be implemented."},HIGH:{returnRate:"75%",recommendation:"High investment recommended",description:"Advanced security measures should be implemented."},VERY_HIGH:{returnRate:"100%",recommendation:"Maximum investment recommended",description:"Comprehensive security measures should be implemented."}},dt=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,className:s="",testId:n="cost-estimation-widget"})=>{const{ciaContentService:o,error:l,isLoading:c}=Fe(),{availabilityOptions:d,integrityOptions:m,confidentialityOptions:u}=(()=>{const e=e=>{switch(e){case"None":default:return"NONE";case"Low":return"LOW";case"Moderate":return"MODERATE";case"High":return"HIGH";case"Very High":return"VERY_HIGH"}};return{availabilityOptions:nt,integrityOptions:ot,confidentialityOptions:lt,ROI_ESTIMATES:ct,getAvailabilityOptions:()=>nt,getIntegrityOptions:()=>ot,getConfidentialityOptions:()=>lt,getROIEstimates:()=>ct,getROIEstimateForSecurityLevel:e,getCombinedROIKey:(t,i,a)=>{const r=[t,i,a].reduce(((e,t)=>(lt[t]?.value||0)>(lt[e]?.value||0)?t:e),"None");return e(r)},getROIDataForCombinedKey:e=>ct[e]||ct.NONE}})(),p=ne(i),h=ne(a),y=ne(r),x=e.useMemo((()=>{try{if(!Pe(o)&&"function"==typeof o.calculateImplementationCost){const e=o.calculateImplementationCost(i,a,r);if(!Pe(e))return e}let e=0;Pe(d)||Pe(d[i])||Pe(d[i].capex)?e+=25e3*p:e+=d[i].capex,Pe(m)||Pe(m[a])||Pe(m[a].capex)?e+=25e3*h:e+=m[a].capex,Pe(u)||Pe(u[r])||Pe(u[r].capex)?e+=25e3*y:e+=u[r].capex;return{total:e,personnel:`${(.5*(p+h+y)).toFixed(1)} FTE`,factors:[{name:"Technology & Infrastructure",description:"Hardware, software licenses, cloud services, and specialized tools."},{name:"Personnel & Training",description:"Staff time for implementation, operation, and ongoing training."},{name:"Integration & Testing",description:"Costs for integrating controls with existing systems and testing."},{name:"Maintenance & Updates",description:"Ongoing operational costs for maintenance and updates."}]}}catch(e){return{total:25e3*(p+h+y),personnel:`${(.5*(p+h+y)).toFixed(1)} FTE`,factors:[{name:"Technology & Infrastructure",description:"Hardware, software, cloud services, and tools."},{name:"Personnel & Training",description:"Staff time and training costs."},{name:"Integration & Testing",description:"Integration and testing costs."},{name:"Maintenance & Updates",description:"Ongoing maintenance costs."}]}}}),[o,i,a,r,p,h,y,d,m,u]),b=e.useMemo((()=>{try{if(!Pe(o)&&"function"==typeof o.calculateOperationalCost){const e=o.calculateOperationalCost(i,a,r);if(!Pe(e))return e}let e=0;return Pe(d)||Pe(d[i])||Pe(d[i].opex)?e+=1e4*p:e+=d[i].opex,Pe(m)||Pe(m[a])||Pe(m[a].opex)?e+=1e4*h:e+=m[a].opex,Pe(u)||Pe(u[r])||Pe(u[r].opex)?e+=1e4*y:e+=u[r].opex,{annual:e}}catch(e){return{annual:1e4*(p+h+y)}}}),[o,i,a,r,p,h,y,d,m,u]),v=(e,t)=>{try{if(!Pe(o)&&"function"==typeof o.getComponentCost){const i=o.getComponentCost(e,t);if(!Pe(i))return i}const i="availability"===e?d:"integrity"===e?m:u;if(!Pe(i)&&!Pe(i[t])){const e=i[t].capex||25e3*ne(t),a=i[t].opex||1e4*ne(t),r=.5*ne(t);return{implementation:N(e),operational:`${N(a)} / year`,personnel:`${r.toFixed(1)} FTE`}}return{implementation:N(25e3*ne(t)),operational:`${N(1e4*ne(t))} / year`,personnel:.5*ne(t)+" FTE"}}catch(i){return{implementation:N(25e3*ne(t)),operational:`${N(1e4*ne(t))} / year`,personnel:.5*ne(t)+" FTE"}}},k=e.useMemo((()=>{try{if(!Pe(o)&&"function"==typeof o.getImplementationTimeline){const e=o.getImplementationTimeline(i,a,r);if(!Pe(e))return e}return{total:`${Math.round(1.5*(p+h+y))} weeks`,phases:[{name:"Planning",duration:`${Math.round(.3*(p+h+y))} weeks`},{name:"Implementation",duration:`${Math.round(.8*(p+h+y))} weeks`},{name:"Testing & Adoption",duration:`${Math.round(.4*(p+h+y))} weeks`}]}}catch(e){const t=Math.round(1.5*(p+h+y));return{total:`${t} weeks`,phases:[{name:"Planning",duration:`${Math.round(.3*t)} weeks`},{name:"Implementation",duration:`${Math.round(.5*t)} weeks`},{name:"Testing",duration:`${Math.round(.2*t)} weeks`}]}}}),[o,i,a,r,p,h,y]),N=e=>null==e?"$0":"string"==typeof e?e.startsWith("$")?e:`$${e}`:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e),w=x.total,j=b.annual,I=v("availability",i),S=v("integrity",a),L=v("confidentiality",r);return t.jsx(We,{title:f,icon:g.COST_ESTIMATION,className:s,testId:n,isLoading:c,error:l,children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:t.jsx("p",{className:"text-sm",children:"This widget provides estimated costs for implementing and maintaining your selected security levels across the CIA triad, helping with budget planning for security initiatives."})}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Cost Summary"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":ie.implementationCost,children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Implementation Cost"}),t.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:N(w)}),t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"One-time cost"})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":ie.operationalCost,children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Operational Cost"}),t.jsx("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:N(j)}),t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Annual cost"})]}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":ie.personnelCost,children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Personnel Needs"}),t.jsx("div",{className:"text-xl font-bold text-purple-600 dark:text-purple-400",children:x.personnel}),t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Full-time equivalents"})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Component Cost Breakdown"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg","data-testid":ie.confidentialityCost,children:[t.jsxs("h4",{className:"text-md font-medium flex items-center text-purple-700 dark:text-purple-300",children:[t.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Confidentiality Costs (",r,")"]}),t.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Implementation"}),t.jsx("div",{className:"text-purple-600 dark:text-purple-400",children:L.implementation})]}),t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Operational"}),t.jsx("div",{className:"text-purple-600 dark:text-purple-400",children:L.operational})]}),t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Personnel"}),t.jsx("div",{className:"text-purple-600 dark:text-purple-400",children:L.personnel})]})]})]}),t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":ie.integrityCost,children:[t.jsxs("h4",{className:"text-md font-medium flex items-center text-green-700 dark:text-green-300",children:[t.jsx("span",{className:"mr-2",children:"âœ“"}),"Integrity Costs (",a,")"]}),t.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Implementation"}),t.jsx("div",{className:"text-green-600 dark:text-green-400",children:S.implementation})]}),t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Operational"}),t.jsx("div",{className:"text-green-600 dark:text-green-400",children:S.operational})]}),t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Personnel"}),t.jsx("div",{className:"text-green-600 dark:text-green-400",children:S.personnel})]})]})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","data-testid":ie.availabilityCost,children:[t.jsxs("h4",{className:"text-md font-medium flex items-center text-blue-700 dark:text-blue-300",children:[t.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Availability Costs (",i,")"]}),t.jsxs("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Implementation"}),t.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:I.implementation})]}),t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Operational"}),t.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:I.operational})]}),t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded",children:[t.jsx("div",{className:"font-medium mb-1",children:"Personnel"}),t.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:I.personnel})]})]})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Implementation Timeline"}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg","data-testid":ie.implementationTimeline,children:[t.jsxs("div",{className:"flex justify-between items-center mb-3",children:[t.jsx("h4",{className:"font-medium",children:"Estimated Duration"}),t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold",children:k.total})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded mb-4",children:t.jsx("div",{className:"h-2 bg-blue-500 dark:bg-blue-600 rounded",style:{width:"100%"}})}),k.phases&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:k.phases.map(((e,i)=>t.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[t.jsx("div",{className:"text-xs font-medium mb-1",children:e.name}),t.jsx("div",{className:"text-sm font-bold",children:e.duration})]},i)))})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Cost Factors"}),t.jsx("ul",{className:"space-y-2 text-sm",children:x.factors?.map(((e,i)=>t.jsxs("li",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded flex",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:e.name}),t.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:e.description})]})]},i)))||t.jsx("li",{className:"p-2 bg-gray-50 dark:bg-gray-800 rounded",children:"No cost factors available"})})]})]})})},mt=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,className:s="",testId:n="value-creation-widget"})=>{const{ciaContentService:o,error:l,isLoading:c}=Fe(),d=e.useMemo((()=>le(i,a,r)),[i,a,r]),m=e.useMemo((()=>{try{if(!Pe(o)&&"function"==typeof o.getBusinessValueMetrics){const e=o.getBusinessValueMetrics(i,a,r);if(Array.isArray(e)&&e.length>0)return e}return ut(i,a,r,d)}catch(e){return ut(i,a,r)}}),[o,i,a,r,d]),u=(e,t)=>{try{if(!Pe(o)&&"function"==typeof o.getComponentValueStatements){const i=o.getComponentValueStatements(e,t);if(Array.isArray(i)&&i.length>0)return i}switch(e){case"availability":return"None"===t||"Low"===t?["Basic operational continuity","Minimal protection against service disruptions"]:"Moderate"===t?["Predictable system access and reliable operations","Improved user satisfaction through consistent service delivery","Enhanced operational efficiency with reduced downtime"]:["Near-continuous operations even during adverse events","Competitive advantage through superior service reliability","Protected revenue streams with minimal service interruptions","Maintained customer trust through consistent service delivery"];case"integrity":return"None"===t||"Low"===t?["Basic data consistency","Minimal protection against data errors"]:"Moderate"===t?["Trustworthy data for operational and strategic decisions","Reduced costs from data errors and reconciliation efforts","Improved compliance posture with accurate record-keeping"]:["Data you can stake your business reputation on","Enhanced business intelligence through high-quality data","Reduced fraud risk with validated transactions","Defensible audit trail for regulatory scrutiny"];case"confidentiality":return"None"===t||"Low"===t?["Basic information protection","Minimal safeguards for sensitive data"]:"Moderate"===t?["Protected intellectual property and business secrets","Reduced risk of data breaches and associated costs","Enhanced customer and partner trust in data handling"]:["Secured competitive advantage through protected innovations","Strengthened customer trust with demonstrable privacy controls","Reputation as a secure business partner","Reduced breach-related costs and regulatory penalties"];default:return["No value statements available"]}}catch(i){return[`Unable to retrieve ${e} value statements`]}},p=e.useMemo((()=>(()=>{try{if(!Pe(o)&&"function"==typeof o.getROIEstimate){const e=o.getROIEstimate(i,a,r);if(!Pe(e))return e}switch(d){case"None":return{value:"0%",description:"No measurable return on investment"};case"Low":return{value:"50-100%",description:"Basic return, primarily through risk avoidance"};case"Moderate":return{value:"150-200%",description:"Balanced return through operational improvements and risk reduction"};case"High":return{value:"200-300%",description:"Strong return through business enablement and risk management"};case"Very High":return{value:"300-500%",description:"Premium return through competitive advantage and comprehensive protection"};default:return{value:"Unknown",description:"Unable to calculate ROI"}}}catch(e){return{value:"Unable to calculate",description:"ROI estimation error"}}})()),[o,i,a,r,d]);return t.jsx(We,{title:k,icon:g.VALUE_CREATION,className:s,testId:n,isLoading:c,error:l,children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mb-4",children:t.jsx("p",{className:"text-sm","data-testid":"value-creation-summary",children:(()=>{try{if(!Pe(o)&&"function"==typeof o.getBusinessValueSummary){const e=o.getBusinessValueSummary(i,a,r);if("string"==typeof e&&e)return e}switch(d){case"None":return"Minimal security investments provide basic operational capabilities but limited business value.";case"Low":return"Basic security controls enable fundamental business operations with modest protection against common threats.";case"Moderate":return"Balanced security investments deliver operational stability, data reliability, and reasonable protection that enable business growth.";case"High":return"Strategic security investments create significant business value through enhanced reliability, data integrity, and protected information assets.";case"Very High":return"Premium security investments establish market-leading capabilities and competitive advantages through exceptional reliability, data quality, and information protection.";default:return"Security investments can deliver business value through improved operations, enhanced decision-making, and protected information assets."}}catch(e){return"Security investments can deliver business value beyond just risk reduction."}})()})}),t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-medium",children:"Overall Value Profile"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("span",{className:"mr-2 text-sm text-gray-600 dark:text-gray-400",children:"Security Level:"}),t.jsx(it,{level:d,size:"md"})]})]}),t.jsx("div",{className:"p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg mb-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-green-700 dark:text-green-300",children:"Estimated Return on Investment"}),t.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:p.description})]}),t.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400","data-testid":"roi-value",children:p.value})]})}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4","data-testid":"value-metrics-grid",children:m.map(((e,i)=>t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700","data-testid":`value-metric-${i}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-xl mr-2 text-blue-500",children:e.icon||"ðŸ“ˆ"}),t.jsx("h4",{className:"font-medium",children:e.category})]}),t.jsx("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400 mb-1",children:e.value}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]},i)))})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-4",children:"Component Business Value"}),t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg","data-testid":"confidentiality-value-section",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-xl mr-2",children:"ðŸ”’"}),t.jsxs("h4",{className:"font-medium",children:["Confidentiality Value (",r,")"]})]}),t.jsx("ul",{className:"list-disc list-inside pl-2 text-sm text-gray-600 dark:text-gray-400",children:u("confidentiality",r).map(((e,i)=>t.jsx("li",{className:"mb-1","data-testid":`confidentiality-value-item-${i}`,children:e},i)))})]}),t.jsxs("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":"integrity-value-section",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-xl mr-2",children:"âœ“"}),t.jsxs("h4",{className:"font-medium",children:["Integrity Value (",a,")"]})]}),t.jsx("ul",{className:"list-disc list-inside pl-2 text-sm text-gray-600 dark:text-gray-400",children:u("integrity",a).map(((e,i)=>t.jsx("li",{className:"mb-1","data-testid":`integrity-value-item-${i}`,children:e},i)))})]}),t.jsxs("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","data-testid":"availability-value-section",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"text-xl mr-2",children:"â±ï¸"}),t.jsxs("h4",{className:"font-medium",children:["Availability Value (",i,")"]})]}),t.jsx("ul",{className:"list-disc list-inside pl-2 text-sm text-gray-600 dark:text-gray-400",children:u("availability",i).map(((e,i)=>t.jsx("li",{className:"mb-1","data-testid":`availability-value-item-${i}`,children:e},i)))})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Investment Business Case"}),t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Use these value statements to build your business case for security investments:"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:[t.jsx("h5",{className:"text-sm font-medium mb-1",children:"Executive Summary"}),t.jsxs("p",{className:"text-sm",children:["Our ",d.toLowerCase()," security investment strategy delivers business value through improved operational reliability, data integrity, and information protection."]})]}),t.jsxs("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:[t.jsx("h5",{className:"text-sm font-medium mb-1",children:"Financial Value"}),t.jsxs("p",{className:"text-sm",children:["With an estimated ROI of ",p.value,", our security investments provide strong financial returns through risk reduction, operational improvements, and business enablement."]})]}),t.jsxs("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:[t.jsx("h5",{className:"text-sm font-medium mb-1",children:"Strategic Value"}),t.jsx("p",{className:"text-sm",children:"Beyond direct financial returns, our security program creates strategic value by enabling digital initiatives, protecting our brand, and building customer trust."})]})]})]})]})]})})};function ut(e,t,i,a){const r={None:0,Low:1,Moderate:2,High:3,"Very High":4},s=(r[e]+r[t]+r[i])/3;return[{category:"Trust Enhancement",value:pt(s,95),description:"Increased customer and partner trust in your business",icon:"ðŸ¤"},{category:"Operational Efficiency",value:pt(s,40),description:"Improved operational efficiency through reliable systems",icon:"âš™ï¸"},{category:"Innovation Enablement",value:pt(s,70),description:"Enhanced ability to launch new digital initiatives",icon:"ðŸ’¡"},{category:"Decision Quality",value:pt(s,60),description:"Better business decisions through reliable data",icon:"ðŸ“Š"},{category:"Competitive Advantage",value:pt(s,50),description:"Market differentiation through security capabilities",icon:"ðŸ†"},{category:"Risk Reduction",value:pt(s,80),description:"Reduced likelihood of business disruptions",icon:"ðŸ›¡ï¸"}]}function pt(e,t){return`${Math.min(95,Math.max(5,Math.round(t*(.3+.2*e))))}%`}const gt=({impact:e,color:i,testId:a="business-impact-section"})=>{const r=e.financial?.riskLevel||e.operational?.riskLevel||"Unknown";return t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card","data-testid":a,children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact",t.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Risk: ",r]})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${a}-summary`,children:e.summary||"No business impact data available"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.financial&&t.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${i}-100 dark:bg-${i}-900 dark:bg-opacity-20 border border-${i}-200 dark:border-${i}-800`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’°"}),t.jsx("span",{className:`font-medium text-${i}-700 dark:text-${i}-300`,children:"Financial Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.financial.description||"No financial impact information available"}),e.financial.annualRevenueLoss&&t.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Annual Revenue Loss: "}),e.financial.annualRevenueLoss]})]}),e.operational&&t.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${i}-100 dark:bg-${i}-900 dark:bg-opacity-20 border border-${i}-200 dark:border-${i}-800`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),t.jsx("span",{className:`font-medium text-${i}-700 dark:text-${i}-300`,children:"Operational Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.operational.description||"No operational impact information available"}),e.operational.meanTimeToRecover&&t.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Mean Time to Recover: "}),e.operational.meanTimeToRecover]})]}),e.reputational&&t.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${i}-100 dark:bg-${i}-900 dark:bg-opacity-20 border border-${i}-200 dark:border-${i}-800`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ†"}),t.jsx("span",{className:`font-medium text-${i}-700 dark:text-${i}-300`,children:"Reputational Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.reputational.description||"No reputational impact information available"}),e.reputational.reputationalImpact&&t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:e.reputational.reputationalImpact})]}),e.strategic&&t.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${i}-100 dark:bg-${i}-900 dark:bg-opacity-20 border border-${i}-200 dark:border-${i}-800`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),t.jsx("span",{className:`font-medium text-${i}-700 dark:text-${i}-300`,children:"Strategic Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.strategic.description||"No strategic impact information available"}),e.strategic.competitiveAdvantage&&t.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Competitive Advantage: "}),e.strategic.competitiveAdvantage]})]}),e.regulatory&&t.jsxs("div",{className:`p-3 rounded-md bg-opacity-10 bg-${i}-100 dark:bg-${i}-900 dark:bg-opacity-20 border border-${i}-200 dark:border-${i}-800`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),t.jsx("span",{className:`font-medium text-${i}-700 dark:text-${i}-300`,children:"Regulatory Impact"})]}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:e.regulatory.description||"No regulatory impact information available"}),e.regulatory.complianceImpact&&t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-1",children:e.regulatory.complianceImpact}),e.regulatory.complianceViolations&&e.regulatory.complianceViolations.length>0&&t.jsxs("div",{className:"mt-1",children:[t.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Potential Violations:"," "]}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.regulatory.complianceViolations.map(((e,a)=>t.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full bg-${i}-50 text-${i}-700 dark:bg-${i}-900 dark:bg-opacity-50 dark:text-${i}-300`,children:e},a)))})]})]})]})]})},ht=({level:i,availabilityLevel:a,integrityLevel:r,confidentialityLevel:s,showExtendedDetails:n=!1,className:o="",testId:l=F})=>{const c=a||i||"Moderate",{ciaContentService:d,error:m,isLoading:u}=Fe(),p=e.useMemo((()=>{if(Pe(d))return null;try{const e=d.getComponentDetails("availability",c);return Pe(e)?null:e}catch(e){return null}}),[d,c]),h=e.useMemo((()=>{if(Pe(d))return null;try{return d.getBusinessImpact("availability",c)}catch(e){return null}}),[d,c]),y=e.useMemo((()=>{const e=function(e){switch(e){case"None":return{uptime:"Best effort",rto:"No commitment",rpo:"No commitment",mttr:"No commitment",sla:"No SLA"};case"Low":return{uptime:"95% (18 days downtime/year)",rto:"24 hours",rpo:"24 hours",mttr:"24 hours",sla:"Business hours"};case"Moderate":return{uptime:"99% (3.7 days downtime/year)",rto:"12 hours",rpo:"12 hours",mttr:"8 hours",sla:"Business hours, 7 days"};case"High":return{uptime:"99.9% (8.8 hours downtime/year)",rto:"4 hours",rpo:"4 hours",mttr:"4 hours",sla:"24/7"};case"Very High":return{uptime:"99.999% (5 minutes downtime/year)",rto:"15 minutes",rpo:"15 minutes",mttr:"1 hour",sla:"24/7 with priority response"};default:return{uptime:"Unknown",rto:"Unknown",rpo:"Unknown",mttr:"Unknown",sla:"Unknown"}}}(c);return Pe(p)?e:{uptime:p.uptime||e.uptime,rto:p.rto||e.rto,rpo:p.rpo||e.rpo,mttr:p.mttr||e.mttr,sla:p.sla||e.sla}}),[p,c]);return t.jsx(We,{title:j,icon:g.AVAILABILITY_IMPACT||"â±ï¸",className:`${o} cia-availability`,testId:l,isLoading:u,error:m,children:t.jsxs("div",{className:"p-4 cia-widget",children:[t.jsx("div",{className:"mb-4",children:t.jsx(_e,{category:"Availability",level:c,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:`${l}-level`})}),h&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:"Business Impact"}),t.jsx(gt,{impact:h,color:"blue",testId:`${l}-business-impact`})]}),t.jsxs("div",{className:"mb-4",children:[t.jsxs("h3",{className:"text-lg font-medium mb-2 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"â±ï¸"}),"SLA Metrics"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[t.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Uptime Target"}),t.jsx("div",{className:"text-lg font-bold",children:y.uptime}),t.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Expected system availability"})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[t.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Time Objective"}),t.jsx("div",{className:"text-lg font-bold",children:y.rto}),t.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Time to restore service"})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[t.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Recovery Point Objective"}),t.jsx("div",{className:"text-lg font-bold",children:y.rpo}),t.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Maximum data loss allowed"})]})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[t.jsx("div",{className:"text-sm font-medium mb-1 text-blue-700 dark:text-blue-300",children:"Service Level Agreement"}),t.jsx("div",{className:"text-lg font-bold",children:y.sla}),t.jsx("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Support coverage period"})]})})]})]})})},yt=({level:i,availabilityLevel:a,integrityLevel:r,confidentialityLevel:s,className:n="",testId:o="widget-confidentiality-impact",onLevelChange:l})=>{const{ciaContentService:c,error:d,isLoading:m}=Fe(),u=s||i||"Moderate",p=e.useMemo((()=>{try{if(Pe(c))return null;const e=c.getComponentDetails("confidentiality",u);return Pe(e)?null:e}catch(e){return null}}),[c,u]),h=e.useMemo((()=>{try{return Pe(c)?null:c.getBusinessImpact("confidentiality",u)}catch(e){return null}}),[c,u]),y=e.useMemo((()=>{if(Pe(c))return`${u} Classification`;try{return c.getInformationSensitivity(u)}catch(e){return`${u} Classification`}}),[c,u]),x=e.useMemo((()=>!Pe(p)&&p.privacyImpact?p.privacyImpact:function(e){switch(e){case"None":return"No Privacy Controls";case"Low":return"Basic Privacy Controls";case"Moderate":return"Standard Privacy Controls";case"High":return"Enhanced Privacy Controls";case"Very High":return"Maximum Privacy Controls";default:return"Unknown Privacy Impact"}}(u)),[p,u]);return t.jsx(We,{title:S,icon:g.CONFIDENTIALITY_IMPACT||"ðŸ”’",className:`${n} overflow-visible`,testId:o,isLoading:m,error:d,children:t.jsx("div",{className:"max-h-[550px] overflow-y-auto pr-1",children:t.jsxs("div",{className:"p-4",role:"region","aria-labelledby":"confidentiality-impact-heading",children:[t.jsx("div",{className:"mb-4",children:t.jsx(_e,{category:"Confidentiality",level:u,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:`${o}-confidentiality-badge`})}),h&&t.jsx(gt,{impact:h,color:"purple",testId:`${o}-business-impact`}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“Š"}),"Data Protection"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[t.jsx("div",{className:"text-sm font-medium mb-1 text-purple-700 dark:text-purple-300",children:"Data Classification"}),t.jsx("div",{className:"text-lg font-bold",children:y}),t.jsx("div",{className:"text-xs text-purple-600 dark:text-purple-400",children:"Level of data sensitivity"})]})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Privacy Impact"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Privacy Impact:"}),t.jsx("div",{className:"text-lg font-bold text-purple-600 dark:text-purple-400",children:x})]})})]})]})})})},xt=({level:i,availabilityLevel:a,integrityLevel:r,confidentialityLevel:s,className:n="",testId:o=B,showExtendedDetails:l=!1})=>{const c=r||i||"Moderate",{ciaContentService:d,error:m,isLoading:u}=Fe(),p=e.useMemo((()=>{try{if(Pe(d)||Pe(c))return null;const e=d.getComponentDetails("integrity",c);return Pe(e)?null:e}catch(e){return null}}),[d,c]),h=e.useMemo((()=>{try{return Pe(d)||Pe(c)?null:d.getBusinessImpact("integrity",c)}catch(e){return null}}),[d,c]),y=e.useMemo((()=>{try{return Pe(d)||Pe(c)?[]:d.getRecommendations("integrity",c)||[]}catch(e){return[]}}),[d,c]),x=e.useMemo((()=>!Pe(p)&&p.validationLevel?p.validationLevel:function(e){switch(e){case"None":return"No Validation";case"Low":return"Basic";case"Moderate":return"Standard";case"High":return"Enhanced";case"Very High":return"Comprehensive";default:return"Unknown"}}(c)),[p,c]),b=e.useMemo((()=>!Pe(p)&&p.errorRate?p.errorRate:(e=>{switch(e){case"None":return"Not monitored";case"Low":return"< 5%";case"Moderate":return"< 3%";case"High":return"< 1%";case"Very High":return"< 0.01%";default:return"Unknown"}})(c)),[p,c]);return t.jsx(We,{title:I,icon:g.INTEGRITY_IMPACT||"âœ“",className:n,testId:o,isLoading:u,error:m,children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"mb-4",children:t.jsx(_e,{category:"Integrity",level:c,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:`${o}-integrity-badge`})}),h&&t.jsx("div",{className:"mt-4","data-testid":`${o}-business-impact-container`,children:t.jsx(gt,{impact:h,color:"green",testId:`${o}-business-impact`})}),t.jsxs("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":`${o}-metrics`,children:[t.jsx("h3",{className:"text-lg font-medium mb-2 text-green-800 dark:text-green-300",children:"Data Integrity Metrics"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Data Validation Controls:"}),t.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:x})]}),t.jsxs("div",{className:"p-2 bg-white dark:bg-gray-800 rounded-lg",children:[t.jsx("div",{className:"text-sm font-medium mb-1",children:"Acceptable Error Rate:"}),t.jsx("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:b})]})]})]}),l&&y.length>0&&t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:"Recommendations"}),t.jsx("ul",{className:"list-disc pl-5 space-y-1",children:y.map(((e,i)=>t.jsx("li",{className:"text-sm text-gray-600 dark:text-gray-400",children:e},i)))})]})]})})},bt=({resource:e,onClick:i,className:a="",testId:r})=>{const s=()=>{i?i(e):window.open(e.url,"_blank","noopener,noreferrer")};return t.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-4 hover:shadow-lg transition-shadow ${a}`,onClick:s,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||s()},"data-testid":r||"resource-item",children:[t.jsxs("div",{className:"flex justify-between items-start mb-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:e.title}),t.jsx("div",{className:"text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-100 px-2 py-1 rounded",children:e.type||"General"})]}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:(n=e.description||"",o=100,n?n.length>o?`${n.substring(0,o)}...`:n:"")}),t.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[e.component&&t.jsxs("span",{className:"mr-2",children:["Component: ",e.component]}),e.source&&t.jsxs("span",{className:"mr-2",children:["Source: ",e.source]}),e.level&&t.jsxs("span",{children:["Level: ",e.level]})]}),t.jsx("div",{className:"mt-2 flex flex-wrap",children:e.tags?.map(((e,i)=>t.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded mr-1 mb-1",children:e},i)))})]});var n,o},vt=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,className:s="",testId:n=U,limit:o=8,showTopResourcesOnly:l=!1})=>{const{ciaContentService:c,error:d,isLoading:m}=Fe(),[u,p]=e.useState(null),[h,y]=e.useState(""),[x,b]=e.useState(1),[f,k]=e.useState(o),N=e.useMemo((()=>{try{if(Pe(c))return[];const e=c.getSecurityResources?.("availability",i)||[],t=c.getSecurityResources?.("integrity",a)||[],s=c.getSecurityResources?.("confidentiality",r)||[],n=[...e,...t,...s],o=[],l=new Set;return n.forEach((e=>{const t=e.url||e.title;l.has(t)||(l.add(t),o.push(e))})),o.sort(((e,t)=>{const i=e.relevanceScore,a=t.relevanceScore;return void 0!==i&&void 0!==a?a-i:e.title.localeCompare(t.title)}))}catch(e){return[]}}),[c,i,a,r]),w=e.useMemo((()=>{const e=new Set;return N.forEach((t=>{t.category&&e.add(t.category)})),Array.from(e).sort()}),[N]),j=e.useMemo((()=>{let e=N;if(u&&(e=e.filter((e=>e.category===u))),h.trim()){const t=h.toLowerCase().trim();e=e.filter((e=>e.title.toLowerCase().includes(t)||e.description?.toLowerCase().includes(t)||e.tags&&e.tags.some((e=>e.toLowerCase().includes(t)))))}return e}),[N,u,h]),I=e.useMemo((()=>{const e=x*f,t=e-f;return j.slice(t,e)}),[j,x,f]),S=e.useCallback((e=>{p(e),b(1)}),[]),L=e.useCallback((e=>{y(e.target.value),b(1)}),[]),C=e.useCallback((e=>{b(e)}),[]),M=Math.ceil(j.length/f),H=e.useMemo((()=>{try{return Pe(c)?[]:[c.getTechnicalImplementation?.("availability",i),c.getTechnicalImplementation?.("integrity",a),c.getTechnicalImplementation?.("confidentiality",r)].filter((e=>void 0!==e))}catch(e){return[]}}),[c,i,a,r]);return t.jsx(We,{title:v,icon:g.SECURITY_RESOURCES,className:s,testId:n,isLoading:m,error:d,children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:t.jsx("p",{className:"text-sm",children:"This widget provides curated security resources to help implement controls that align with your selected security levels across the CIA triad."})}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[t.jsxs("div",{className:"md:w-1/4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"resource-search",className:"block text-sm font-medium mb-1",children:"Search Resources"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{id:"resource-search",type:"text",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md dark:bg-gray-800 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Search by title, description...",value:h,onChange:L,"data-testid":`${n}-search`}),t.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 dark:text-gray-400",children:"ðŸ”"})]})]}),w.length>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-sm font-medium mb-2",children:"Categories"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"px-3 py-2 rounded-md cursor-pointer text-sm "+(null===u?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"),onClick:()=>S(null),"data-testid":`${n}-category-all`,children:"All Resources"}),w.map(((e,i)=>t.jsx("div",{className:"px-3 py-2 rounded-md cursor-pointer text-sm "+(u===e?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"),onClick:()=>S(e),"data-testid":`${n}-category-${i}`,children:e},e)))]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-sm font-medium mb-2",children:"Implementation Guidelines"}),t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg text-sm",children:[t.jsx("p",{className:"mb-2 font-medium",children:"Selected Security Levels:"}),t.jsxs("div",{className:"mb-2 text-xs",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Confidentiality:"}),t.jsx("span",{className:"font-medium",children:r})]}),t.jsxs("div",{className:"flex justify-between mb-1",children:[t.jsx("span",{children:"Integrity:"}),t.jsx("span",{className:"font-medium",children:a})]}),t.jsxs("div",{className:"flex justify-between mb-1",children:[t.jsx("span",{children:"Availability:"}),t.jsx("span",{className:"font-medium",children:i})]})]}),t.jsx("p",{className:"mb-2 text-xs text-gray-600 dark:text-gray-400",children:"Focus on implementing controls that satisfy all three components for a balanced security posture."})]})]})]}),t.jsxs("div",{className:"md:w-3/4",children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h3",{className:"text-lg font-medium",children:"Security Resources"}),t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[j.length," ",1===j.length?"resource":"resources"," ","found"]})]}),0===j.length&&t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center text-gray-500 dark:text-gray-400","data-testid":`${n}-no-resources`,children:[t.jsx("p",{className:"mb-2",children:"No resources found."}),t.jsx("p",{className:"text-sm",children:h?"Try adjusting your search terms or clearing filters.":"Resources will appear here when available."})]}),j.length>0&&t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:I.map(((e,i)=>t.jsx(bt,{resource:e,testId:`${n}-resource-${i}`},`${e.url||""}-${i}`)))}),M>1&&t.jsx("div",{className:"mt-4 flex justify-center",children:t.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[t.jsx("button",{onClick:()=>C(x-1),disabled:1===x,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border ${1===x?"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600 cursor-not-allowed":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"} text-sm font-medium`,children:"Previous"}),Array.from({length:M}).map(((e,i)=>t.jsx("button",{onClick:()=>C(i+1),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium "+(x===i+1?"z-10 bg-blue-50 border-blue-500 text-blue-600 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"),children:i+1},i))),t.jsx("button",{onClick:()=>C(x+1),disabled:x===M,className:`relative inline-flex items-center px-2 py-2 rounded-r-md border ${x===M?"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600 cursor-not-allowed":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"} text-sm font-medium`,children:"Next"})]})})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Implementation Tips"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[t.jsx("h4",{className:"text-md font-medium mb-2",children:"Getting Started with Implementation"}),t.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400 pl-2",children:[t.jsx("li",{children:"Begin with a thorough assessment of your current security controls"}),t.jsx("li",{children:"Prioritize implementations based on risk exposure and business impact"}),t.jsx("li",{children:"Implement controls gradually, starting with foundational elements"}),t.jsx("li",{children:"Document your implementation process and security configurations"}),t.jsx("li",{children:"Test and validate controls after implementation"})]})]}),H.length>0&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[H[2]&&t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg border border-purple-100 dark:border-purple-800",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 text-purple-700 dark:text-purple-300 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ”’"}),"Confidentiality (",r,")"]}),t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("p",{className:"mb-2",children:H[2].description||"Focus on data protection and access controls."}),t.jsxs("div",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Expertise:"})," ",H[2].expertiseLevel||"Standard"]}),t.jsxs("div",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Effort:"})," ",H[2].developmentEffort||"Medium"]})]})]}),H[1]&&t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg border border-green-100 dark:border-green-800",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 text-green-700 dark:text-green-300 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âœ“"}),"Integrity (",a,")"]}),t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("p",{className:"mb-2",children:H[1].description||"Focus on data accuracy and validation mechanisms."}),t.jsxs("div",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Expertise:"})," ",H[1].expertiseLevel||"Standard"]}),t.jsxs("div",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Effort:"})," ",H[1].developmentEffort||"Medium"]})]})]}),H[0]&&t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg border border-blue-100 dark:border-blue-800",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 text-blue-700 dark:text-blue-300 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"â±ï¸"}),"Availability (",i,")"]}),t.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("p",{className:"mb-2",children:H[0].description||"Focus on systems uptime and recovery capabilities."}),t.jsxs("div",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Expertise:"})," ",H[0].expertiseLevel||"Standard"]}),t.jsxs("div",{className:"text-xs",children:[t.jsx("span",{className:"font-medium",children:"Effort:"})," ",H[0].developmentEffort||"Medium"]})]})]})]}),t.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg border border-yellow-100 dark:border-yellow-800",children:[t.jsxs("h4",{className:"text-md font-medium mb-2 text-yellow-700 dark:text-yellow-300 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"âš ï¸"}),"Common Implementation Challenges"]}),t.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400 pl-2",children:[t.jsx("li",{children:"Balancing security with usability and performance"}),t.jsx("li",{children:"Maintaining consistent controls across different environments"}),t.jsx("li",{children:"Integration with legacy systems and applications"}),t.jsx("li",{children:"Building security expertise and awareness across teams"}),t.jsx("li",{children:"Allocating sufficient resources for ongoing maintenance"})]})]})]})]})]})]})]})})},ft={},kt=function(e,t,i){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map((e=>Promise.resolve(e).then((e=>({status:"fulfilled",value:e})),(e=>({status:"rejected",reason:e}))))))};const r=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),n=s?.nonce||s?.getAttribute("nonce");a=e(t.map((e=>{if(e=function(e,t){return new URL(e,t).href}(e,i),e in ft)return;ft[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(!!i)for(let i=r.length-1;i>=0;i--){const a=r[i];if(a.href===e&&(!t||"stylesheet"===a.rel))return}else if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":"modulepreload",t||(s.as="script"),s.crossOrigin="",s.href=e,n&&s.setAttribute("nonce",n),document.head.appendChild(s),t?new Promise(((t,i)=>{s.addEventListener("load",t),s.addEventListener("error",(()=>i(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then((t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)}))},Nt=()=>{const[t,i]=e.useState(null),[a,r]=e.useState(null),[s,n]=e.useState(!0),{dataProvider:o}=(()=>{const[t,i]=e.useState(null),[a,r]=e.useState(null),[s,n]=e.useState(!0),o=e.useCallback((async()=>{try{n(!0),r(null);const{createDefaultDataProvider:e}=await kt((async()=>{const{createDefaultDataProvider:e}=await import("./dataProviders-CFFatKfO.js");return{createDefaultDataProvider:e}}),[],import.meta.url),t=e();i(t)}catch(e){r(e instanceof Error?e:new Error("Failed to initialize data provider")),i(null)}finally{n(!1)}}),[]);return e.useEffect((()=>{o()}),[o]),{dataProvider:t,error:a,isLoading:s,refreshDataProvider:o}})(),l=e.useCallback((async()=>{try{n(!0),r(null);const e=o?Ie(o):Ie();i(e)}catch(e){r(e instanceof Error?e:new Error("Failed to initialize security metrics service")),i(null)}finally{n(!1)}}),[o]);return e.useEffect((()=>{l()}),[l]),{securityMetricsService:t,error:a,isLoading:s,refreshService:l}},wt=({availabilityLevel:i="None",integrityLevel:a="None",confidentialityLevel:s="None",className:n="",testId:o=C})=>{const l=e.useRef(null),c=e.useRef(null),[d,m]=e.useState(null),[u,p]=e.useState(document.documentElement.classList.contains("dark")),[g]=e.useState({availabilityLevel:i,integrityLevel:a,confidentialityLevel:s}),h=e=>{switch(e){case"None":default:return 0;case"Basic":case"Low":return 1;case"Moderate":return 2;case"High":return 3;case"Very High":return 4}};e.useEffect((()=>{const e=new MutationObserver((e=>{e.forEach((e=>{if("class"===e.attributeName&&e.target===document.documentElement){const e=document.documentElement.classList.contains("dark");e!==u&&p(e)}}))}));return e.observe(document.documentElement,{attributes:!0}),()=>e.disconnect()}),[u]),e.useEffect((()=>{if(l.current)try{c.current&&c.current.destroy();const e=l.current?.getContext("2d");if(!e)return void m("Could not get canvas context");const t=h(i),n=h(a),o=h(s),d=u?"rgba(0, 204, 102, 0.2)":"rgba(0, 102, 51, 0.2)",p=u?"#00cc66":"#006633",g=u?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",y=u?"#f0f0f0":"#222222";c.current=new r(e,{type:"radar",data:{labels:["Availability","Integrity","Confidentiality"],datasets:[{label:"Security Profile",data:[t,n,o],backgroundColor:d,borderColor:p,borderWidth:2,pointBackgroundColor:p,pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:p}]},options:{responsive:!0,maintainAspectRatio:!0,scales:{r:{angleLines:{color:g},grid:{color:g},pointLabels:{color:y,font:{size:12}},min:0,max:4,ticks:{backdropColor:"transparent",color:y,z:100,stepSize:1,font:{size:10},callback:function(e){return["None","Basic","Moderate","High","Very High"][e]||""}},beginAtZero:!0}},plugins:{legend:{display:!1,labels:{color:u?"#00cc66":"#006633",font:{family:"'Share Tech Mono', monospace",size:12},boxWidth:15,boxHeight:2}},tooltip:{callbacks:{label:function(e){const t=e.raw;return`${e.label}: ${["None","Basic","Moderate","High","Very High"][t]||""}`}}}}}});const x=()=>{c.current&&c.current.resize()};return window.addEventListener("resize",x),()=>{window.removeEventListener("resize",x),c.current&&c.current.destroy()}}catch(e){m(e instanceof Error?e.message:String(e))}}),[i,a,s,u]);const y=n?`radar-chart-container ${n}`.trim():"radar-chart-container";return t.jsxs("div",{className:y,"data-testid":`${o}-container`,children:[d?t.jsxs("div",{"data-testid":`${o}-error`,className:"error-message",children:["Error loading chart: ",d]}):t.jsxs("div",{className:"radar-values flex justify-between mb-2",children:[t.jsxs("div",{children:[t.jsx("strong",{children:"Availability:"})," ",t.jsx("span",{"data-testid":M,children:i||"None"})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Integrity:"})," ",t.jsx("span",{"data-testid":H,children:a||"None"})]}),t.jsxs("div",{children:[t.jsx("strong",{children:"Confidentiality:"})," ",t.jsx("span",{"data-testid":R,children:s||"None"})]})]}),t.jsx("canvas",{ref:l,"data-testid":o})]})},jt=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,className:s="",testId:n="security-visualization-widget"})=>{const{error:o,isLoading:l}=Nt(),c=e.useMemo((()=>{const e=ne(i)+ne(a)+ne(r);return Math.round(e/12*100)}),[i,a,r]),d=e.useMemo((()=>c<=30||c<=60?"High Risk":c<=80?"Medium Risk":"Low Risk"),[c]);return t.jsx(We,{title:w,icon:g.SECURITY_VISUALIZATION,className:s,testId:n,isLoading:l,error:o,children:t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Posture"}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Security Score"}),t.jsx("div",{className:"text-3xl font-bold","data-testid":"security-score-value",children:c})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Risk Level"}),t.jsx("div",{className:"text-xl font-bold "+(u=d,u.includes("Critical")?"text-red-600 dark:text-red-400":u.includes("High")?"text-orange-600 dark:text-orange-400":u.includes("Medium")?"text-yellow-600 dark:text-yellow-400":u.includes("Low")?"text-green-600 dark:text-green-400":u.includes("Minimal")?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400"),"data-testid":"risk-level",children:d})]})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Security Level"}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:t.jsx("div",{className:"h-2.5 rounded-full "+(m=c,m<=30?"bg-red-600":50===m?"bg-yellow-400":m<=60?"bg-orange-500":m<=80?"bg-green-500":"bg-blue-500"),style:{width:`${c}%`},"data-testid":"security-score-bar"})}),t.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mt-1",children:[t.jsx("div",{children:"Critical"}),t.jsx("div",{children:"High"}),t.jsx("div",{children:"Medium"}),t.jsx("div",{children:"Low"}),t.jsx("div",{children:"Minimal"})]})]})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Components"}),t.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:t.jsx(wt,{availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,testId:`${n}-radar-chart`})})]}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h3",{className:"text-lg font-medium mb-3",children:"Component Details"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg","data-testid":"confidentiality-component",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-md font-medium text-purple-800 dark:text-purple-300",children:"Confidentiality"}),t.jsx(it,{level:r,testId:"confidentiality-level-indicator"})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:t.jsx("div",{className:"bg-purple-500 h-1.5 rounded-full",style:{width:ne(r)/4*100+"%"},"data-testid":"confidentiality-gauge"})})]}),t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":"integrity-component",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-md font-medium text-green-800 dark:text-green-300",children:"Integrity"}),t.jsx(it,{level:a,testId:"integrity-level-indicator"})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:t.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:ne(a)/4*100+"%"},"data-testid":"integrity-gauge"})})]}),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","data-testid":"availability-component",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"text-md font-medium text-blue-800 dark:text-blue-300",children:"Availability"}),t.jsx(it,{level:i,testId:"availability-level-indicator"})]}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:t.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full",style:{width:ne(i)/4*100+"%"},"data-testid":"availability-gauge"})})]})]})]}),(()=>{const e=ne(i),s=ne(a),n=ne(r);return i!==a||a!==r||"High"!==i&&"Very High"!==i?t.jsxs("div",{className:"space-y-2 mt-4","data-testid":"security-recommendations",children:[e<2&&t.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:t.jsx("p",{className:"text-sm",children:"Consider improving availability controls to ensure business continuity."})}),s<3&&t.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:t.jsx("p",{className:"text-sm",children:"Enhance data validation mechanisms and change management to improve integrity."})}),n<2&&t.jsx("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:t.jsx("p",{className:"text-sm",children:"Strengthen access controls and data protection to improve confidentiality."})})]}):t.jsx("div",{"data-testid":"balanced-recommendation",className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg mt-4",children:t.jsx("p",{className:"text-sm",children:"Your security posture is well-balanced with strong controls across all CIA components."})})})(),t.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mt-4",children:[t.jsx("h3",{className:"text-md font-medium mb-2",children:"Security Visualization Key"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"The security score represents your overall security posture based on your CIA triad levels. The risk level indicates the potential business risk associated with your current security posture."}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 text-xs",children:[t.jsx("div",{className:"p-1 bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300 rounded text-center",children:"Critical Risk"}),t.jsx("div",{className:"p-1 bg-orange-100 text-orange-800 dark:bg-orange-900 dark:bg-opacity-30 dark:text-orange-300 rounded text-center",children:"High Risk"}),t.jsx("div",{className:"p-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300 rounded text-center",children:"Medium Risk"}),t.jsx("div",{className:"p-1 bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300 rounded text-center",children:"Low Risk"}),t.jsx("div",{className:"p-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300 rounded text-center",children:"Minimal Risk"})]})]})]})});var m,u},It=({availabilityLevel:i,integrityLevel:a,confidentialityLevel:r,className:s="",testId:n="technical-details-widget"})=>{const[o,l]=e.useState("confidentiality"),{ciaContentService:c,error:d,isLoading:m}=Fe(),u=e.useMemo((()=>{try{if(Pe(c))return St("confidentiality",r);const e=c.getComponentDetails?.("confidentiality",r);return Pe(e)?St("confidentiality",r):e}catch(e){return St("confidentiality",r)}}),[c,r]),p=e.useMemo((()=>{try{if(Pe(c))return St("integrity",a);const e=c.getComponentDetails?.("integrity",a);return Pe(e)?St("integrity",a):e}catch(e){return St("integrity",a)}}),[c,a]),h=e.useMemo((()=>{try{if(Pe(c))return St("availability",i);const e=c.getComponentDetails?.("availability",i);return Pe(e)?St("availability",i):e}catch(e){return St("availability",i)}}),[c,i]),y=(e,t)=>{try{if(Pe(c))return Mt(e,t);const i=c.getTechnicalRequirements?.(e,t);return Array.isArray(i)&&i.length>0?i:Mt(e,t)}catch(i){return Mt(e,t)}},x=e=>{switch(e){case"None":return{value:0,label:"None"};case"Low":return{value:25,label:"Low"};case"Moderate":return{value:50,label:"Moderate"};case"High":return{value:75,label:"High"};case"Very High":return{value:100,label:"Very High"};default:return{value:0,label:"Unknown"}}},b=(e,t)=>{try{if(!Pe(c)&&"function"==typeof c.getExpertiseRequired){const i=c.getExpertiseRequired(e,t);if(Array.isArray(i)&&i.length>0)return i}return $t(e,t)}catch(i){return $t(e,t)}},v=e=>`${{None:.1,Low:.25,Moderate:.5,High:1,"Very High":2}[e]||.5} FTE`,f=x(r),k=x(a),w=x(i);return t.jsx(We,{title:N,icon:g.TECHNICAL_DETAILS,className:s,testId:n,isLoading:m,error:d,children:t.jsxs("div",{className:"p-4",children:[t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg",children:t.jsx("p",{className:"text-sm",children:"This widget provides technical implementation details for achieving your selected security levels. Use these guidelines when designing and implementing your security controls."})}),t.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-4",children:[t.jsxs("button",{onClick:()=>l("confidentiality"),className:"py-2 px-4 font-medium text-sm focus:outline-none "+("confidentiality"===o?"border-b-2 border-purple-500 text-purple-600 dark:text-purple-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),"data-testid":"confidentiality-tab",children:[t.jsx("span",{className:"mr-1",children:"ðŸ”’"})," Confidentiality"]}),t.jsxs("button",{onClick:()=>l("integrity"),className:"py-2 px-4 font-medium text-sm focus:outline-none "+("integrity"===o?"border-b-2 border-green-500 text-green-600 dark:text-green-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),"data-testid":"integrity-tab",children:[t.jsx("span",{className:"mr-1",children:"âœ“"})," Integrity"]}),t.jsxs("button",{onClick:()=>l("availability"),className:"py-2 px-4 font-medium text-sm focus:outline-none "+("availability"===o?"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),"data-testid":"availability-tab",children:[t.jsx("span",{className:"mr-1",children:"â±ï¸"})," Availability"]})]}),"confidentiality"===o&&t.jsxs("div",{className:"mb-6","data-testid":"confidentiality-section",children:[t.jsxs("div",{className:"flex items-center mb-4","data-testid":"technical-header",children:[t.jsx("span",{className:"text-xl mr-2 text-purple-500",children:"ðŸ”’"}),t.jsx("h3",{className:"text-lg font-medium",children:"Confidentiality Controls"}),t.jsx("div",{className:"ml-auto",children:t.jsx(_e,{category:"",level:r,colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",testId:`${n}-confidentiality-badge`})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg shadow-sm border border-purple-100 dark:border-purple-800",children:[t.jsx("h4",{className:"text-md font-medium text-purple-700 dark:text-purple-300 mb-3",children:"Technical Description"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"technical-description",children:u?.technical||Ct("confidentiality",r)}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Implementation Complexity"}),t.jsxs("div",{className:"flex items-center","data-testid":"development-effort",children:[t.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:t.jsx("div",{className:"h-2 bg-purple-500 dark:bg-purple-600 rounded-full",style:{width:`${f.value}%`}})}),t.jsx("span",{className:"text-xs font-medium",children:f.label})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-300 mb-2",children:"Personnel Requirements"}),t.jsxs("div",{className:"flex items-center","data-testid":"maintenance-level",children:[t.jsx("span",{className:"text-sm",children:"Estimated staffing: "}),t.jsx("span",{className:"ml-2 text-sm font-medium text-purple-600 dark:text-purple-400",children:v(r)})]})]})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("h4",{className:"text-md font-medium mb-3","data-testid":"implementation-header",children:"Implementation Requirements"}),t.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400","data-testid":"implementation-steps",children:y("confidentiality",r).map(((e,i)=>t.jsx("li",{"data-testid":`conf-req-${i}`,children:e},`conf-req-${i}`)))})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-purple-500",children:"ðŸ’»"}),"Technologies"]}),t.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:u?.technologies||Ht("confidentiality",r)})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-purple-500",children:"âš™ï¸"}),"Configurations"]}),t.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:u?.configurations||Rt("confidentiality",r)})]})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-purple-500",children:"ðŸ‘¨â€ðŸ’»"}),"Expertise Required"]}),t.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2","data-testid":"required-expertise",children:b("confidentiality",r).map(((e,i)=>t.jsxs("li",{className:"flex items-center text-sm",children:[t.jsx("span",{className:"mr-2 text-purple-500",children:"â€¢"}),t.jsx("span",{children:e})]},`conf-exp-${i}`)))})]})]}),"integrity"===o&&t.jsxs("div",{className:"mb-6","data-testid":"integrity-section",children:[t.jsxs("div",{className:"flex items-center mb-4","data-testid":"technical-header",children:[t.jsx("span",{className:"text-xl mr-2 text-green-500",children:"âœ“"}),t.jsx("h3",{className:"text-lg font-medium",children:"Integrity Controls"}),t.jsx("div",{className:"ml-auto",children:t.jsx(_e,{category:"",level:a,colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",testId:`${n}-integrity-badge`})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg shadow-sm border border-green-100 dark:border-green-800",children:[t.jsx("h4",{className:"text-md font-medium text-green-700 dark:text-green-300 mb-3",children:"Technical Description"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"technical-description",children:p?.technical||Ct("integrity",a)}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h5",{className:"text-sm font-medium text-green-700 dark:text-green-300 mb-2",children:"Implementation Complexity"}),t.jsxs("div",{className:"flex items-center","data-testid":"development-effort",children:[t.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:t.jsx("div",{className:"h-2 bg-green-500 dark:bg-green-600 rounded-full",style:{width:`${k.value}%`}})}),t.jsx("span",{className:"text-xs font-medium",children:k.label})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h5",{className:"text-sm font-medium text-green-700 dark:text-green-300 mb-2",children:"Personnel Requirements"}),t.jsxs("div",{className:"flex items-center","data-testid":"maintenance-level",children:[t.jsx("span",{className:"text-sm",children:"Estimated staffing: "}),t.jsx("span",{className:"ml-2 text-sm font-medium text-green-600 dark:text-green-400",children:v(a)})]})]})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("h4",{className:"text-md font-medium mb-3","data-testid":"implementation-header",children:"Implementation Requirements"}),t.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400","data-testid":"implementation-steps",children:y("integrity",a).map(((e,i)=>t.jsx("li",{"data-testid":`int-req-${i}`,children:e},`int-req-${i}`)))})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-green-500",children:"ðŸ’»"}),"Technologies"]}),t.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:p?.technologies||Ht("integrity",a)})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-green-500",children:"âš™ï¸"}),"Configurations"]}),t.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:p?.configurations||Rt("integrity",a)})]})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-green-500",children:"ðŸ‘¨â€ðŸ’»"}),"Expertise Required"]}),t.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2","data-testid":"required-expertise",children:b("integrity",a).map(((e,i)=>t.jsxs("li",{className:"flex items-center text-sm",children:[t.jsx("span",{className:"mr-2 text-green-500",children:"â€¢"}),t.jsx("span",{children:e})]},`int-exp-${i}`)))})]})]}),"availability"===o&&t.jsxs("div",{className:"mb-6","data-testid":"availability-section",children:[t.jsxs("div",{className:"flex items-center mb-4","data-testid":"technical-header",children:[t.jsx("span",{className:"text-xl mr-2 text-blue-500",children:"â±ï¸"}),t.jsx("h3",{className:"text-lg font-medium",children:"Availability Controls"}),t.jsx("div",{className:"ml-auto",children:t.jsx(_e,{category:"",level:i,colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",testId:`${n}-availability-badge`})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg shadow-sm border border-blue-100 dark:border-blue-800",children:[t.jsx("h4",{className:"text-md font-medium text-blue-700 dark:text-blue-300 mb-3",children:"Technical Description"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":"technical-description",children:h?.technical||Ct("availability",i)}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h5",{className:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Implementation Complexity"}),t.jsxs("div",{className:"flex items-center","data-testid":"development-effort",children:[t.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:t.jsx("div",{className:"h-2 bg-blue-500 dark:bg-blue-600 rounded-full",style:{width:`${w.value}%`}})}),t.jsx("span",{className:"text-xs font-medium",children:w.label})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h5",{className:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-2",children:"Personnel Requirements"}),t.jsxs("div",{className:"flex items-center","data-testid":"maintenance-level",children:[t.jsx("span",{className:"text-sm",children:"Estimated staffing: "}),t.jsx("span",{className:"ml-2 text-sm font-medium text-blue-600 dark:text-blue-400",children:v(i)})]})]})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsx("h4",{className:"text-md font-medium mb-3","data-testid":"implementation-header",children:"Implementation Requirements"}),t.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400","data-testid":"implementation-steps",children:y("availability",i).map(((e,i)=>t.jsx("li",{"data-testid":`avail-req-${i}`,children:e},`avail-req-${i}`)))})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"ðŸ’»"}),"Technologies"]}),t.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:h?.technologies||Ht("availability",i)})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"âš™ï¸"}),"Configurations"]}),t.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:h?.configurations||Rt("availability",i)})]})]}),t.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4",children:[t.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"ðŸ‘¨â€ðŸ’»"}),"Expertise Required"]}),t.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-2","data-testid":"required-expertise",children:b("availability",i).map(((e,i)=>t.jsxs("li",{className:"flex items-center text-sm",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),t.jsx("span",{children:e})]},`avail-exp-${i}`)))})]})]}),t.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[t.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¡"}),"Implementation Notes"]}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),t.jsx("span",{children:"Implement these technical controls in a layered approach, starting with foundational controls."})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),t.jsx("span",{children:"Regular testing and validation are required to ensure controls are functioning as intended."})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),t.jsx("span",{children:"Consider integrating with existing security infrastructure to maximize effectiveness."})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx("span",{className:"mr-2 text-blue-500",children:"â€¢"}),t.jsx("span",{children:"Document all implementation details and maintain up-to-date configuration records."})]})]})]})]})})};function St(e,t){return{description:Lt(e,t),technical:Ct(e,t),recommendations:Mt(e,t)}}function Lt(e,t){if("confidentiality"===e)switch(t){case"None":return"No confidentiality controls implemented, allowing unrestricted access to data.";case"Low":return"Basic confidentiality controls to prevent casual unauthorized access to data.";case"Moderate":return"Standard confidentiality controls with defined access privileges and protections.";case"High":return"Advanced confidentiality controls with strong encryption and strict access management.";case"Very High":return"Comprehensive confidentiality controls with the highest level of protection.";default:return"Standard confidentiality controls."}if("integrity"===e)switch(t){case"None":return"No integrity controls implemented, data can be modified without detection.";case"Low":return"Basic integrity controls that provide minimal protection against unauthorized changes.";case"Moderate":return"Standard integrity controls that detect unauthorized modifications to data.";case"High":return"Advanced integrity controls with cryptographic verification of data.";case"Very High":return"Comprehensive integrity controls with immutable audit trails.";default:return"Standard integrity controls."}switch(t){case"None":return"No availability controls implemented, no guarantees for system uptime.";case"Low":return"Basic availability controls providing minimal resilience to disruptions.";case"Moderate":return"Standard availability controls ensuring reasonable system uptime.";case"High":return"Advanced availability controls with redundancy and quick recovery capabilities.";case"Very High":return"Comprehensive availability controls with maximum fault tolerance.";default:return"Standard availability controls."}}function Ct(e,t){if("confidentiality"===e)switch(t){case"None":return"No specific technical controls for protecting data confidentiality.";case"Low":return"Basic access controls and password protection for sensitive resources.";case"Moderate":return"Role-based access control (RBAC), data encryption at rest and in transit, and proper authentication mechanisms.";case"High":return"Granular access control, strong encryption with proper key management, DLP controls, and multi-factor authentication.";case"Very High":return"Zero-trust architecture, advanced encryption with hardware security modules, comprehensive DLP, and context-aware access controls.";default:return"Standard confidentiality technical controls."}if("integrity"===e)switch(t){case"None":return"No specific technical controls for ensuring data integrity.";case"Low":return"Basic input validation and error detection mechanisms.";case"Moderate":return"Comprehensive input validation, checksums, access controls, and error detection.";case"High":return"Digital signatures, cryptographic hashing, strong change control, and comprehensive logging.";case"Very High":return"Blockchain or similar technologies for critical data, immutable audit logs, and formal verification methods.";default:return"Standard integrity technical controls."}switch(t){case"None":return"No specific technical controls for ensuring system availability.";case"Low":return"Basic monitoring and manual recovery procedures.";case"Moderate":return"Redundant components, scheduled backups, load balancing, and defined recovery procedures.";case"High":return"Automatic failover, real-time monitoring, comprehensive disaster recovery, and advanced load balancing.";case"Very High":return"Multi-site active-active configurations, continuous data protection, and fully automated recovery with zero data loss.";default:return"Standard availability technical controls."}}function Mt(e,t){if("confidentiality"===e)switch(t){case"None":return["No specific requirements."];case"Low":return["Implement user authentication","Use basic password policies","Apply simple access controls","Secure sensitive data storage"];case"Moderate":return["Implement role-based access control","Use standard TLS for data in transit","Encrypt sensitive data at rest","Enforce strong password policies","Implement session management"];case"High":return["Implement multi-factor authentication","Deploy data loss prevention solutions","Use strong encryption for all data","Implement privileged access management","Conduct regular access reviews"];case"Very High":return["Implement zero-trust network architecture","Use hardware security modules for encryption","Deploy advanced data loss prevention","Implement just-in-time access","Use behavioral analytics for access monitoring"];default:return["Standard confidentiality requirements."]}if("integrity"===e)switch(t){case"None":return["No specific requirements."];case"Low":return["Implement basic input validation","Use simple error detection","Apply basic data quality checks"];case"Moderate":return["Implement comprehensive input validation","Use checksums for data verification","Implement change detection mechanisms","Maintain data validation logs","Use database constraints"];case"High":return["Implement digital signatures","Use cryptographic hash verification","Deploy comprehensive audit logging","Implement strict change controls","Use data integrity monitoring"];case"Very High":return["Implement blockchain for critical data","Use immutable audit trails","Deploy formal verification methods","Implement hardware-based integrity controls","Use zero-knowledge proofs where applicable"];default:return["Standard integrity requirements."]}switch(t){case"None":return["No specific requirements."];case"Low":return["Set up basic system monitoring","Implement manual backup procedures","Create simple incident response plan"];case"Moderate":return["Implement redundant components","Set up scheduled backup routines","Deploy basic load balancing","Create disaster recovery procedures","Implement health checks and alerts"];case"High":return["Implement automatic failover mechanisms","Deploy real-time monitoring and alerting","Set up geographically distributed backups","Implement advanced load balancing","Create comprehensive disaster recovery plan"];case"Very High":return["Implement multi-site active-active configuration","Deploy continuous data protection","Use fully automated recovery mechanisms","Implement zero-downtime deployment processes","Deploy dedicated site reliability engineering"];default:return["Standard availability requirements."]}}function Ht(e,t){if("confidentiality"===e)switch(t){case"None":return"No specific technologies";case"Low":return"Password managers, basic access control lists";case"Moderate":return"LDAP, Active Directory, TLS 1.2+, AES-128";case"High":return"MFA solutions, DLP tools, AES-256, Key Management Systems";case"Very High":return"Zero-trust platforms, HSMs, Advanced SIEM/SOAR, PAM solutions";default:return"Standard security technologies"}if("integrity"===e)switch(t){case"None":return"No specific technologies";case"Low":return"Form validation libraries, database constraints";case"Moderate":return"Checksum tools, hash functions (SHA-256), validation frameworks";case"High":return"Digital signature tools, cryptographic libraries, audit platforms";case"Very High":return"Blockchain frameworks, zero-knowledge proof systems, formal verification tools";default:return"Standard integrity technologies"}switch(t){case"None":return"No specific technologies";case"Low":return"Basic monitoring tools, manual backup solutions";case"Moderate":return"Load balancers, backup solutions, monitoring systems";case"High":return"Clustering solutions, automated failover systems, advanced monitoring";case"Very High":return"Global load balancing, containerization, automated recovery systems";default:return"Standard availability technologies"}}function Rt(e,t){if("confidentiality"===e)switch(t){case"None":return"No specific configurations";case"Low":return"Basic password policies, minimal HTTPS";case"Moderate":return"RBAC configurations, TLS 1.2+, standard encryption setup";case"High":return"MFA policies, DLP rules, key management procedures";case"Very High":return"Zero-trust policies, HSM integration, advanced access controls";default:return"Standard security configurations"}if("integrity"===e)switch(t){case"None":return"No specific configurations";case"Low":return"Basic validation rules, simple error handling";case"Moderate":return"Comprehensive validation rules, hash verification setup";case"High":return"Digital signature verification, advanced audit logging, strong change control";case"Very High":return"Blockchain node configuration, immutable storage settings";default:return"Standard integrity configurations"}switch(t){case"None":return"No specific configurations";case"Low":return"Basic monitoring alerts, manual backup procedures";case"Moderate":return"Redundant configurations, backup schedules, load balancer settings";case"High":return"Cluster configurations, automated failover settings, monitoring rules";case"Very High":return"Multi-region deployments, automated scaling, zero-downtime configurations";default:return"Standard availability configurations"}}function $t(e,t){if("confidentiality"===e)switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic security knowledge","Access control fundamentals"];case"Moderate":return["Identity management","Encryption technologies","Authentication systems"];case"High":return["Advanced cryptography","Identity and access management","Security architecture","Data protection"];case"Very High":return["Security architecture","Advanced cryptography","Zero-trust implementation","Data protection specialization","Hardware security"];default:return["General security knowledge"]}if("integrity"===e)switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic data validation","Error handling"];case"Moderate":return["Data validation techniques","Database integrity","Error handling"];case"High":return["Cryptographic verification","Digital signatures","Secure logging","Change management"];case"Very High":return["Advanced cryptography","Formal verification","Distributed ledger technologies","Immutable logging systems"];default:return["Data integrity fundamentals"]}switch(t){case"None":return["No specific expertise required"];case"Low":return["Basic system monitoring","Manual recovery procedures"];case"Moderate":return["System redundancy","Backup management","Basic load balancing"];case"High":return["High availability architecture","Disaster recovery","Advanced monitoring","Automated failover"];case"Very High":return["Distributed systems","Site reliability engineering","Global load balancing","Chaos engineering","Real-time recovery systems"];default:return["System reliability fundamentals"]}}const At=()=>{const i=localStorage.getItem("availabilityLevel")||"Moderate",a=localStorage.getItem("integrityLevel")||"Moderate",r=localStorage.getItem("confidentialityLevel")||"Moderate",s="true"===localStorage.getItem("darkMode")||window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,[n,o]=e.useState(i),[l,c]=e.useState(a),[d,m]=e.useState(r),[u,g]=e.useState(s);e.useEffect((()=>{}),[n,l,d]);const h=e.useCallback((e=>{(e=>{localStorage.setItem("availabilityLevel",e),o(e)})(e)}),[]),y=e.useCallback((e=>{(e=>{localStorage.setItem("integrityLevel",e),c(e)})(e)}),[]),x=e.useCallback((e=>{(e=>{localStorage.setItem("confidentialityLevel",e),m(e)})(e)}),[]);return e.useEffect((()=>{u?(document.documentElement.classList.add("dark"),document.body.classList.add("dark")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark"))}),[u]),t.jsx("div",{className:"app-container",children:t.jsxs("div",{className:`min-h-screen ${u?"dark bg-gray-900":"bg-gray-100"} p-4 transition-colors duration-300`,children:[t.jsxs("div",{className:"mb-2 px-2 py-0.5 bg-white dark:bg-gray-800 rounded-lg shadow-md flex justify-between items-center app-header",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"w-5 h-5 flex items-center justify-center overflow-hidden mr-1.5",children:t.jsx("img",{src:"./icon-192.png",alt:"CIA Compliance Manager Logo",style:{transform:"scale(0.2)"},"data-testid":"app-logo"})}),t.jsxs("div",{className:"flex flex-row items-center",children:[t.jsx("h1",{"data-testid":A,className:"text-sm font-semibold text-gray-800 dark:text-gray-100 transition-colors duration-300 mr-2",children:p}),t.jsxs("div",{className:"cyber-nav flex items-center flex-wrap",children:[t.jsx("span",{className:"inline-block pulse-dot mr-1","data-testid":"app-indicator",children:"â– "}),t.jsxs("span",{className:"mr-1 version-tag","data-testid":"app-version",children:["v","0.8.8"]}),t.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),t.jsx("a",{href:"https://github.com/Hack23/cia-compliance-manager",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":"source-link",children:"Source"}),t.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),t.jsx("a",{href:"https://hack23.github.io/cia-compliance-manager/documentation.html",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":"docs-link",children:"Doc"}),t.jsx("span",{className:"mx-1 nav-separator",children:"â€¢"}),t.jsx("a",{href:"https://hack23.com/",target:"_blank",rel:"noopener noreferrer",className:"cyber-link","data-testid":"author-link",children:"Hack23"})]})]})]}),t.jsx("button",{onClick:()=>{(e=>{const t="function"==typeof e?e(u):e;localStorage.setItem("darkMode",String(t)),g(t)})((e=>!e))},className:"theme-toggle-btn","data-testid":"theme-toggle",children:u?"â˜€ï¸ Light":"ðŸŒ™ Dark"})]}),t.jsx("div",{className:"w-full max-w-[1600px] mx-auto",children:t.jsxs("div",{"data-testid":"dashboard-grid",className:"dashboard-grid-container",children:[t.jsx("div",{className:"grid-widget-container",children:t.jsx(tt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,onAvailabilityChange:h,onIntegrityChange:y,onConfidentialityChange:x,testId:"widget-security-level"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(Ye,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-business-impact"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(at,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-security-summary"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(mt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-value-creation"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(dt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-cost-estimation"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(rt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-compliance-status"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(yt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-confidentiality-impact"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(xt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"integrity-impact-widget"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(ht,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-availability-impact"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(It,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-technical-details"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(jt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"widget-security-visualization"})}),t.jsx("div",{className:"grid-widget-container",children:t.jsx(vt,{availabilityLevel:n,integrityLevel:l,confidentialityLevel:d,testId:"security-resources-widget"})})]})})]})})};function Dt(){return t.jsx("div",{className:"app-container","data-testid":$,children:t.jsx(At,{})})}i.createRoot(document.getElementById("root")).render(t.jsx(a.StrictMode,{children:t.jsx(Dt,{})}));
//# sourceMappingURL=index-DE2jbmuD.js.map
