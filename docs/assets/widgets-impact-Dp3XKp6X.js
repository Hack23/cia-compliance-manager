import{r as c,j as t,R as A}from"./react-vendor-CfW4w6aS.js";import{e as j,i as N,t as k,v as L,w as M,x as R,y as D,z as P,A as f,B,D as O,E as W,F as Y,G as F,W as K,a as V,b as G,c as U,g as X,m as z,H as J,I as H,J as S,K as q,L as _,M as Q,N as E}from"./widgets-assessment-Cd1Up9vA.js";function Z(e,a){const{ciaContentService:s}=j();return c.useMemo(()=>{if(N(s))return null;try{const n=s.getComponentDetails(e,a);return N(n)?null:n}catch(n){return console.error(`Error getting ${e} details:`,n),null}},[s,e,a])}function ee(e,a){const{ciaContentService:s}=j();return c.useMemo(()=>{if(N(s))return k(e,a);try{return s.getBusinessImpact(e,a)||k(e,a)}catch(n){return console.error(`Error getting ${e} business impact:`,n),k(e,a)}},[s,e,a])}function me(e){const[a,s]=c.useState({availability:e?.availability??"Moderate",integrity:e?.integrity??"Moderate",confidentiality:e?.confidentiality??"Moderate"}),l=c.useCallback((r,d)=>{s(m=>({...m,[r]:d}))},[]),n=c.useCallback((r="Moderate")=>{s({availability:r,integrity:r,confidentiality:r})},[]),i=c.useCallback(r=>a[r],[a]);return{levels:a,setLevel:l,resetLevels:n,getLevel:i}}function be(e,a){const[s,l]=c.useState(()=>{if(typeof window>"u")return a;try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):a}catch(i){return console.warn(`Error reading localStorage key "${e}":`,i),a}}),n=c.useCallback(i=>{try{l(r=>{const d=i instanceof Function?i(r):i;return typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(d)),d})}catch(r){console.error(`Error saving to localStorage key "${e}":`,r)}},[e]);return c.useEffect(()=>{if(typeof window>"u")return;const i=r=>{if(r.key===e&&r.newValue!==null)try{l(JSON.parse(r.newValue))}catch(d){console.warn(`Error parsing storage event for key "${e}":`,d)}};return window.addEventListener("storage",i),()=>{window.removeEventListener("storage",i)}},[e]),[s,n]}function ye(e){const{shortcuts:a,enabled:s=!0,preventDefault:l=!0,stopPropagation:n=!1}=e,i=c.useRef(a),r=c.useRef({preventDefault:l,stopPropagation:n});c.useEffect(()=>{i.current=a,r.current={preventDefault:l,stopPropagation:n}},[a,l,n]);const d=c.useCallback(m=>{if(!L()||M(m))return;const o=R(m),u=Object.values(i.current).find(y=>{if(y.enabled===!1)return!1;const h=D(y.keys,y.platformKeys);return P(o,h)});if(u){f.debug("Keyboard shortcut triggered",{id:u.id,keys:o,description:u.description}),r.current.preventDefault&&m.preventDefault(),r.current.stopPropagation&&m.stopPropagation();try{u.handler()}catch(y){f.error("Error executing keyboard shortcut handler",{id:u.id,error:y})}}},[]);c.useEffect(()=>{if(!(!s||!L()))return f.debug("Registering keyboard shortcuts"),window.addEventListener("keydown",d),()=>{f.debug("Unregistering keyboard shortcuts"),window.removeEventListener("keydown",d)}},[s,d])}function te(e){return{confidentiality:{bg:"bg-purple-50 dark:bg-purple-900/20",text:"text-purple-800 dark:text-purple-300",border:"border-l-4 border-purple-500 dark:border-purple-400",badge:"bg-purple-100 dark:bg-purple-900/30"},integrity:{bg:"bg-green-50 dark:bg-green-900/20",text:"text-green-800 dark:text-green-300",border:"border-l-4 border-green-500 dark:border-green-400",badge:"bg-green-100 dark:bg-green-900/30"},availability:{bg:"bg-blue-50 dark:bg-blue-900/20",text:"text-blue-800 dark:text-blue-300",border:"border-l-4 border-blue-500 dark:border-blue-400",badge:"bg-blue-100 dark:bg-blue-900/30"}}[e]}const ae=e=>{switch(e){case"blue":return"bg-blue-100 dark:bg-blue-900 border-blue-200 dark:border-blue-800";case"green":return"bg-green-100 dark:bg-green-900 border-green-200 dark:border-green-800";case"orange":return"bg-orange-100 dark:bg-orange-900 border-orange-200 dark:border-orange-800";default:{const a=e;throw new Error(`Unsupported color: ${String(a)}`)}}},re=e=>{switch(e){case"blue":return"text-blue-700 dark:text-blue-300";case"green":return"text-green-700 dark:text-green-300";case"orange":return"text-orange-700 dark:text-orange-300";default:{const a=e;throw new Error(`Unsupported color: ${String(a)}`)}}},se=e=>{switch(e){case"blue":return"bg-blue-50 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300";case"green":return"bg-green-50 text-green-700 dark:bg-green-900/50 dark:text-green-300";case"orange":return"bg-orange-50 text-orange-700 dark:bg-orange-900/50 dark:text-orange-300";default:{const a=e;throw new Error(`Unsupported color: ${String(a)}`)}}},ie=({impact:e,color:a,testId:s="business-impact-section"})=>{const l=e.financial?.riskLevel||e.operational?.riskLevel||"Unknown",n=ae(a),i=re(a),r=se(a);return t.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg border shadow-sm security-card","data-testid":s,children:[t.jsxs("h4",{className:"text-md font-medium mb-3 flex items-center",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’¼"}),"Business Impact",t.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["Risk: ",l]})]}),t.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-4","data-testid":`${s}-summary`,children:e.summary||"No business impact data available"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.financial&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ’°"}),t.jsx("span",{className:`font-medium ${i}`,children:"Financial Impact"})]}),t.jsx("p",{className:"text-caption text-gray-700 dark:text-gray-300",children:e.financial.description||"No financial impact information available"}),e.financial.annualRevenueLoss&&t.jsxs("p",{className:"text-caption text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Annual Revenue Loss: "}),e.financial.annualRevenueLoss]})]}),e.operational&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"âš™ï¸"}),t.jsx("span",{className:`font-medium ${i}`,children:"Operational Impact"})]}),t.jsx("p",{className:"text-caption text-gray-700 dark:text-gray-300",children:e.operational.description||"No operational impact information available"}),e.operational.meanTimeToRecover&&t.jsxs("p",{className:"text-caption text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Mean Time to Recover: "}),e.operational.meanTimeToRecover]})]}),e.reputational&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ†"}),t.jsx("span",{className:`font-medium ${i}`,children:"Reputational Impact"})]}),t.jsx("p",{className:"text-caption text-gray-700 dark:text-gray-300",children:e.reputational.description||"No reputational impact information available"}),e.reputational.reputationalImpact&&t.jsx("p",{className:"text-caption text-gray-700 dark:text-gray-300 mt-1",children:e.reputational.reputationalImpact})]}),e.strategic&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸŽ¯"}),t.jsx("span",{className:`font-medium ${i}`,children:"Strategic Impact"})]}),t.jsx("p",{className:"text-caption text-gray-700 dark:text-gray-300",children:e.strategic.description||"No strategic impact information available"}),e.strategic.competitiveAdvantage&&t.jsxs("p",{className:"text-caption text-gray-700 dark:text-gray-300 mt-1",children:[t.jsx("span",{className:"font-medium",children:"Competitive Advantage: "}),e.strategic.competitiveAdvantage]})]}),e.regulatory&&t.jsxs("div",{className:`p-2 rounded-md bg-opacity-10 dark:bg-opacity-20 border ${n}`,children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx("span",{className:"mr-2",children:"ðŸ“œ"}),t.jsx("span",{className:`font-medium ${i}`,children:"Regulatory Impact"})]}),t.jsx("p",{className:"text-caption text-gray-700 dark:text-gray-300",children:e.regulatory.description||"No regulatory impact information available"}),e.regulatory.complianceImpact&&t.jsx("p",{className:"text-caption text-gray-700 dark:text-gray-300 mt-1",children:e.regulatory.complianceImpact}),e.regulatory.complianceViolations&&e.regulatory.complianceViolations.length>0&&t.jsxs("div",{className:"mt-1",children:[t.jsxs("span",{className:"text-caption font-medium text-gray-700 dark:text-gray-300",children:["Potential Violations:"," "]}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.regulatory.complianceViolations.map((d,m)=>t.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${r}`,children:d},m))})]})]})]})]})},x=({label:e,value:a,unit:s,icon:l,description:n,variant:i="default",testId:r="metric-card",className:d="",ariaLabel:m})=>{const u={default:{container:"border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",value:"text-gray-800 dark:text-gray-200",label:"text-gray-700 dark:text-gray-300",description:"text-gray-600 dark:text-gray-400"},primary:{container:"border-primary-light dark:border-primary-dark bg-primary-light/10 dark:bg-primary-dark/20",value:"text-primary-dark dark:text-primary-light",label:"text-primary-dark dark:text-primary-light",description:"text-primary-dark/70 dark:text-primary-light/70"},success:{container:"border-green-300 dark:border-green-700 bg-green-50 dark:bg-green-900/20",value:"text-green-700 dark:text-green-300",label:"text-green-700 dark:text-green-300",description:"text-green-600 dark:text-green-400"},warning:{container:"border-yellow-300 dark:border-yellow-700 bg-yellow-50 dark:bg-yellow-900/20",value:"text-yellow-700 dark:text-yellow-300",label:"text-yellow-700 dark:text-yellow-300",description:"text-yellow-600 dark:text-yellow-400"},error:{container:"border-red-300 dark:border-red-700 bg-red-50 dark:bg-red-900/20",value:"text-red-700 dark:text-red-300",label:"text-red-700 dark:text-red-300",description:"text-red-600 dark:text-red-400"},info:{container:"border-blue-300 dark:border-blue-700 bg-blue-50 dark:bg-blue-900/20",value:"text-blue-700 dark:text-blue-300",label:"text-blue-700 dark:text-blue-300",description:"text-blue-600 dark:text-blue-400"}}[i];return t.jsxs("div",{className:`p-sm border rounded-md shadow-sm ${u.container} ${d}`,"data-testid":r,"aria-label":m||`${e}: ${a}${s||""}`,children:[t.jsxs("div",{className:`flex items-center ${l?"justify-between":"justify-end"} mb-sm`,children:[l&&t.jsx("span",{className:"text-body","aria-hidden":"true",children:l}),t.jsxs("span",{className:`text-heading font-bold leading-none ${u.value}`,"data-testid":`${r}-value`,children:[a,s&&t.jsx("span",{className:s.startsWith(" ")?"":"ml-1",children:s})]})]}),t.jsx("p",{className:`text-caption font-medium ${u.label}`,"data-testid":`${r}-label`,children:e}),n&&t.jsx("p",{className:`text-xs mt-sm ${u.description}`,"data-testid":`${r}-description`,children:n})]})},I=({title:e,children:a,subtitle:s,icon:l,className:n="",testId:i="widget-section",ariaLabelledBy:r,variant:d="default"})=>{const m={default:"border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",primary:"border-primary-light dark:border-primary-dark bg-primary-light/10 dark:bg-primary-dark/20",success:"border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20",info:"border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20",warning:"border-yellow-200 dark:border-yellow-800 bg-yellow-50 dark:bg-yellow-900/20",error:"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20"},o=r||`${i}-heading`;return t.jsxs("section",{className:`p-sm border rounded-md shadow-sm ${m[d]} ${n}`,"data-testid":i,"aria-labelledby":o,children:[t.jsxs("div",{className:"flex items-center gap-sm mb-sm",children:[l&&t.jsx("span",{className:"text-body","aria-hidden":"true",children:l}),t.jsx("h3",{className:"text-body-lg font-semibold text-gray-800 dark:text-gray-200",id:o,children:e})]}),s&&t.jsx("p",{className:"text-caption text-gray-600 dark:text-gray-400 mb-sm",children:s}),t.jsx("div",{children:a})]})},ne=e=>{const a=te(e);switch(e){case"availability":return{titleKey:"AVAILABILITY_IMPACT",iconKey:"AVAILABILITY_IMPACT",defaultTitle:"Availability Impact Analysis",defaultIcon:"â±ï¸",color:"blue",textClass:a.text,ariaDescription:"Business impact of availability controls including uptime targets and recovery objectives",categoryLabel:"Availability",getSecurityBadgeTestId:(s,l)=>l.label("security-level")};case"integrity":return{titleKey:"INTEGRITY_IMPACT",iconKey:"INTEGRITY_IMPACT",defaultTitle:"Integrity Impact Analysis",defaultIcon:"âœ“",color:"green",textClass:a.text,ariaDescription:"Business impact of integrity controls including data accuracy and validation mechanisms",categoryLabel:"Integrity",getSecurityBadgeTestId:(s,l)=>l.label("security-badge")};case"confidentiality":return{titleKey:"CONFIDENTIALITY_IMPACT",iconKey:"CONFIDENTIALITY_IMPACT",defaultTitle:"Confidentiality Impact Analysis",defaultIcon:"ðŸ”’",color:"orange",textClass:a.text,ariaDescription:"Business impact of confidentiality controls including data classification and privacy measures",categoryLabel:"Confidentiality",getSecurityBadgeTestId:(s,l)=>l.label("security-badge")};default:{const s=e;throw new Error(`Unsupported CIA component in ImpactWidget: ${String(s)}`)}}},le=e=>{switch(e){case"availability":return{prefix:E.AVAILABILITY_IMPACT_PREFIX,widgetIds:Q};case"integrity":return{prefix:_.INTEGRITY_IMPACT_PREFIX,widgetIds:q};case"confidentiality":return{prefix:S.CONFIDENTIALITY_IMPACT_PREFIX,widgetIds:H};default:{const a=e;throw new Error(`Unsupported CIA component in getTestIds: ${String(a)}`)}}},v=A.memo(({component:e,level:a,className:s="",testId:l,showExtendedDetails:n=!1,onError:i})=>{const r=c.useMemo(()=>ne(e),[e]),d=c.useMemo(()=>le(e),[e]),m=l||d.prefix,o=c.useMemo(()=>B(a||"Moderate"),[a]),{ciaContentService:u,error:y,isLoading:h}=j(),C=c.useCallback(g=>{i&&i(g)},[i]);A.useEffect(()=>{y&&C(y)},[y,C]);const p=Z(e,o),T=ee(e,o),w=c.useMemo(()=>{if(!n||!u)return[];try{return u.getRecommendations(e,o)||[]}catch(g){return console.error(`Error getting ${e} recommendations:`,g),[]}},[n,u,e,o]),b=c.useMemo(()=>{switch(e){case"availability":{const g=F(o);return{type:"availability",data:{uptime:p?.uptime||g.uptime,rto:p?.rto||g.rto,rpo:p?.rpo||g.rpo,mttr:p?.mttr||g.mttr,sla:p?.sla||g.sla}}}case"integrity":return{type:"integrity",data:{validationLevel:p?.validationLevel||Y(o),errorRate:p?.errorRate||W(o)}};case"confidentiality":{let g;if(u)try{g=u.getInformationSensitivity(o)}catch{g=`${o} Classification`}else g=`${o} Classification`;return{type:"confidentiality",data:{dataClassification:g,privacyImpact:p?.privacyImpact||O(o)}}}default:{const g=e;throw new Error(`Unsupported CIA component in metrics calculation: ${String(g)}`)}}},[e,o,p,u]);return t.jsx(K,{widgetName:`${r.categoryLabel} Impact`,children:t.jsx(V,{title:U[r.titleKey]||r.defaultTitle,icon:G[r.iconKey]||r.defaultIcon,className:s,testId:m,isLoading:h,error:y,children:t.jsxs("div",{className:"p-sm space-y-sm",role:"region","aria-label":X(r.defaultTitle,r.ariaDescription),children:[t.jsxs("section",{className:"mb-sm","aria-labelledby":`${e}-level-heading`,children:[t.jsxs("h3",{id:`${e}-level-heading`,className:"sr-only",children:["Current ",r.categoryLabel," Security Level"]}),t.jsx(z,{category:r.categoryLabel,level:o,colorClass:J(r.color),textClass:r.textClass,testId:r.getSecurityBadgeTestId(m,d.widgetIds)})]}),T&&t.jsxs("section",{className:"mb-sm","aria-labelledby":`${e}-business-impact-heading`,children:[t.jsx("h3",{id:`${e}-business-impact-heading`,className:"text-body-lg font-semibold text-gray-800 dark:text-gray-100 mb-sm",children:"Business Impact"}),t.jsx(ie,{impact:T,color:r.color,testId:d.widgetIds.section("business-impact")})]}),b.type==="availability"&&t.jsxs(I,{title:"SLA Metrics",icon:"â±ï¸",variant:"info",className:"mb-sm",ariaLabelledBy:"sla-metrics-heading",testId:d.widgetIds.section("sla-metrics"),children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-sm mb-sm",role:"group","aria-label":"Service level agreement metrics",children:[t.jsx(x,{label:"Uptime Target",value:b.data.uptime,icon:"ðŸ“ˆ",description:"Expected system availability",variant:"info",testId:d.widgetIds.label("uptime")}),t.jsx(x,{label:"Recovery Time Objective",value:b.data.rto,icon:"â±ï¸",description:"Time to restore service",variant:"info",testId:d.widgetIds.label("rto")}),t.jsx(x,{label:"Recovery Point Objective",value:b.data.rpo,icon:"ðŸ’¾",description:"Maximum data loss allowed",variant:"info",testId:d.widgetIds.label("rpo")})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-sm",children:t.jsx(x,{label:"Service Level Agreement",value:b.data.sla,icon:"ðŸ“‹",description:"Support coverage period",variant:"info",testId:d.widgetIds.label("sla")})})]}),b.type==="integrity"&&t.jsx(I,{title:"Data Integrity Metrics",icon:"ðŸ“Š",variant:"success",className:"mb-sm",testId:d.widgetIds.section("metrics"),children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-sm",children:[t.jsx(x,{label:"Data Validation Controls",value:b.data.validationLevel,icon:"âœ“",variant:"success",testId:d.widgetIds.label("validation")}),t.jsx(x,{label:"Acceptable Error Rate",value:b.data.errorRate,icon:"ðŸ“‰",variant:"success",testId:d.widgetIds.label("error-rate")})]})}),b.type==="confidentiality"&&t.jsxs(t.Fragment,{children:[t.jsx(I,{title:"Data Protection",icon:"ðŸ“Š",variant:"primary",className:"mb-sm",testId:d.widgetIds.section("data-protection"),children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-sm",children:t.jsx(x,{label:"Data Classification",value:b.data.dataClassification,icon:"ðŸ·ï¸",description:"Level of data sensitivity",variant:"primary",testId:d.widgetIds.label("classification")})})}),t.jsx(I,{title:"Privacy Impact",icon:"ðŸ”’",variant:"primary",className:"mb-sm",testId:d.widgetIds.section("privacy-impact"),children:t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-sm",children:t.jsx(x,{label:"Privacy Impact",value:b.data.privacyImpact,icon:"ðŸ›¡ï¸",variant:"primary",testId:d.widgetIds.label("privacy")})})})]}),n&&e==="integrity"&&w.length>0&&t.jsxs("div",{className:"mt-md",children:[t.jsx("h3",{className:"text-lg font-medium mb-sm",children:"Recommendations"}),t.jsx("ul",{className:"list-disc pl-5 space-y-sm",children:w.map((g,$)=>t.jsx("li",{className:"text-sm text-gray-600 dark:text-gray-400",children:g},$))})]})]})})})});v.displayName="ImpactWidget";const de=({availabilityLevel:e,integrityLevel:a,confidentialityLevel:s,showExtendedDetails:l=!1,className:n="",testId:i=`widget-${E.AVAILABILITY_IMPACT_PREFIX}`,onError:r})=>t.jsx(v,{component:"availability",level:e,className:n,testId:i,showExtendedDetails:l,onError:r}),pe=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"})),oe=({availabilityLevel:e,integrityLevel:a,confidentialityLevel:s,className:l="",testId:n=`widget-${S.CONFIDENTIALITY_IMPACT_PREFIX}`,showExtendedDetails:i=!1,onError:r})=>t.jsx(v,{component:"confidentiality",level:s,className:l,testId:n,showExtendedDetails:i,onError:r}),xe=Object.freeze(Object.defineProperty({__proto__:null,default:oe},Symbol.toStringTag,{value:"Module"})),ce=({availabilityLevel:e,integrityLevel:a,confidentialityLevel:s,className:l="",testId:n=`widget-${_.INTEGRITY_IMPACT_PREFIX}`,showExtendedDetails:i=!1,onError:r})=>t.jsx(v,{component:"integrity",level:a,className:l,testId:n,showExtendedDetails:i,onError:r}),fe=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"}));export{pe as A,xe as C,fe as I,me as a,ye as b,be as u};
//# sourceMappingURL=widgets-impact-Dp3XKp6X.js.map
