import{r as u,j as e}from"./react-vendor-DYnYXy5G.js";import{u as v,n,g as a,a as f,W as S,b as w,c as I,d as C,e as R,f as V,R as T,S as o,h as E}from"./index-D4CDDWWH.js";import"./chart-D_MT0XO1.js";const W=({availabilityLevel:s,integrityLevel:t,confidentialityLevel:r,className:x="",testId:m="security-visualization-widget"})=>{const{error:b,isLoading:h}=v(),i=u.useMemo(()=>{const d=n(s),l=n(t),c=n(r),p=a(d),j=a(l),k=a(c),N=p+j+k;return Math.round(N/12*100)},[s,t,r]),g=u.useMemo(()=>{const d=E(s,t,r);return f(d)},[s,t,r]),y=()=>{const d=a(s),l=a(t),c=a(r);return s===t&&t===r&&(s==="High"||s==="Very High")?e.jsx("div",{"data-testid":"balanced-recommendation",className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg mt-4",children:e.jsx("p",{className:"text-sm",children:"Your security posture is well-balanced with strong controls across all CIA components."})}):e.jsxs("div",{className:"space-y-2 mt-4","data-testid":"security-recommendations",children:[d<2&&e.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded",children:e.jsx("p",{className:"text-sm",children:"Consider improving availability controls to ensure business continuity."})}),l<3&&e.jsx("div",{className:"p-2 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded",children:e.jsx("p",{className:"text-sm",children:"Enhance data validation mechanisms and change management to improve integrity."})}),c<2&&e.jsx("div",{className:"p-2 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded",children:e.jsx("p",{className:"text-sm",children:"Strengthen access controls and data protection to improve confidentiality."})})]})};return e.jsx(S,{widgetName:"Security Visualization",children:e.jsx(w,{title:C.SECURITY_VISUALIZATION,icon:I.SECURITY_VISUALIZATION,className:x,testId:m,isLoading:h,error:b,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Posture"}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Security Score"}),e.jsx("div",{className:"text-3xl font-bold","data-testid":"security-score-value",children:i})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Risk Level"}),e.jsx("div",{className:`text-xl font-bold ${R(g)}`,"data-testid":"risk-level",children:g})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Security Level"}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${V(i)}`,style:{width:`${i}%`},"data-testid":"security-score-bar"})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mt-1",children:[e.jsx("div",{children:"Critical"}),e.jsx("div",{children:"High"}),e.jsx("div",{children:"Medium"}),e.jsx("div",{children:"Low"}),e.jsx("div",{children:"Minimal"})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Security Components"}),e.jsx("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:e.jsx(T,{availabilityLevel:s,integrityLevel:t,confidentialityLevel:r,testId:`${m}-radar-chart`})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Component Details"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20 rounded-lg","data-testid":"confidentiality-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-purple-800 dark:text-purple-300",children:"Confidentiality"}),e.jsx(o,{level:r,testId:"confidentiality-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-purple-500 h-1.5 rounded-full",style:{width:`${a(r)/4*100}%`},"data-testid":"confidentiality-gauge"})})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900 dark:bg-opacity-20 rounded-lg","data-testid":"integrity-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-green-800 dark:text-green-300",children:"Integrity"}),e.jsx(o,{level:t,testId:"integrity-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${a(t)/4*100}%`},"data-testid":"integrity-gauge"})})]}),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","data-testid":"availability-component",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-md font-medium text-blue-800 dark:text-blue-300",children:"Availability"}),e.jsx(o,{level:s,testId:"availability-level-indicator"})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full",style:{width:`${a(s)/4*100}%`},"data-testid":"availability-gauge"})})]})]})]}),y(),e.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg mt-4",children:[e.jsx("h3",{className:"text-md font-medium mb-2",children:"Security Visualization Key"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:"The security score represents your overall security posture based on your CIA triad levels. The risk level indicates the potential business risk associated with your current security posture."}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-2 text-xs",children:[e.jsx("div",{className:"p-1 bg-red-100 text-red-800 dark:bg-red-900 dark:bg-opacity-30 dark:text-red-300 rounded text-center",children:"Critical Risk"}),e.jsx("div",{className:"p-1 bg-orange-100 text-orange-800 dark:bg-orange-900 dark:bg-opacity-30 dark:text-orange-300 rounded text-center",children:"High Risk"}),e.jsx("div",{className:"p-1 bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:bg-opacity-30 dark:text-yellow-300 rounded text-center",children:"Medium Risk"}),e.jsx("div",{className:"p-1 bg-green-100 text-green-800 dark:bg-green-900 dark:bg-opacity-30 dark:text-green-300 rounded text-center",children:"Low Risk"}),e.jsx("div",{className:"p-1 bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300 rounded text-center",children:"Minimal Risk"})]})]})]})})})};export{W as default};
//# sourceMappingURL=SecurityVisualizationWidget-Cr3QDHkt.js.map
