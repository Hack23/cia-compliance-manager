import{j as e,r as m}from"./react-vendor-BzhlA2NX.js";import{e as X,i as j,n as U,o as ne,N as Y,W as J,a as ee,O as ce,b as te,c as re,g as ae,P as B,h as P,j as se,T as v,l as le,Q as Z,R as oe,U as V,X as de}from"./widgets-assessment-29On9S3B.js";const me=(t,r)=>t?t.length>r?`${t.substring(0,r)}...`:t:"",ue=({resource:t,onClick:r,className:n="",testId:o})=>{const c=()=>{r?r(t):window.open(t.url,"_blank","noopener,noreferrer")};return e.jsxs("div",{className:`bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 mb-4 hover:shadow-lg transition-shadow ${n}`,onClick:c,role:"button",tabIndex:0,onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&c()},"data-testid":o||"resource-item",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:t.title}),e.jsx("div",{className:"text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-100 px-2 py-1 rounded",children:t.type||"General"})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-3",children:me(t.description||"",100)}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[t.component&&e.jsxs("span",{className:"mr-2",children:["Component: ",t.component]}),t.source&&e.jsxs("span",{className:"mr-2",children:["Source: ",t.source]}),t.level&&e.jsxs("span",{children:["Level: ",t.level]})]}),e.jsx("div",{className:"mt-2 flex flex-wrap",children:t.tags?.map((y,w)=>e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded mr-1 mb-1",children:y},w))})]})},ge=({availabilityLevel:t,integrityLevel:r,confidentialityLevel:n,className:o="",testId:c=ce.WIDGET,limit:y=8,showTopResourcesOnly:w=!1})=>{const{ciaContentService:u,error:E,isLoading:i}=X(),[b,R]=m.useState(null),[N,x]=m.useState(""),[d,k]=m.useState(1),[a,p]=m.useState(y),g=m.useMemo(()=>{try{if(j(u))return[];const s=U(u.getSecurityResources?.("availability",t))?u.getSecurityResources?.("availability",t):[],l=U(u.getSecurityResources?.("integrity",r))?u.getSecurityResources?.("integrity",r):[],$=U(u.getSecurityResources?.("confidentiality",n))?u.getSecurityResources?.("confidentiality",n):[],_=[...s||[],...l||[],...$||[]],W=[],F=new Set;return _.forEach(S=>{const I=ne(S.url)?S.url:S.title;F.has(I)||(F.add(I),W.push(S))}),W.sort((S,I)=>{const L=Y(S)&&"relevanceScore"in S?S.relevanceScore:0,K=Y(I)&&"relevanceScore"in I?I.relevanceScore:0;return L!==void 0&&K!==void 0?K-L:S.title.localeCompare(I.title)})}catch(s){return console.error("Error getting security resources:",s),[]}},[u,t,r,n]),A=m.useMemo(()=>{const s=new Set;return g.forEach(l=>{l.category&&s.add(l.category)}),Array.from(s).sort()},[g]),h=m.useMemo(()=>{let s=g;if(b&&(s=s.filter(l=>l.category===b)),N.trim()){const l=N.toLowerCase().trim();s=s.filter($=>$.title.toLowerCase().includes(l)||$.description?.toLowerCase().includes(l)||$.tags&&$.tags.some(_=>_.toLowerCase().includes(l)))}return s},[g,b,N]),H=m.useMemo(()=>{const s=d*a,l=s-a;return h.slice(l,s)},[h,d,a]),C=m.useCallback(s=>{R(s),k(1)},[]),T=m.useCallback(s=>{x(s.target.value),k(1)},[]),q=m.useCallback(s=>{k(s)},[]),M=Math.ceil(h.length/a),f=m.useMemo(()=>{try{return j(u)?[]:[u.getTechnicalImplementation?.("availability",t),u.getTechnicalImplementation?.("integrity",r),u.getTechnicalImplementation?.("confidentiality",n)].filter(s=>s!==void 0)}catch(s){return console.error("Error getting implementation guides:",s),[]}},[u,t,r,n]);return e.jsx(J,{widgetName:"Security Resources",children:e.jsx(ee,{title:re.SECURITY_RESOURCES,icon:te.SECURITY_RESOURCES,className:o,testId:c,isLoading:i,error:E,children:e.jsxs("div",{className:"p-md sm:p-lg",role:"region","aria-label":ae("Security Resources","Curated security resources and implementation guides for selected CIA security levels"),children:[e.jsxs("section",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20 rounded-lg","aria-labelledby":"resources-intro-heading",children:[e.jsx("h2",{id:"resources-intro-heading",className:"sr-only",children:"Security Resources Introduction"}),e.jsx("p",{className:"text-sm",children:"This widget provides curated security resources to help implement controls that align with your selected security levels across the CIA triad."})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("aside",{className:"md:w-1/4","aria-label":"Resource filters and search",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"resource-search",className:"block text-sm font-medium mb-1",children:"Search Resources"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"resource-search",type:"text",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-700 rounded-md dark:bg-gray-800 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Search by title, description...",value:N,onChange:T,"data-testid":B.input("search"),"aria-label":"Search security resources by title or description"}),e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-500 dark:text-gray-400","aria-hidden":"true",children:"üîç"})]})]}),A.length>0&&e.jsxs("nav",{className:"mb-4","aria-label":"Resource categories",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Categories"}),e.jsxs("ul",{className:"space-y-2",role:"list",children:[e.jsx("li",{children:e.jsx("button",{className:`w-full text-left px-3 py-2 rounded-md text-sm ${b===null?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,onClick:()=>C(null),"data-testid":B.button("category-all"),"aria-pressed":b===null,children:"All Resources"})}),A.map((s,l)=>e.jsx("li",{children:e.jsx("button",{className:`w-full text-left px-3 py-2 rounded-md text-sm ${b===s?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-gray-100 hover:bg-gray-200 text-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,onClick:()=>C(s),"data-testid":B.button(`category-${l}`),"aria-pressed":b===s,children:s})},s))]})]}),e.jsxs("section",{className:"mb-4","aria-labelledby":"implementation-guidelines-heading",children:[e.jsx("h3",{id:"implementation-guidelines-heading",className:"text-sm font-medium mb-2",children:"Implementation Guidelines"}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-3 rounded-lg text-sm",children:[e.jsx("p",{className:"mb-2 font-medium",children:"Selected Security Levels:"}),e.jsxs("dl",{className:"mb-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("dt",{children:"Confidentiality:"}),e.jsx("dd",{className:"font-medium",children:n})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("dt",{children:"Integrity:"}),e.jsx("dd",{className:"font-medium",children:r})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("dt",{children:"Availability:"}),e.jsx("dd",{className:"font-medium",children:t})]})]}),e.jsx("p",{className:"mb-2 text-xs text-gray-600 dark:text-gray-400",children:"Focus on implementing controls that satisfy all three components for a balanced security posture."})]})]})]}),e.jsxs("div",{className:"md:w-3/4",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Security Resources"}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[h.length," ",h.length===1?"resource":"resources"," ","found"]})]}),h.length===0&&e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg text-center text-gray-500 dark:text-gray-400","data-testid":B.label("no-resources"),children:[e.jsx("p",{className:"mb-2",children:"No resources found."}),e.jsx("p",{className:"text-sm",children:N?"Try adjusting your search terms or clearing filters.":"Resources will appear here when available."})]}),h.length>0&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:H.map((s,l)=>e.jsx(ue,{resource:s,testId:`${c}-resource-${l}`},`${s.url||""}-${l}`))}),M>1&&e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>q(d-1),disabled:d===1,className:`relative inline-flex items-center px-2 py-2 rounded-l-md border ${d===1?"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600 cursor-not-allowed":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"} text-sm font-medium`,children:"Previous"}),Array.from({length:M}).map((s,l)=>e.jsx("button",{onClick:()=>q(l+1),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${d===l+1?"z-10 bg-blue-50 border-blue-500 text-blue-600 dark:bg-blue-900 dark:bg-opacity-30 dark:text-blue-300":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}`,children:l+1},l)),e.jsx("button",{onClick:()=>q(d+1),disabled:d===M,className:`relative inline-flex items-center px-2 py-2 rounded-r-md border ${d===M?"bg-gray-100 text-gray-400 dark:bg-gray-800 dark:text-gray-600 cursor-not-allowed":"bg-white text-gray-500 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"} text-sm font-medium`,children:"Next"})]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Implementation Tips"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-md bg-neutral-light/10 dark:bg-neutral-dark/20 rounded-md",children:[e.jsx("h4",{className:"text-md font-medium mb-2",children:"Getting Started with Implementation"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400 pl-2",children:[e.jsx("li",{children:"Begin with a thorough assessment of your current security controls"}),e.jsx("li",{children:"Prioritize implementations based on risk exposure and business impact"}),e.jsx("li",{children:"Implement controls gradually, starting with foundational elements"}),e.jsx("li",{children:"Document your implementation process and security configurations"}),e.jsx("li",{children:"Test and validate controls after implementation"})]})]}),f.length>0&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[f[2]&&e.jsxs("div",{className:"p-md bg-primary-light/10 dark:bg-primary-dark/20 rounded-md border border-primary-light dark:border-primary-dark",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-primary-dark dark:text-primary-light flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üîí"}),"Confidentiality (",n,")"]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("p",{className:"mb-2",children:f[2].description||"Focus on data protection and access controls."}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Expertise:"})," ",f[2].expertiseLevel||"Standard"]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Effort:"})," ",f[2].developmentEffort||"Medium"]})]})]}),f[1]&&e.jsxs("div",{className:"p-md bg-success-light/10 dark:bg-success-dark/20 rounded-md border border-success-light dark:border-success-dark",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-green-700 dark:text-green-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"‚úì"}),"Integrity (",r,")"]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("p",{className:"mb-2",children:f[1].description||"Focus on data accuracy and validation mechanisms."}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Expertise:"})," ",f[1].expertiseLevel||"Standard"]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Effort:"})," ",f[1].developmentEffort||"Medium"]})]})]}),f[0]&&e.jsxs("div",{className:"p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md border border-info-light dark:border-info-dark",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-blue-700 dark:text-blue-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"‚è±Ô∏è"}),"Availability (",t,")"]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("p",{className:"mb-2",children:f[0].description||"Focus on systems uptime and recovery capabilities."}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Expertise:"})," ",f[0].expertiseLevel||"Standard"]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Effort:"})," ",f[0].developmentEffort||"Medium"]})]})]})]}),e.jsxs("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900 dark:bg-opacity-20 rounded-lg border border-yellow-100 dark:border-yellow-800",children:[e.jsxs("h4",{className:"text-md font-medium mb-2 text-yellow-700 dark:text-yellow-300 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"‚ö†Ô∏è"}),"Common Implementation Challenges"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600 dark:text-gray-400 pl-2",children:[e.jsx("li",{children:"Balancing security with usability and performance"}),e.jsx("li",{children:"Maintaining consistent controls across different environments"}),e.jsx("li",{children:"Integration with legacy systems and applications"}),e.jsx("li",{children:"Building security expertise and awareness across teams"}),e.jsx("li",{children:"Allocating sufficient resources for ongoing maintenance"})]})]})]})]})]})]})]})})})},ve=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));function D(t,r){return{description:he(t,r),technical:ie(t,r),recommendations:G(t,r)}}function he(t,r){if(t==="confidentiality")switch(r){case"None":return"No confidentiality controls implemented, allowing unrestricted access to data.";case"Low":return"Basic confidentiality controls to prevent casual unauthorized access to data.";case"Moderate":return"Standard confidentiality controls with defined access privileges and protections.";case"High":return"Advanced confidentiality controls with strong encryption and strict access management.";case"Very High":return"Comprehensive confidentiality controls with the highest level of protection.";default:return"Standard confidentiality controls."}if(t==="integrity")switch(r){case"None":return"No integrity controls implemented, data can be modified without detection.";case"Low":return"Basic integrity controls that provide minimal protection against unauthorized changes.";case"Moderate":return"Standard integrity controls that detect unauthorized modifications to data.";case"High":return"Advanced integrity controls with cryptographic verification of data.";case"Very High":return"Comprehensive integrity controls with immutable audit trails.";default:return"Standard integrity controls."}switch(r){case"None":return"No availability controls implemented, no guarantees for system uptime.";case"Low":return"Basic availability controls providing minimal resilience to disruptions.";case"Moderate":return"Standard availability controls ensuring reasonable system uptime.";case"High":return"Advanced availability controls with redundancy and quick recovery capabilities.";case"Very High":return"Comprehensive availability controls with maximum fault tolerance.";default:return"Standard availability controls."}}function ie(t,r){if(t==="confidentiality")switch(r){case"None":return"No specific technical controls for protecting data confidentiality.";case"Low":return"Basic access controls and password protection for sensitive resources.";case"Moderate":return"Role-based access control (RBAC), data encryption at rest and in transit, and proper authentication mechanisms.";case"High":return"Granular access control, strong encryption with proper key management, DLP controls, and multi-factor authentication.";case"Very High":return"Zero-trust architecture, advanced encryption with hardware security modules, comprehensive DLP, and context-aware access controls.";default:return"Standard confidentiality technical controls."}if(t==="integrity")switch(r){case"None":return"No specific technical controls for ensuring data integrity.";case"Low":return"Basic input validation and error detection mechanisms.";case"Moderate":return"Comprehensive input validation, checksums, access controls, and error detection.";case"High":return"Digital signatures, cryptographic hashing, strong change control, and comprehensive logging.";case"Very High":return"Blockchain or similar technologies for critical data, immutable audit logs, and formal verification methods.";default:return"Standard integrity technical controls."}switch(r){case"None":return"No specific technical controls for ensuring system availability.";case"Low":return"Basic monitoring and manual recovery procedures.";case"Moderate":return"Redundant components, scheduled backups, load balancing, and defined recovery procedures.";case"High":return"Automatic failover, real-time monitoring, comprehensive disaster recovery, and advanced load balancing.";case"Very High":return"Multi-site active-active configurations, continuous data protection, and fully automated recovery with zero data loss.";default:return"Standard availability technical controls."}}function G(t,r){if(t==="confidentiality")switch(r){case"None":return["No specific requirements."];case"Low":return["Implement user authentication","Use basic password policies","Apply simple access controls","Secure sensitive data storage"];case"Moderate":return["Implement role-based access control","Use standard TLS for data in transit","Encrypt sensitive data at rest","Enforce strong password policies","Implement session management"];case"High":return["Implement multi-factor authentication","Deploy data loss prevention solutions","Use strong encryption for all data","Implement privileged access management","Conduct regular access reviews"];case"Very High":return["Implement zero-trust network architecture","Use hardware security modules for encryption","Deploy advanced data loss prevention","Implement just-in-time access","Use behavioral analytics for access monitoring"];default:return["Standard confidentiality requirements."]}if(t==="integrity")switch(r){case"None":return["No specific requirements."];case"Low":return["Implement basic input validation","Use simple error detection","Apply basic data quality checks"];case"Moderate":return["Implement comprehensive input validation","Use checksums for data verification","Implement change detection mechanisms","Maintain data validation logs","Use database constraints"];case"High":return["Implement digital signatures","Use cryptographic hash verification","Deploy comprehensive audit logging","Implement strict change controls","Use data integrity monitoring"];case"Very High":return["Implement blockchain for critical data","Use immutable audit trails","Deploy formal verification methods","Implement hardware-based integrity controls","Use zero-knowledge proofs where applicable"];default:return["Standard integrity requirements."]}switch(r){case"None":return["No specific requirements."];case"Low":return["Set up basic system monitoring","Implement manual backup procedures","Create simple incident response plan"];case"Moderate":return["Implement redundant components","Set up scheduled backup routines","Deploy basic load balancing","Create disaster recovery procedures","Implement health checks and alerts"];case"High":return["Implement automatic failover mechanisms","Deploy real-time monitoring and alerting","Set up geographically distributed backups","Implement advanced load balancing","Create comprehensive disaster recovery plan"];case"Very High":return["Implement multi-site active-active configuration","Deploy continuous data protection","Use fully automated recovery mechanisms","Implement zero-downtime deployment processes","Deploy dedicated site reliability engineering"];default:return["Standard availability requirements."]}}function pe(t,r){if(t==="confidentiality")switch(r){case"None":return"No specific technologies";case"Low":return"Password managers, basic access control lists";case"Moderate":return"LDAP, Active Directory, TLS 1.2+, AES-128";case"High":return"MFA solutions, DLP tools, AES-256, Key Management Systems";case"Very High":return"HSMs, Zero-trust frameworks, Advanced DLP, AES-256-GCM, Behavioral analytics";default:return"Standard encryption and access control tools"}if(t==="integrity")switch(r){case"None":return"No specific technologies";case"Low":return"Basic input validation libraries, simple checksums";case"Moderate":return"SHA-256, input validation frameworks, database constraints";case"High":return"Digital signature systems, cryptographic hashing, SIEM tools";case"Very High":return"Blockchain platforms, immutable logging systems, formal verification tools";default:return"Standard integrity verification tools"}switch(r){case"None":return"No specific technologies";case"Low":return"Basic monitoring tools, manual backup scripts";case"Moderate":return"Load balancers, backup solutions, monitoring systems";case"High":return"HA clusters, advanced monitoring, automated failover systems";case"Very High":return"Global load balancers, CDP solutions, site reliability platforms, chaos engineering tools";default:return"Standard availability tools"}}function ye(t,r){if(t==="confidentiality")switch(r){case"None":return"No specific configurations";case"Low":return"Password complexity rules, basic session timeouts";case"Moderate":return"RBAC policies, TLS 1.2+, encryption keys rotation every 180 days";case"High":return"MFA required, encryption key rotation every 90 days, privileged access controls";case"Very High":return"Zero-trust policies, HSM-managed keys, continuous authentication, behavioral monitoring";default:return"Standard security configurations"}if(t==="integrity")switch(r){case"None":return"No specific configurations";case"Low":return"Basic input validation rules, error logging";case"Moderate":return"Comprehensive validation rules, checksums for critical data, change logs";case"High":return"Digital signature verification, cryptographic hashing, immutable audit logs";case"Very High":return"Blockchain consensus rules, formal verification policies, hardware integrity checks";default:return"Standard integrity configurations"}switch(r){case"None":return"No specific configurations";case"Low":return"Basic monitoring alerts, manual backup schedules";case"Moderate":return"Load balancer rules, daily backups, health check intervals";case"High":return"Automatic failover policies, real-time replication, RPO < 1 hour";case"Very High":return"Multi-site active-active configuration, continuous replication, RPO near-zero, RTO < 5 minutes";default:return"Standard availability configurations"}}function Q(t,r){if(t==="confidentiality")switch(r){case"None":return["No specific expertise required"];case"Low":return["Basic security knowledge","Access control fundamentals"];case"Moderate":return["Identity management","Encryption technologies","Authentication systems"];case"High":return["Advanced cryptography","Identity and access management","Security architecture","Data protection"];case"Very High":return["Security architecture","Advanced cryptography","Zero-trust implementation","Data protection specialization","Hardware security"];default:return["General security knowledge"]}if(t==="integrity")switch(r){case"None":return["No specific expertise required"];case"Low":return["Basic data validation","Error handling"];case"Moderate":return["Data validation techniques","Database integrity","Error handling"];case"High":return["Cryptographic verification","Digital signatures","Secure logging","Change management"];case"Very High":return["Advanced cryptography","Formal verification","Distributed ledger technologies","Immutable logging systems"];default:return["Data integrity fundamentals"]}switch(r){case"None":return["No specific expertise required"];case"Low":return["Basic system monitoring","Manual recovery procedures"];case"Moderate":return["System redundancy","Backup management","Basic load balancing"];case"High":return["High availability architecture","Disaster recovery","Advanced monitoring","Automated failover"];case"Very High":return["Distributed systems","Site reliability engineering","Global load balancing","Chaos engineering","Real-time recovery systems"];default:return["System reliability fundamentals"]}}function xe(t,r,n,o){const c=a=>se(a)*25,y=m.useMemo(()=>{try{if(j(o))return D("confidentiality",n);const a=o.getComponentDetails?.("confidentiality",n);return j(a)?D("confidentiality",n):a}catch(a){return console.error("Error getting confidentiality details:",a),D("confidentiality",n)}},[o,n]),w=m.useMemo(()=>{try{if(j(o))return D("integrity",r);const a=o.getComponentDetails?.("integrity",r);return j(a)?D("integrity",r):a}catch(a){return console.error("Error getting integrity details:",a),D("integrity",r)}},[o,r]),u=m.useMemo(()=>{try{if(j(o))return D("availability",t);const a=o.getComponentDetails?.("availability",t);return j(a)?D("availability",t):a}catch(a){return console.error("Error getting availability details:",a),D("availability",t)}},[o,t]),E=m.useMemo(()=>{const a=P(n,n,n);return{value:c(a),label:a}},[n]),i=m.useMemo(()=>{const a=P(r,r,r);return{value:c(a),label:a}},[r]),b=m.useMemo(()=>{const a=P(t,t,t);return{value:c(a),label:a}},[t]);return{confidentialityDetails:y,integrityDetails:w,availabilityDetails:u,confidentialityComplexity:E,integrityComplexity:i,availabilityComplexity:b,getTechnicalDescription:(a,p)=>ie(a,p),getTechnicalRequirements:(a,p)=>{try{if(!j(o)){const g=o.getTechnicalRequirements?.(a,p);if(Array.isArray(g)&&g.length>0)return g}return G(a,p)}catch(g){return console.error(`Error getting ${a} technical requirements:`,g),G(a,p)}},getTechnologies:(a,p)=>pe(a,p),getConfigurations:(a,p)=>ye(a,p),getExpertiseRequired:(a,p)=>{try{if(!j(o)){const g=o.getRequiredExpertise?.(a,p);if(Array.isArray(g)&&g.length>0)return g}return Q(a,p)}catch(g){return console.error(`Error getting ${a} expertise requirements:`,g),Q(a,p)}}}}function be(t){return`${{None:.1,Low:.25,Moderate:.5,High:1,"Very High":2}[t]||.5} FTE`}const fe={confidentiality:{icon:"üîí",colorClass:"bg-purple-100 dark:bg-purple-900 dark:bg-opacity-20",textClass:"text-purple-800 dark:text-purple-300",bgClass:"bg-purple-50 dark:bg-purple-900 dark:bg-opacity-20",borderClass:"border-purple-100 dark:border-purple-800",accentClass:"text-purple-500",accentBgClass:"bg-purple-500 dark:bg-purple-600",title:"Confidentiality Controls"},integrity:{icon:"‚úì",colorClass:"bg-green-100 dark:bg-green-900 dark:bg-opacity-20",textClass:"text-green-800 dark:text-green-300",bgClass:"bg-green-50 dark:bg-green-900 dark:bg-opacity-20",borderClass:"border-green-100 dark:border-green-800",accentClass:"text-green-500",accentBgClass:"bg-green-500 dark:bg-green-600",title:"Integrity Controls"},availability:{icon:"‚è±Ô∏è",colorClass:"bg-blue-100 dark:bg-blue-900 dark:bg-opacity-20",textClass:"text-blue-800 dark:text-blue-300",bgClass:"bg-blue-50 dark:bg-blue-900 dark:bg-opacity-20",borderClass:"border-blue-100 dark:border-blue-800",accentClass:"text-blue-500",accentBgClass:"bg-blue-500 dark:bg-blue-600",title:"Availability Controls"}},O=({component:t,level:r,details:n,testId:o,getTechnicalDescription:c,getTechnicalRequirements:y,getTechnologies:w,getConfigurations:u,getExpertiseRequired:E})=>{const i=fe[t],b=x=>se(x)*25,R=m.useMemo(()=>{const x=P(r,r,r);return{value:b(x),label:x}},[r]),N=(x,d,k)=>{if(j(x))return k;if(typeof x=="object"&&d in x){const a=x[d];if(!j(a)&&typeof a=="string")return a}return k};return e.jsxs("div",{className:"mb-6","data-testid":v.section(t),children:[e.jsxs("div",{className:"flex items-center mb-4","data-testid":v.header(),children:[e.jsx("span",{className:`text-xl mr-2 ${i.accentClass}`,children:i.icon}),e.jsx("h3",{className:"text-lg font-medium",children:i.title}),e.jsx("div",{className:"ml-auto",children:e.jsx(le,{category:"",level:r,colorClass:i.colorClass,textClass:i.textClass,testId:`${o}-${t}-badge`})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:`p-4 ${i.bgClass} rounded-lg shadow-sm border ${i.borderClass}`,children:[e.jsx("h4",{className:`text-md font-medium ${i.textClass} mb-3`,children:"Technical Description"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400","data-testid":v.label("description"),children:N(n,"technical",c(t,r))}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:`text-sm font-medium ${i.textClass} mb-2`,children:"Implementation Complexity"}),e.jsxs("div",{className:"flex items-center","data-testid":v.label("development-effort"),children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 dark:bg-gray-700 rounded-full mr-2",children:e.jsx("div",{className:`h-2 ${i.accentBgClass} rounded-full`,style:{width:`${R.value}%`}})}),e.jsx("span",{className:"text-xs font-medium",children:R.label})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{className:`text-sm font-medium ${i.textClass} mb-2`,children:"Personnel Requirements"}),e.jsxs("div",{className:"flex items-center","data-testid":v.label("maintenance-level"),children:[e.jsx("span",{className:"text-sm",children:"Estimated staffing: "}),e.jsx("span",{className:`ml-2 text-sm font-medium ${i.textClass}`,children:be(r)})]})]})]}),e.jsxs("div",{className:"p-md bg-white dark:bg-gray-800 rounded-md shadow-md border border-neutral-light dark:border-neutral-dark",children:[e.jsx("h4",{className:"text-md font-medium mb-3","data-testid":v.header("implementation"),children:"Implementation Requirements"}),e.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-gray-600 dark:text-gray-400","data-testid":v.list("implementation-steps"),children:y(t,r).map((x,d)=>e.jsx("li",{"data-testid":v.item(`requirement-${d}`),children:x},`${t}-req-${d}`))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"p-md bg-white dark:bg-gray-800 rounded-md shadow-md border border-neutral-light dark:border-neutral-dark",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:`mr-2 ${i.accentClass}`,children:"üíª"}),"Technologies"]}),e.jsx("p",{className:`text-sm ${i.textClass}`,children:N(n,"technologies",w(t,r))})]}),e.jsxs("div",{className:"p-md bg-white dark:bg-gray-800 rounded-md shadow-md border border-neutral-light dark:border-neutral-dark",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:`mr-2 ${i.accentClass}`,children:"‚öôÔ∏è"}),"Configurations"]}),e.jsx("p",{className:`text-sm ${i.textClass}`,children:N(n,"configurations",u(t,r))})]})]}),e.jsxs("div",{className:"p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-4",children:[e.jsxs("h4",{className:"text-md font-medium flex items-center mb-3",children:[e.jsx("span",{className:`mr-2 ${i.accentClass}`,children:"üë®‚Äçüíª"}),"Expertise Required"]}),e.jsx("ul",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2","data-testid":v.list("required-expertise"),children:E(t,r).map((x,d)=>e.jsxs("li",{className:"flex items-center text-sm",children:[e.jsx("span",{className:`mr-2 ${i.accentClass}`,children:"‚Ä¢"}),e.jsx("span",{children:x})]},`${t}-exp-${d}`))})]})]})},z=[{id:"confidentiality",label:"Confidentiality",icon:"üîí"},{id:"integrity",label:"Integrity",icon:"‚úì"},{id:"availability",label:"Availability",icon:"‚è±Ô∏è"}],Ne=({availabilityLevel:t,integrityLevel:r,confidentialityLevel:n,className:o="",testId:c="technical-details-widget"})=>{const[y,w]=m.useState("confidentiality"),u=m.useRef(null),E=(h,H)=>{de(h,H,z.length,C=>{w(z[C].id);const T=u.current?.querySelectorAll('button[role="tab"]');T&&T[C]&&T[C].focus()},"horizontal")},{ciaContentService:i,error:b,isLoading:R}=X(),{confidentialityDetails:N,integrityDetails:x,availabilityDetails:d,getTechnicalDescription:k,getTechnicalRequirements:a,getTechnologies:p,getConfigurations:g,getExpertiseRequired:A}=xe(t,r,n,i);return e.jsx(J,{widgetName:"Technical Details",children:e.jsx(ee,{title:re.TECHNICAL_DETAILS,icon:te.TECHNICAL_DETAILS,className:o,testId:c,isLoading:R,error:b,children:e.jsxs("div",{className:"p-md sm:p-lg",role:Z.REGION,"aria-label":ae("Technical Implementation Details","Detailed technical implementation requirements for achieving selected security levels"),children:[e.jsx("section",{className:"mb-md p-md bg-info-light/10 dark:bg-info-dark/20 rounded-md","aria-labelledby":"technical-description-heading",children:e.jsx("p",{id:"technical-description-heading",className:"text-sm",children:"This widget provides technical implementation details for achieving your selected security levels. Use these guidelines when designing and implementing your security controls."})}),e.jsx("div",{className:"flex border-b border-gray-200 dark:border-gray-700 mb-4",children:e.jsxs("div",{ref:u,role:Z.TABLIST,"aria-label":"Technical implementation components",className:"flex",children:[e.jsx("span",{className:"sr-only",id:"tech-tab-keyboard-instructions",children:"Use arrow keys to navigate between tabs. Press Enter or Space to activate a tab."}),z.map((h,H)=>{const C=y===h.id,T=`${c}-tab-${h.id}`,q=`${c}-panel-${h.id}`;return e.jsxs("button",{onClick:()=>{w(h.id)},onKeyDown:M=>E(M,H),className:`py-2 px-4 font-medium text-sm focus:outline-none ${C?h.id==="confidentiality"?"border-b-2 border-primary text-primary-dark dark:text-primary-light":h.id==="integrity"?"border-b-2 border-green-500 text-green-600 dark:text-green-400":"border-b-2 border-blue-500 text-blue-600 dark:text-blue-400":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"}`,"data-testid":v.button(`${h.id}-tab`),...oe(T,C,q),"aria-describedby":"tech-tab-keyboard-instructions",children:[e.jsx("span",{className:"mr-1","aria-hidden":"true",children:h.icon})," ",h.label]},h.id)})]})}),e.jsx("div",{...V(`${c}-panel-confidentiality`,`${c}-tab-confidentiality`,y!=="confidentiality"),children:y==="confidentiality"&&e.jsx(O,{component:"confidentiality",level:n,details:N,ciaContentService:i,testId:c,getTechnicalDescription:k,getTechnicalRequirements:a,getTechnologies:p,getConfigurations:g,getExpertiseRequired:A})}),e.jsx("div",{...V(`${c}-panel-integrity`,`${c}-tab-integrity`,y!=="integrity"),children:y==="integrity"&&e.jsx(O,{component:"integrity",level:r,details:x,ciaContentService:i,testId:c,getTechnicalDescription:k,getTechnicalRequirements:a,getTechnologies:p,getConfigurations:g,getExpertiseRequired:A})}),e.jsx("div",{...V(`${c}-panel-availability`,`${c}-tab-availability`,y!=="availability"),children:y==="availability"&&e.jsx(O,{component:"availability",level:t,details:d,ciaContentService:i,testId:c,getTechnicalDescription:k,getTechnicalRequirements:a,getTechnologies:p,getConfigurations:g,getExpertiseRequired:A})}),e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-medium mb-3 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"üí°"}),"Implementation Notes"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"‚Ä¢"}),e.jsx("span",{children:"Implement these technical controls in a layered approach, starting with foundational controls."})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"‚Ä¢"}),e.jsx("span",{children:"Regular testing and validation are required to ensure controls are functioning as intended."})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"‚Ä¢"}),e.jsx("span",{children:"Consider integrating with existing security infrastructure to maximize effectiveness."})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"mr-2 text-blue-500",children:"‚Ä¢"}),e.jsx("span",{children:"Document all implementation details and maintain up-to-date configuration records."})]})]})]})]})})})},we=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"}));export{ve as S,we as T};
//# sourceMappingURL=widgets-implementation-C_zdtplH.js.map
